*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IXGQUERY                              -01/02/19-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Query System Logger                           * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5647-A01 (C) COPYRIGHT IBM CORP. 1997, 1999                     * 00001200
*                                                                     * 00001300
* STATUS= HBB6608                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The IXGQUERY macro allows a user to retrieve information about * 00002100
*      a log stream.                                                  * 00002200
*                                                                     * 00002300
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00002400
*                                                                     * 00002500
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002600
*                                                                     * 00002700
*01* ENVIRONMENT:                                                     * 00002800
*                                                                     * 00002900
*                                                                     * 00003000
*      Dispatchable unit mode: Task mode.                             * 00003100
*                                                                     * 00003200
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00003300
*                                                                     * 00003400
*      Minimum authorization: Problem or Supervisor state.  Any PSW   * 00003500
*                        key.                                         * 00003600
*                                                                     * 00003700
*      AMODE:            31-bit.                                      * 00003800
*                                                                     * 00003900
*      ASC mode:         Primary or Access Register.                  * 00004000
*                                                                     * 00004100
*      Interrupt status: Enabled for I/O and external interrupts.     * 00004200
*                                                                     * 00004300
*                        The current primary address space must be    * 00004400
*                        the same as the HOME address space at the    * 00004500
*                        time you issued the IXGCONN macro.           * 00004600
*                                                                     * 00004700
*                        The caller's parameter list must be resident * 00004800
*                        in the caller's primary address space.       * 00004900
*                                                                     * 00005000
*                        The caller's buffer must be in the caller's  * 00005100
*                        primary address space and cannot be          * 00005200
*                        ALET-qualified.                              * 00005300
*                                                                     * 00005400
*                        All storage areas specified must be in the   * 00005500
*                        same storage key as the caller.              * 00005600
*                                                                     * 00005700
*      Locks:            No locks held.                               * 00005800
*                                                                     * 00005900
*      Control parameters: None.                                      * 00006000
*                                                                     * 00006100
*                                                                     * 00006200
*                                                                     * 00006300
*01* PROGRAMMING REQUIREMENTS:                                        * 00006400
*                                                                     * 00006500
*    Before issuing this request, a valid connection to the target    * 00006600
*    log stream identified by STREAMTOKEN must exist. Additionally,   * 00006700
*    the connection request (established by the IXGCONN) macro must   * 00006800
*    specify IMPORTCONNECT=YES.                                       * 00006900
*                                                                     * 00007000
*01* RESTRICTIONS:                                                    * 00007100
*                                                                     * 00007200
*                                                                     * 00007300
*    o   The caller's parameter list must be resident in the caller's * 00007400
*        primary address space.                                       * 00007500
*                                                                     * 00007600
*    o   All storage areas specified must be in the same storage key  * 00007700
*        as the caller. Storage areas must exist in the caller's      * 00007800
*        primary address space.                                       * 00007900
*                                                                     * 00008000
*    o   The caller cannot have any enabled, unlocked task (EUT) FRRs * 00008100
*        established.                                                 * 00008200
*                                                                     * 00008300
*                                                                     * 00008400
*                                                                     * 00008500
*01* INPUT REGISTERS:  GR0-GR1     Reserved                           * 00008600
*                      GR2-GR13    Undefined                          * 00008700
*                      GR14-GR15   Reserved                           * 00008800
*                      AR0-AR1     Reserved                           * 00008900
*                      AR2-AR13    Undefined                          * 00009000
*                      AR14-AR15   Reserved                           * 00009100
*                                                                     * 00009200
*01* OUTPUT REGISTERS: GR0         Reason code if GR15 return code is * 00009300
*                                  non-zero                           * 00009400
*                      GR1         Unpredictable                      * 00009500
*                      GR2-GR13    Unchanged                          * 00009600
*                      GR14        Unpredictable                      * 00009700
*                      GR15        Return code                        * 00009800
*                      AR0-AR1     Unpredictable                      * 00009900
*                      AR2-AR13    Unchanged                          * 00010000
*                      AR14-AR15   Unpredictable                      * 00010100
*                                                                     * 00010200
*01* PERFORMANCE IMPLICATIONS:                                        * 00010300
*                                                                     * 00010400
*    None.                                                            * 00010500
*                                                                     * 00010600
*01* SYNTAX:                                                          * 00010700
*                                                                     * 00010800
*[xlabel]  IXGQUERY     STREAMTOKEN=xstreamtoken                      * 00010900
*                    [,CHECKCONNSTATUS=NO                            * 00011000
*                    |     ,BUFFER=xbuffer                            * 00011100
*                    |     ,BUFFLEN=xbufflen]                         * 00011200
*                    [,CHECKCONNSTATUS=YES]                          * 00011300
*                      ,ANSAREA=xansarea                              * 00011400
*                      ,ANSLEN=xanslen                                * 00011500
*                     [,RETCODE=xretcode]                             * 00011600
*                     [,RSNCODE=xrsncode]                             * 00011700
*                     [,PLISTVER=xplistver|IMPLIED_VERSION]         * 00011800
*                    [,MF=S]                                         * 00011900
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 00012000
*                    [,MF=(M,xmfctrl,COMPLETE|NOCHECK)]            * 00012100
*                    [,MF=(E,xmfctrl,COMPLETE|NOCHECK)]            * 00012200
*                                                                     * 00012300
*                                                                     * 00012400
*      Where:                                                         * 00012500
*                                                                     * 00012600
*                                                                     * 00012700
*      [xlabel]                                                       * 00012800
*          is an optional symbol, starting in column 1, that is the   * 00012900
*          name on the IXGQUERY macro invocation.  The name must      * 00013000
*          conform to the rules for an ordinary assembler language    * 00013100
*          symbol.                                                    * 00013200
*          DEFAULT: No name.                                          * 00013300
*                                                                     * 00013400
*                                                                     * 00013500
*                                                                     * 00013600
*                                                                     * 00013700
*      STREAMTOKEN=xstreamtoken                                       * 00013800
*          is the name (RS-type), or address in register (2)-(12), of * 00013900
*          a required 16 character input that specifies the log       * 00014000
*          stream token that was returned by the IXGCONN service.     * 00014100
*                                                                     * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*      [CHECKCONNSTATUS=NO|YES]                                     * 00014600
*          is an optional keyword input that indicates whether or not * 00014700
*          only the Connection status of the logstream should be      * 00014800
*          checked.                                                   * 00014900
*          DEFAULT: NO                                                * 00015000
*                                                                     * 00015100
*                                                                     * 00015200
*          [CHECKCONNSTATUS=NO                                        * 00015300
*              indicates that full IXGQUERY processing should be      * 00015400
*              performed.                                             * 00015500
*                                                                     * 00015600
*                                                                     * 00015700
*              BUFFER=xbuffer                                         * 00015800
*                  is the name (RS-type), or address in register      * 00015900
*                  (2)-(12), of a required character output that      * 00016000
*                  specifies the buffer into which the requested data * 00016100
*                  are to be copied. The contents of the buffer are   * 00016200
*                  mapped by IXGQBUF.                                 * 00016300
*                                                                     * 00016400
*                  The buffer cannot be ALET qualified.               * 00016500
*                                                                     * 00016600
*                                                                     * 00016700
*                                                                     * 00016800
*                                                                     * 00016900
*              BUFFLEN=xbufflen]                                      * 00017000
*                  is the name (RS-type), or address in register      * 00017100
*                  (2)-(12), of a required fullword input that        * 00017200
*                  specifies the length of the buffer identified by   * 00017300
*                  the BUFFER keyword.                                * 00017400
*                                                                     * 00017500
*                  If the user specified buffer is not large enough   * 00017600
*                  to return the specified data, a specific           * 00017700
*                  return/reason code will be returned.               * 00017800
*                                                                     * 00017900
*                                                                     * 00018000
*                                                                     * 00018100
*          [CHECKCONNSTATUS=YES]                                      * 00018200
*              indicates that only the status of the Log Stream       * 00018300
*              Connection should be checked.  No Buffer is needed for * 00018400
*              this operation.                                        * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*                                                                     * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*                                                                     * 00019100
*      ANSAREA=xansarea                                               * 00019200
*          is a required input.  It is the name (RS-type), or address * 00019300
*          in register (2)-(12), of a virtual storage area, called    * 00019400
*          the answer area.  The ANSAREA contains additional error    * 00019500
*          status when the IXGQUERY service generates an error return * 00019600
*          code. The format of the returned data is defined by the    * 00019700
*          IXGANSAA mapping macro.                                    * 00019800
*                                                                     * 00019900
*                                                                     * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*      ANSLEN=xanslen                                                 * 00020300
*          is the name (RS-type), or address in register (2)-(12), of * 00020400
*          a required fullword input that contains the length in      * 00020500
*          bytes of the virtual storage area provided for ANSAREA.    * 00020600
*                                                                     * 00020700
*          The length of the answer area is described by the IXGANSAA * 00020800
*          mapping macro.                                             * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*                                                                     * 00021200
*                                                                     * 00021300
*      [RETCODE=xretcode]                                             * 00021400
*          is the name (RS-type) of an optional fullword output       * 00021500
*          variable, or register (2)-(12), into which the return code * 00021600
*          is to be copied from GPR 15.                               * 00021700
*                                                                     * 00021800
*                                                                     * 00021900
*                                                                     * 00022000
*                                                                     * 00022100
*      [RSNCODE=xrsncode]                                             * 00022200
*          is the name (RS-type) of an optional fullword output       * 00022300
*          variable, or register (2)-(12), into which the reason code * 00022400
*          is to be copied from GPR 0.                                * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00023000
*          is an optional byte input decimal value in the "0-1" range * 00023100
*          that specifies the macro version.  PLISTVER is the only    * 00023200
*          key allowed on the list form of MF and determines which    * 00023300
*          parameter list is generated (see Macro USAGE NOTE 2).  The * 00023400
*          macro keys associated with each supported version of the   * 00023500
*          macro are listed in MACRO USAGE NOTE 3.  Note that MAX may * 00023600
*          be specified instead of a number, and the parameter list   * 00023700
*          will be of the largest size currently supported. This size * 00023800
*          may grow from release to release (thus possibly affecting  * 00023900
*          the amount of storage needed by your program).  If your    * 00024000
*          program can tolerate this, IBM recommends that you always  * 00024100
*          specify MAX when creating the list form parameter list as  * 00024200
*          that will ensure that the list form parameter list is      * 00024300
*          always long enough to hold whatever parameters might be    * 00024400
*          specified on the execute form.                             * 00024500
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00024600
*          default is the lowest version which allows all of the      * 00024700
*          parameters specified on the invocation to be processed.    * 00024800
*                                                                     * 00024900
*                                                                     * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*      [MF=S|L|M|E]                                                 * 00025300
*          is an optional keyword input which specifies the macro     * 00025400
*          form.                                                      * 00025500
*          DEFAULT: S                                                 * 00025600
*                                                                     * 00025700
*                                                                     * 00025800
*          [MF=S]                                                     * 00025900
*              specifies the standard form of the macro.  The "S"     * 00026000
*              form generates code to put the parameters into an      * 00026100
*              in-line parameter list and invoke the desired service. * 00026200
*              Full checking for required macro keys is done along    * 00026300
*              with supplying defaults for omitted optional           * 00026400
*              parameters.                                            * 00026500
*                                                                     * 00026600
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00026700
*              specifies the list form of the macro.  The "L" form    * 00026800
*              defines an area to be used for the parameter list.     * 00026900
*              Only the PLISTVER key may be specified on the          * 00027000
*              invocation.  All other macro parameters are flagged as * 00027100
*              errors.  If PLISTVER is not specified, the original    * 00027200
*              parameter list definition is used.                     * 00027300
*                                                                     * 00027400
*            ,xmfctrl                                                 * 00027500
*              is a required input.  It is the name of a storage area * 00027600
*              for the parameter list.                                * 00027700
*                                                                     * 00027800
*            ,xmfattr|0D                                            * 00027900
*              is an optional 60 character input string that varies   * 00028000
*              from 1 to 60 characters. Use it to force boundary      * 00028100
*              alignment of the parameter list. Use only 0F or 0D.    * 00028200
*              DEFAULT: 0D which forces the parameter list to a       * 00028300
*              doubleword boundary.                                   * 00028400
*                                                                     * 00028500
*          [MF(M,xmfctrl,COMPLETE|NOCHECK)]                         * 00028600
*              specifies the modify form of the macro.  The "M" form  * 00028700
*              generates code to put the parameters into the          * 00028800
*              parameter list specified by xmfctrl.                   * 00028900
*                                                                     * 00029000
*            ,xmfctrl                                                 * 00029100
*              is a required input.  It is the name (RS-type), or     * 00029200
*              address in register (1)-(12), of a storage area for    * 00029300
*              the parameter list.                                    * 00029400
*                                                                     * 00029500
*            ,COMPLETE|NOCHECK]                                     * 00029600
*              is an optional keyword input which specifies the       * 00029700
*              degree of macro parameter syntax checking.             * 00029800
*              DEFAULT: COMPLETE                                      * 00029900
*                                                                     * 00030000
*                                                                     * 00030100
*              COMPLETE                                               * 00030200
*                  Checking for required macro keys is done and       * 00030300
*                  defaults are supplied for omitted optional         * 00030400
*                  parameters.  (See Macro Usage Note 2).             * 00030500
*                                                                     * 00030600
*              NOCHECK                                                * 00030700
*                  Checking for required macro keys is not done nor   * 00030800
*                  are defaults supplied for omitted optional         * 00030900
*                  parameters.                                        * 00031000
*                                                                     * 00031100
*                                                                     * 00031200
*                                                                     * 00031300
*          [MF=(E,xmfctrl,COMPLETE|NOCHECK)]                        * 00031400
*              specifies the execute form of the macro.  The "E" form * 00031500
*              generates code to put the parameters into the          * 00031600
*              parameter list specified by xmfctrl and invoke the     * 00031700
*              desired service.                                       * 00031800
*                                                                     * 00031900
*            ,xmfctrl                                                 * 00032000
*              is a required input.  It is the name (RS-type), or     * 00032100
*              address in register (1)-(12), of a storage area for    * 00032200
*              the parameter list.                                    * 00032300
*                                                                     * 00032400
*            ,COMPLETE|NOCHECK                                      * 00032500
*              is an optional keyword input which specifies the       * 00032600
*              degree of macro parameter syntax checking.             * 00032700
*              DEFAULT: COMPLETE                                      * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*              COMPLETE                                               * 00033100
*                  Checking for required macro keys is done and       * 00033200
*                  defaults are supplied for omitted optional         * 00033300
*                  parameters.  (See Macro Usage Note 2).             * 00033400
*                                                                     * 00033500
*              NOCHECK                                                * 00033600
*                  Checking for required macro keys is not done nor   * 00033700
*                  are defaults supplied for omitted optional         * 00033800
*                  parameters.                                        * 00033900
*                                                                     * 00034000
*                                                                     * 00034100
*                                                                     * 00034200
*                                                                     * 00034300
*                                                                     * 00034400
*                                                                     * 00034500
*                                                                     * 00034600
*01* RETURN CODES:                                                    * 00034700
*                                                                     * 00034800
*                                                                     * 00034900
*       00        IXGRETCODEOK -  Successful Completion               * 00035000
*                                                                     * 00035100
*       04        IXGRETCODEWARNING - The request was processed       * 00035200
*                 successfully, however a warning condition was       * 00035300
*                 encountered.                                        * 00035400
*                                                                     * 00035500
*       08        IXGRETCODEERROR - An error has been encountered.    * 00035600
*                 The associated reason code provides more            * 00035700
*                 information.                                        * 00035800
*                                                                     * 00035900
*       0C        IXGRETCODECOMPERROR - A System Logger component     * 00036000
*                 error has been encountered.                         * 00036100
*                                                                     * 00036200
*                                                                     * 00036300
*                                                                     * 00036400
*01* REASON CODES:                                                    * 00036500
*                                                                     * 00036600
*       REASON    RETURN                                              * 00036700
*       CODE      CODE      DESCRIPTION                               * 00036800
*                                          * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*       xxxx0000  00                                                  * 00037200
*                                                                     * 00037300
*                           IXGRSNCODEOK -                            * 00037400
*                                                                     * 00037500
*                           EXPLANATION:       Request      processed * 00037600
*                           successfully.                             * 00037700
*                                                                     * 00037800
*       xxxx0801  08                                                  * 00037900
*                                                                     * 00038000
*                           IXGRSNCODEBADPARMLIST -                   * 00038100
*                                                                     * 00038200
*                           EXPLANATION:       Program   error.   The * 00038300
*                           parameter  list  is invalid.   Either the * 00038400
*                           parameter  list  storage is inaccessible, * 00038500
*                           or  an  invalid  version of the macro was * 00038600
*                           used.                                     * 00038700
*                                                                     * 00038800
*                           ACTION:  Ensure that the storage area for * 00038900
*                           the  parameter  list is accessible to the * 00039000
*                           system  logger  for  the  duration of the * 00039100
*                           request,  and  that  the macro version is * 00039200
*                           correct.  The parameter list storage must * 00039300
*                           be  addressable  in  the caller's primary * 00039400
*                           address  space and in the same key as the * 00039500
*                           caller.                                   * 00039600
*                                                                     * 00039700
*       xxxx0802  08        IXGRSNCODEXESERROR -                      * 00039800
*                                                                     * 00039900
*                                                                     * 00040000
*                           EXPLANATION:    System  error.  A  severe * 00040100
*                           cross-system   extended   services  (XES) * 00040200
*                           error has occurred.                       * 00040300
*                                                                     * 00040400
*                           ACTION:    See  ANSAA_DIAG1  for  the XES * 00040500
*                           return  code  and ANSAA_DIAG2 for the XES * 00040600
*                           reason code.                              * 00040700
*                                                                     * 00040800
*       xxxx0803  08                                                  * 00040900
*                                                                     * 00041000
*                           IXGRSNCODEBADBUFFER -                     * 00041100
*                                                                     * 00041200
*                                                                     * 00041300
*                           EXPLANATION:  The  virtual  storage  area * 00041400
*                           specified   by  the  BUFFER  keyword  not * 00041500
*                           addressable.                              * 00041600
*                                                                     * 00041700
*                           ACTION:   Ensure   the  storage  area  is * 00041800
*                           accessible to the Logger Services for the * 00041900
*                           duration of the request.                  * 00042000
*                                                                     * 00042100
*       xxxx0806  08                                                  * 00042200
*                                                                     * 00042300
*                           IXGRSNCODEBADSTMTOKEN -                   * 00042400
*                                                                     * 00042500
*                           EXPLANATION:  Program  error.  One of the * 00042600
*                           following  occurred:  #  The stream token * 00042700
*                           was  not  valid.  # The specified request * 00042800
*                           was  issued  from  an address space other * 00042900
*                           than the connectors address space.        * 00043000
*                                                                     * 00043100
*                           ACTION:  Do  one of the following: # Make * 00043200
*                           sure  that  the stream token specified is * 00043300
*                           valid.  #  Ensure  that IXGQUERY requests * 00043400
*                           were  issued  from the connectors address * 00043500
*                           space.                                    * 00043600
*                                                                     * 00043700
*       xxxx080A  08                                                  * 00043800
*                                                                     * 00043900
*                           IXGRSNCODEREQUESTLOCKED -                 * 00044000
*                                                                     * 00044100
*                           EXPLANATION:   Program error. The program * 00044200
*                           issuing the request is holding a lock.    * 00044300
*                                                                     * 00044400
*                           ACTION:  Ensure  that the program issuing * 00044500
*                           the request is not holding a lock.        * 00044600
*                                                                     * 00044700
*       xxxx080F  08        IXGRSNCODEBADBUFSIZE -                    * 00044800
*                                                                     * 00044900
*                           EXPLANATION:  The BUFFER specified is not * 00045000
*                           large  enough  to  contain the data being * 00045100
*                           returned. No data is returned.            * 00045200
*                                                                     * 00045300
*                           ACTION:  Obtain a buffer of the length of * 00045400
*                           IXGQBUF and redrive the request.          * 00045500
*                                                                     * 00045600
*       xxxx0814  08                                                  * 00045700
*                                                                     * 00045800
*                           IXGRSNCODENOTAVAILFORIPL -                * 00045900
*                                                                     * 00046000
*                           EXPLANATION:     Environment  error.  The * 00046100
*                           system   logger   address  space  is  not * 00046200
*                           available  for the remainder of this IPL. * 00046300
*                           The  system  issues  messages  about this * 00046400
*                           error      during      system      logger * 00046500
*                           initialization.                           * 00046600
*                                                                     * 00046700
*                           ACTION:  See  the  explanation for system * 00046800
*                           messages   issued  during  system  logger * 00046900
*                           initialization.                           * 00047000
*                                                                     * 00047100
*       xxxx0815  08                                                  * 00047200
*                                                                     * 00047300
*                           IXGRSNCODENOTENABLED -                    * 00047400
*                                                                     * 00047500
*                           EXPLANATION:   Program error. The program * 00047600
*                           issuing  the  request  is not enabled for * 00047700
*                           I/O   and  external  interrupts,  so  the * 00047800
*                           request fails.                            * 00047900
*                                                                     * 00048000
*                           ACTION:    Make  sure the program issuing * 00048100
*                           the   request  is  enabled  for  I/O  and * 00048200
*                           external interrupts.                      * 00048300
*                                                                     * 00048400
*       xxxx0816  08                                                  * 00048500
*                                                                     * 00048600
*                           IXGRSNCODEBADANSLEN -                     * 00048700
*                                                                     * 00048800
*                           EXPLANATION:    Program error. The answer * 00048900
*                           area  length  (ANSLEN  parameter)  is not * 00049000
*                           large  enough. The system logger returned * 00049100
*                           the      required     size     in     the * 00049200
*                           Ansaa_Preferred_Size  field of the answer * 00049300
*                           area, mapped by IXGANSAA macro.           * 00049400
*                                                                     * 00049500
*                           ACTION:  Re-issue the request, specifying * 00049600
*                           an answer area of the required size.      * 00049700
*                                                                     * 00049800
*       xxxx0817  08                                                  * 00049900
*                                                                     * 00050000
*                           IXGRSNCODEBADANSAREA -                    * 00050100
*                                                                     * 00050200
*                           EXPLANATION:  Program  error. The storage * 00050300
*                           area  specified  on the ANSAREA parameter * 00050400
*                           cannot  be accessed. This may occur after * 00050500
*                           the   system  logger  address  space  has * 00050600
*                           terminated.                               * 00050700
*                                                                     * 00050800
*                           ACTION:  Specify  storage  that is in the * 00050900
*                           callers  primary address space and in the * 00051000
*                           same  key  as  the calling program at the * 00051100
*                           time   the   system  logger  service  was * 00051200
*                           issued.  This  storage must be accessible * 00051300
*                           until the request completes.              * 00051400
*                                                                     * 00051500
*       xxxx0819  08                                                  * 00051600
*                                                                     * 00051700
*                           IXGRSNCODESRBMODE -                       * 00051800
*                                                                     * 00051900
*                           EXPLANATION:   Program error. The calling * 00052000
*                           program  is in SRB mode, but task mode is * 00052100
*                           the  required  dispatchable unit mode for * 00052200
*                           this system logger service.               * 00052300
*                                                                     * 00052400
*                           ACTION:  Make sure the calling program is * 00052500
*                           in task mode.                             * 00052600
*                                                                     * 00052700
*       xxxx082D  08        IXGRSNCODEEXPIREDSTMTOKEN -               * 00052800
*                                                                     * 00052900
*                           EXPLANATION:   Environment   error.   The * 00053000
*                           stream  token  is no longer valid because * 00053100
*                           the connector has been disconnected.      * 00053200
*                                                                     * 00053300
*                           ACTION:   Re-connect   to  the  logstream * 00053400
*                           before issuing any functional requests.   * 00053500
*                                                                     * 00053600
*       xxxx0840  08                                                  * 00053700
*                                                                     * 00053800
*                           IXGRSNCODEBADVERSION -                    * 00053900
*                                                                     * 00054000
*                           EXPLANATION:   Environment   error.   The * 00054100
*                           parameter  list  passed  to  the  service * 00054200
*                           routine has an invalid version indicator. * 00054300
*                                                                     * 00054400
*                           ACTION: Ensure the level of MVS executing * 00054500
*                           the request and the macro library used to * 00054600
*                           compile    the   invoking   routine   are * 00054700
*                           compatible.                               * 00054800
*                                                                     * 00054900
*       xxxx0861  08                                                  * 00055000
*                                                                     * 00055100
*                           IXGRSNCODEREBUILDINPROGRESS -             * 00055200
*                                                                     * 00055300
*                           EXPLANATION:    Environment   error.   No * 00055400
*                           requests  can  be  processed for this log * 00055500
*                           stream   because   a   coupling  facility * 00055600
*                           structure re-build is in progress for the * 00055700
*                           structure   associated   with   this  log * 00055800
*                           stream.                                   * 00055900
*                                                                     * 00056000
*                           ACTION:  Listen  for  ENF  signal 48 that * 00056100
*                           will indicate one of the following: # The * 00056200
*                           log   stream  is  available  because  the * 00056300
*                           re-build completed successfully. Re-issue * 00056400
*                           the  request.   # The re-build failed and * 00056500
*                           the log stream is not available. .        * 00056600
*                                                                     * 00056700
*       xxxx0862  08                                                  * 00056800
*                                                                     * 00056900
*                           IXGRSNCODEXESPURGE -                      * 00057000
*                                                                     * 00057100
*                           EXPLANATION:    Environment   error.   An * 00057200
*                           cross-system   extended   services  (XES) * 00057300
*                           request  has  been purged due to re-build * 00057400
*                           processing.                               * 00057500
*                                                                     * 00057600
*                           ACTION:  Listen  for  ENF  signal 48 that * 00057700
*                           will indicate one of the following: # The * 00057800
*                           log   stream  is  available  because  the * 00057900
*                           re-build completed successfully. Re-issue * 00058000
*                           the  request.   # The re-build failed and * 00058100
*                           the log stream is not available. .        * 00058200
*                                                                     * 00058300
*       xxxx0863  08                                                  * 00058400
*                                                                     * 00058500
*                           IXGRSNCODESTRUCTUREFAILED -               * 00058600
*                                                                     * 00058700
*                           EXPLANATION:  Environment  error.  Either * 00058800
*                           the     coupling    facility    structure * 00058900
*                           associated with the log stream has failed * 00059000
*                           or   the  coupling  facility  itself  has * 00059100
*                           failed.                                   * 00059200
*                                                                     * 00059300
*                           ACTION:  Listen  for  ENF  signal 48 that * 00059400
*                           will indicate one of the following: # The * 00059500
*                           log   stream  is  available  because  the * 00059600
*                           re-build completed successfully. Re-issue * 00059700
*                           the  request.   # The re-build failed and * 00059800
*                           the log stream is not available.          * 00059900
*                                                                     * 00060000
*       xxxx0864  08                                                  * 00060100
*                                                                     * 00060200
*                           IXGRSNCODENOCONNECTIVITY -                * 00060300
*                                                                     * 00060400
*                           EXPLANATION:    Environment   error.   No * 00060500
*                           connectivity   exists   to  the  coupling * 00060600
*                           facility  associated with the log stream. * 00060700
*                           The  system logger will either attempt to * 00060800
*                           re-build   the   log  stream  in  another * 00060900
*                           coupling  facility or the log stream will * 00061000
*                           be disconnected.                          * 00061100
*                                                                     * 00061200
*                           ACTION:  Listen  for  ENF  signal 48 that * 00061300
*                           will indicate one of the following: # The * 00061400
*                           log   stream  is  available  because  the * 00061500
*                           re-build completed successfully. Re-issue * 00061600
*                           the  request.   # The re-build failed and * 00061700
*                           the  log  stream  is not available. # The * 00061800
*                           log  stream  has  been  disconnected from * 00061900
*                           this system.                              * 00062000
*                                                                     * 00062100
*       xxxx0890  08                                                  * 00062200
*                                                                     * 00062300
*                           IXGRSNCODEADDRSPACENOTAVAIL -             * 00062400
*                                                                     * 00062500
*                           EXPLANATION:  System  error.  The  system * 00062600
*                           logger  address  space  failed and is not * 00062700
*                           available.                                * 00062800
*                                                                     * 00062900
*                           ACTION:   Do   not  issue  system  logger * 00063000
*                           requests.                                 * 00063100
*                                                                     * 00063200
*       xxxx0891  08                                                  * 00063300
*                                                                     * 00063400
*                           IXGRSNCODEADDRSPACEINITIALIZING -         * 00063500
*                                                                     * 00063600
*                                                                     * 00063700
*                           EXPLANATION:  System  error.  The  system * 00063800
*                           logger  address  space  is  not available * 00063900
*                           because it is IPLing.                     * 00064000
*                                                                     * 00064100
*                           ACTION:   Listen for ENF signal 48, which * 00064200
*                           will  indicate  when  the  system  logger * 00064300
*                           address  space  is available.   Once it's * 00064400
*                           available,  re-connect to the log stream, * 00064500
*                           then  re-issue this request. You can also * 00064600
*                           listen  for  ENF  signal  48,  which will * 00064700
*                           indicate  if  the  system  logger address * 00064800
*                           space  will not be available for the life * 00064900
*                           of  the  IPL.  In that case, do not issue * 00065000
*                           system logger services.                   * 00065100
*                                                                     * 00065200
*       xxxx08D3  08        IXGRSNCODEFUNCNOTSUPPORTED -              * 00065300
*                                                                     * 00065400
*                                                                     * 00065500
*                           EXPLANATION:   Environment  error.    The * 00065600
*                           query  request  failed  because  the LOGR * 00065700
*                           couple  data  set  is  not at the correct * 00065800
*                           level.  The inventory must be at least at * 00065900
*                           the OS390R3 level.                        * 00066000
*                                                                     * 00066100
*       xxxx0C00  0C                                                  * 00066200
*                                                                     * 00066300
*                           EXPLANATION:  System  Logger  Error.    A * 00066400
*                           System  Logger  component  error has been * 00066500
*                           encountered.                              * 00066600
*                                                                     * 00066700
*                                                                     * 00066800
*                                                                     * 00066900
*01* ABEND CODES:                                                     * 00067000
*                                                                     * 00067100
*                                                                     * 00067200
*       1C5       IXG_ABEND_CODE   -   A   System  Logger  abend  has * 00067300
*                 occurred.                                           * 00067400
*                                                                     * 00067500
*                                                                     * 00067600
*                                                                     * 00067700
*01* ABEND REASON CODES:                                              * 00067800
*                                                                     * 00067900
*       REASON    ABEND                                               * 00068000
*       CODE      CODE      DESCRIPTION                               * 00068100
*                                          * 00068200
*                                                                     * 00068300
*                                                                     * 00068400
*       xxxx085F  1C5       IXGRSNCODEPERCTOREQUESTOR -               * 00068500
*                                                                     * 00068600
*                           EXPLANATION:      Environment      error. * 00068700
*                           Percolation  to  the  service requestor's * 00068800
*                           task  occurred because of an abend during * 00068900
*                           system  logger  processing. Retry was not * 00069000
*                           allowed.                                  * 00069100
*                                                                     * 00069200
*                           ACTION:  Issue  the request again. If the * 00069300
*                           problem persists, contact the IBM Support * 00069400
*                           Center.                                   * 00069500
*                                                                     * 00069600
*                                                                     * 00069700
*                                                                     * 00069800
*01* MODULE TYPE:  ASSEM MACRO                                        * 00069900
*                                                                     * 00070000
*02*   PROCESSOR:  ASSEM                                              * 00070100
*                                                                     * 00070200
*01* COMPONENT:  SCLOG                                                * 00070300
*                                                                     * 00070400
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00070500
*                                                                     * 00070600
*01* EXAMPLES:                                                        * 00070700
*    None.                                                            * 00070800
*                                                                     * 00070900
*01* MACRO USAGE NOTES:                                               * 00071000
*                                                                     * 00071100
*                                                                     * 00071200
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00071300
*        global macro variable.  Any value other than 'NO' will       * 00071400
*        result in the macro expansion being printed.  The default is * 00071500
*        'YES'.  The following examples illustrate how the ZPRINT     * 00071600
*        variable should be set.                                      * 00071700
*                                                                     * 00071800
*                    GBLC &ZPRINT                                     * 00071900
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00072000
*                                                                     * 00072100
*                                                                     * 00072200
*    2.  When using the NOCHECK option in conjunction with the Modify * 00072300
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00072400
*        Modify   or  Execute  form  invocation  which  specifies  or * 00072500
*        defaults  to  the  COMPLETE  option.   This insures that the * 00072600
*        parameter  list  is  initialized completely.   The parameter * 00072700
*        list  field which identifies the version number of the macro * 00072800
*        is only set when the Standard form or the Complete option of * 00072900
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00073000
*        explicitly  specified.  Be sure that the resulting parameter * 00073100
*        list version number covers all the keys that you use.        * 00073200
*                                                                     * 00073300
*                                                                     * 00073400
*    3.  The IXGQUERY macro supports multiple versions. The macro key * 00073500
*        list  below  contains the version level in which the key was * 00073600
*        first  introduced.  Positionals  are  identified by the word * 00073700
*        'Positional'  followed by the numeric value of its position. * 00073800
*        Nested  positionals  are  preceded  by their outer key.  The * 00073900
*        lowest value represents the original version and the highest * 00074000
*        value  represents  the  most  recent version of the IXGQUERY * 00074100
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00074200
*        least  as high as the highest version number of all the keys * 00074300
*        being used.                                                  * 00074400
*                                                                     * 00074500
*        VERSION   KEY                                                * 00074600
*                                                                     * 00074700
*              0      ANSAREA                                         * 00074800
*                     ANSLEN                                          * 00074900
*                     BUFFER                                          * 00075000
*                     BUFFLEN                                         * 00075100
*                     STREAMTOKEN                                     * 00075200
*              1      CHECKCONNSTATUS                                 * 00075300
*                                                                     * 00075400
*                                                                     * 00075500
*                                                                     * 00075600
*01* CHANGE ACTIVITY:                                                 * 00075700
*                                                                     * 00075800
*   Flag LineItem  FMID    Date   ID    Comment                       * 00075900
*                                                                     * 00076000
*    $L0=LOGGR    HBB6603 951201 PDXD:                                * 00076100
*    $01=OW48404  HBB7703 010218 PD00A8:                              * 00076200
****** END OF SPECIFICATIONS *****************************************/ 00076300
*/* TLINE 1 *********************************************************** 00076400
         MACRO                                                          00076500
&XLABEL  IXGQUERY &STREAMTOKEN=,&CHECKCONNSTATUS=,&BUFFER=,&BUFFLEN=,  *00076600
               &ANSAREA=,&ANSLEN=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=   00076700
.*                                                                      00076800
*                     MACDATE -01/02/19-<1>                             00076900
.*                                                                      00077000
.*******************************************************************    00077100
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00077200
.*******************************************************************    00077300
                     GBLC  &ZPRINT     YES=PRINT NO=NO PRINT            00077400
                     GBLC  &ZTEST      YES=TEST NO=NO TEST              00077500
                     GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX      00077600
.*                                                                      00077700
                     GBLC  &ZIXGQUERY  YES=MACRO USED AT LEAST ONCE     00077800
.*******************************************************************    00077900
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00078000
.*******************************************************************    00078100
                     LCLC  &ZMS        ERROR MESSAGE WORK AREA          00078200
                     LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS     00078300
                     LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED       00078400
                     LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR      00078500
                     LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE      00078600
                     LCLA  &ZAWRK      USED AS A WORK AREA              00078700
                     LCLA  &ZASIZ      USED FOR SIZE OF VALUE           00078800
                     LCLA  &ZN         NUMERIC WORK VARIABLE            00078900
                     LCLC  &ZC         CHARACTER WORK VARIABLE          00079000
                     LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE      00079100
                     LCLA  &ZTLA       VALUE TOO LONG VARIABLE          00079200
                     LCLC  &ZMAC_G     "G" or null                      00079300
&ZMAC_G              SETC  ''                                           00079400
                     LCLC  &ZMAC_LR                                     00079500
&ZMAC_LR             SETC  'LR'                                         00079600
                     LCLC  &ZMAC_L                                      00079700
&ZMAC_L              SETC  'L'                                          00079800
                     LCLC  &ZMAC_ST                                     00079900
&ZMAC_ST             SETC  'ST'                                         00080000
                     LCLA  &ZMACRET    MACRO RETURN CODE                00080100
&ZMACRET             SETA  0           ASSUME NO ERRORS                 00080200
.*                                                                      00080300
                     LCLC  &ZCSYSLIST(255)      NONXKEY, POS ARRAY      00080400
                     LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()       00080500
                     LCLA  &ZPLLEN     PARAMETER LIST LENGTH            00080600
                     LCLC  &ZENDBASEPL          End of base PL          00080700
                     LCLA  &ZPLWORKA   PARAMETER LIST LENGTH            00080800
.*******************************************************************    00080900
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00081000
.*******************************************************************    00081100
                     LCLA  &ZI         INDEX FOR ARRAY                  00081200
                     LCLA  &ZJ         INDEX FOR PARMS                  00081300
                     LCLA  &ZK         INDEX FOR PARSE                  00081400
                     LCLA  &ZLO        LOW RANGE VALUE                  00081500
                     LCLA  &ZHI        HIGH RANGE VALUE                 00081600
                     LCLC  &ZW         WORK AREA FOR PARM               00081700
.********************************************************************   00081800
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00081900
.********************************************************************   00082000
                     GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL          00082100
                     GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE   00082200
                     GBLA  &SYSALVL    SYSSTATE ARCHLVL                 00082300
.*                                                                      00082400
                     AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED   00082500
                     AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED    00082600
                     SPLEVEL  TEST                                      00082700
.ZSYS2               ANOP  ,                                            00082800
                     AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1        00082900
                     AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1        00083000
                     SYSSTATE TEST                                      00083100
                     AGO   .ZSYS4                                       00083200
.ZSYS3               ANOP  ,                                            00083300
&SYSASCE             SETC  'P'         ASSUME SYSSTATE PRIMARY          00083400
.ZSYS4               ANOP  ,                                            00083500
.*******************************************************************    00083600
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00083700
.*******************************************************************    00083800
                     LCLC  &XSTREAMTOKEN        ++ NAME                 00083900
                     LCLC  &XCHECKCONNSTATUS    ++ VALUE                00084000
                     LCLC  &XBUFFER    ++ NAME                          00084100
                     LCLC  &XBUFFLEN   ++ NAME                          00084200
                     LCLC  &XANSAREA   ++ NAME                          00084300
                     LCLC  &XANSLEN    ++ NAME                          00084400
                     LCLC  &XRETCODE   ++ NAME                          00084500
                     LCLC  &XRSNCODE   ++ NAME                          00084600
                     LCLA  &XPLISTVER  ++ VALUE                         00084700
                     LCLC  &XMF        ++ VALUE                         00084800
                     LCLC  &XMFCTRL    ++ NAME                          00084900
                     LCLC  &XMFATTR    ++ VALUE                         00085000
                     LCLC  &XMFSCK     ++ VALUE                         00085100
.*******************************************************************    00085200
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00085300
.*******************************************************************    00085400
                     LCLC  &ZXSTREAMTOKEN       ++ INPUT NAME           00085500
                     LCLC  &ZXCHECKCONNSTATUS   ++ INPUT VALUE          00085600
                     LCLC  &ZXBUFFER   ++ OUTPUT NAME                   00085700
                     LCLC  &ZXBUFFLEN  ++ INPUT NAME                    00085800
                     LCLC  &ZXANSAREA  ++ INPUT NAME                    00085900
                     LCLC  &ZXANSLEN   ++ INPUT NAME                    00086000
                     LCLC  &ZXRETCODE  ++ OUTPUT NAME                   00086100
                     LCLC  &ZXRSNCODE  ++ OUTPUT NAME                   00086200
                     LCLC  &ZXPLISTVER          ++ INPUT VALUE          00086300
                     LCLC  &ZXMF       ++ INPUT VALUE                   00086400
                     LCLC  &ZXMFCTRL   ++ INPUT NAME                    00086500
                     LCLC  &ZXMFATTR   ++ INPUT VALUE                   00086600
                     LCLC  &ZXMFSCK    ++ INPUT VALUE                   00086700
.********************************************************************   00086800
.***AC.PLV01  PROCESS PLISTVER                                      *   00086900
.********************************************************************   00087000
&XPLISTVER      SETA  0                                                 00087100
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00087200
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00087300
&XPLISTVER      SETA  1                                                 00087400
.ZPLV0          ANOP  ,                                                 00087500
.*                                                                      00087600
                AIF   ('&CHECKCONNSTATUS' EQ '').ZPLV1E                 00087700
                AIF   (&XPLISTVER GE 1).ZPLV1E                          00087800
&XPLISTVER      SETA  1                                                 00087900
.ZPLV1E         ANOP  ,                                                 00088000
.*                                                                      00088100
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00088200
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00088300
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00088400
.*-------------------------------------------------------------------   00088500
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00088600
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00088700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00088800
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00088900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00089000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00089100
                AGO   .ZPVCK2                                           00089200
.ZPVCK3         ANOP  ,                                                 00089300
.*-------------------------------------------------------------------   00089400
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00089500
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00089600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00089700
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00089800
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00089900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00090000
                AGO   .ZPVCKE                                           00090100
.ZPVCK2         ANOP  ,                                                 00090200
.*-------------------------------------------------------------------   00090300
&ZCVAL          SETC  '&PLISTVER(1)'                                    00090400
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00090500
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00090600
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00090700
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00090800
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00090900
.ZPVCK6         ANOP  ,                                                 00091000
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00091100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00091200
&ZMS            SETC  '&ZMS THE RANGE IS "0-1"'                         00091300
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00091400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00091500
&XPLISTVER      SETA  1                                                 00091600
                AGO   .ZPVCKE                                           00091700
.*-------------------------------------------------------------------   00091800
.ZPVCK4A        ANOP  ,                                                 00091900
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00092000
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00092100
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00092200
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00092300
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00092400
                MNOTE 8,' &ZMS IS REQUIRED.'                            00092500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00092600
                AGO   .ZPVCK5                                           00092700
.ZPVCK4         ANOP  ,                                                 00092800
&XPLISTVER      SETA  &PLISTVER(1)                                      00092900
.ZPVCK5         ANOP  ,                                                 00093000
.ZPVCKE         ANOP  ,                                                 00093100
.********************************************************************   00093200
.***AG.MF01 PROCESS MF MACRO FORMS                                      00093300
.********************************************************************   00093400
                     ACTR  10000                                        00093500
.*------------------------------------------------------------------    00093600
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00093700
&XMF                 SETC  ''          INITIALIZE XVARIABLE             00093800
.*-------------------------------------------------------------------   00093900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00094000
.ZG32                ANOP  ,                                            00094100
&ZTLC                SETC 'S'                                           00094200
                     AIF   ('&MF(1)' NE '&ZTLC').ZG33                   00094300
&XMF                 SETC  'S'         SET KEYWORD                      00094400
&XMFSCK              SETC  'COMPLETE'  SET XMFSCK                       00094500
                     AIF   (N'&MF LE 1).ZG32A   CK NUM                  00094600
&ZMS                 SETC  '"MF='      *KPOSA* MNOTE                    00094700
&ZMS                 SETC  '&ZMS.&MF"'                                  00094800
&ZMS                 SETC  '&ZMS "MF"'                                  00094900
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00095000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00095100
.ZG32A               ANOP  ,                                            00095200
.*-------------------------------------------------------------------   00095300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00095400
.ZG33                ANOP  ,                                            00095500
&ZTLC                SETC 'L'                                           00095600
                     AIF   ('&MF(1)' NE '&ZTLC').ZG40                   00095700
&XMF                 SETC  'L'         SET KEYWORD                      00095800
                     AIF   (N'&MF LE 3).ZG33A   CK NUM                  00095900
&ZMS                 SETC  '"MF='      *KPOSA* MNOTE                    00096000
&ZMS                 SETC  '&ZMS.&MF"'                                  00096100
&ZMS                 SETC  '&ZMS "MF"'                                  00096200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00096300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00096400
.ZG33A               ANOP  ,                                            00096500
.*-------------------------------------------------------------------   00096600
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00096700
                     AIF   (N'&SYSLIST NE 0).ZG33B  POSITIONALS?        00096800
                     AIF   ('&STREAMTOKEN' NE '').ZG33B  KEYS?          00096900
                     AIF   ('&CHECKCONNSTATUS' NE '').ZG33B  KEYS?      00097000
                     AIF   ('&BUFFER' NE '').ZG33B  KEYS?               00097100
                     AIF   ('&BUFFLEN' NE '').ZG33B  KEYS?              00097200
                     AIF   ('&ANSAREA' NE '').ZG33B  KEYS?              00097300
                     AIF   ('&ANSLEN' NE '').ZG33B  KEYS?               00097400
                     AIF   ('&RETCODE' NE '').ZG33B  KEYS?              00097500
                     AIF   ('&RSNCODE' NE '').ZG33B  KEYS?              00097600
                     AGO    .ZG33C     INVOCATION OKAY                  00097700
.ZG33B               ANOP  ,                                            00097800
&ZMS                 SETC  'THE "L" FORM OF "MF"'  *MFLA* MNOTE         00097900
&ZMS                 SETC  '&ZMS CAN ONLY HAVE'                         00098000
&ZMS                 SETC  '&ZMS THE "PLISTVER" KEY'                    00098100
                     MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'       00098200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00098300
.ZG33C               ANOP  ,                                            00098400
.*-------------------------------------------------------------------   00098500
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00098600
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00098700
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00098800
                     AIF   (N'&MF(2) GT 1).ZG35B  MULTI PARMS           00098900
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00099000
.ZG35B               AIF   (K'&MF(2) GT 0).ZG35C                        00099100
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00099200
&ZMS                 SETC  'WHEN "L" IS SPECIFIED'  *KRQDA*             00099300
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00099400
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00099500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00099600
.ZG35C               ANOP  ,                                            00099700
.*-------------------------------------------------------------------   00099800
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00099900
                     AIF   (K'&ZXMFCTRL LE 0).ZG35P  NOT I/O            00100000
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG35P               00100100
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00100200
&ZMS                 SETC  '"MF='      *KGPRA* MNOTE                    00100300
&ZMS                 SETC  '&ZMS.&MF"'                                  00100400
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00100500
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'            00100600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00100700
.ZG35P               ANOP  ,                                            00100800
.*-------------------------------------------------------------------   00100900
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00101000
&ZXMFATTR            SETC  'INPUT'     SET IN/OUTPUT                    00101100
&XMFATTR             SETC  '0D'                                         00101200
                     AIF   (K'&MF(3) LE 0).ZG38B  PARM                  00101300
&XMFATTR             SETC  '&MF(3,1)'  SET XVARIABLE                    00101400
                     AIF   (N'&MF(3) GT 1).ZG38B  MULTI PARMS           00101500
&XMFATTR             SETC  '&MF(3)'    SET XVARIABLE                    00101600
.ZG38B               ANOP  ,                                            00101700
.*-------------------------------------------------------------------   00101800
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00101900
                     AIF   (K'&ZXMFATTR LE 0).ZG38P  NOT I/O            00102000
                     AIF   ('&XMFATTR'(1,1) NE '(').ZG38P               00102100
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00102200
&ZMS                 SETC  '"MF='      *KGPRA* MNOTE                    00102300
&ZMS                 SETC  '&ZMS.&MF"'                                  00102400
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00102500
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'            00102600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00102700
.ZG38P               ANOP  ,                                            00102800
.*-------------------------------------------------------------------   00102900
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00103000
                     AIF   (K'&ZXMFATTR LE 0).ZG38S  NOT I/O            00103100
                     AIF   (K'&XMFATTR LE 60).ZG38S  LNG OK             00103200
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00103300
&ZMS                 SETC  '"MF='      *KLNGA* MNOTE                    00103400
&ZMS                 SETC  '&ZMS.&MF"'                                  00103500
&ZMS                 SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'        00103600
                     MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'           00103700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00103800
.ZG38S               ANOP  ,                                            00103900
.*-------------------------------------------------------------------   00104000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00104100
.ZG40                ANOP  ,                                            00104200
&ZTLC                SETC 'M'                                           00104300
                     AIF   ('&MF(1)' NE '&ZTLC').ZG49                   00104400
&XMF                 SETC  'M'         SET KEYWORD                      00104500
                     AIF   (N'&MF LE 3).ZG40A   CK NUM                  00104600
&ZMS                 SETC  '"MF='      *KPOSA* MNOTE                    00104700
&ZMS                 SETC  '&ZMS.&MF"'                                  00104800
&ZMS                 SETC  '&ZMS "MF"'                                  00104900
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00105000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00105100
.ZG40A               ANOP  ,                                            00105200
.*-------------------------------------------------------------------   00105300
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00105400
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00105500
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00105600
                     AIF   (N'&MF(2) GT 1).ZG42B  MULTI PARMS           00105700
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00105800
.ZG42B               AIF   (K'&MF(2) GT 0).ZG42C                        00105900
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00106000
&ZMS                 SETC  'WHEN "M" IS SPECIFIED'  *KRQDA*             00106100
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00106200
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00106300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00106400
.ZG42C               ANOP  ,                                            00106500
.*-------------------------------------------------------------------   00106600
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00106700
                     AIF   (K'&ZXMFCTRL LE 0).ZG42R  NOT I/O            00106800
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG42R               00106900
&ZCGPR               SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                   00107000
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG42P                 00107100
                     AIF   (K'&ZCGPR GT 2).ZG42Q                        00107200
                     AIF   ('&ZCGPR' EQ '0').ZG42Q                      00107300
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00107400
                     AIF   (T'&ZCGPR NE 'N').ZG42Q  INVALID REG NAME    00107500
.ZG42P               ANOP  ,                                            00107600
                     AIF   (T'&ZCGPR NE 'N').ZG42R  NON NUMERIC         00107700
                     AIF   ('&ZCGPR' LT '1').ZG42Q                      00107800
                     AIF   ('&ZCGPR' LE '12').ZG42R                     00107900
.ZG42Q               ANOP  ,                                            00108000
&ZMS                 SETC  '"MF='      *KGPRA* MNOTE                    00108100
&ZMS                 SETC  '&ZMS.&MF"'                                  00108200
&ZMS                 SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'    00108300
                     MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'             00108400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00108500
.ZG42R               ANOP  ,                                            00108600
.*-------------------------------------------------------------------   00108700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00108800
&XMFSCK              SETC  ''          INITIALIZE XVARIABLE             00108900
.ZG46A   AIF   ('&MF(3)' NE 'COMPLETE').ZG47A                           00109000
&XMFSCK              SETC  'COMPLETE'  SET KEYWORD                      00109100
.*-------------------------------------------------------------------   00109200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00109300
.ZG47A   AIF   ('&MF(3)' NE 'NOCHECK').ZG48A                            00109400
&XMFSCK              SETC  'NOCHECK'   SET KEYWORD                      00109500
.*-------------------------------------------------------------------   00109600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00109700
.ZG48A               AIF   (K'&XMFSCK GT 0).ZG48C  KEYWORD              00109800
                     AIF   (K'&MF(3) LE 0).ZG48B                        00109900
&ZMS                 SETC  '"MF='      *KUKWA* MNOTE                    00110000
&ZMS                 SETC  '&ZMS.&MF"'                                  00110100
&ZMS                 SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '    00110200
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00110300
&ZMS                 SETC  '&ZMS "COMPLETE"'                            00110400
&ZMS                 SETC  '&ZMS OR "NOCHECK".'                         00110500
                     MNOTE 8,' &ZMS '                                   00110600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00110700
.ZG48B               ANOP  ,                                            00110800
&XMFSCK              SETC  'COMPLETE'  SET DEFAULT KEYWORD              00110900
.ZG48C               ANOP  ,                                            00111000
&ZXMFSCK             SETC  'INPUT'     SET IN/OUTPUT                    00111100
.*-------------------------------------------------------------------   00111200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00111300
.ZG49                ANOP  ,                                            00111400
&ZTLC                SETC 'E'                                           00111500
                     AIF   ('&MF(1)' NE '&ZTLC').ZG58                   00111600
&XMF                 SETC  'E'         SET KEYWORD                      00111700
                     AIF   (N'&MF LE 3).ZG49A   CK NUM                  00111800
&ZMS                 SETC  '"MF='      *KPOSA* MNOTE                    00111900
&ZMS                 SETC  '&ZMS.&MF"'                                  00112000
&ZMS                 SETC  '&ZMS "MF"'                                  00112100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00112200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00112300
.ZG49A               ANOP  ,                                            00112400
.*-------------------------------------------------------------------   00112500
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00112600
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00112700
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00112800
                     AIF   (N'&MF(2) GT 1).ZG51B  MULTI PARMS           00112900
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00113000
.ZG51B               AIF   (K'&MF(2) GT 0).ZG51C                        00113100
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00113200
&ZMS                 SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*             00113300
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00113400
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00113500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00113600
.ZG51C               ANOP  ,                                            00113700
.*-------------------------------------------------------------------   00113800
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00113900
                     AIF   (K'&ZXMFCTRL LE 0).ZG51R  NOT I/O            00114000
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG51R               00114100
&ZCGPR               SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                   00114200
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG51P                 00114300
                     AIF   (K'&ZCGPR GT 2).ZG51Q                        00114400
                     AIF   ('&ZCGPR' EQ '0').ZG51Q                      00114500
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00114600
                     AIF   (T'&ZCGPR NE 'N').ZG51Q  INVALID REG NAME    00114700
.ZG51P               ANOP  ,                                            00114800
                     AIF   (T'&ZCGPR NE 'N').ZG51R  NON NUMERIC         00114900
                     AIF   ('&ZCGPR' LT '1').ZG51Q                      00115000
                     AIF   ('&ZCGPR' LE '12').ZG51R                     00115100
.ZG51Q               ANOP  ,                                            00115200
&ZMS                 SETC  '"MF='      *KGPRA* MNOTE                    00115300
&ZMS                 SETC  '&ZMS.&MF"'                                  00115400
&ZMS                 SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'    00115500
                     MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'             00115600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00115700
.ZG51R               ANOP  ,                                            00115800
.*-------------------------------------------------------------------   00115900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00116000
&XMFSCK              SETC  ''          INITIALIZE XVARIABLE             00116100
.ZG55A   AIF   ('&MF(3)' NE 'COMPLETE').ZG56A                           00116200
&XMFSCK              SETC  'COMPLETE'  SET KEYWORD                      00116300
.*-------------------------------------------------------------------   00116400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00116500
.ZG56A   AIF   ('&MF(3)' NE 'NOCHECK').ZG57A                            00116600
&XMFSCK              SETC  'NOCHECK'   SET KEYWORD                      00116700
.*-------------------------------------------------------------------   00116800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00116900
.ZG57A               AIF   (K'&XMFSCK GT 0).ZG57C  KEYWORD              00117000
                     AIF   (K'&MF(3) LE 0).ZG57B                        00117100
&ZMS                 SETC  '"MF='      *KUKWA* MNOTE                    00117200
&ZMS                 SETC  '&ZMS.&MF"'                                  00117300
&ZMS                 SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '    00117400
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00117500
&ZMS                 SETC  '&ZMS "COMPLETE"'                            00117600
&ZMS                 SETC  '&ZMS OR "NOCHECK".'                         00117700
                     MNOTE 8,' &ZMS '                                   00117800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00117900
.ZG57B               ANOP  ,                                            00118000
&XMFSCK              SETC  'COMPLETE'  SET DEFAULT KEYWORD              00118100
.ZG57C               ANOP  ,                                            00118200
&ZXMFSCK             SETC  'INPUT'     SET IN/OUTPUT                    00118300
.*------------------------------------------------------------------    00118400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00118500
.ZG58                ANOP  ,                                            00118600
&ZXMF                SETC  'INPUT'     SET IN/OUTPUT                    00118700
                     AIF   (K'&XMF GT 0).ZG58E  VALID ARG               00118800
                     AIF   (T'&MF EQ 'O').ZG58D  OMITTED                00118900
&ZASYSLNDX           SETA  0                                            00119000
.ZG58A               ANOP  ,           POSITIONAL MACRO KEY             00119100
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00119200
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG58C             00119300
&ZTLC                SETC 'MF'                                          00119400
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG58A    00119500
.ZG58B               ANOP  ,                                            00119600
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00119700
&ZMS                 SETC  'THE "MF" KEY'       *KOPTA* MNOTE           00119800
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00119900
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00120000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00120100
                     AGO   .ZG58E                                       00120200
.ZG58C               ANOP  ,                                            00120300
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00120400
&ZMS                 SETC  '"MF='      *KUKWA* MNOTE                    00120500
&ZMS                 SETC  '&ZMS.&MF"'                                  00120600
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00120700
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00120800
&ZMS                 SETC  '&ZMS "S",'                                  00120900
&ZMS                 SETC  '&ZMS "L",'                                  00121000
&ZMS                 SETC  '&ZMS "M",'                                  00121100
&ZMS                 SETC  '&ZMS OR "E".'                               00121200
                     MNOTE 8,' &ZMS '                                   00121300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00121400
                     AGO   .ZG58E                                       00121500
.ZG58D               ANOP  ,                                            00121600
&XMF                 SETC  'S'         SET DEFAULT KEYWORD              00121700
&XMFSCK              SETC  'COMPLETE'  COMPLETE CHECKING                00121800
.ZG58E               ANOP  ,                                            00121900
.********************************************************************   00122000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00122100
.********************************************************************   00122200
                     ACTR  10000                                        00122300
.*-------------------------------------------------------------------   00122400
.***AG.MF03 MF=(SLME)                                                   00122500
                     AIF   ('&XMF' EQ 'L').ZGMFX                        00122600
                     AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX              00122700
.*----------------------------------------------------------------***   00122800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00122900
                     AIF   (N'&STREAMTOKEN LE 1).ZG2A  CK NUM           00123000
&ZMS                 SETC  '"STREAMTOKEN='      *KPOSA* MNOTE           00123100
&ZMS                 SETC  '&ZMS.&STREAMTOKEN"'                         00123200
&ZMS                 SETC  '&ZMS "STREAMTOKEN"'                         00123300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00123400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00123500
.ZG2A                ANOP  ,                                            00123600
.*-------------------------------------------------------------------   00123700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00123800
&ZXSTREAMTOKEN       SETC  'INPUT'     SET IN/OUTPUT                    00123900
&XSTREAMTOKEN        SETC  '&STREAMTOKEN(1)'    SET XVARIABLE           00124000
                     AIF   (N'&STREAMTOKEN GT 1).ZG2B  MULTI PARMS      00124100
&XSTREAMTOKEN        SETC  '&STREAMTOKEN'       SET XVARIABLE           00124200
.ZG2B                AIF   (K'&STREAMTOKEN(1) GT 0).ZG2C                00124300
&ZXSTREAMTOKEN       SETC  ''          RESET IN/OUTPUT                  00124400
&ZMS                 SETC  ' '         *KRQDA*                          00124500
&ZMS                 SETC  '&ZMS "STREAMTOKEN" KEY AND ITS'             00124600
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00124700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00124800
.ZG2C                ANOP  ,                                            00124900
.*-------------------------------------------------------------------   00125000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00125100
                     AIF   (K'&ZXSTREAMTOKEN LE 0).ZG2R  NOT I/O        00125200
                     AIF   ('&XSTREAMTOKEN'(1,1) NE '(').ZG2R           00125300
&ZCGPR               SETC  '&XSTREAMTOKEN'(2,K'&XSTREAMTOKEN-2)         00125400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                  00125500
                     AIF   (K'&ZCGPR GT 2).ZG2Q                         00125600
                     AIF   ('&ZCGPR' EQ '0').ZG2Q                       00125700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00125800
                     AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME     00125900
.ZG2P                ANOP  ,                                            00126000
                     AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC          00126100
                     AIF   ('&ZCGPR' LT '2').ZG2Q                       00126200
                     AIF   ('&ZCGPR' LE '12').ZG2R                      00126300
.ZG2Q                ANOP  ,                                            00126400
&ZMS                 SETC  '"STREAMTOKEN='      *KGPRA* MNOTE           00126500
&ZMS                 SETC  '&ZMS.&STREAMTOKEN"'                         00126600
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00126700
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00126800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00126900
.ZG2R                ANOP  ,                                            00127000
.*------------------------------------------------------------------    00127100
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00127200
&XCHECKCONNSTATUS    SETC  ''          INITIALIZE XVARIABLE             00127300
.*-------------------------------------------------------------------   00127400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00127500
.ZG6                 ANOP  ,                                            00127600
                     AIF   (K'&CHECKCONNSTATUS(1) LE 0).ZG6A            00127700
&ZTLC                SETC 'NO'                                          00127800
                     AIF   ('&CHECKCONNSTATUS(1)' NE '&ZTLC').ZG13      00127900
&XCHECKCONNSTATUS    SETC  'NO'        SET KEYWORD                      00128000
                     AIF   (N'&CHECKCONNSTATUS LE 1).ZG6A  CK NUM       00128100
&ZMS                 SETC  '"CHECKCONNSTATUS='  *KPOSA* MNOTE           00128200
&ZMS                 SETC  '&ZMS.&CHECKCONNSTATUS"'                     00128300
&ZMS                 SETC  '&ZMS "CHECKCONNSTATUS"'                     00128400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00128500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00128600
.ZG6A                ANOP  ,                                            00128700
.*----------------------------------------------------------------***   00128800
.***AG.KXVAR05 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE KEY                00128900
                     AIF   (N'&BUFFER LE 1).ZG8A  CK NUM                00129000
&ZMS                 SETC  '"BUFFER='  *KPOSA* MNOTE                    00129100
&ZMS                 SETC  '&ZMS.&BUFFER"'                              00129200
&ZMS                 SETC  '&ZMS "BUFFER"'                              00129300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00129400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00129500
.ZG8A                ANOP  ,                                            00129600
.*-------------------------------------------------------------------   00129700
.***AG.KXVAR06 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE                    00129800
&ZXBUFFER            SETC  'OUTPUT'    SET IN/OUTPUT                    00129900
&XBUFFER             SETC  '&BUFFER(1)'         SET XVARIABLE           00130000
                     AIF   (N'&BUFFER GT 1).ZG8B  MULTI PARMS           00130100
&XBUFFER             SETC  '&BUFFER'   SET XVARIABLE                    00130200
.ZG8B                AIF   (K'&BUFFER(1) GT 0).ZG8C                     00130300
&ZXBUFFER            SETC  ''          RESET IN/OUTPUT                  00130400
&ZMS                 SETC  ' '         *KRQDA*                          00130500
&ZMS                 SETC  '&ZMS "BUFFER" KEY AND ITS'                  00130600
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00130700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00130800
.ZG8C                ANOP  ,                                            00130900
.*-------------------------------------------------------------------   00131000
.***AG.KCK02 NAME, OPT RQD OUTPUT, KEYS -GPR OUT OF RANGE               00131100
                     AIF   (K'&ZXBUFFER LE 0).ZG8R  NOT I/O             00131200
                     AIF   ('&XBUFFER'(1,1) NE '(').ZG8R                00131300
&ZCGPR               SETC  '&XBUFFER'(2,K'&XBUFFER-2)                   00131400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                  00131500
                     AIF   (K'&ZCGPR GT 2).ZG8Q                         00131600
                     AIF   ('&ZCGPR' EQ '0').ZG8Q                       00131700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00131800
                     AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME     00131900
.ZG8P                ANOP  ,                                            00132000
                     AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC          00132100
                     AIF   ('&ZCGPR' LT '2').ZG8Q                       00132200
                     AIF   ('&ZCGPR' LE '12').ZG8R                      00132300
.ZG8Q                ANOP  ,                                            00132400
&ZMS                 SETC  '"BUFFER='  *KGPRA* MNOTE                    00132500
&ZMS                 SETC  '&ZMS.&BUFFER"'                              00132600
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00132700
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00132800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00132900
.ZG8R                ANOP  ,                                            00133000
.*----------------------------------------------------------------***   00133100
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00133200
                     AIF   (N'&BUFFLEN LE 1).ZG11A  CK NUM              00133300
&ZMS                 SETC  '"BUFFLEN='          *KPOSA* MNOTE           00133400
&ZMS                 SETC  '&ZMS.&BUFFLEN"'                             00133500
&ZMS                 SETC  '&ZMS "BUFFLEN"'                             00133600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00133700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00133800
.ZG11A               ANOP  ,                                            00133900
.*-------------------------------------------------------------------   00134000
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00134100
&ZXBUFFLEN           SETC  'INPUT'     SET IN/OUTPUT                    00134200
&XBUFFLEN            SETC  '&BUFFLEN(1)'        SET XVARIABLE           00134300
                     AIF   (N'&BUFFLEN GT 1).ZG11B  MULTI PARMS         00134400
&XBUFFLEN            SETC  '&BUFFLEN'  SET XVARIABLE                    00134500
.ZG11B               AIF   (K'&BUFFLEN(1) GT 0).ZG11C                   00134600
&ZXBUFFLEN           SETC  ''          RESET IN/OUTPUT                  00134700
&ZMS                 SETC  ' '         *KRQDA*                          00134800
&ZMS                 SETC  '&ZMS "BUFFLEN" KEY AND ITS'                 00134900
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00135000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00135100
.ZG11C               ANOP  ,                                            00135200
.*-------------------------------------------------------------------   00135300
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00135400
                     AIF   (K'&ZXBUFFLEN LE 0).ZG11R  NOT I/O           00135500
                     AIF   ('&XBUFFLEN'(1,1) NE '(').ZG11R              00135600
&ZCGPR               SETC  '&XBUFFLEN'(2,K'&XBUFFLEN-2)                 00135700
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                 00135800
                     AIF   (K'&ZCGPR GT 2).ZG11Q                        00135900
                     AIF   ('&ZCGPR' EQ '0').ZG11Q                      00136000
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00136100
                     AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME    00136200
.ZG11P               ANOP  ,                                            00136300
                     AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC         00136400
                     AIF   ('&ZCGPR' LT '2').ZG11Q                      00136500
                     AIF   ('&ZCGPR' LE '12').ZG11R                     00136600
.ZG11Q               ANOP  ,                                            00136700
&ZMS                 SETC  '"BUFFLEN='          *KGPRA* MNOTE           00136800
&ZMS                 SETC  '&ZMS.&BUFFLEN"'                             00136900
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00137000
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00137100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00137200
.ZG11R               ANOP  ,                                            00137300
.*-------------------------------------------------------------------   00137400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00137500
.ZG13                ANOP  ,                                            00137600
&ZTLC                SETC 'YES'                                         00137700
                     AIF   ('&CHECKCONNSTATUS(1)' NE '&ZTLC').ZG14      00137800
&XCHECKCONNSTATUS    SETC  'YES'       SET KEYWORD                      00137900
                     AIF   (N'&CHECKCONNSTATUS LE 1).ZG13A  CK NUM      00138000
&ZMS                 SETC  '"CHECKCONNSTATUS='  *KPOSA* MNOTE           00138100
&ZMS                 SETC  '&ZMS.&CHECKCONNSTATUS"'                     00138200
&ZMS                 SETC  '&ZMS "CHECKCONNSTATUS"'                     00138300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00138400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00138500
.ZG13A               ANOP  ,                                            00138600
.*------------------------------------------------------------------    00138700
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00138800
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00138900
.ZG13A0              AIF   (K'&BUFFER LE 0).ZG13A1  OK                  00139000
&ZCVAL               SETC '&ZCVAL BUFFER'       INCORRECT KEY USED      00139100
.ZG13A1              AIF   (K'&BUFFLEN LE 0).ZG13A2  OK                 00139200
&ZCVAL               SETC '&ZCVAL BUFFLEN'      INCORRECT KEY USED      00139300
.ZG13A2              AIF   (K'&ZCVAL LE 0).ZG13A3  OK                   00139400
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00139500
&ZMS                 SETC  '"CHECKCONNSTATUS'   *KMEIA* MNOTE           00139600
&ZMS                 SETC  '&ZMS.=&CHECKCONNSTATUS"'                    00139700
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00139800
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00139900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00140000
.ZG13A3              ANOP  ,                                            00140100
.*------------------------------------------------------------------    00140200
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00140300
.ZG14                ANOP  ,                                            00140400
&ZXCHECKCONNSTATUS   SETC  'INPUT'     SET IN/OUTPUT                    00140500
                     AIF   (K'&XCHECKCONNSTATUS GT 0).ZG14E  VALID ARG  00140600
                     AIF   (T'&CHECKCONNSTATUS EQ 'O').ZG14D  OMITTED   00140700
&ZASYSLNDX           SETA  0                                            00140800
.ZG14A               ANOP  ,           POSITIONAL MACRO KEY             00140900
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00141000
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG14C             00141100
&ZTLC                SETC 'CHECKCONNSTATUS'                             00141200
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG14A    00141300
.ZG14B               ANOP  ,                                            00141400
&ZXCHECKCONNSTATUS   SETC  ''          RESET IN/OUTPUT                  00141500
&ZMS                 SETC  'THE "CHECKCONNSTATUS" KEY'  *KOPTA* MNOTE   00141600
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00141700
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00141800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00141900
                     AGO   .ZG14E                                       00142000
.ZG14C               ANOP  ,                                            00142100
&ZXCHECKCONNSTATUS   SETC  ''          RESET IN/OUTPUT                  00142200
&ZMS                 SETC  '"CHECKCONNSTATUS='  *KUKWA* MNOTE           00142300
&ZMS                 SETC  '&ZMS.&CHECKCONNSTATUS"'                     00142400
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00142500
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00142600
&ZMS                 SETC  '&ZMS "NO"'                                  00142700
&ZMS                 SETC  '&ZMS OR "YES".'                             00142800
                     MNOTE 8,' &ZMS '                                   00142900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00143000
                     AGO   .ZG14E                                       00143100
.ZG14D               ANOP  ,                                            00143200
&XCHECKCONNSTATUS    SETC  'NO'        SET DEFAULT KEYWORD              00143300
.ZG14E               ANOP  ,                                            00143400
.*----------------------------------------------------------------***   00143500
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00143600
                     AIF   (N'&ANSAREA LE 1).ZG16A  CK NUM              00143700
&ZMS                 SETC  '"ANSAREA='          *KPOSA* MNOTE           00143800
&ZMS                 SETC  '&ZMS.&ANSAREA"'                             00143900
&ZMS                 SETC  '&ZMS "ANSAREA"'                             00144000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00144100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00144200
.ZG16A               ANOP  ,                                            00144300
.*-------------------------------------------------------------------   00144400
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00144500
&ZXANSAREA           SETC  'INPUT'     SET IN/OUTPUT                    00144600
&XANSAREA            SETC  '&ANSAREA(1)'        SET XVARIABLE           00144700
                     AIF   (N'&ANSAREA GT 1).ZG16B  MULTI PARMS         00144800
&XANSAREA            SETC  '&ANSAREA'  SET XVARIABLE                    00144900
.ZG16B               AIF   (K'&ANSAREA(1) GT 0).ZG16C                   00145000
&ZXANSAREA           SETC  ''          RESET IN/OUTPUT                  00145100
&ZMS                 SETC  ' '         *KRQDA*                          00145200
&ZMS                 SETC  '&ZMS "ANSAREA" KEY AND ITS'                 00145300
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00145400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00145500
.ZG16C               ANOP  ,                                            00145600
.*-------------------------------------------------------------------   00145700
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00145800
                     AIF   (K'&ZXANSAREA LE 0).ZG16R  NOT I/O           00145900
                     AIF   ('&XANSAREA'(1,1) NE '(').ZG16R              00146000
&ZCGPR               SETC  '&XANSAREA'(2,K'&XANSAREA-2)                 00146100
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG16P                 00146200
                     AIF   (K'&ZCGPR GT 2).ZG16Q                        00146300
                     AIF   ('&ZCGPR' EQ '0').ZG16Q                      00146400
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00146500
                     AIF   (T'&ZCGPR NE 'N').ZG16Q  INVALID REG NAME    00146600
.ZG16P               ANOP  ,                                            00146700
                     AIF   (T'&ZCGPR NE 'N').ZG16R  NON NUMERIC         00146800
                     AIF   ('&ZCGPR' LT '2').ZG16Q                      00146900
                     AIF   ('&ZCGPR' LE '12').ZG16R                     00147000
.ZG16Q               ANOP  ,                                            00147100
&ZMS                 SETC  '"ANSAREA='          *KGPRA* MNOTE           00147200
&ZMS                 SETC  '&ZMS.&ANSAREA"'                             00147300
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00147400
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00147500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00147600
.ZG16R               ANOP  ,                                            00147700
.*----------------------------------------------------------------***   00147800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00147900
                     AIF   (N'&ANSLEN LE 1).ZG19A  CK NUM               00148000
&ZMS                 SETC  '"ANSLEN='  *KPOSA* MNOTE                    00148100
&ZMS                 SETC  '&ZMS.&ANSLEN"'                              00148200
&ZMS                 SETC  '&ZMS "ANSLEN"'                              00148300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00148400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00148500
.ZG19A               ANOP  ,                                            00148600
.*-------------------------------------------------------------------   00148700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00148800
&ZXANSLEN            SETC  'INPUT'     SET IN/OUTPUT                    00148900
&XANSLEN             SETC  '&ANSLEN(1)'         SET XVARIABLE           00149000
                     AIF   (N'&ANSLEN GT 1).ZG19B  MULTI PARMS          00149100
&XANSLEN             SETC  '&ANSLEN'   SET XVARIABLE                    00149200
.ZG19B               AIF   (K'&ANSLEN(1) GT 0).ZG19C                    00149300
&ZXANSLEN            SETC  ''          RESET IN/OUTPUT                  00149400
&ZMS                 SETC  ' '         *KRQDA*                          00149500
&ZMS                 SETC  '&ZMS "ANSLEN" KEY AND ITS'                  00149600
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00149700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00149800
.ZG19C               ANOP  ,                                            00149900
.*-------------------------------------------------------------------   00150000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00150100
                     AIF   (K'&ZXANSLEN LE 0).ZG19R  NOT I/O            00150200
                     AIF   ('&XANSLEN'(1,1) NE '(').ZG19R               00150300
&ZCGPR               SETC  '&XANSLEN'(2,K'&XANSLEN-2)                   00150400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                 00150500
                     AIF   (K'&ZCGPR GT 2).ZG19Q                        00150600
                     AIF   ('&ZCGPR' EQ '0').ZG19Q                      00150700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00150800
                     AIF   (T'&ZCGPR NE 'N').ZG19Q  INVALID REG NAME    00150900
.ZG19P               ANOP  ,                                            00151000
                     AIF   (T'&ZCGPR NE 'N').ZG19R  NON NUMERIC         00151100
                     AIF   ('&ZCGPR' LT '2').ZG19Q                      00151200
                     AIF   ('&ZCGPR' LE '12').ZG19R                     00151300
.ZG19Q               ANOP  ,                                            00151400
&ZMS                 SETC  '"ANSLEN='  *KGPRA* MNOTE                    00151500
&ZMS                 SETC  '&ZMS.&ANSLEN"'                              00151600
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00151700
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00151800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00151900
.ZG19R               ANOP  ,                                            00152000
.*----------------------------------------------------------------***   00152100
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00152200
                     AIF   (N'&RETCODE LE 1).ZG22A  CK NUM              00152300
&ZMS                 SETC  '"RETCODE='          *KPOSA* MNOTE           00152400
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00152500
&ZMS                 SETC  '&ZMS "RETCODE"'                             00152600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00152700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00152800
.ZG22A               ANOP  ,                                            00152900
.*-------------------------------------------------------------------   00153000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00153100
                     AIF   (K'&RETCODE(1) LE 0).ZG22C  NO PARM          00153200
&ZXRETCODE           SETC  'OUTPUT'    SET OUTPUT                       00153300
&XRETCODE            SETC  '&RETCODE(1)'        SET XVARIABLE           00153400
                     AIF   (N'&RETCODE GT 1).ZG22C                      00153500
&XRETCODE            SETC  '&RETCODE'  SET XVARIABLE                    00153600
.ZG22C               ANOP  ,                                            00153700
.*-------------------------------------------------------------------   00153800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00153900
                     AIF   (K'&ZXRETCODE LE 0).ZG22R  NOT I/O           00154000
                     AIF   ('&XRETCODE'(1,1) NE '(').ZG22R              00154100
&ZCGPR               SETC  '&XRETCODE'(2,K'&XRETCODE-2)                 00154200
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                 00154300
                     AIF   (K'&ZCGPR GT 2).ZG22Q                        00154400
                     AIF   ('&ZCGPR' EQ '0').ZG22Q                      00154500
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00154600
                     AIF   (T'&ZCGPR NE 'N').ZG22Q  INVALID REG NAME    00154700
.ZG22P               ANOP  ,                                            00154800
                     AIF   (T'&ZCGPR NE 'N').ZG22R  NON NUMERIC         00154900
                     AIF   ('&ZCGPR' LT '2').ZG22Q                      00155000
                     AIF   ('&ZCGPR' LE '12').ZG22R                     00155100
.ZG22Q               ANOP  ,                                            00155200
&ZMS                 SETC  '"RETCODE='          *KGPRA* MNOTE           00155300
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00155400
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00155500
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00155600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00155700
.ZG22R               ANOP  ,                                            00155800
.*----------------------------------------------------------------***   00155900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00156000
                     AIF   (N'&RSNCODE LE 1).ZG25A  CK NUM              00156100
&ZMS                 SETC  '"RSNCODE='          *KPOSA* MNOTE           00156200
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00156300
&ZMS                 SETC  '&ZMS "RSNCODE"'                             00156400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00156500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00156600
.ZG25A               ANOP  ,                                            00156700
.*-------------------------------------------------------------------   00156800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00156900
                     AIF   (K'&RSNCODE(1) LE 0).ZG25C  NO PARM          00157000
&ZXRSNCODE           SETC  'OUTPUT'    SET OUTPUT                       00157100
&XRSNCODE            SETC  '&RSNCODE(1)'        SET XVARIABLE           00157200
                     AIF   (N'&RSNCODE GT 1).ZG25C                      00157300
&XRSNCODE            SETC  '&RSNCODE'  SET XVARIABLE                    00157400
.ZG25C               ANOP  ,                                            00157500
.*-------------------------------------------------------------------   00157600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00157700
                     AIF   (K'&ZXRSNCODE LE 0).ZG25R  NOT I/O           00157800
                     AIF   ('&XRSNCODE'(1,1) NE '(').ZG25R              00157900
&ZCGPR               SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                 00158000
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                 00158100
                     AIF   (K'&ZCGPR GT 2).ZG25Q                        00158200
                     AIF   ('&ZCGPR' EQ '0').ZG25Q                      00158300
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00158400
                     AIF   (T'&ZCGPR NE 'N').ZG25Q  INVALID REG NAME    00158500
.ZG25P               ANOP  ,                                            00158600
                     AIF   (T'&ZCGPR NE 'N').ZG25R  NON NUMERIC         00158700
                     AIF   ('&ZCGPR' LT '2').ZG25Q                      00158800
                     AIF   ('&ZCGPR' LE '12').ZG25R                     00158900
.ZG25Q               ANOP  ,                                            00159000
&ZMS                 SETC  '"RSNCODE='          *KGPRA* MNOTE           00159100
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00159200
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00159300
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00159400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00159500
.ZG25R               ANOP  ,                                            00159600
.******************************************************************     00159700
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00159800
.******************************************************************     00159900
                     ACTR  10000                                        00160000
.*----------------------------------------------------------------***   00160100
.***AH.P02 EXTRA POSITIONALS                                            00160200
                     AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS         00160300
                     AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL         00160400
                     AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL     00160500
                     AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL      00160600
.ZGLISTX1            ANOP  ,                                            00160700
&ZCVAL               SETC  ''          ERROR FIELD                      00160800
&ZAWRK               SETA  0           POSITIONAL NUMBER                00160900
.ZGLIST2             ANOP  ,                                            00161000
&ZAWRK               SETA  &ZAWRK+1    NEXT POSITIONAL                  00161100
                     AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE         00161200
&ZCVAL               SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA              00161300
                     AGO   .ZGLIST2                                     00161400
.*                                                                      00161500
.ZGLIST3             ANOP  ,                                            00161600
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA           00161700
&ZMS                 SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE     00161800
&ZMS                 SETC  '&ZMS "&ZCVAL"'                              00161900
&ZMS                 SETC  '&ZMS CANNOT BE USED.'                       00162000
&ZMS                 SETC  '&ZMS NO POSITIONAL ARGUMENTS'               00162100
                     MNOTE 8,' &ZMS ARE ALLOWED.'                       00162200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00162300
.ZGLISTX             ANOP  ,                                            00162400
&ZASYSLNDX           SETA  0                                            00162500
.*-------------------------------------------------------------------   00162600
.***AG.MF04 MF=(SLME)                                                   00162700
.ZGMFX               ANOP  ,           END OF FULL SYNTAX CHECK         00162800
.********************************************************************   00162900
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00163000
.********************************************************************   00163100
                     ACTR  10000                                        00163200
.*-------------------------------------------------------------------   00163300
.***AE.MF01 MF=(SLME)                                                   00163400
                     AIF   ('&XMF' EQ 'L').ZEMFX                        00163500
                     AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX               00163600
.********************************************************************   00163700
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00163800
.********************************************************************   00163900
&XCHECKCONNSTATUS    SETC  ''          INITIALIZE XVARIABLE             00164000
.*----------------------------------------------------------------***   00164100
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00164200
                     AIF   (N'&STREAMTOKEN LE 1).ZE2A  CK NUM           00164300
&ZMS                 SETC  '"STREAMTOKEN='      *KPOSA* MNOTE           00164400
&ZMS                 SETC  '&ZMS.&STREAMTOKEN"'                         00164500
&ZMS                 SETC  '&ZMS "STREAMTOKEN"'                         00164600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00164700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00164800
.ZE2A                ANOP  ,                                            00164900
.*-------------------------------------------------------------------   00165000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00165100
                     AIF   (K'&STREAMTOKEN(1) LE 0).ZE2B NO PRM         00165200
&ZXSTREAMTOKEN       SETC  'INPUT'     SET IN/OUTPUT                    00165300
&XSTREAMTOKEN        SETC  '&STREAMTOKEN(1)'    SET XVARIABLE           00165400
                     AIF   (N'&STREAMTOKEN GT 1).ZE2B                   00165500
.*                   ANOP              MULTIPLE PARMS                   00165600
&XSTREAMTOKEN        SETC  '&STREAMTOKEN'       SET XVARIABLE           00165700
.ZE2B                ANOP  ,                                            00165800
.*-------------------------------------------------------------------   00165900
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00166000
                     AIF   (K'&ZXSTREAMTOKEN LE 0).ZE2R  NOT I/O        00166100
                     AIF   ('&XSTREAMTOKEN'(1,1) NE '(').ZE2R           00166200
&ZCGPR               SETC  '&XSTREAMTOKEN'(2,K'&XSTREAMTOKEN-2)         00166300
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE2P                  00166400
                     AIF   (K'&ZCGPR GT 2).ZE2Q                         00166500
                     AIF   ('&ZCGPR' EQ '0').ZE2Q                       00166600
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00166700
                     AIF   (T'&ZCGPR NE 'N').ZE2Q  INVALID REG NAME     00166800
.ZE2P                ANOP  ,                                            00166900
                     AIF   (T'&ZCGPR NE 'N').ZE2R  NON NUMERIC          00167000
                     AIF   ('&ZCGPR' LT '2').ZE2Q                       00167100
                     AIF   ('&ZCGPR' LE '12').ZE2R                      00167200
.ZE2Q                ANOP  ,                                            00167300
&ZMS                 SETC  '"STREAMTOKEN='      *KGPRA* MNOTE           00167400
&ZMS                 SETC  '&ZMS.&STREAMTOKEN"'                         00167500
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00167600
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00167700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00167800
.ZE2R                ANOP  ,                                            00167900
.*-------------------------------------------------------------------   00168000
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00168100
&ZTLC                SETC 'NO'                                          00168200
                     AIF   ('&CHECKCONNSTATUS(1)' NE '&ZTLC').ZE6A      00168300
&XCHECKCONNSTATUS    SETC  'NO'        SET KEYWORD                      00168400
                     AIF   (N'&CHECKCONNSTATUS LE 1).ZE6A  CK NUM       00168500
&ZMS                 SETC  '"CHECKCONNSTATUS='  *KPOSA* MNOTE           00168600
&ZMS                 SETC  '&ZMS.&CHECKCONNSTATUS"'                     00168700
&ZMS                 SETC  '&ZMS "CHECKCONNSTATUS"'                     00168800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00168900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00169000
.ZE6A                ANOP  ,                                            00169100
.*----------------------------------------------------------------***   00169200
.***AE.KXVAR03 NAME, RQD OUTPUT, KEYS -XVAR KEY                         00169300
                     AIF   (N'&BUFFER LE 1).ZE8A  CK NUM                00169400
&ZMS                 SETC  '"BUFFER='  *KPOSA* MNOTE                    00169500
&ZMS                 SETC  '&ZMS.&BUFFER"'                              00169600
&ZMS                 SETC  '&ZMS "BUFFER"'                              00169700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00169800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00169900
.ZE8A                ANOP  ,                                            00170000
.*-------------------------------------------------------------------   00170100
.***AE.KXVAR04 NAME, RQD OUTPUT, KEYS -XVAR ARGUMENT                    00170200
                     AIF   (K'&BUFFER(1) LE 0).ZE8B NO PRM              00170300
&ZXBUFFER            SETC  'OUTPUT'    SET IN/OUTPUT                    00170400
&XBUFFER             SETC  '&BUFFER(1)'         SET XVARIABLE           00170500
                     AIF   (N'&BUFFER GT 1).ZE8B                        00170600
.*                   ANOP              MULTIPLE PARMS                   00170700
&XBUFFER             SETC  '&BUFFER'   SET XVARIABLE                    00170800
.ZE8B                ANOP  ,                                            00170900
.*-------------------------------------------------------------------   00171000
.***AE.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00171100
                     AIF   (K'&ZXBUFFER LE 0).ZE8R  NOT I/O             00171200
                     AIF   ('&XBUFFER'(1,1) NE '(').ZE8R                00171300
&ZCGPR               SETC  '&XBUFFER'(2,K'&XBUFFER-2)                   00171400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE8P                  00171500
                     AIF   (K'&ZCGPR GT 2).ZE8Q                         00171600
                     AIF   ('&ZCGPR' EQ '0').ZE8Q                       00171700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00171800
                     AIF   (T'&ZCGPR NE 'N').ZE8Q  INVALID REG NAME     00171900
.ZE8P                ANOP  ,                                            00172000
                     AIF   (T'&ZCGPR NE 'N').ZE8R  NON NUMERIC          00172100
                     AIF   ('&ZCGPR' LT '2').ZE8Q                       00172200
                     AIF   ('&ZCGPR' LE '12').ZE8R                      00172300
.ZE8Q                ANOP  ,                                            00172400
&ZMS                 SETC  '"BUFFER='  *KGPRA* MNOTE                    00172500
&ZMS                 SETC  '&ZMS.&BUFFER"'                              00172600
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00172700
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00172800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00172900
.ZE8R                ANOP  ,                                            00173000
.*----------------------------------------------------------------***   00173100
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00173200
                     AIF   (N'&BUFFLEN LE 1).ZE11A  CK NUM              00173300
&ZMS                 SETC  '"BUFFLEN='          *KPOSA* MNOTE           00173400
&ZMS                 SETC  '&ZMS.&BUFFLEN"'                             00173500
&ZMS                 SETC  '&ZMS "BUFFLEN"'                             00173600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00173700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00173800
.ZE11A               ANOP  ,                                            00173900
.*-------------------------------------------------------------------   00174000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00174100
                     AIF   (K'&BUFFLEN(1) LE 0).ZE11B NO PRM            00174200
&ZXBUFFLEN           SETC  'INPUT'     SET IN/OUTPUT                    00174300
&XBUFFLEN            SETC  '&BUFFLEN(1)'        SET XVARIABLE           00174400
                     AIF   (N'&BUFFLEN GT 1).ZE11B                      00174500
.*                   ANOP              MULTIPLE PARMS                   00174600
&XBUFFLEN            SETC  '&BUFFLEN'  SET XVARIABLE                    00174700
.ZE11B               ANOP  ,                                            00174800
.*-------------------------------------------------------------------   00174900
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00175000
                     AIF   (K'&ZXBUFFLEN LE 0).ZE11R  NOT I/O           00175100
                     AIF   ('&XBUFFLEN'(1,1) NE '(').ZE11R              00175200
&ZCGPR               SETC  '&XBUFFLEN'(2,K'&XBUFFLEN-2)                 00175300
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE11P                 00175400
                     AIF   (K'&ZCGPR GT 2).ZE11Q                        00175500
                     AIF   ('&ZCGPR' EQ '0').ZE11Q                      00175600
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00175700
                     AIF   (T'&ZCGPR NE 'N').ZE11Q  INVALID REG NAME    00175800
.ZE11P               ANOP  ,                                            00175900
                     AIF   (T'&ZCGPR NE 'N').ZE11R  NON NUMERIC         00176000
                     AIF   ('&ZCGPR' LT '2').ZE11Q                      00176100
                     AIF   ('&ZCGPR' LE '12').ZE11R                     00176200
.ZE11Q               ANOP  ,                                            00176300
&ZMS                 SETC  '"BUFFLEN='          *KGPRA* MNOTE           00176400
&ZMS                 SETC  '&ZMS.&BUFFLEN"'                             00176500
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00176600
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00176700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00176800
.ZE11R               ANOP  ,                                            00176900
.*-------------------------------------------------------------------   00177000
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00177100
&ZTLC                SETC 'YES'                                         00177200
                     AIF   ('&CHECKCONNSTATUS(1)' NE '&ZTLC').ZE13A     00177300
&XCHECKCONNSTATUS    SETC  'YES'       SET KEYWORD                      00177400
                     AIF   (N'&CHECKCONNSTATUS LE 1).ZE13A  CK NUM      00177500
&ZMS                 SETC  '"CHECKCONNSTATUS='  *KPOSA* MNOTE           00177600
&ZMS                 SETC  '&ZMS.&CHECKCONNSTATUS"'                     00177700
&ZMS                 SETC  '&ZMS "CHECKCONNSTATUS"'                     00177800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00177900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00178000
.ZE13A               ANOP  ,                                            00178100
.*------------------------------------------------------------------    00178200
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00178300
.ZE14                AIF   (K'&XCHECKCONNSTATUS GT 0).ZE14A  VALID      00178400
                     AIF   (K'&CHECKCONNSTATUS(1) LE 0).ZE14B           00178500
&ZMS                 SETC  '"CHECKCONNSTATUS='  *KUKWA* MNOTE           00178600
&ZMS                 SETC  '&ZMS.&CHECKCONNSTATUS"'                     00178700
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00178800
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00178900
&ZMS                 SETC  '&ZMS "NO"'                                  00179000
&ZMS                 SETC  '&ZMS OR "YES".'                             00179100
                     MNOTE 8,' &ZMS '                                   00179200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00179300
                     AGO   .ZE14B                                       00179400
.*                                                                      00179500
.ZE14A               ANOP  ,                                            00179600
&ZXCHECKCONNSTATUS   SETC  'INPUT'     SET IN/OUTPUT                    00179700
.ZE14B               ANOP  ,                                            00179800
.*----------------------------------------------------------------***   00179900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00180000
                     AIF   (N'&ANSAREA LE 1).ZE16A  CK NUM              00180100
&ZMS                 SETC  '"ANSAREA='          *KPOSA* MNOTE           00180200
&ZMS                 SETC  '&ZMS.&ANSAREA"'                             00180300
&ZMS                 SETC  '&ZMS "ANSAREA"'                             00180400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00180500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00180600
.ZE16A               ANOP  ,                                            00180700
.*-------------------------------------------------------------------   00180800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00180900
                     AIF   (K'&ANSAREA(1) LE 0).ZE16B NO PRM            00181000
&ZXANSAREA           SETC  'INPUT'     SET IN/OUTPUT                    00181100
&XANSAREA            SETC  '&ANSAREA(1)'        SET XVARIABLE           00181200
                     AIF   (N'&ANSAREA GT 1).ZE16B                      00181300
.*                   ANOP              MULTIPLE PARMS                   00181400
&XANSAREA            SETC  '&ANSAREA'  SET XVARIABLE                    00181500
.ZE16B               ANOP  ,                                            00181600
.*-------------------------------------------------------------------   00181700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00181800
                     AIF   (K'&ZXANSAREA LE 0).ZE16R  NOT I/O           00181900
                     AIF   ('&XANSAREA'(1,1) NE '(').ZE16R              00182000
&ZCGPR               SETC  '&XANSAREA'(2,K'&XANSAREA-2)                 00182100
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE16P                 00182200
                     AIF   (K'&ZCGPR GT 2).ZE16Q                        00182300
                     AIF   ('&ZCGPR' EQ '0').ZE16Q                      00182400
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00182500
                     AIF   (T'&ZCGPR NE 'N').ZE16Q  INVALID REG NAME    00182600
.ZE16P               ANOP  ,                                            00182700
                     AIF   (T'&ZCGPR NE 'N').ZE16R  NON NUMERIC         00182800
                     AIF   ('&ZCGPR' LT '2').ZE16Q                      00182900
                     AIF   ('&ZCGPR' LE '12').ZE16R                     00183000
.ZE16Q               ANOP  ,                                            00183100
&ZMS                 SETC  '"ANSAREA='          *KGPRA* MNOTE           00183200
&ZMS                 SETC  '&ZMS.&ANSAREA"'                             00183300
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00183400
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00183500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00183600
.ZE16R               ANOP  ,                                            00183700
.*----------------------------------------------------------------***   00183800
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00183900
                     AIF   (N'&ANSLEN LE 1).ZE19A  CK NUM               00184000
&ZMS                 SETC  '"ANSLEN='  *KPOSA* MNOTE                    00184100
&ZMS                 SETC  '&ZMS.&ANSLEN"'                              00184200
&ZMS                 SETC  '&ZMS "ANSLEN"'                              00184300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00184400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00184500
.ZE19A               ANOP  ,                                            00184600
.*-------------------------------------------------------------------   00184700
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00184800
                     AIF   (K'&ANSLEN(1) LE 0).ZE19B NO PRM             00184900
&ZXANSLEN            SETC  'INPUT'     SET IN/OUTPUT                    00185000
&XANSLEN             SETC  '&ANSLEN(1)'         SET XVARIABLE           00185100
                     AIF   (N'&ANSLEN GT 1).ZE19B                       00185200
.*                   ANOP              MULTIPLE PARMS                   00185300
&XANSLEN             SETC  '&ANSLEN'   SET XVARIABLE                    00185400
.ZE19B               ANOP  ,                                            00185500
.*-------------------------------------------------------------------   00185600
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00185700
                     AIF   (K'&ZXANSLEN LE 0).ZE19R  NOT I/O            00185800
                     AIF   ('&XANSLEN'(1,1) NE '(').ZE19R               00185900
&ZCGPR               SETC  '&XANSLEN'(2,K'&XANSLEN-2)                   00186000
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE19P                 00186100
                     AIF   (K'&ZCGPR GT 2).ZE19Q                        00186200
                     AIF   ('&ZCGPR' EQ '0').ZE19Q                      00186300
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00186400
                     AIF   (T'&ZCGPR NE 'N').ZE19Q  INVALID REG NAME    00186500
.ZE19P               ANOP  ,                                            00186600
                     AIF   (T'&ZCGPR NE 'N').ZE19R  NON NUMERIC         00186700
                     AIF   ('&ZCGPR' LT '2').ZE19Q                      00186800
                     AIF   ('&ZCGPR' LE '12').ZE19R                     00186900
.ZE19Q               ANOP  ,                                            00187000
&ZMS                 SETC  '"ANSLEN='  *KGPRA* MNOTE                    00187100
&ZMS                 SETC  '&ZMS.&ANSLEN"'                              00187200
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00187300
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00187400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00187500
.ZE19R               ANOP  ,                                            00187600
.*----------------------------------------------------------------***   00187700
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00187800
                     AIF   (N'&RETCODE LE 1).ZE22A  CK NUM              00187900
&ZMS                 SETC  '"RETCODE='          *KPOSA* MNOTE           00188000
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00188100
&ZMS                 SETC  '&ZMS "RETCODE"'                             00188200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00188300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00188400
.ZE22A               ANOP  ,                                            00188500
.*-------------------------------------------------------------------   00188600
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00188700
                     AIF   (K'&RETCODE(1) LE 0).ZE22B NO PRM            00188800
&ZXRETCODE           SETC  'OUTPUT'    SET IN/OUTPUT                    00188900
&XRETCODE            SETC  '&RETCODE(1)'        SET XVARIABLE           00189000
                     AIF   (N'&RETCODE GT 1).ZE22B                      00189100
.*                   ANOP              MULTIPLE PARMS                   00189200
&XRETCODE            SETC  '&RETCODE'  SET XVARIABLE                    00189300
.ZE22B               ANOP  ,                                            00189400
.*-------------------------------------------------------------------   00189500
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00189600
                     AIF   (K'&ZXRETCODE LE 0).ZE22R  NOT I/O           00189700
                     AIF   ('&XRETCODE'(1,1) NE '(').ZE22R              00189800
&ZCGPR               SETC  '&XRETCODE'(2,K'&XRETCODE-2)                 00189900
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE22P                 00190000
                     AIF   (K'&ZCGPR GT 2).ZE22Q                        00190100
                     AIF   ('&ZCGPR' EQ '0').ZE22Q                      00190200
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00190300
                     AIF   (T'&ZCGPR NE 'N').ZE22Q  INVALID REG NAME    00190400
.ZE22P               ANOP  ,                                            00190500
                     AIF   (T'&ZCGPR NE 'N').ZE22R  NON NUMERIC         00190600
                     AIF   ('&ZCGPR' LT '2').ZE22Q                      00190700
                     AIF   ('&ZCGPR' LE '12').ZE22R                     00190800
.ZE22Q               ANOP  ,                                            00190900
&ZMS                 SETC  '"RETCODE='          *KGPRA* MNOTE           00191000
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00191100
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00191200
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00191300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00191400
.ZE22R               ANOP  ,                                            00191500
.*----------------------------------------------------------------***   00191600
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00191700
                     AIF   (N'&RSNCODE LE 1).ZE25A  CK NUM              00191800
&ZMS                 SETC  '"RSNCODE='          *KPOSA* MNOTE           00191900
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00192000
&ZMS                 SETC  '&ZMS "RSNCODE"'                             00192100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00192200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00192300
.ZE25A               ANOP  ,                                            00192400
.*-------------------------------------------------------------------   00192500
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00192600
                     AIF   (K'&RSNCODE(1) LE 0).ZE25B NO PRM            00192700
&ZXRSNCODE           SETC  'OUTPUT'    SET IN/OUTPUT                    00192800
&XRSNCODE            SETC  '&RSNCODE(1)'        SET XVARIABLE           00192900
                     AIF   (N'&RSNCODE GT 1).ZE25B                      00193000
.*                   ANOP              MULTIPLE PARMS                   00193100
&XRSNCODE            SETC  '&RSNCODE'  SET XVARIABLE                    00193200
.ZE25B               ANOP  ,                                            00193300
.*-------------------------------------------------------------------   00193400
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00193500
                     AIF   (K'&ZXRSNCODE LE 0).ZE25R  NOT I/O           00193600
                     AIF   ('&XRSNCODE'(1,1) NE '(').ZE25R              00193700
&ZCGPR               SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                 00193800
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE25P                 00193900
                     AIF   (K'&ZCGPR GT 2).ZE25Q                        00194000
                     AIF   ('&ZCGPR' EQ '0').ZE25Q                      00194100
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00194200
                     AIF   (T'&ZCGPR NE 'N').ZE25Q  INVALID REG NAME    00194300
.ZE25P               ANOP  ,                                            00194400
                     AIF   (T'&ZCGPR NE 'N').ZE25R  NON NUMERIC         00194500
                     AIF   ('&ZCGPR' LT '2').ZE25Q                      00194600
                     AIF   ('&ZCGPR' LE '12').ZE25R                     00194700
.ZE25Q               ANOP  ,                                            00194800
&ZMS                 SETC  '"RSNCODE='          *KGPRA* MNOTE           00194900
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00195000
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00195100
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00195200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00195300
.ZE25R               ANOP  ,                                            00195400
.******************************************************************     00195500
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00195600
.******************************************************************     00195700
                     ACTR  10000                                        00195800
.*----------------------------------------------------------------***   00195900
.***AF.P02 EXTRA POSITIONALS                                            00196000
                     AIF   (N'&SYSLIST LE 0).ZELISTX  NO EXTRAS         00196100
&ZCVAL               SETC  ''          ERROR FIELD                      00196200
&ZAWRK               SETA  0           POSITIONAL NUMBER                00196300
.ZELIST2             ANOP  ,                                            00196400
&ZAWRK               SETA  &ZAWRK+1    NEXT POSITIONAL                  00196500
                     AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE         00196600
&ZCVAL               SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA              00196700
                     AGO   .ZELIST2                                     00196800
.*                                                                      00196900
.ZELIST3             ANOP  ,                                            00197000
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA           00197100
&ZMS                 SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE     00197200
&ZMS                 SETC  '&ZMS "&ZCVAL"'                              00197300
&ZMS                 SETC  '&ZMS CANNOT BE USED.'                       00197400
&ZMS                 SETC  '&ZMS NO POSITIONAL ARGUMENTS'               00197500
                     MNOTE 8,' &ZMS ARE ALLOWED.'                       00197600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00197700
.ZELISTX             ANOP  ,                                            00197800
&ZASYSLNDX           SETA  0                                            00197900
.*-------------------------------------------------------------------   00198000
.***AE.MF02 MF=(SLME)                                                   00198100
.ZEMFX               ANOP  ,           END OF PARTIAL SYNTAX CHECK      00198200
.*******************************************************************    00198300
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00198400
.*******************************************************************    00198500
                     AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED         00198600
.*******************************************************************    00198700
.***AE.01  START OF IXGQUERY MACRO CODE                                 00198800
.*******************************************************************    00198900
                     LCLC  &M0M0001                 NAME                00199000
&M0M0001             SETC  '&XLABEL'                SET NAME            00199100
                     AIF   (K'&XLABEL NE 0).XLAB2                       00199200
&M0M0001             SETC  'M00M&SYSNDX'            DEFAULT NAME        00199300
.*                                                                      00199400
.XLAB2               ANOP  ,                                            00199500
                     AIF   ('&XMF' EQ 'L').XLAB3                        00199600
&M0M0001 DS    0H                             IXGQUERY-1                00199700
.XLAB3               ANOP  ,                                            00199800
.*******************************************************************    00199900
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00200000
.*******************************************************************    00200100
              PUSH  PRINT                                               00200200
                     AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON   00200300
                     PRINT OFF         ++ PR01                          00200400
                     AGO   .ZPRNTXX                                     00200500
.ZPRINTX             PRINT ON                                           00200600
.ZPRNTXX             ANOP  ,                                            00200700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00200800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00200900
.********************************************************************   00201000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00201100
.********************************************************************   00201200
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00201300
                      LCLA  &ZOPN1         INVOCATION INDEX             00201400
                      LCLC  &ZOPL(4095)    LABEL                        00201500
                      LCLC  &ZOPO(4095)    OPERATION                    00201600
                      LCLC  &ZOPV(4095)    VALUE                        00201700
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00201800
.*                                                                      00201900
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00202000
.******************************************************************     00202100
.***AL.L10 IXGQUERY FMT=LIST MF=S|L PARAMETERS                          00202200
.******************************************************************     00202300
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00202400
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00202500
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00202600
&XMFATTR              SETC  '0D'                                        00202700
.*                                                                      00202800
&ZOPN                 SETA  &ZOPN+1                                     00202900
&ZOPL(&ZOPN)          SETC  ' '                                         00203000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00203100
&ZOPO(&ZOPN)          SETC  'B'                                         00203200
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00203300
                      AGO   .ZALVL6B                                    00203400
.ZALVL6A              ANOP                                              00203500
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00203600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00203700
.ZALVL6B              ANOP                                              00203800
&ZOPD(&ZOPN)          SETC  '++ IXGQUERY ARG PARMS'                     00203900
.*                                                                      00204000
&ZOPN                 SETA  &ZOPN+1                                     00204100
&ZOPL(&ZOPN)          SETC  ' '                                         00204200
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00204300
&ZOPV(&ZOPN)          SETC  '1'                                         00204400
&ZOPD(&ZOPN)          SETC  ' '                                         00204500
.*                                                                      00204600
.ZLMFSL2              ANOP  ,                                           00204700
.*-------------------------------------------------------------------   00204800
.***AM.L00  IXGQUERY FMT=LIST name                                      00204900
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00205000
&ZOPN                 SETA &ZOPN+1                                      00205100
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00205200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00205300
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00205400
&ZOPD(&ZOPN)          SETC '++ IXGQUERY NAME'                           00205500
.ZLMFSL2M             ANOP  ,                                           00205600
.*-------------------------------------------------------------------   00205700
.***AM.L01  IXGQUERY FMT=LIST PARAMETERS                                00205800
&ZOPN                 SETA &ZOPN+1                                      00205900
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00206000
&ZOPO(&ZOPN)          SETC 'DS'                                         00206100
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00206200
&ZOPD(&ZOPN)          SETC '++ IXGQUERY PARM LIST'                      00206300
.*-------------------------------------------------------------------   00206400
.***AM.L02 XVERSION XL1                                                 00206500
&ZOPN                 SETA &ZOPN+1                                      00206600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00206700
&ZOPO(&ZOPN)          SETC 'DS'                                         00206800
&ZOPV(&ZOPN)          SETC 'XL1'                                        00206900
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00207000
.*-------------------------------------------------------------------   00207100
.***AM.L03 XIXGFLAGS BL.8                                               00207200
&ZOPN                 SETA &ZOPN+1                                      00207300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XIXGFLAGS'                        00207400
&ZOPO(&ZOPN)          SETC 'DS'                                         00207500
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00207600
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00207700
.*                                                                      00207800
&ZOPN                 SETA  &ZOPN+1                                     00207900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCHECKCONNSTATUS_YES'            00208000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00208100
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00208200
&ZOPD(&ZOPN)          SETC  '++ XCHECKCONNSTATUS.'                      00208300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00208400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00208500
.*-------------------------------------------------------------------   00208600
.***AM.L09  XRSV0001 CL2                                                00208700
&ZOPN                 SETA &ZOPN+1                                      00208800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00208900
&ZOPO(&ZOPN)          SETC 'DS'                                         00209000
&ZOPV(&ZOPN)          SETC 'CL2'                                        00209100
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      00209200
.*-------------------------------------------------------------------   00209300
.***AM.L09  XPLISTPTR F                                                 00209400
&ZOPN                 SETA &ZOPN+1                                      00209500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTPTR'                        00209600
&ZOPO(&ZOPN)          SETC 'DS'                                         00209700
&ZOPV(&ZOPN)          SETC 'A'                                          00209800
&ZOPD(&ZOPN)          SETC '++ INPUT  XPLISTPTR'                        00209900
.*-------------------------------------------------------------------   00210000
.***AM.L09 ADDR XBUFFER A                                               00210100
&ZOPN                 SETA &ZOPN+1                                      00210200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER_ADDR'                     00210300
&ZOPO(&ZOPN)          SETC 'DS'                                         00210400
&ZOPV(&ZOPN)          SETC 'A'                                          00210500
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFER ADDR XBUFFER'                  00210600
.*-------------------------------------------------------------------   00210700
.***AM.L09  XBUFFLEN F                                                  00210800
&ZOPN                 SETA &ZOPN+1                                      00210900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFLEN'                         00211000
&ZOPO(&ZOPN)          SETC 'DS'                                         00211100
&ZOPV(&ZOPN)          SETC 'F'                                          00211200
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFLEN  XBUFFLEN'                    00211300
.*-------------------------------------------------------------------   00211400
.***AM.L09  XANSAREA A                                                  00211500
&ZOPN                 SETA &ZOPN+1                                      00211600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA'                         00211700
&ZOPO(&ZOPN)          SETC 'DS'                                         00211800
&ZOPV(&ZOPN)          SETC 'A'                                          00211900
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA  XANSAREA'                    00212000
.*-------------------------------------------------------------------   00212100
.***AM.L09  XANSLEN F                                                   00212200
&ZOPN                 SETA &ZOPN+1                                      00212300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSLEN'                          00212400
&ZOPO(&ZOPN)          SETC 'DS'                                         00212500
&ZOPV(&ZOPN)          SETC 'F'                                          00212600
&ZOPD(&ZOPN)          SETC '++ &ZXANSLEN  XANSLEN'                      00212700
.*-------------------------------------------------------------------   00212800
.***AM.L09  XSTREAMTOKEN CL16                                           00212900
&ZOPN                 SETA &ZOPN+1                                      00213000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTREAMTOKEN'                     00213100
&ZOPO(&ZOPN)          SETC 'DS'                                         00213200
&ZOPV(&ZOPN)          SETC 'CL16'                                       00213300
&ZOPD(&ZOPN)          SETC '++ &ZXSTREAMTOKEN  XSTREAMTOKEN'            00213400
.*-------------------------------------------------------------------   00213500
.***AM.L10 END OF IXGQUERY LIST PARAMETERS                              00213600
&ZOPN                 SETA &ZOPN+1                                      00213700
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00213800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00213900
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00214000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00214100
.*                                                                      00214200
&ZOPN                 SETA &ZOPN+1                                      00214300
&ZOPL(&ZOPN)          SETC ' '                                          00214400
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00214500
&ZOPV(&ZOPN)          SETC '1'                                          00214600
&ZOPD(&ZOPN)          SETC ' '                                          00214700
.*-------------------------------------------------------------------   00214800
.***AL.L12 IXGQUERY FMT=LIST MF=S|L PARAMETERS                          00214900
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00215000
.*                                                                      00215100
&ZOPN                 SETA  &ZOPN+1                                     00215200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00215300
&ZOPO(&ZOPN)          SETC  'DC'                                        00215400
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00215500
&ZOPD(&ZOPN)          SETC  '++ IXGQUERY ARG PARMS'                     00215600
.*                                                                      00215700
.ZLMFSLX              ANOP  ,                                           00215800
.*-------------------------------------------------------------------   00215900
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00216000
&ZPLLEN               SETA 40                                           00216100
.*                                                                      00216200
.******************************************************************     00216300
.***AI.L01 IXGQUERY FMT=LIST FILL IN PARAMETER AREA                     00216400
.******************************************************************     00216500
                      ACTR  10000                                       00216600
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00216700
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00216800
&ZCVAL                SETC  'LAE'          XAX MODE                     00216900
.ZIMFXA               ANOP ,                                            00217000
.*                                                                      00217100
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00217200
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00217300
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00217400
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00217500
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00217600
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00217700
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00217800
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00217900
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00218000
&ZOPN                 SETA  &ZOPN+1                                     00218100
&ZOPL(&ZOPN)          SETC  ' '                                         00218200
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00218300
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00218400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00218500
                      AGO   .ZIMFNX                                     00218600
.*                                                                      00218700
.ZIMFN2               ANOP ,                                            00218800
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00218900
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00219000
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00219100
&ZOPN                 SETA  &ZOPN+1                                     00219200
&ZOPL(&ZOPN)          SETC  ' '                                         00219300
&ZOPO(&ZOPN)          SETC  'LAE'                                       00219400
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00219500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00219600
                      AGO   .ZIMFNX                                     00219700
.ZIMFNX1              ANOP ,                                            00219800
&ZOPN                 SETA  &ZOPN+1                                     00219900
&ZOPL(&ZOPN)          SETC  ' '                                         00220000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00220100
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00220200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00220300
.ZIMFNX               ANOP ,                                            00220400
.********************************************************************   00220500
.***AI.L02 IXGQUERY FMT=LIST INITIALIZE PARAMETER AREA                  00220600
.********************************************************************   00220700
.***AI.L03 MF=(SLME)                                                    00220800
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00220900
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00221000
.*                                                                      00221100
&ZOPN                 SETA  &ZOPN+1                                     00221200
&ZOPL(&ZOPN)          SETC  ' '                                         00221300
&ZOPO(&ZOPN)          SETC  'XC'                                        00221400
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00221500
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00221600
.ZIMFLX               ANOP  ,                                           00221700
.*-------------------------------------------------------------------   00221800
.***AI.L04B XVERSION XL1                                                00221900
                      AIF   (&XPLISTVER EQ 0).ZIMFVX                    00222000
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVY            00222100
.ZIMFVX               ANOP  ,                                           00222200
                      AIF   ('&PLISTVER' EQ '').ZIMFVZ                  00222300
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVZ            00222400
.ZIMFVY               ANOP  ,                                           00222500
&ZOPN                 SETA  &ZOPN+1                                     00222600
&ZOPL(&ZOPN)          SETC  ' '                                         00222700
&ZOPO(&ZOPN)          SETC  'MVI'                                       00222800
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00222900
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00223000
.ZIMFVZ               ANOP  ,                                           00223100
.*-------------------------------------------------------------------   00223200
.***AI.L05 XIXGFLAGS BL1                                                00223300
&ZW                   SETC  ''                                          00223400
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00223500
&ZMS                  SETC  ''                                          00223600
&ZC                   SETC  ''                                          00223700
.*-------------------------------------------------------------------   00223800
.***AI.L08 XIXGFLAGS "YES"                                              00223900
.***      BL1'1XXXXXXX'                                                 00224000
         AIF   ('&XCHECKCONNSTATUS' NE 'YES').ZI3A                      00224100
&ZW                   SETC  '&ZW.10000000'                              00224200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00224300
&ZMS                  SETC  '&ZMS.11111111'                             00224400
                      AGO   .ZI3C                                       00224500
.*                                                                      00224600
.ZI3A                 ANOP  ,                                           00224700
&ZW                   SETC  '&ZW.00000000'                              00224800
         AIF   ('&ZXCHECKCONNSTATUS' EQ '').ZI3B                        00224900
&ZMS                  SETC  '&ZMS.01111111'                             00225000
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00225100
                      AGO   .ZI3C                                       00225200
.*                                                                      00225300
.ZI3B                 ANOP  ,                                           00225400
&ZMS                  SETC  '&ZMS.11111111'                             00225500
.ZI3C                 ANOP  ,                                           00225600
.*-------------------------------------------------------------------   00225700
.***AI.L11 XIXGFLAGS BL1                                                00225800
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI3D               00225900
                      AIF   ('&ZC' NE 'YES').ZI3D                       00226000
&ZOPN                 SETA  &ZOPN+1                                     00226100
&ZOPL(&ZOPN)          SETC  ' '                                         00226200
&ZOPO(&ZOPN)          SETC  'NI'                                        00226300
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZMS'''                            00226400
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00226500
.ZI3D                 ANOP  ,                                           00226600
                      AIF   ('&ZCLNG' NE 'YES').ZI3E  ALL ZERO BITS     00226700
&ZOPN                 SETA  &ZOPN+1                                     00226800
&ZOPL(&ZOPN)          SETC  ' '                                         00226900
&ZOPO(&ZOPN)          SETC  'OI'                                        00227000
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00227100
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00227200
.ZI3E                 ANOP  ,                                           00227300
.*-------------------------------------------------------------------   00227400
.***AI.L19 ADDR XBUFFER A                                               00227500
                      AIF   ('&ZXBUFFER' EQ '').ZI6H                    00227600
&ZCLNG                SETC  '&XBUFFER'                                  00227700
&ZCGPR                SETC  '14'                                        00227800
         AIF   ('&XBUFFER'(1,1) EQ '(').ZI6F  IN GPR                    00227900
.*                                                                      00228000
&ZOPN                 SETA  &ZOPN+1                                     00228100
&ZOPL(&ZOPN)          SETC  ' '                                         00228200
&ZOPO(&ZOPN)          SETC  'LA'                                        00228300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00228400
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00228500
.*                                                                      00228600
                      AGO   .ZI6G                                       00228700
.*                                                                      00228800
.ZI6F                 ANOP  ,                                           00228900
&ZCGPR   SETC  '&XBUFFER'(2,K'&XBUFFER-2)                               00229000
.*                                                                      00229100
.ZI6G                 ANOP  ,                                           00229200
.*                                                                      00229300
&ZOPN                 SETA  &ZOPN+1                                     00229400
&ZOPL(&ZOPN)          SETC  ' '                                         00229500
&ZOPO(&ZOPN)          SETC  'ST'                                        00229600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              00229700
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00229800
.*                                                                      00229900
.ZI6H                 ANOP  ,                                           00230000
.*-------------------------------------------------------------------   00230100
.***AI.L25  XBUFFLEN F                                                  00230200
                      AIF   ('&ZXBUFFLEN' EQ '').ZI7E                   00230300
                      AIF   ('&ZXBUFFLEN' EQ 'OUTPUT').ZI7E             00230400
&ZCGPR                SETC  '&XBUFFLEN'                                 00230500
.*                                                                      00230600
                      AIF   ('&XBUFFLEN'(1,1) NE '(').ZI7B              00230700
&ZCGPR   SETC  '0('.'&XBUFFLEN'(2,K'&XBUFFLEN-2).')'                    00230800
                      AGO   .ZI7D                                       00230900
.ZI7B                 ANOP  ,                                           00231000
.*                                                                      00231100
&ZC                   SETC  '&XBUFFLEN'(1,1)                            00231200
                      AIF   (T'&ZC NE 'N').ZI7D                         00231300
&ZC                   SETC  '&XBUFFLEN'                                 00231400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI7D                00231500
&ZCGPR                SETC  '=AL4(&XBUFFLEN)'                           00231600
.*                                                                      00231700
.ZI7D                 ANOP  ,                                           00231800
.*                                                                      00231900
&ZOPN                 SETA  &ZOPN+1                                     00232000
&ZOPL(&ZOPN)          SETC  ' '                                         00232100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00232200
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            00232300
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFLEN XBUFFLEN'                    00232400
.*                                                                      00232500
.ZI7E                 ANOP  ,                                           00232600
.*-------------------------------------------------------------------   00232700
.***AI.L19  XANSAREA A                                                  00232800
                      AIF   ('&ZXANSAREA' EQ '').ZI8H                   00232900
&ZCLNG                SETC  '&XANSAREA'                                 00233000
&ZCGPR                SETC  '14'                                        00233100
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI8F  IN GPR                   00233200
.*                                                                      00233300
&ZOPN                 SETA  &ZOPN+1                                     00233400
&ZOPL(&ZOPN)          SETC  ' '                                         00233500
&ZOPO(&ZOPN)          SETC  'LA'                                        00233600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00233700
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00233800
.*                                                                      00233900
                      AGO   .ZI8G                                       00234000
.*                                                                      00234100
.ZI8F                 ANOP  ,                                           00234200
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             00234300
.*                                                                      00234400
.ZI8G                 ANOP  ,                                           00234500
.*                                                                      00234600
&ZOPN                 SETA  &ZOPN+1                                     00234700
&ZOPL(&ZOPN)          SETC  ' '                                         00234800
&ZOPO(&ZOPN)          SETC  'ST'                                        00234900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             00235000
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00235100
.*                                                                      00235200
.ZI8H                 ANOP  ,                                           00235300
.*-------------------------------------------------------------------   00235400
.***AI.L25  XANSLEN F                                                   00235500
                      AIF   ('&ZXANSLEN' EQ '').ZI9E                    00235600
                      AIF   ('&ZXANSLEN' EQ 'OUTPUT').ZI9E              00235700
&ZCGPR                SETC  '&XANSLEN'                                  00235800
.*                                                                      00235900
                      AIF   ('&XANSLEN'(1,1) NE '(').ZI9B               00236000
&ZCGPR   SETC  '0('.'&XANSLEN'(2,K'&XANSLEN-2).')'                      00236100
                      AGO   .ZI9D                                       00236200
.ZI9B                 ANOP  ,                                           00236300
.*                                                                      00236400
&ZC                   SETC  '&XANSLEN'(1,1)                             00236500
                      AIF   (T'&ZC NE 'N').ZI9D                         00236600
&ZC                   SETC  '&XANSLEN'                                  00236700
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI9D                00236800
&ZCGPR                SETC  '=AL4(&XANSLEN)'                            00236900
.*                                                                      00237000
.ZI9D                 ANOP  ,                                           00237100
.*                                                                      00237200
&ZOPN                 SETA  &ZOPN+1                                     00237300
&ZOPL(&ZOPN)          SETC  ' '                                         00237400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00237500
&ZOPV(&ZOPN)          SETC  '20(4,1),&ZCGPR'                            00237600
&ZOPD(&ZOPN)          SETC  '++ &ZXANSLEN XANSLEN'                      00237700
.*                                                                      00237800
.ZI9E                 ANOP  ,                                           00237900
.*-------------------------------------------------------------------   00238000
.***AI.L25  XSTREAMTOKEN CL16                                           00238100
                      AIF   ('&ZXSTREAMTOKEN' EQ '').ZI10E              00238200
                      AIF   ('&ZXSTREAMTOKEN' EQ 'OUTPUT').ZI10E        00238300
&ZCGPR                SETC  '&XSTREAMTOKEN'                             00238400
.*                                                                      00238500
                      AIF   ('&XSTREAMTOKEN'(1,1) NE '(').ZI10B         00238600
&ZCGPR   SETC  '0('.'&XSTREAMTOKEN'(2,K'&XSTREAMTOKEN-2).')'            00238700
.ZI10B                ANOP  ,                                           00238800
.*                                                                      00238900
&ZOPN                 SETA  &ZOPN+1                                     00239000
&ZOPL(&ZOPN)          SETC  ' '                                         00239100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00239200
&ZOPV(&ZOPN)          SETC  '24(16,1),&ZCGPR'                           00239300
&ZOPD(&ZOPN)          SETC  '++ &ZXSTREAMTOKEN XSTREAMTOKEN'            00239400
.*                                                                      00239500
.ZI10E                ANOP  ,                                           00239600
.*-------------------------------------------------------------------   00239700
.***AI.C01 RESTORE ADDR OF PARM LIST PTR                                00239800
.*                                                                      00239900
&ZOPN                 SETA  &ZOPN+1                                     00240000
&ZOPL(&ZOPN)          SETC  ' '                                         00240100
&ZOPO(&ZOPN)          SETC  'ST'                                        00240200
&ZOPV(&ZOPN)          SETC  '1,4(,1)'                                   00240300
&ZOPD(&ZOPN)          SETC  '++ STORE ADDR OF PARM LIST'                00240400
.*                                                                      00240500
&ZOPN                 SETA  &ZOPN+1                                     00240600
&ZOPL(&ZOPN)          SETC  ' '                                         00240700
&ZOPO(&ZOPN)          SETC  'LA'                                        00240800
&ZOPV(&ZOPN)          SETC  '1,4(,1)'                                   00240900
&ZOPD(&ZOPN)          SETC  '++ LOAD ADDR OF PARM LIST PTR INTO R1'     00241000
.*-------------------------------------------------------------------   00241100
&ZOPN1                SETA &ZOPN                                        00241200
.*-------------------------------------------------------------------   00241300
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00241400
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00241500
.*******************************************************************    00241600
.***  PROCESS IXGQUERY OUTPUT PARAMETERS                                00241700
.*******************************************************************    00241800
                      ACTR  10000                                       00241900
.*******************************************************************    00242000
.***AO.X02  RETURN CODE PROCESSING                                      00242100
.*******************************************************************    00242200
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00242300
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00242400
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00242500
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00242600
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00242700
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00242800
&ZOPN                 SETA  &ZOPN+1                                     00242900
&ZOPL(&ZOPN)          SETC  ' '                                         00243000
&ZOPO(&ZOPN)          SETC  'ST'                                        00243100
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00243200
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00243300
                      AGO   .ZMRETX                                     00243400
.*                                                                      00243500
.ZMRET2               ANOP  ,                                           00243600
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00243700
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00243800
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00243900
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00244000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00244100
&ZOPN                 SETA  &ZOPN+1                                     00244200
&ZOPL(&ZOPN)          SETC  ' '                                         00244300
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00244400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00244500
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00244600
.ZMRETX               ANOP  ,                                           00244700
.*******************************************************************    00244800
.***AO.X03  REASON CODE PROCESSING                                      00244900
.*******************************************************************    00245000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00245100
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00245200
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00245300
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00245400
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00245500
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00245600
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00245700
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00245800
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00245900
&ZOPN                 SETA  &ZOPN+1                                     00246000
&ZOPL(&ZOPN)          SETC  ' '                                         00246100
&ZOPO(&ZOPN)          SETC  'ST'                                        00246200
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00246300
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00246400
                      AGO   .ZMRSNX                                     00246500
.*                                                                      00246600
.ZMRSN2               ANOP  ,                                           00246700
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00246800
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00246900
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00247000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00247100
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00247200
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00247300
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00247400
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00247500
&ZOPN                 SETA  &ZOPN+1                                     00247600
&ZOPL(&ZOPN)          SETC  ' '                                         00247700
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00247800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00247900
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00248000
.ZMRSNX               ANOP  ,                                           00248100
.*******************************************************************    00248200
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00248300
.*******************************************************************    00248400
.ZMFLX                ANOP  ,              MF=L PROCESSING              00248500
.*******************************************************************    00248600
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00248700
.*******************************************************************    00248800
                      ACTR  10000                                       00248900
.*                                                                      00249000
                      LCLA  &ZLC           COLUMN POSITION              00249100
                      LCLA  &ZOPX          LIST TABLE INDEX             00249200
                      LCLC  &ZLL           LABEL                        00249300
                      LCLC  &ZLOP          OPERATION                    00249400
                      LCLC  &ZLV           VALUE                        00249500
                      LCLC  &ZLD           DESCRIPTION                  00249600
.*                                                                      00249700
&ZOPX                 SETA  1                                           00249800
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00249900
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00250000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00250100
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00250200
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00250300
                      AIF   (K'&ZLD LE 0).ZL5                           00250400
&ZLC                  SETA  35             COMMENT COLUMN               00250500
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00250600
&ZLC                  SETA  33             COMMMENT COLUMN              00250700
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00250800
&ZLV                  SETC  '&ZLV'.' '                                  00250900
                      AGO   .ZL3                                        00251000
.*                                                                      00251100
.ZL4                  ANOP  ,                                           00251200
&ZLV                  SETC  '&ZLV'.' '                                  00251300
.ZL5                  ANOP  ,                                           00251400
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00251500
.*                                                                      00251600
&ZLL     &ZLOP &ZLV                                                     00251700
.*                                                                      00251800
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00251900
                      AGO   .ZL2           CONTINUE LOOPING             00252000
.*                                                                      00252100
.ZLX                  ANOP  ,                                           00252200
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00252300
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00252400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00252500
         L     15,16(0,0)           GET CVT ADDRESS                     00252600
         L     15,140(15,0)         GET ECVT ADDRESS                    00252700
         L     15,288(15,0)         GET LSAB ADDRESS                    00252800
         L     15,124(15,0)         GET ENTRY POINT ADDRESS             00252900
         LA    0,12                 EX OF QUERY SERVICE                 00253000
         BALR  14,15                INVOKE SERVICE ROUTINE              00253100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00253200
.ZLINKX               ANOP  ,                                           00253300
.*******************************************************************    00253400
.***AP.X01  FORMAT GENERATED CODE                                       00253500
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00253600
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00253700
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00253800
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00253900
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00254000
                      AIF   (K'&ZLD LE 0).ZL51                          00254100
&ZLC                  SETA  35             COMMENT COLUMN               00254200
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00254300
&ZLC                  SETA  33             COMMENT COLUMN               00254400
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00254500
&ZLV                  SETC  '&ZLV'.' '                                  00254600
                      AGO   .ZL31                                       00254700
.*                                                                      00254800
.ZL41                 ANOP  ,                                           00254900
&ZLV                  SETC  '&ZLV'.' '                                  00255000
.ZL51                 ANOP  ,                                           00255100
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00255200
.*                                                                      00255300
&ZLL     &ZLOP &ZLV                                                     00255400
.*                                                                      00255500
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00255600
                      AGO   .ZL21          CONTINUE LOOPING             00255700
.*                                                                      00255800
.ZLX1                 ANOP  ,                                           00255900
.*******************************************************************    00256000
.***AP.X02  END OF IXGQUERY MACRO                                       00256100
&ZIXGQUERY            SETC  'YES'          SET IXGQUERY USED            00256200
         POP   PRINT                                                    00256300
*                                            IXGQUERY-1                 00256400
         SPACE 1                                                        00256500
.ZLX2                 ANOP  ,                                           00256600
         MEND                                                           00256700
**********************************************************************/ 00256800
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00256900
*%IXGQUERY: MACRO KEYS(STREAMTOKEN,CHECKCONNSTATUS,BUFFER,BUFFLEN,      00257000
*                 ANSAREA,ANSLEN,RETCODE,RSNCODE,PLISTVER,MF);          00257100
*  ANS('?'||MACLABEL||' '||'IXGQUERP '||MACLIST||                       00257200
*         ' '||MACKEYS||';') COL(MACLMAR);                              00257300
*%END IXGQUERY;                                                         00257400
