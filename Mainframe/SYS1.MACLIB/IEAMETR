*/**** START OF SPECIFICATIONS **************************************** 00050000
*                                                                     * 00100000
*                                                                     * 00150000
*01* MACRO NAME:  IEAMETR                               -09/10/99-<0> * 00200000
*                                                                     * 00250000
*                                                                     * 00300000
*01* DESCRIPTIVE NAME:  ETR Status Information Service                * 00350000
*                                                                     * 00400000
*01* PROPRIETARY STATEMENT:                                           * 00450000
*                                                                     * 00500000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00550000
*     5655-068 (C) COPYRIGHT IBM CORP. 1993                           * 00650000
*                                                                     * 00700000
* STATUS= HBB5510                                                     * 00750000
*                                                                     * 00800000
*                                                                     * 00850000
*                                                                     * 00900000
*01* FUNCTION:                                                        * 00950000
*                                                                     * 01000000
*                                                                     * 01050000
*      The IEAMETR macro obtains ETR status and connection            * 01100000
*      information for the current MVS image.  This information is to * 01150000
*      the users output area specified by the OUTAREA keyword.  These * 01200000
*      6 words are mapped by the IHAETRI mapping macro.               * 01250000
*                                                                     * 01300000
*      REGISTER INFORMATION:                                          * 01350000
*                                                                     * 01400000
*                                                                     * 01450000
*      o   Registers on Entry:                                        * 01500000
*                                                                     * 01550000
*                                                                     * 01600000
*          -   General Purpose Registers                              * 01650000
*                                                                     * 01700000
*                                                                     * 01750000
*              Reg  0-15   Irrelevant                                 * 01800000
*                                                                     * 01850000
*                                                                     * 01900000
*                                                                     * 01950000
*          -   Access Registers                                       * 02000000
*                                                                     * 02050000
*                                                                     * 02100000
*              Reg  0-15   Irrelevant                                 * 02150000
*                                                                     * 02200000
*                                                                     * 02250000
*                                                                     * 02300000
*                                                                     * 02350000
*                                                                     * 02400000
*      o   Registers on Return:                                       * 02450000
*                                                                     * 02500000
*                                                                     * 02550000
*          -   General Purpose Registers                              * 02600000
*                                                                     * 02650000
*                                                                     * 02700000
*              Reg  0-1    Unpredictable                              * 02750000
*                                                                     * 02800000
*              Reg  2-13   Preserved                                  * 02850000
*                                                                     * 02900000
*              Reg 14      Unpredictable                              * 02950000
*                                                                     * 03000000
*              Reg 15      Return code                                * 03050000
*                                                                     * 03100000
*                                                                     * 03150000
*                                                                     * 03200000
*          -   Access Registers                                       * 03250000
*                                                                     * 03300000
*                                                                     * 03350000
*              Reg  0-1    Unpredictable                              * 03400000
*                                                                     * 03450000
*              Reg  2-13   Preserved                                  * 03500000
*                                                                     * 03550000
*              Reg  14-15  Unpredictable                              * 03600000
*                                                                     * 03650000
*                                                                     * 03700000
*                                                                     * 03750000
*                                                                     * 03800000
*                                                                     * 03850000
*                                                                     * 03900000
*                                                                     * 03950000
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 04000000
*                                                                     * 04050000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 04100000
*                                                                     * 04150000
*01* ENVIRONMENT:                                                     * 04200000
*                                                                     * 04250000
*                                                                     * 04300000
*      Dispatchable unit mode: Either Task, SRB, or DIE mode.         * 04350000
*                                                                     * 04400000
*      Minimum authorization: Any state or key.                       * 04450000
*                                                                     * 04500000
*      AMODE:            31-bit.                                      * 04550000
*                                                                     * 04600000
*      ASC mode:         Primary or Access Register.                  * 04650000
*                                                                     * 04700000
*      Serialization:                                                 * 04750000
*                                                                     * 04800000
*                                                                     * 04850000
*                        o   Any lock may be held.                    * 04900000
*                                                                     * 04950000
*                        o   Enabled or Disabled for I/O and external * 05000000
*                            interrupts.                              * 05050000
*                                                                     * 05100000
*                        o   Control parameters must be in the        * 05150000
*                            primary address space.                   * 05200000
*                                                                     * 05250000
*                        o   HASN = PASN = SASN or HASN ^= PASN ^=    * 05300000
*                            SASN.                                    * 05350000
*                                                                     * 05400000
*                                                                     * 05450000
*                                                                     * 05500000
*      Restrictions:                                                  * 05550000
*                                                                     * 05600000
*                                                                     * 05650000
*                                                                     * 05700000
*01* SYNTAX:                                                          * 05750000
*                                                                     * 05800000
*[xlabel]  IEAMETR     OUTADDR=xoutaddr                               * 05850000
*                   [,MF=S]                                          * 05900000
*                   [,MF=(L,xmfctrl,xmfattr|0D)]                   * 05950000
*                   [,MF=(E,xmfctrl,COMPLETE)]                     * 06000000
*                                                                     * 06050000
*                                                                     * 06100000
*      Where:                                                         * 06150000
*                                                                     * 06200000
*                                                                     * 06250000
*      [xlabel]                                                       * 06300000
*          is an optional symbol, starting in column 1, that is the   * 06350000
*          name on the IEAMETR macro invocation.  The name must       * 06400000
*          conform to the rules for an ordinary assembler language    * 06450000
*          symbol.                                                    * 06500000
*          DEFAULT: No name.                                          * 06550000
*                                                                     * 06600000
*                                                                     * 06650000
*                                                                     * 06700000
*                                                                     * 06750000
*      OUTADDR=xoutaddr                                               * 06800000
*          is the name (RS-type), or address in register (2)-(12), of * 06850000
*          a required 4 byte input that contains the address of the   * 06900000
*          24 byte output area to receive the ouptut.                 * 06950000
*                                                                     * 07000000
*                                                                     * 07050000
*                                                                     * 07100000
*                                                                     * 07150000
*      [MF=S|L|E]                                                   * 07200000
*          is an optional keyword input which specifies the macro     * 07250000
*          form.                                                      * 07300000
*          DEFAULT: S                                                 * 07350000
*                                                                     * 07400000
*                                                                     * 07450000
*          [MF=S]                                                     * 07500000
*              specifies the standard form of the macro.  The "S"     * 07550000
*              form generates code to put the parameters into an      * 07600000
*              in-line parameter list and invoke the desired service. * 07650000
*              Full checking for required macro keys is done along    * 07700000
*              with supplying defaults for omitted optional           * 07750000
*              parameters.                                            * 07800000
*                                                                     * 07850000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 07900000
*              specifies the list form of the macro.  The "L" form    * 07950000
*              defines an area to be used for the parameter list.     * 08000000
*              Any other macro parameters are flagged as errors.      * 08050000
*                                                                     * 08100000
*            ,xmfctrl                                                 * 08150000
*              is a required input.  It is the name of a storage area * 08200000
*              for the parameter list.                                * 08250000
*                                                                     * 08300000
*            ,xmfattr|0D                                            * 08350000
*              is an optional 60 character input string that varies   * 08400000
*              from 1 to 60 characters. Use it to force boundary      * 08450000
*              alignment of the parameter list. Use only 0F or 0D.    * 08500000
*              DEFAULT: 0D which forces the parameter list to a       * 08650000
*              doubleword boundary.                                   * 08700000
*                                                                     * 08750000
*          [MF=(E,xmfctrl,COMPLETE)]                                * 08800000
*              specifies the execute form of the macro.  The "E" form * 08850000
*              generates code to put the parameters into the          * 08900000
*              parameter list specified by xmfctrl and provides full  * 08950000
*              syntax checking with default setting.                  * 09000000
*                                                                     * 09050000
*            ,xmfctrl                                                 * 09100000
*              is a required input.  It is the name (RS-type), or     * 09150000
*              address in register (1)-(12), of a storage area for    * 09200000
*              the parameter list.                                    * 09250000
*                                                                     * 09300000
*            ,COMPLETE                                              * 09350000
*              is an optional keyword input which specifies the       * 09400000
*              degree of macro parameter syntax checking.             * 09450000
*              DEFAULT: COMPLETE                                      * 09500000
*                                                                     * 09550000
*                                                                     * 09600000
*              COMPLETE                                               * 09650000
*                  Checking for required macro keys is done and       * 09700000
*                  defaults are supplied for omitted optional         * 09750000
*                  parameters.                                        * 09800000
*                                                                     * 09850000
*                                                                     * 09900000
*                                                                     * 09950000
*                                                                     * 10000000
*                                                                     * 10050000
*                                                                     * 10100000
*                                                                     * 10150000
*01* RETURN CODES:                                                    * 10200000
*                                                                     * 10250000
*                                                                     * 10300000
*       00        ETR status and port data was successfully obtained. * 10350000
*                                                                     * 10400000
*       04        ETR status information is available, but port data  * 10450000
*                 is not.                                             * 10500000
*                                                                     * 10550000
*       08        No status or port data is available.                * 10600000
*                                                                     * 10650000
*       0C        The parameter list is not in the user's primary     * 10700000
*                 address space.                                      * 10750000
*                                                                     * 10800000
*                                                                     * 10850000
*                                                                     * 10900000
*01* REASON CODES:  None.                                             * 10950000
*                                                                     * 11000000
*01* MODULE TYPE:  ASSEM MACRO                                        * 11050000
*                                                                     * 11100000
*02*   PROCESSOR:  ASSEM                                              * 11150000
*                                                                     * 11200000
*01* COMPONENT:  SC1CV                                                * 11250000
*                                                                     * 11300000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 11350000
*                                                                     * 11400000
*01* EXAMPLES:                                                        * 11450000
*    EXAMPLE 1                                                        * 11500000
*                                                                     * 11550000
*    OPERATION:  Obtain ETR status information and return             * 11600000
*    it to the address specified by the OUTADDR keyword.  These 6 wor * 11650000
*    ds                                                               * 11700000
*    are mapped by IHAETRI.                                           * 11750000
*                                                                     * 11800000
*      *                                                              * 11850000
*      INFO_RTN       EQU      *                                      * 11900000
*                     IEAMETR                                         * 11950000
*          .                                                          * 12000000
*          .                                                          * 12050000
*      *                                                              * 12100000
*                                                                     * 12150000
*                                                                     * 12200000
*01* MACRO USAGE NOTES:                                               * 12250000
*                                                                     * 12300000
*                                                                     * 12350000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 12400000
*        global macro variable.  Any value other than 'NO' will       * 12450000
*        result in the macro expansion being printed.  The default is * 12500000
*        'YES'.  The following examples illustrate how the ZPRINT     * 12550000
*        variable should be set.                                      * 12600000
*                                                                     * 12650000
*                    GBLC &ZPRINT                                     * 12700000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 12750000
*                                                                     * 12800000
*                                                                     * 12850000
*                                                                     * 12900000
*01* CHANGE ACTIVITY:                                                 * 12950000
*                                                                     * 13000000
*   Flag LineItem  FMID    Date   ID    Comment                       * 13050000
*                                                                     * 13100000
*    $L0=ETRI     HBB5510 960806 B7HGH5:  IEAMETR macro               * 13150000
****** END OF SPECIFICATIONS *****************************************/ 13200000
*/* TLINE 1 *********************************************************** 13250000
         MACRO                                                          13300000
&XLABEL  IEAMETR &OUTADDR=,&MF=                                         13350000
.*                                                                      13400000
*              MACDATE -09/10/99-<0>                                    13450000
.*                                                                      13500000
.*******************************************************************    13550000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        13600000
.*******************************************************************    13650000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   13700000
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     13750000
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             13800000
.*                                                                      13850000
              GBLC  &ZIEAMETR   YES=MACRO USED AT LEAST ONCE            13900000
.*******************************************************************    13950000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          14000000
.*******************************************************************    14050000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 14100000
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            14150000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              14200000
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             14250000
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             14300000
              LCLA  &ZAWRK      USED AS A WORK AREA                     14350000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  14400000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   14450000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 14500000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             14550000
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 14600000
              LCLA  &ZMACRET    MACRO RETURN CODE                       14650000
&ZMACRET      SETA  0           ASSUME NO ERRORS                        14700000
.*                                                                      14750000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      14800000
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              14850000
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   14900000
              LCLC  &ZENDBASEPL                 End of base PL          14950000
.********************************************************************   15000000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 15050000
.********************************************************************   15100000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 15150000
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          15200000
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        15225000
.*                                                                      15250000
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       15300000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        15350000
              SPLEVEL  TEST                                             15400000
.ZSYS2        ANOP  ,                                                   15450000
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              15500000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              15550000
              SYSSTATE TEST                                             15600000
              AGO   .ZSYS4                                              15650000
.ZSYS3        ANOP  ,                                                   15700000
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 15750000
.ZSYS4        ANOP  ,                                                   15800000
.*******************************************************************    15850000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   15900000
.*******************************************************************    15950000
              LCLC  &XOUTADDR   ++ NAME                                 16000000
              LCLC  &XMF        ++ VALUE                                16050000
              LCLC  &XMFCTRL    ++ NAME                                 16100000
              LCLC  &XMFATTR    ++ VALUE                                16150000
              LCLC  &XMFSCK     ++ VALUE                                16200000
.*******************************************************************    16250000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           16300000
.*******************************************************************    16350000
              LCLC  &ZXOUTADDR  ++ INPUT NAME                           16400000
              LCLC  &ZXMF       ++ INPUT VALUE                          16450000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           16500000
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          16550000
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          16600000
.********************************************************************   16650000
.***AG.MF01 PROCESS MF MACRO FORMS                                      16700000
.********************************************************************   16750000
              ACTR  10000                                               16800000
.*------------------------------------------------------------------    16850000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           16900000
&XMF          SETC  ''          INITIALIZE XVARIABLE                    16950000
.*-------------------------------------------------------------------   17000000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           17050000
.ZG6          ANOP  ,                                                   17100000
&ZTLC         SETC 'S'                                                  17150000
              AIF   ('&MF(1)' NE '&ZTLC').ZG7                           17200000
&XMF          SETC  'S'         SET KEYWORD                             17250000
              AIF   (N'&MF LE 1).ZG6A           CK NUM                  17300000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           17350000
&ZMS          SETC  '&ZMS.&MF"'                                         17400000
&ZMS          SETC  '&ZMS "MF"'                                         17450000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 17500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             17550000
.ZG6A         ANOP  ,                                                   17600000
.*-------------------------------------------------------------------   17650000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           17700000
.ZG7          ANOP  ,                                                   17750000
&ZTLC         SETC 'L'                                                  17800000
              AIF   ('&MF(1)' NE '&ZTLC').ZG14                          17850000
&XMF          SETC  'L'         SET KEYWORD                             17900000
              AIF   (N'&MF LE 3).ZG7A           CK NUM                  17950000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           18000000
&ZMS          SETC  '&ZMS.&MF"'                                         18050000
&ZMS          SETC  '&ZMS "MF"'                                         18100000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                18150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             18200000
.ZG7A         ANOP  ,                                                   18250000
.*-------------------------------------------------------------------   18300000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     18350000
              AIF   (N'&SYSLIST NE 0).ZG7B      POSITIONALS?            18400000
              AIF   ('&OUTADDR' NE '').ZG7B     KEYS?                   18450000
              AGO    .ZG7C      INVOCATION OKAY                         18500000
.ZG7B         ANOP  ,                                                   18550000
&ZMS          SETC  'THE "L" FORM OF "MF" CANNOT'  *MFLA* MNOTE         18600000
&ZMS          SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                   18650000
&ZMS          SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'              18700000
              MNOTE 8,' &ZMS ON THE INVOCATION.'                        18750000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             18800000
.ZG7C         ANOP  ,                                                   18850000
.*-------------------------------------------------------------------   18900000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   18950000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           19000000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           19050000
              AIF   (N'&MF(2) GT 1).ZG9B        MULTI PARMS             19100000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           19150000
.ZG9B         AIF   (K'&MF(2) GT 0).ZG9C                                19200000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         19250000
&ZMS          SETC  ' '         *KRQDA*                                 19300000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 19350000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        19400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             19450000
.ZG9C         ANOP  ,                                                   19500000
.*-------------------------------------------------------------------   19550000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               19600000
              AIF   (K'&ZXMFCTRL LE 0).ZG9P     NOT I/O                 19650000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG9P                       19700000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         19750000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           19800000
&ZMS          SETC  '&ZMS.&MF"'                                         19850000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           19900000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   19950000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             20000000
.ZG9P         ANOP  ,                                                   20050000
.*-------------------------------------------------------------------   20100000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      20150000
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           20200000
&XMFATTR      SETC  '0D'                                                20250000
              AIF   (K'&MF(3) LE 0).ZG12B       PARM                    20300000
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           20350000
              AIF   (N'&MF(3) GT 1).ZG12B       MULTI PARMS             20400000
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           20450000
.ZG12B        ANOP  ,                                                   20500000
.*-------------------------------------------------------------------   20550000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  20600000
              AIF   (K'&ZXMFATTR LE 0).ZG12P    NOT I/O                 20650000
              AIF   ('&XMFATTR'(1,1) NE '(').ZG12P                      20700000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         20750000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           20800000
&ZMS          SETC  '&ZMS.&MF"'                                         20850000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           20900000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   20950000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             21000000
.ZG12P        ANOP  ,                                                   21050000
.*-------------------------------------------------------------------   21100000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 21150000
              AIF   (K'&ZXMFATTR LE 0).ZG12S    NOT I/O                 21200000
              AIF   (K'&XMFATTR LE 60).ZG12S    LNG OK                  21250000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         21300000
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           21350000
&ZMS          SETC  '&ZMS.&MF"'                                         21400000
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               21450000
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  21500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             21550000
.ZG12S        ANOP  ,                                                   21600000
.*-------------------------------------------------------------------   21650000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           21700000
.ZG14         ANOP  ,                                                   21750000
&ZTLC         SETC 'E'                                                  21800000
              AIF   ('&MF(1)' NE '&ZTLC').ZG22                          21850000
&XMF          SETC  'E'         SET KEYWORD                             21900000
              AIF   (N'&MF LE 3).ZG14A          CK NUM                  21950000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           22000000
&ZMS          SETC  '&ZMS.&MF"'                                         22050000
&ZMS          SETC  '&ZMS "MF"'                                         22100000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                22150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             22200000
.ZG14A        ANOP  ,                                                   22250000
.*-------------------------------------------------------------------   22300000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   22350000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           22400000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           22450000
              AIF   (N'&MF(2) GT 1).ZG16B       MULTI PARMS             22500000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           22550000
.ZG16B        AIF   (K'&MF(2) GT 0).ZG16C                               22600000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         22650000
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 22700000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 22750000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        22800000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             22850000
.ZG16C        ANOP  ,                                                   22900000
.*-------------------------------------------------------------------   22950000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              23000000
              AIF   (K'&ZXMFCTRL LE 0).ZG16R    NOT I/O                 23050000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG16R                      23100000
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          23150000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG16P                        23200000
              AIF   (K'&ZCGPR GT 2).ZG16Q                               23250000
              AIF   ('&ZCGPR' EQ '0').ZG16Q                             23300000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       23350000
              AIF   (T'&ZCGPR NE 'N').ZG16Q     INVALID REG NAME        23400000
.ZG16P        ANOP  ,                                                   23450000
              AIF   (T'&ZCGPR NE 'N').ZG16R     NON NUMERIC             23500000
              AIF   ('&ZCGPR' LT '1').ZG16Q                             23550000
              AIF   ('&ZCGPR' LE '12').ZG16R                            23600000
.ZG16Q        ANOP  ,                                                   23650000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           23700000
&ZMS          SETC  '&ZMS.&MF"'                                         23750000
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           23800000
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    23850000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             23900000
.ZG16R        ANOP  ,                                                   23950000
.*-------------------------------------------------------------------   24000000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             24050000
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    24100000
.ZG20A   AIF   ('&MF(3)' NE 'COMPLETE').ZG21A                           24150000
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             24200000
.*-------------------------------------------------------------------   24250000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             24300000
.ZG21A        AIF   (K'&XMFSCK GT 0).ZG21C      KEYWORD                 24350000
              AIF   (K'&MF(3) LE 0).ZG21B                               24400000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           24450000
&ZMS          SETC  '&ZMS.&MF"'                                         24500000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           24550000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 24600000
&ZMS          SETC  '&ZMS "COMPLETE".'                                  24650000
              MNOTE 8,' &ZMS '                                          24700000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             24750000
.ZG21B        ANOP  ,                                                   24800000
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     24850000
.ZG21C        ANOP  ,                                                   24900000
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           24950000
.*------------------------------------------------------------------    25000000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           25050000
.ZG22         ANOP  ,                                                   25100000
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           25150000
              AIF   (K'&XMF GT 0).ZG22E         VALID ARG               25200000
              AIF   (T'&MF EQ 'O').ZG22D        OMITTED                 25250000
&ZASYSLNDX    SETA  0                                                   25300000
.ZG22A        ANOP  ,           POSITIONAL MACRO KEY                    25350000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        25400000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG22C                    25450000
&ZTLC         SETC 'MF'                                                 25500000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG22A           25550000
.ZG22B        ANOP  ,                                                   25600000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         25650000
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           25700000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             25750000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    25800000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             25850000
              AGO   .ZG22E                                              25900000
.ZG22C        ANOP  ,                                                   25950000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         26000000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           26050000
&ZMS          SETC  '&ZMS.&MF"'                                         26100000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           26150000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 26200000
&ZMS          SETC  '&ZMS "S",'                                         26250000
&ZMS          SETC  '&ZMS "L",'                                         26300000
&ZMS          SETC  '&ZMS OR "E".'                                      26350000
              MNOTE 8,' &ZMS '                                          26400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             26450000
              AGO   .ZG22E                                              26500000
.ZG22D        ANOP  ,                                                   26550000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     26600000
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       26650000
.ZG22E        ANOP  ,                                                   26700000
.********************************************************************   26750000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 26800000
.********************************************************************   26850000
              ACTR  10000                                               26900000
.*-------------------------------------------------------------------   26950000
.***AG.MF03 MF=(SLE)                                                    27000000
              AIF   ('&XMF' EQ 'L').ZGMFX                               27050000
.*----------------------------------------------------------------***   27100000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     27150000
              AIF   (N'&OUTADDR LE 1).ZG2A      CK NUM                  27200000
&ZMS          SETC  '"OUTADDR='                 *KPOSA* MNOTE           27250000
&ZMS          SETC  '&ZMS.&OUTADDR"'                                    27300000
&ZMS          SETC  '&ZMS "OUTADDR"'                                    27350000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 27400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             27450000
.ZG2A         ANOP  ,                                                   27500000
.*-------------------------------------------------------------------   27550000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         27600000
&ZXOUTADDR    SETC  'INPUT'     SET IN/OUTPUT                           27650000
&XOUTADDR     SETC  '&OUTADDR(1)'               SET XVARIABLE           27700000
              AIF   (N'&OUTADDR GT 1).ZG2B      MULTI PARMS             27750000
&XOUTADDR     SETC  '&OUTADDR'  SET XVARIABLE                           27800000
.ZG2B         AIF   (K'&OUTADDR(1) GT 0).ZG2C                           27850000
&ZXOUTADDR    SETC  ''          RESET IN/OUTPUT                         27900000
&ZMS          SETC  ' '         *KRQDA*                                 27950000
&ZMS          SETC  '&ZMS "OUTADDR" KEY AND ITS'                        28000000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    28050000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             28100000
.ZG2C         ANOP  ,                                                   28150000
.*-------------------------------------------------------------------   28200000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    28250000
              AIF   (K'&ZXOUTADDR LE 0).ZG2R    NOT I/O                 28300000
              AIF   ('&XOUTADDR'(1,1) NE '(').ZG2R                      28350000
&ZCGPR        SETC  '&XOUTADDR'(2,K'&XOUTADDR-2)                        28400000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                         28450000
              AIF   (K'&ZCGPR GT 2).ZG2Q                                28500000
              AIF   ('&ZCGPR' EQ '0').ZG2Q                              28550000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       28600000
              AIF   (T'&ZCGPR NE 'N').ZG2Q      INVALID REG NAME        28650000
.ZG2P         ANOP  ,                                                   28700000
              AIF   (T'&ZCGPR NE 'N').ZG2R      NON NUMERIC             28750000
              AIF   ('&ZCGPR' LT '2').ZG2Q                              28800000
              AIF   ('&ZCGPR' LE '12').ZG2R                             28850000
.ZG2Q         ANOP  ,                                                   28900000
&ZMS          SETC  '"OUTADDR='                 *KGPRA* MNOTE           28950000
&ZMS          SETC  '&ZMS.&OUTADDR"'                                    29000000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           29050000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    29100000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             29150000
.ZG2R         ANOP  ,                                                   29200000
.******************************************************************     29250000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        29300000
.******************************************************************     29350000
              ACTR  10000                                               29400000
.*----------------------------------------------------------------***   29450000
.***AH.P02 EXTRA POSITIONALS                                            29500000
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               29550000
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                29600000
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            29650000
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             29700000
.ZGLISTX1     ANOP  ,                                                   29750000
&ZCVAL        SETC  ''          ERROR FIELD                             29800000
&ZAWRK        SETA  0           POSITIONAL NUMBER                       29850000
.ZGLIST2      ANOP  ,                                                   29900000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         29950000
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                30000000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   30050000
              AGO   .ZGLIST2                                            30100000
.*                                                                      30150000
.ZGLIST3      ANOP  ,                                                   30200000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             30250000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           30300000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     30350000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              30400000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      30450000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              30500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             30550000
.ZGLISTX      ANOP  ,                                                   30600000
&ZASYSLNDX    SETA  0                                                   30650000
.*-------------------------------------------------------------------   30700000
.***AG.MF04 MF=(SLE)                                                    30750000
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                30800000
.*******************************************************************    30850000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       30900000
.*******************************************************************    30950000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          31000000
.*******************************************************************    31050000
.***AE.01  START OF IEAMETR MACRO CODE                                  31100000
.*******************************************************************    31150000
              LCLC  &M0M0001                 NAME                       31200000
&M0M0001      SETC  '&XLABEL'                SET NAME                   31250000
              AIF   (K'&XLABEL NE 0).XLAB2                              31300000
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               31350000
.*                                                                      31400000
.XLAB2        ANOP  ,                                                   31450000
              AIF   ('&XMF' EQ 'L').XLAB3                               31500000
&M0M0001 DS    0H                             IEAMETR-0                 31550000
.XLAB3        ANOP  ,                                                   31600000
.*******************************************************************    31650000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              31700000
.*******************************************************************    31750000
              PUSH  PRINT                                               31800000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          31850000
              PRINT OFF         ++ PR01                                 31900000
              AGO   .ZPRNTXX                                            31950000
.ZPRINTX      PRINT ON                                                  32000000
.ZPRNTXX      ANOP  ,                                                   32050000
.********************************************************************   32100000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     32150000
.********************************************************************   32200000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       32250000
                      LCLA  &ZOPN1         INVOCATION INDEX             32300000
                      LCLC  &ZOPL(4095)    LABEL                        32350000
                      LCLC  &ZOPO(4095)    OPERATION                    32400000
                      LCLC  &ZOPV(4095)    VALUE                        32450000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  32500000
.*                                                                      32550000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     32600000
.******************************************************************     32650000
.***AL.L10 IEAMETR FMT=LIST MF=S|L PARAMETERS                           32700000
.******************************************************************     32750000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     32800000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     32850000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     32900000
&XMFATTR              SETC  '0D'                                        32950000
.*                                                                      33000000
&ZOPN                 SETA  &ZOPN+1                                     33050000
&ZOPL(&ZOPN)          SETC  ' '                                         33100000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     33125000
&ZOPO(&ZOPN)          SETC  'B'                                         33150000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                33200000
                      AGO   .ZALVL6B                                    33208300
.ZALVL6A              ANOP                                              33216600
&ZOPO(&ZOPN)          SETC  'BRAS'                                      33224900
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              33233200
.ZALVL6B              ANOP                                              33241500
&ZOPD(&ZOPN)          SETC  '++ IEAMETR ARG PARMS'                      33250000
.*                                                                      33300000
&ZOPN                 SETA  &ZOPN+1                                     33350000
&ZOPL(&ZOPN)          SETC  ' '                                         33400000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     33450000
&ZOPV(&ZOPN)          SETC  '1'                                         33500000
&ZOPD(&ZOPN)          SETC  ' '                                         33550000
.*                                                                      33600000
.ZLMFSL2              ANOP  ,                                           33650000
.*-------------------------------------------------------------------   33700000
.***AM.L00  IEAMETR FMT=LIST name                                       33750000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    33800000
&ZOPN                 SETA &ZOPN+1                                      33850000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   33900000
&ZOPO(&ZOPN)          SETC 'EQU'                                        33950000
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   34000000
&ZOPD(&ZOPN)          SETC '++ IEAMETR NAME'                            34050000
.ZLMFSL2M             ANOP  ,                                           34100000
.*-------------------------------------------------------------------   34150000
.***AM.L01  IEAMETR FMT=LIST PARAMETERS                                 34200000
&ZOPN                 SETA &ZOPN+1                                      34250000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   34300000
&ZOPO(&ZOPN)          SETC 'DS'                                         34350000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   34400000
&ZOPD(&ZOPN)          SETC '++ IEAMETR PARM LIST'                       34450000
.*-------------------------------------------------------------------   34500000
.***AM.L02 XVERSION XL1                                                 34550000
&ZOPN                 SETA &ZOPN+1                                      34600000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         34650000
&ZOPO(&ZOPN)          SETC 'DS'                                         34700000
&ZOPV(&ZOPN)          SETC 'XL1'                                        34750000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          34800000
.*-------------------------------------------------------------------   34850000
.***AM.L09  XRSV0001 CL3                                                34900000
&ZOPN                 SETA &ZOPN+1                                      34950000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         35000000
&ZOPO(&ZOPN)          SETC 'DS'                                         35050000
&ZOPV(&ZOPN)          SETC 'CL3'                                        35100000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      35150000
.*-------------------------------------------------------------------   35200000
.***AM.L09  XOUTADDR A                                                  35250000
&ZOPN                 SETA &ZOPN+1                                      35300000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOUTADDR'                         35350000
&ZOPO(&ZOPN)          SETC 'DS'                                         35400000
&ZOPV(&ZOPN)          SETC 'A'                                          35450000
&ZOPD(&ZOPN)          SETC '++ &ZXOUTADDR  XOUTADDR'                    35500000
.*-------------------------------------------------------------------   35550000
.***AM.L09  XRETDATA CL24                                               35600000
&ZOPN                 SETA &ZOPN+1                                      35650000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRETDATA'                         35700000
&ZOPO(&ZOPN)          SETC 'DS'                                         35750000
&ZOPV(&ZOPN)          SETC 'CL24'                                       35800000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRETDATA'                   35850000
.*-------------------------------------------------------------------   35900000
.***AM.L10 END OF IEAMETR LIST PARAMETERS                               35950000
&ZOPN                 SETA &ZOPN+1                                      36000000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 36050000
&ZOPO(&ZOPN)          SETC 'EQU'                                        36100000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 36150000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         36200000
.*                                                                      36250000
&ZOPN                 SETA &ZOPN+1                                      36300000
&ZOPL(&ZOPN)          SETC ' '                                          36350000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      36400000
&ZOPV(&ZOPN)          SETC '1'                                          36450000
&ZOPD(&ZOPN)          SETC ' '                                          36500000
.*-------------------------------------------------------------------   36550000
.***AL.L12 IEAMETR FMT=LIST MF=S|L PARAMETERS                           36600000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         36650000
.*                                                                      36700000
&ZOPN                 SETA  &ZOPN+1                                     36750000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                36800000
&ZOPO(&ZOPN)          SETC  'DC'                                        36850000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   36900000
&ZOPD(&ZOPN)          SETC  '++ IEAMETR ARG PARMS'                      36950000
.*                                                                      37000000
.ZLMFSLX              ANOP  ,                                           37050000
.*-------------------------------------------------------------------   37100000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          37150000
&ZPLLEN               SETA 32                                           37200000
.*                                                                      37250000
.******************************************************************     37300000
.***AI.L01 IEAMETR FMT=LIST FILL IN PARAMETER AREA                      37350000
.******************************************************************     37400000
                      ACTR  10000                                       37450000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               37500000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    37550000
&ZCVAL                SETC  'LAE'          XAX MODE                     37600000
.ZIMFXA               ANOP ,                                            37650000
.*                                                                      37700000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    37750000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         37800000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 37850000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                37900000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 37950000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                38000000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   38050000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    38100000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   38150000
&ZOPN                 SETA  &ZOPN+1                                     38200000
&ZOPL(&ZOPN)          SETC  ' '                                         38250000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    38300000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              38350000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       38400000
                      AGO   .ZIMFNX                                     38450000
.*                                                                      38500000
.ZIMFN2               ANOP ,                                            38550000
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     38554500
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     38559000
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  38563500
&ZOPN                 SETA  &ZOPN+1                                     38568000
&ZOPL(&ZOPN)          SETC  ' '                                         38572500
&ZOPO(&ZOPN)          SETC  'LAE'                                       38577000
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  38581500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       38586000
                      AGO   .ZIMFNX                                     38590500
.ZIMFNX1              ANOP ,                                            38595000
&ZOPN                 SETA  &ZOPN+1                                     38600000
&ZOPL(&ZOPN)          SETC  ' '                                         38650000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    38700000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                38750000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       38800000
.ZIMFNX               ANOP ,                                            38850000
.********************************************************************   38900000
.***AI.L02 IEAMETR FMT=LIST INITIALIZE PARAMETER AREA                   38950000
.********************************************************************   39000000
.***AI.L03 MF=(SLE)                                                     39050000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      39100000
.*                                                                      39150000
&ZOPN                 SETA  &ZOPN+1                                     39200000
&ZOPL(&ZOPN)          SETC  ' '                                         39250000
&ZOPO(&ZOPN)          SETC  'XC'                                        39300000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         39350000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             39400000
.ZIMFLX               ANOP  ,                                           39450000
.*-------------------------------------------------------------------   39500000
.***AI.L25  XOUTADDR AL4                                                39550000
                      AIF   ('&ZXOUTADDR' EQ '').ZI3E                   39600000
                      AIF   ('&ZXOUTADDR' EQ 'OUTPUT').ZI3E             39650000
&ZCGPR                SETC  '&XOUTADDR'                                 39700000
.*                                                                      39750000
                      AIF   ('&XOUTADDR'(1,1) NE '(').ZI3B              39800000
&ZCGPR   SETC  '0('.'&XOUTADDR'(2,K'&XOUTADDR-2).')'                    39850000
                      AGO   .ZI3D                                       39900000
.ZI3B                 ANOP  ,                                           39950000
.*                                                                      40000000
&ZC                   SETC  '&XOUTADDR'(1,1)                            40050000
                      AIF   (T'&ZC NE 'N').ZI3D                         40100000
&ZC                   SETC  '&XOUTADDR'                                 40150000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI3D                40200000
&ZCGPR                SETC  '=AL4(&XOUTADDR)'                           40250000
.*                                                                      40300000
.ZI3D                 ANOP  ,                                           40350000
.*                                                                      40400000
&ZOPN                 SETA  &ZOPN+1                                     40450000
&ZOPL(&ZOPN)          SETC  ' '                                         40500000
&ZOPO(&ZOPN)          SETC  'MVC'                                       40550000
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             40600000
&ZOPD(&ZOPN)          SETC  '++ &ZXOUTADDR XOUTADDR'                    40650000
.*                                                                      40700000
.ZI3E                 ANOP  ,                                           40750000
.*-------------------------------------------------------------------   40800000
&ZOPN1                SETA &ZOPN                                        40850000
.*******************************************************************    40900000
.***  PROCESS IEAMETR OUTPUT PARAMETERS                                 40950000
.*******************************************************************    41000000
                      ACTR  10000                                       41050000
.*******************************************************************    41100000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   41150000
.*******************************************************************    41200000
.ZMFLX                ANOP  ,              MF=L PROCESSING              41250000
.*******************************************************************    41300000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               41350000
.*******************************************************************    41400000
                      ACTR  10000                                       41450000
.*                                                                      41500000
                      LCLA  &ZLC           COLUMN POSITION              41550000
                      LCLA  &ZOPX          LIST TABLE INDEX             41600000
                      LCLC  &ZLL           LABEL                        41650000
                      LCLC  &ZLOP          OPERATION                    41700000
                      LCLC  &ZLV           VALUE                        41750000
                      LCLC  &ZLD           DESCRIPTION                  41800000
.*                                                                      41850000
&ZOPX                 SETA  1                                           41900000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            41950000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              42000000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              42050000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              42100000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              42150000
                      AIF   (K'&ZLD LE 0).ZL5                           42200000
&ZLC                  SETA  35             COMMENT COLUMN               42250000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    42300000
&ZLC                  SETA  33             COMMMENT COLUMN              42350000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   42400000
&ZLV                  SETC  '&ZLV'.' '                                  42450000
                      AGO   .ZL3                                        42500000
.*                                                                      42550000
.ZL4                  ANOP  ,                                           42600000
&ZLV                  SETC  '&ZLV'.' '                                  42650000
.ZL5                  ANOP  ,                                           42700000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               42750000
.*                                                                      42800000
&ZLL     &ZLOP &ZLV                                                     42850000
.*                                                                      42900000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               42950000
                      AGO   .ZL2           CONTINUE LOOPING             43000000
.*                                                                      43050000
.ZLX                  ANOP  ,                                           43100000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                43150000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  43200000
         L     14,16(0,0)              CVT Address                      43250000
         L     14,772(0,14)            SFT Address                      43300000
         L     14,428(0,14)            LX/EX for service routine        43350000
         PC    0(14)                                                    43400000
         L     14,4(0,1)               Return area address              43450000
         MVC   0(24,14),8(1)           Move data to return area         43500000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  43550000
.ZLINKX               ANOP  ,                                           43600000
.*******************************************************************    43650000
.***AP.X01  FORMAT GENERATED CODE                                       43700000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            43750000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              43800000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              43850000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              43900000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              43950000
                      AIF   (K'&ZLD LE 0).ZL51                          44000000
&ZLC                  SETA  35             COMMENT COLUMN               44050000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   44100000
&ZLC                  SETA  33             COMMENT COLUMN               44150000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  44200000
&ZLV                  SETC  '&ZLV'.' '                                  44250000
                      AGO   .ZL31                                       44300000
.*                                                                      44350000
.ZL41                 ANOP  ,                                           44400000
&ZLV                  SETC  '&ZLV'.' '                                  44450000
.ZL51                 ANOP  ,                                           44500000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               44550000
.*                                                                      44600000
&ZLL     &ZLOP &ZLV                                                     44650000
.*                                                                      44700000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               44750000
                      AGO   .ZL21          CONTINUE LOOPING             44800000
.*                                                                      44850000
.ZLX1                 ANOP  ,                                           44900000
.*******************************************************************    44950000
.***AP.X02  END OF IEAMETR MACRO                                        45000000
&ZIEAMETR             SETC  'YES'          SET IEAMETR USED             45050000
         POP   PRINT                                                    45100000
*                                            IEAMETR-0                  45150000
         SPACE 1                                                        45200000
.ZLX2                 ANOP  ,                                           45250000
         MEND                                                           45300000
**********************************************************************/ 45350000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  45400000
*%IEAMETR: MACRO KEYS(OUTADDR,MF);                                      45450000
*  ANS('?'||MACLABEL||' '||'IEAMETRP '||MACLIST||                       45500000
*         ' '||MACKEYS||';') COL(MACLMAR);                              45550000
*%END IEAMETR;                                                          45600000
