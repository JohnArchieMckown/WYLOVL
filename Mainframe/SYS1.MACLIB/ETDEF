*%/*                                                                    00050000
         MACRO                                                          00150000
&NAME    ETDEF &TYPE=,             INITIAL | ENTRY | SET | FINAL       *00200000
               &AKM=,              Authorization Key Mask              *00250000
               &ARR=,              Associated Recovery Routine Address *00300000
               &ASCMODE=,          PRIMARY | AR                        *00350000
               &ASYNCH=,           YES | NO                        @L2A*00366600
               &CANCEL=,           YES | NO                        @L2A*00383200
               &EAX=,              Extended Authorization index        *00400000
               &EK=,               Entry Key                           *00450000
               &EKM=,              Entry Key Mask                      *00500000
               &ETEADR=,           ENTRY address/name                  *00550000
               &HEADER=,           HEADER address/name                 *00600000
               &NUMETE=,           Number of entries                   *00650000
               &PARM1=,            User parameter 1                    *00700000
               &PARM2=,            User parameter 2                    *00750000
               &PC=,               STACKING | BASIC                    *00800000
               &PKM=,              OR | REPLACE                        *00850000
               &PROGRAM=,          Program name                        *00900000
               &RECORD=,           YES | NO                        @01A*00925000
               &ROUTINE=,          Routine address                     *00950000
               &RAMODE=,           Routine address AMODE           @D2A*00975000
               &SASN=,             OLD | NEW                           *01000000
               &SSWITCH=,          NO | YES  XM Space Switch           *01050000
               &STATE=,            PROBLEM | SUPERVISOR                *01100000
               &RELATED=           Any value                            01150000
         AGO   .SKIP                                                 */ 01200000
*/****  START OF SPECIFICATIONS  *************************************/ 01250000
*/*                                                                  */ 01300000
*/*01*  MACRO NAME = ETDEF                                           */ 01350000
*/*                                                                  */ 01400000
*/*01*  DESCRIPTIVE NAME = Entry Table Definition                    */ 01450000
*/*                                                                  */ 01500000
*/*01*  COPYRIGHT=                                                   */ 01550000
*/*         5685-001                                                 */ 01600000
*/*         THIS MACRO IS "RESTRICTED MATERIALS OF IBM"              */ 01650000
*/*         (C) COPYRIGHT IBM CORP. 1988                             */ 01700000
*/*         LICENSED MATERIALS - PROPERTY OF IBM                     */ 01750000
*/*                                                                  */ 01900000
*/*01*  STATUS =  HBB4430                                        @L2C*/ 01950000
*/*                                                                  */ 02000000
*/*01*  FUNCTION =                                                   */ 02050000
*/*       Define or set entry table entries.                         */ 02100000
*/*       ETDEF will create a FORMAT=1 Entry Table Descriptor        */ 02150000
*/*       or reset lists of entry table descriptors that will        */ 02200000
*/*       be used as input to the Entry Table Create process.        */ 02250000
*/*                                                                  */ 02300000
*/*02*    OPERATION =                                                */ 02350000
*/*         The ETDEF macro parses the keywords according to         */ 02400000
*/*         the TYPE parameter.  It will either initialize or        */ 02450000
*/*         set entries for the entry table entry.                   */ 02500000
*/*                                                                  */ 02550000
*/*         In the event of an error, syntax checking will attempt   */ 02600000
*/*         to continue for the remainder of the input. No data      */ 02650000
*/*         will be generated.                                       */ 02700000
*/*                                                                  */ 02750000
*/*01*  INPUT =  (BAL)                                               */ 02800000
*/*        TYPE=            INITIAL | ENTRY | FINAL | SET            */ 02850000
*/*                          Required, no default                    */ 02900000
*/*                                                                  */ 02950000
*/*               INITIAL  Specifies that an entry table descriptor  */ 03000000
*/*                        list is starting. The header for the      */ 03050000
*/*                        list will be generated.                   */ 03100000
*/*               ENTRY    Specifies that an entry table descriptor  */ 03150000
*/*                        is to be generated. Each entry in the     */ 03200000
*/*                        list must be within the scope of an       */ 03250000
*/*                        INITIAL - FINAL pair.                     */ 03300000
*/*               FINAL    Specifies that the entry table descriptor */ 03350000
*/*                        list is complete.                         */ 03400000
*/*               SET      Specifies that an entry table descriptor  */ 03450000
*/*                        or header is to be initialized or reset.  */ 03500000
*/*                                                                  */ 03550000
*/*                                                                  */ 03600000
*/*02*   INPUT when TYPE is INITIAL or FINAL                         */ 03650000
*/*                                                                  */ 03700000
*/*           ,RELATED=     Any value                                */ 03750000
*/*                                                                  */ 03800000
*/*                                                                  */ 03850000
*/*02*   INPUT when TYPE is ENTRY                                    */ 03900000
*/*                                                                  */ 03950000
*/*       ,AKM=             Authorization Key Mask. Required.        */ 04000000
*/*                          The AKM can be a single number or pair  */ 04050000
*/*                          of numbers (low:high) separated by a    */ 04100000
*/*                          colon to indicate a range. Multiple     */ 04150000
*/*                          ranges may be specified and parenthesis */ 04200000
*/*                          are optional.  Example:                 */ 04250000
*/*                             AKM=(2,(3),5:8,(10:12),15)  would    */ 04300000
*/*                             result in: B'0011011110111001'       */ 04350000
*/*                             or decimal: 14265.                   */ 04400000
*/*       ,PROGRAM=       1 Program name. Character string of        */ 04500000
*/*                          maximum length 8, optionally enclosed   */ 04550000
*/*                          in single quotation marks.              */ 04600000
*/*       ,ROUTINE=       1 Routine address. A-type address.         */ 04650000
*/*                                                                  */ 04700000
*/*           ,ARR=         Associated Recovery Routine Address.     */ 04750000
*/*           ,ASCMODE=     PRIMARY | AR                             */ 04800000
*/*           ,ASYNCH=,     YES | NO  Valid only with ARR            */ 04816600
*/*           ,CANCEL=,     YES | NO  Valid only with ARR (See NOTES)*/ 04833200
*/*           ,EAX=         Extended Authorization index. Halfword   */ 04850000
*/*                          decimal value (self-defining term).     */ 04900000
*/*           ,EK=          Entry Key. Decimal number or constant    */ 04950000
*/*                          from 0 -15.                             */ 05000000
*/*           ,EKM=         Entry Key Mask. See AKM. Required when   */ 05016600
*/*                          PKM=REPLACE.                            */ 05033200
*/*           ,PARM1=       User parameter 1. A-type address or      */ 05050000
*/*                          character string of maximum length 4,   */ 05100000
*/*                          enclosed in single quotation marks.     */ 05150000
*/*           ,PARM2=       User parameter 2. See PARM1              */ 05200000
*/*           ,PC=          STACKING | BASIC                         */ 05250000
*/*           ,PKM=         OR | REPLACE                             */ 05300000
*/*           ,RAMODE=      31 | 24  Valid only with ROUTINE.        */ 05325000
*/*           ,SASN=        OLD | NEW                                */ 05350000
*/*           ,SSWITCH=     NO | YES                                 */ 05400000
*/*           ,STATE=       PROBLEM | SUPERVISOR                     */ 05450000
*/*           ,RELATED=     Any value                                */ 05500000
*/*                                                                  */ 05550000
*/*                                                                  */ 05600000
*/*02*   INPUT when TYPE is SET and HEADER is to be changed          */ 05650000
*/*                                                                  */ 05700000
*/*       ,HEADER=          HEADER name. RX-address or register      */ 05750000
*/*                          (1) - (15).                             */ 05800000
*/*       ,NUMETE=          Number of entries.  Symbol, decimal      */ 05850000
*/*                          number (1 to 128), or register.         */ 05900000
*/*           ,RECORD=      YES | NO.   INTERNAL USE ONLY.           */ 05916600
*/*                                                                  */ 05933200
*/*           ,RELATED=     Any value                                */ 05950000
*/*                                                                  */ 06000000
*/*                                                                  */ 06050000
*/*02*   INPUT when TYPE is SET and ETEADR is to be changed          */ 06100000
*/*                                                                  */ 06150000
*/*       ,ETEADR=          ENTRY name. RX-address or register       */ 06200000
*/*                          (1) - (15).                             */ 06250000
*/*       ,AKM=             Authorization Key Mask. Required.        */ 06300000
*/*                          The AKM can be a single number or pair  */ 06350000
*/*                          of numbers (low:high) separated by a    */ 06400000
*/*                          colon to indicate a range. Multiple     */ 06450000
*/*                          ranges may be specified and parenthesis */ 06500000
*/*                          are optional.  Example:                 */ 06550000
*/*                             AKM=(2,(3),5:8,(10:12),15)  would    */ 06600000
*/*                             result in: B'0011011110111001'       */ 06650000
*/*                             or decimal: 14265.                   */ 06700000
*/*       ,PROGRAM=       1 Program name. Character string of        */ 06800000
*/*                          maximum length 8, optionally enclosed   */ 06850000
*/*                          in single quotation marks.              */ 06900000
*/*       ,ROUTINE=       1 Routine address. A-type address or       */ 06950000
*/*                          register.                               */ 07000000
*/*                                                                  */ 07050000
*/*           ,ARR=         Associated Recovery Routine Address.     */ 07100000
*/*                          A-type address or register, or quoted   */ 07150000
*/*                          character string of maximum length 8.   */ 07200000
*/*           ,ASCMODE=     PRIMARY | AR                             */ 07250000
*/*           ,ASYNCH=,     YES | NO  Valid only with ARR            */ 07266600
*/*           ,CANCEL=,     YES | NO  Valid only with ARR (See NOTES)*/ 07283200
*/*           ,EAX=         Extended Authorization index.            */ 07300000
*/*                          Halfword decimal value, or register.    */ 07350000
*/*           ,EK=          Entry Key. Decimal number or constant    */ 07400000
*/*                          from 0 -15.                             */ 07450000
*/*           ,EKM=         Entry Key Mask. See AKM. Required when   */ 07466600
*/*                          PKM=REPLACE.                            */ 07483200
*/*           ,PARM1=       User parameter 1. A-type address or      */ 07500000
*/*                          character string of maximum length 4,   */ 07550000
*/*                          enclosed in single quotation marks.     */ 07600000
*/*                          Register form may contain data.         */ 07650000
*/*           ,PARM2=       User parameter 2. See PARM1              */ 07700000
*/*           ,PC=          STACKING | BASIC                         */ 07750000
*/*           ,PKM=         OR | REPLACE                             */ 07800000
*/*           ,RAMODE=      31 | 24  Valid only with ROUTINE.        */ 07825000
*/*           ,SASN=        OLD | NEW                                */ 07850000
*/*           ,SSWITCH=     NO | YES                                 */ 07900000
*/*           ,STATE=       PROBLEM | SUPERVISOR                     */ 07950000
*/*           ,RELATED=     Any value                                */ 08000000
*/*                                                                  */ 08050000
*/*03*    NOTES =                                                    */ 08100000
*/*         -  The following are not valid with PC=BASIC:            */ 08150000
*/*             ARR, ASCMODE=AR, ASYNCH, CANCEL, EAX, EK,            */ 08200000
*/*             PKM=REPLACE, SASN=NEW                                */ 08250000
*/*         -  Mutually exclusive keywords are noted numerically.    */ 08300000
*/*         -  Default options are listed first. If a default is     */ 08350000
*/*            is not listed, the parameter will be given a value    */ 08400000
*/*            of zero.                                              */ 08450000
*/*         -  The EKM is required when STATE=PROBLEM and the EK     */ 08457100
*/*            is specified.                                         */ 08464200
*/*         -  When CANCEL=NO is specified, the PC routine must be   */ 08471300
*/*            in supervisor state (STATE=SUPERVISOR), or the EKM    */ 08478400
*/*            must contain a system key, or the AKM can only have   */ 08485500
*/*            system keys and PKM=OR.                               */ 08492600
*/*         -  If explicit register notation is specified, only      */ 08500000
*/*            registers (2) through (12) may be used, unless        */ 08550000
*/*            noted otherwise.                                      */ 08600000
*/*                                                                  */ 08650000
*/*                                                                  */ 08700000
*/*01*  NOTES =                                                      */ 08750000
*/*                                                                  */ 08800000
*/*02*    RESTRICTIONS = None                                        */ 08850000
*/*                                                                  */ 08900000
*/*02*    DEPENDENCIES =                                             */ 08950000
*/*                      If the offsets in the IHAETD mapping        */ 09000000
*/*                      macro change, the SETA symbols defined      */ 09050000
*/*                      under 'IHAETD offsets' in the BAL source    */ 09100000
*/*                      must also be changed respectively.          */ 09150000
*/*                                                                  */ 09200000
*/*03*      CHARACTER-CODE DEPENDENCIES= EBCDIC                      */ 09250000
*/*                                                                  */ 09300000
*/*01*  MODULE TYPE = BIL MACRO                                      */ 09350000
*/*                                                                  */ 09400000
*/*02*    PROCESSOR = ASSEMBLER-H  or  PLAS                          */ 09450000
*/*                                                                  */ 09500000
*/*02*    INVOCATION = See MACRO definition                          */ 09550000
*/*                                                                  */ 09600000
*/*01*  COMPONENT  =  SCXMS (PC/AUTH)                                */ 09650000
*/*                                                                  */ 09700000
*/*01*  DISTRIBUTION LIBRARY = AMACLIB                               */ 09750000
*/*                                                                  */ 09800000
*/**** END OF SPECIFICATIONS *****************************************/ 09850000
*/*                                                                     09900000
.*                                                                      09950000
.*   CHANGE ACTIVITY =                                                  10000000
.*      $L0=AR      HBB3310 851118 PD16LD: Access Registers             10050000
.*      $D1=DCR0006 HBB3310 851118 PD16LD: ARR in quotes                10055000
.*      $P1=PC40037 HBB3310 860404 PD16LD: Inconsistent error checking  10067500
.*                                         with PLAS version            10080000
.*      $P2=PC40042 HBB3310 860404 PD16LD: Null sublist is processed    10090000
.*      $P3=PC40157 HBB3310 860825 PD16LD: Change MNOTE text            89668400
.*      $P4=PC40345 HBB3310 861020 PD16LD: Negative EK value            89671600
.*      $L1=AR      HBB3310 870406 PD16LD: Access Registers             89672400
.*      $D2=DCR0248 HBB3310 870406 PD16LD: Make EKM optional and add    89673200
.*                                         RAMODE keyword               89674000
.*      $P5=PC41695 HBB3310 871123 PD16LD: EAX default is 0, not loc 0  89674400
.*      $L2=ARREN   JBB3311 880418 PD16LD: ARR Enhancement              89675500
.*      $D3=DCR0012 JBB3311 880418 PD16LD: EKM required with EK when    89676600
.*                                         STATE=PROBLEM                89677700
.*      $D4=DCR0014 JBB3311 880418 PD16LD: Check AKM with CANCEL=NO     89678800
.*      $01=OY55354 HBB4430 920625 PD16EJ: Add RECORD keyword           89679300
.*                                                                      89679900
.********************************************************************** 89681200
.*                                                                      89687600
.SKIP    ANOP ,                                                         89694000
*        MACDATE  06/25/92                                              89700400
.*                                                                      89706800
.********************************************************************** 89713200
.*                                                                    * 89719600
.*       Declare GLOBAL and LOCAL variables                           * 89726000
.*                                                                    * 89732400
.********************************************************************** 89738800
.*                                                                      89745200
         GBLA  &IHAETDI       LIST counter                              89751600
         GBLC  &IHAETDN       LIST name                                 89758000
.*                                                                      89764400
         LCLA  &AKMV          AKM - Decimal value                       89770800
         LCLC  &AMOD          OI or NI the AMODE qualifier         @D2A 89774000
         LCLC  &ARRV          Associated Recovery Routine address       89777200
         LCLA  &AWK           Arithmetic work variable                  89783600
         LCLA  &COLN          Colon used but no parens (range value)    89790000
         LCLC  &CWK           Character work variable                   89796400
         LCLC  &CWK1          Character work variable              @01A 89799600
         LCLA  &DECVAL        Decimal work variable                     89802800
         LCLC  &EAXV          Extended Authorization Index              89809200
         LCLB  &AKMUSER       AKM specified a user key (flag)      @D4A 89811300
         LCLB  &EKMSYS        EKM specified a system key (flag)    @L2A 89813400
         LCLA  &EKMV          EKM - Decimal value                       89815600
         LCLC  &EKV           Entry Key value                           89822000
         LCLC  &EM(20)        General error messages                    89828400
         LCLC  &ENTV          ENTRY name (ETEADR or HEADER)             89834800
         LCLA  &ER1           Entry register low bound (ETEADR,HEADER)  89841200
         LCLA  &ER2           Entry register high bound (ETEADR,HEADER) 89847600
         LCLA  &FBYTE         FLAG byte                                 89854000
         LCLA  &FBSUP,&FBXMSS  FLAG byte settings                       89860400
         LCLB  &IHBBIT(16)    Bit array                                 89866800
         LCLA  &IHBBITL       Length of bit array &IHBBIT               89873200
         LCLB  &IHBERR        Error flag                                89879600
         LCLC  &KEYS1(22)     Keywords invalid with INITIAL,FINAL  @01C 89880200
         LCLC  &KEYN1(22)     Keyword names for &KEYS1             @01C 89880800
         LCLA  &K1SIZE        Dimension of &KEYS1 and &KEYN1       @L1A 89881400
         LCLC  &KEYS2(19)     Keywords invalid with HEADER         @L2C 89882000
         LCLC  &KEYN2(19)     Keyword names for &KEYS2             @L2C 89882600
         LCLA  &K2SIZE        Dimension of &KEYS2 and &KEYN2       @L1A 89883200
         LCLC  &KEYS4(4)      Keywords invalid with TYPE=ENTRY     @01C 89883800
         LCLC  &KEYN4(4)      Keyword names for &KEYS4             @01C 89884400
         LCLA  &K4SIZE        Dimension of &KEYS4 and &KEYN4       @L1A 89885000
         LCLC  &KEYS5(8)      Keywords invalid with PC=BASIC       @L2A 89885200
         LCLC  &KEYN5(8)      Keyword names for &KEYS5             @L2A 89885400
         LCLA  &K5SIZE        Dimension of &KEYS5 and &KEYN5       @L2A 89885600
         LCLA  &L1            Lower bound                               89886000
         LCLA  &L2            Upper bound                               89892400
         LCLA  &LPAFB1        Flag for LPA, byte 1                 @L2A 89894000
         LCLA  &LPA1CAN         LPA Flag  CANCEL option for ARR    @L2A 89895600
         LCLA  &LPA1ASY         LPA Flag  ASYNCH option for ARR    @L2A 89897200
         LCLA  &NDX           Substring index                           89898800
         LCLC  &NUMV          NUMETE value                              89905200
         LCLA  &OBYTE         OPTION byte                               89911600
         LCLA  &OBPCTC,&OBPKC   OPTION byte settings                    89918000
         LCLA  &OBPKMC,&OBEAXC  OPTION byte settings                    89924400
         LCLA  &OBASC,&OBSASN   OPTION byte settings                    89930800
         LCLA  &PAREN         Parenthesis used                          89937200
         LCLC  &PARM1V        USER parameter 1                          89943600
         LCLC  &PARM2V        USER parameter 2                          89950000
         LCLC  &PGM           PROGRAM NAME                              89956400
         LCLC  &RANGE(2)      Lower/upper range values                  89962800
         LCLC  &RTNV          ROUTINE address                           89967000
         LCLC  &RTNAMOD       AMODE for register form of ROUTINE   @D2A 89971200
         LCLA  &RVAL          Range value pointer                       89975600
         LCLA  &R1            Register usage lower bound                89982000
         LCLA  &R2            Register usage upper bound                89988400
         LCLA  &SUB           Sublist element number                    89994800
         LCLA  &SYSKEY        Highest system key                   @L2A 89996900
         LCLA  &USERKEY       Highest user key                     @L2A 89999000
         LCLC  &VALUE         Sublist element                           90001200
.*                                                                      90007600
.********************************************************************** 90014000
.*       Declares for IHAETD offsets and lengths                      * 90020400
.********************************************************************** 90026800
.*                                                                      90033200
         LCLA  &ETDFMT        Offset to FORMAT NUMBER                   90039600
         LCLA  &ETDFMTE       Extended format indicator                 90046000
         LCLA  &ETDRCRD       Record=YES|NO indicator              @01A 90049200
         LCLA  &ETDNUM        Offset to NUMBER OF ENTRIES               90052400
.*                                                                      90058800
         LCLA  &ETDFLG        Offset to FLAG BYTE                       90065200
         LCLA  &ETDPRO        Offset to PROGRAM name                    90071600
         LCLA  &ETDPRO1       Offset to first word of ETDPRO            90078000
         LCLA  &ETDPRO2       Offset to second word of ETDPRO           90084400
         LCLA  &ETDAKM        Offset to AKM                             90090800
         LCLA  &ETDEKM        Offset to EKM                             90097200
         LCLA  &ETDPAR        Offset to PARM1                           90103600
         LCLA  &ETDOPT1       Offset to OPTION BYTE 1                   90110000
         LCLA  &ETDEK         Offset to EK                              90116400
         LCLA  &ETDEAX        Offset to EAX                             90122800
         LCLA  &ETDARR        Offset to ARR                             90129200
         LCLA  &ETDARR1       Offset to first word of ETDARR            90135600
         LCLA  &ETDARR2       Offset to second word of ETDARR           90142000
         LCLA  &ETDPAR2       Offset to PARM2                           90148400
         LCLA  &ETDLPA1       Offset to LPA FLAG BYTE 1            @L2A 90151600
.*                                                                      90154800
         LCLA  &ETDNUML       Length of NUMBER OF ENTRIES               90161200
         LCLA  &ETDPROL       Length of PROGRAM name                    90167600
         LCLA  &ETDPR1L       Length of first word of ETDPRO            90174000
         LCLA  &ETDPR2L       Length of second word of ETDPRO           90180400
         LCLA  &ETDAKML       Length of AKM                             90186800
         LCLA  &ETDEKML       Length of EKM                             90193200
         LCLA  &ETDPA1L       Length of PARM1                           90199600
         LCLA  &ETDEAXL       Length of EAX                             90206000
         LCLA  &ETDARRL       Length of ARR                             90212400
         LCLA  &ETDAR1L       Length of first word of ETDARR            90218800
         LCLA  &ETDAR2L       Length of second word of ETDARR           90225200
         LCLA  &ETDPA2L       Length of PARM2                           90231600
.*                                                                      90238000
.********************************************************************** 90244400
.*                                                                    * 90250800
.*       IHAETD offsets       These SETs should not be changed        * 90257200
.*                            unless the offsets in the IHAETD        * 90263600
.*                            mapping macro have been changed.        * 90270000
.*                                                                    * 90276400
.********************************************************************** 90282800
.*                                                                      90289200
&ETDFMT  SETA    0            Offset to FORMAT NUMBER                   90295600
&ETDFMTE SETA    1            Extended format indicator                 90302000
&ETDRCRD SETA    0            Record=NO indicator                  @01A 90304100
&ETDRCO  SETA    1            Offset to Header Flag Byte           @01A 90306200
&ETDNUM  SETA    2            Offset to NUMBER OF ENTRIES               90308400
.*                                                                      90314800
&ETDFLG  SETA    1            Offset to FLAG BYTE                       90321200
&ETDPRO  SETA    4            Offset to PROGRAM name                    90327600
&ETDPRO1 SETA    4            Offset to first word of ETDPRO            90334000
&ETDPRO2 SETA    8            Offset to second word of ETDPRO           90340400
&ETDAKM  SETA   12            Offset to AKM                             90346800
&ETDEKM  SETA   14            Offset to EKM                             90353200
&ETDPAR  SETA   16            Offset to PARM1                           90359600
&ETDOPT1 SETA   20            Offset to OPTION BYTE 1                   90366000
&ETDEK   SETA   21            Offset to EK                              90372400
&ETDEAX  SETA   22            Offset to EAX                             90378800
&ETDARR  SETA   24            Offset to ARR                             90385200
&ETDARR1 SETA   24            Offset to first word of ETDPRO            90391600
&ETDARR2 SETA   28            Offset to second word of ETDPRO           90398000
&ETDPAR2 SETA   32            Offset to PARM2                           90404400
&ETDLPA1 SETA   36            Offset to LPA FLAG BYTE 1            @L2A 90407600
.*                                                                      90410800
&ETDNUML SETA      2          Length of NUMBER OF ENTRIES               90417200
&ETDPROL SETA      8          Length of PROGRAM name                    90423600
&ETDPR1L SETA      4          Length of first word of ETDPRO            90430000
&ETDPR2L SETA      4          Length of second word of ETDPRO           90436400
&ETDAKML SETA      2          Length of AKM                             90442800
&ETDEKML SETA      2          Length of EKM                             90449200
&ETDPA1L SETA      4          Length of PARM1                           90455600
&ETDEAXL SETA      2          Length of EAX                             90462000
&ETDARRL SETA      8          Length of ARR                             90468400
&ETDAR1L SETA      4          Length of first word of ETDARR            90474800
&ETDAR2L SETA      4          Length of second word of ETDARR           90481200
&ETDPA2L SETA      4          Length of PARM2                           90487600
.*                                                                      90494000
.********************************************************************** 90500400
.*                                                                    * 90506800
.*       Constants                                                    * 90513200
.*                                                                    * 90519600
.********************************************************************** 90526000
.*                                                                      90532400
&IHBBITL SETA  16             Length of bit array &IHBBIT               90538800
&R1      SETA   2             General register lower bound              90545200
&R2      SETA  12             General register upper bound              90551600
&ER1     SETA   1             Entry register low bound (ETEADR,HEADER)  90558000
&ER2     SETA  15             Entry register high bound (ETEADR,HEADER) 90564400
&SYSKEY  SETA   7             Highest system key (0 - 7)           @L2A 90566500
&USERKEY SETA  15             Highest user key (8 - 15)            @L2A 90568600
.*                                                                      90570800
.*       (&FBYTE)             ETDFLG flag byte settings                 90577200
&FBSUP   SETA  128            X'80'  Supervisor State                   90583600
&FBXMSS  SETA   64            X'40'  XM Space Switch                    90590000
.*                                                                      90596400
.*       (&OBYTE)             ETDOPTB1 Option byte 1 flag settings      90602800
&OBPCTC  SETA  128            X'80'  Stacking PC                        90609200
&OBPKC   SETA   16            X'10'  Replace PSW key                    90615600
&OBPKMC  SETA    8            X'08'  Replace PKM                        90622000
&OBEAXC  SETA    4            X'04'  Replace EAX                        90628400
&OBASC   SETA    2            X'02'  AR mode                            90634800
&OBSASN  SETA    1            X'01'  SASN=NEW PASN                      90641200
.*                                                                      90647600
.*       (&LPAFB1)            ETDLPAF1  LPA flag byte 1 settings   @L2A 90648800
&LPA1CAN SETA  128            X'80'  CANCEL option for ARR         @L2A 90650000
&LPA1ASY SETA   64            X'40'  ASYNCH option for ARR         @L2A 90651200
.*                                                                      90652400
.********************************************************************** 90654000
.*                                                                    * 90660400
.*       Tables                                                       * 90660500
.*                                                                    * 90660600
.********************************************************************** 90660700
.*                                                                      90660800
.********************************************************************** 90660900
.*       Keywords not valid with TYPE=INITIAL | FINAL              @L1A 90661000
.********************************************************************** 90661100
&KEYS1(1)  SETC  '&AKM'                                            @L1A 90661200
&KEYS1(2)  SETC  '&ARR'                                            @L1A 90661300
&KEYS1(3)  SETC  '&ASCMODE'                                        @L1A 90661400
&KEYS1(4)  SETC  '&EAX'                                            @L1A 90661500
&KEYS1(5)  SETC  '&EK'                                             @L1A 90661600
&KEYS1(6)  SETC  '&EKM'                                            @L1A 90661700
&KEYS1(7)  SETC  '&ETEADR'                                         @L1A 90661800
&KEYS1(8)  SETC  '&HEADER'                                         @L1A 90661900
&KEYS1(9)  SETC  '&NUMETE'                                         @L1A 90662000
&KEYS1(10) SETC  '&PARM1'                                          @L1A 90662100
&KEYS1(11) SETC  '&PARM2'                                          @L1A 90662200
&KEYS1(12) SETC  '&PC'                                             @L1A 90662300
&KEYS1(13) SETC  '&PKM'                                            @L1A 90662400
&KEYS1(14) SETC  '&PROGRAM'                                        @L1A 90662500
&KEYS1(15) SETC  '&ROUTINE'                                        @L1A 90662600
&KEYS1(16) SETC  '&RAMODE'                                         @D2A 90662700
&KEYS1(17) SETC  '&SASN'                                           @L1A 90662800
&KEYS1(18) SETC  '&SSWITCH'                                        @L1A 90662900
&KEYS1(19) SETC  '&STATE'                                          @L1A 90663000
&KEYS1(20) SETC  '&ASYNCH'                                         @L2A 90663100
&KEYS1(21) SETC  '&CANCEL'                                         @L2A 90663200
&KEYS1(22) SETC  '&RECORD'                                         @01A 90663300
.*                            Keyword names for &KEYS1                  90663400
&KEYN1(1)  SETC  'AKM'                                             @L1A 90663500
&KEYN1(2)  SETC  'ARR'                                             @L1A 90663600
&KEYN1(3)  SETC  'ASCMODE'                                         @L1A 90663700
&KEYN1(4)  SETC  'EAX'                                             @L1A 90663800
&KEYN1(5)  SETC  'EK'                                              @L1A 90663900
&KEYN1(6)  SETC  'EKM'                                             @L1A 90664000
&KEYN1(7)  SETC  'ETEADR'                                          @L1A 90664100
&KEYN1(8)  SETC  'HEADER'                                          @L1A 90664200
&KEYN1(9)  SETC  'NUMETE'                                          @L1A 90664300
&KEYN1(10) SETC  'PARM1'                                           @L1A 90664400
&KEYN1(11) SETC  'PARM2'                                           @L1A 90664500
&KEYN1(12) SETC  'PC'                                              @L1A 90664600
&KEYN1(13) SETC  'PKM'                                             @L1A 90664700
&KEYN1(14) SETC  'PROGRAM'                                         @L1A 90664800
&KEYN1(15) SETC  'ROUTINE'                                         @L1A 90664900
&KEYN1(16) SETC  'RAMODE'                                          @D2A 90665000
&KEYN1(17) SETC  'SASN'                                            @L1A 90665100
&KEYN1(18) SETC  'SSWITCH'                                         @L1A 90665200
&KEYN1(19) SETC  'STATE'                                           @L1A 90665300
&KEYN1(20) SETC  'ASYNCH'                                          @L2A 90665400
&KEYN1(21) SETC  'CANCEL'                                          @L2A 90665500
&KEYN1(22) SETC  'RECORD'                                          @01A 90665600
&K1SIZE    SETA  22           Dimension of &KEYS1 and &KEYN1       @01C 90665700
.*                                                                      90665800
.********************************************************************** 90665900
.*       Keywords not valid with HEADER                            @L1A 90666000
.********************************************************************** 90666100
&KEYS2(1)  SETC  '&AKM'                                            @L1A 90666200
&KEYS2(2)  SETC  '&ARR'                                            @L1A 90666300
&KEYS2(3)  SETC  '&ASCMODE'                                        @L1A 90666400
&KEYS2(4)  SETC  '&EAX'                                            @L1A 90666500
&KEYS2(5)  SETC  '&EK'                                             @L1A 90666600
&KEYS2(6)  SETC  '&EKM'                                            @L1A 90666700
&KEYS2(7)  SETC  '&ETEADR'                                         @L1A 90666800
&KEYS2(8)  SETC  '&PARM1'                                          @L1A 90666900
&KEYS2(9)  SETC  '&PARM2'                                          @L1A 90667000
&KEYS2(10) SETC  '&PC'                                             @L1A 90667100
&KEYS2(11) SETC  '&PKM'                                            @L1A 90667200
&KEYS2(12) SETC  '&PROGRAM'                                        @L1A 90667300
&KEYS2(13) SETC  '&ROUTINE'                                        @L1A 90667400
&KEYS2(14) SETC  '&RAMODE'                                         @D2A 90667500
&KEYS2(15) SETC  '&SASN'                                           @L1A 90667600
&KEYS2(16) SETC  '&SSWITCH'                                        @L1A 90667700
&KEYS2(17) SETC  '&STATE'                                          @L1A 90667800
&KEYS2(18) SETC  '&ASYNCH'                                         @L2A 90667900
&KEYS2(19) SETC  '&CANCEL'                                         @L2A 90668000
.*                            Keyword names for &KEYS2             @L1A 90668100
&KEYN2(1)  SETC  'AKM'                                             @L1A 90668200
&KEYN2(2)  SETC  'ARR'                                             @L1A 90668300
&KEYN2(3)  SETC  'ASCMODE'                                         @L1A 90668400
&KEYN2(4)  SETC  'EAX'                                             @L1A 90668500
&KEYN2(5)  SETC  'EK'                                              @L1A 90668600
&KEYN2(6)  SETC  'EKM'                                             @L1A 90668700
&KEYN2(7)  SETC  'ETEADR'                                          @L1A 90668800
&KEYN2(8)  SETC  'PARM1'                                           @L1A 90668900
&KEYN2(9)  SETC  'PARM2'                                           @L1A 90669000
&KEYN2(10) SETC  'PC'                                              @L1A 90669100
&KEYN2(11) SETC  'PKM'                                             @L1A 90669200
&KEYN2(12) SETC  'PROGRAM'                                         @L1A 90669300
&KEYN2(13) SETC  'ROUTINE'                                         @L1A 90669400
&KEYN2(14) SETC  'RAMODE'                                          @D2A 90669500
&KEYN2(15) SETC  'SASN'                                            @L1A 90669600
&KEYN2(16) SETC  'SSWITCH'                                         @L1A 90669700
&KEYN2(17) SETC  'STATE'                                           @L1A 90669800
&KEYN2(18) SETC  'ASYNCH'                                          @L2A 90669900
&KEYN2(19) SETC  'CANCEL'                                          @L2A 90670000
&K2SIZE    SETA  19           Dimension of &KEYS2 and &KEYN2       @L2C 90670100
.*                                                                      90670200
.********************************************************************** 90670300
.*       Keywords not valid with TYPE=ENTRY                        @L1A 90670400
.********************************************************************** 90670500
&KEYS4(1)  SETC  '&ETEADR'                                         @L1A 90670600
&KEYS4(2)  SETC  '&HEADER'                                         @L1A 90670700
&KEYS4(3)  SETC  '&NUMETE'                                         @L1A 90670800
&KEYS4(4)  SETC  '&RECORD'                                         @01A 90670900
.*                            Keyword names for &KEYS4             @L1A 90671000
&KEYN4(1)  SETC  'ETEADR'                                          @L1A 90671100
&KEYN4(2)  SETC  'HEADER'                                          @L1A 90671200
&KEYN4(3)  SETC  'NUMETE'                                          @L1A 90671300
&KEYN4(4)  SETC  'RECORD'                                          @01A 90671400
&K4SIZE    SETA  4            Dimension of &KEYS4 and &KEYN4       @01C 90671500
.*                                                                      90671600
.********************************************************************** 90671700
.*       Keywords not valid with PC=BASIC                          @L2A 90671800
.********************************************************************** 90671900
&KEYS5(1)  SETC  '&ARR'                                            @L2A 90672000
&KEYS5(2)  SETC  '&ASYNCH'                                         @L2A 90672100
&KEYS5(3)  SETC  '&CANCEL'                                         @L2A 90672200
&KEYS5(4)  SETC  '&EAX'                                            @L2A 90672300
&KEYS5(5)  SETC  '&EK'                                             @L2A 90672400
           AIF   ('&ASCMODE(1)' NE 'AR').PCBASC                    @L2A 90672500
&KEYS5(6)  SETC  '&ASCMODE'                                        @L2A 90672600
.PCBASC    ANOP  ,                                                 @L2A 90672700
           AIF   ('&PKM(1)' NE 'REPLACE').PCBPKM                   @L2A 90672800
&KEYS5(7)  SETC  '&PKM'                                            @L2A 90672900
.PCBPKM    ANOP  ,                                                 @L2A 90673000
           AIF   ('&SASN(1)' NE 'NEW').PCBSAS                      @L2A 90673100
&KEYS5(8)  SETC  '&SASN'                                           @L2A 90673200
.PCBSAS    ANOP  ,                                                 @L2A 90673300
.*                            Keyword names for &KEYS5             @L2A 90673400
&KEYN5(1)  SETC  'ARR PARAMETER'                                   @L2A 90673500
&KEYN5(2)  SETC  'ASYNCH PARAMETER'                                @L2A 90673600
&KEYN5(3)  SETC  'CANCEL PARAMETER'                                @L2A 90673700
&KEYN5(4)  SETC  'EAX PARAMETER'                                   @L2A 90673800
&KEYN5(5)  SETC  'EK PARAMETER'                                    @L2A 90673900
&KEYN5(6)  SETC  'ASCMODE=&ASCMODE'                                @L2A 90674000
&KEYN5(7)  SETC  'PKM=&PKM'                                        @L2A 90674100
&KEYN5(8)  SETC  'SASN=&SASN'                                      @L2A 90674200
&K5SIZE    SETA  8            Dimension of &KEYS5 and &KEYN5       @L2A 90674300
.*                                                                      90674400
.********************************************************************** 90674500
.*                                                                    * 90674600
.*       Initialization                                               * 90674700
.*                                                                    * 90674800
.********************************************************************** 90679600
         ACTR  10000          Set for infinite loop control             90686000
.*                            Reset Global Variables                    90692400
&IHBERR  SETB  0              Reset error flag                          90698800
.*                            Set up the default flag bytes             90705200
&FBYTE   SETA  0               ETDFLG flag byte                         90711600
&OBYTE   SETA  0               ETDOPTB1 option byte                     90718000
.*                                                                      90724400
.********************************************************************** 90730800
.*                                                                    * 90737200
.*       Generic suffixes for MNOTE Error Messages                    * 90743600
.*             (Refer to MNOTEs at end of listing)                    * 90750000
.*                                                                    * 90756400
.********************************************************************** 90762800
.*                                                                      90769200
&EM(1)   SETC 'PARAMETER IS NOT VALID WHEN TYPE=&TYPE'                  90775600
&EM(2)   SETC 'PARAMETER IS NOT VALID WITH HEADER'                      90782000
&EM(3)   SETC 'PARAMETER IS NOT VALID WITH ETEADR'                      90788400
&EM(4)   SETC 'PARAMETER CONTAINS TOO MANY SUBLISTS'                    90794800
&EM(5)   SETC 'PARAMETER IS REQUIRED WHEN TYPE=&TYPE'                   90801200
&EM(6)   SETC 'PARAMETER IS MISSING SUBLIST ENTRY' ||'n - IGNORED' @P1C 90807600
&EM(7)   SETC 'MAY NOT USE A REGISTER WHEN TYPE=&TYPE'                  90814000
&EM(8)   SETC 'IS NOT VALID WITH PC=BASIC'                              90820400
&EM(9)   SETC 'PARAMETER REQUIRES A VALUE'                         @P3C 90826800
&EM(10)  SETC 'PARAMETER MUST BE ''''YES'''' OR ''''NO'''' '       @01C 90828900
&EM(11)  SETC 'PARAMETER MAY ONLY BE SPECIFIED WITH'               @L2A 90831000
.*                                                                      90833200
.********************************************************************** 90839600
.*                                                                    * 90846000
.*       Check for positional parameters                              * 90852400
.*                                                                    * 90858800
.********************************************************************** 90865200
.*                                                                      90871600
         AIF   (N'&SYSLIST GE 1).ERR01          Too many positionals    90878000
.EXPOS   ANOP ,                                                         90884400
.*                                                                      90890800
.********************************************************************** 90897200
.*                                                                    * 90903600
.*       Validate and process according to the TYPE parameter         * 90910000
.*                                                                    * 90916400
.********************************************************************** 90922800
.*                                                                      90929200
.*                                              Check TYPE parameter    90935600
         AIF   ('&TYPE' EQ '').ERR02            TYPE is required   @P1C 90942000
         AIF   (N'&TYPE GT 1).ERR02A            Too many sublists  @P1C 90948400
.CKTYPE  ANOP ,                                 Check TYPE parameter    90954800
         AIF   ('&TYPE(1)' EQ '').ERR02B        No sublist value   @P1A 90961200
         AIF   ('&TYPE(1)' EQ 'SET').DOSET      Process TYPE=SET        90967600
         AIF   ('&TYPE(1)' EQ 'ENTRY').DOENTRY  Process TYPE=ENTRY      90974000
         AIF   ('&TYPE(1)' EQ 'INITIAL').DOINIT Process TYPE=INITIAL    90980400
         AIF   ('&TYPE(1)' EQ 'FINAL').DOINIT   Process TYPE=FINAL      90986800
         AGO   .ERR04                           TYPE is not valid       90993200
.*                                                                      90999600
.********************************************************************** 91006000
.*                                                                    * 91012400
.*       TYPE=INITIAL and TYPE=FINAL                                  * 91018800
.*                                                                    * 91025200
.********************************************************************** 91031600
.*                                                                      91038000
.DOINIT  ANOP  ,                Check for invalid parameters            91081000
&NDX     SETA  0                            Init index counter     @L1C 91124000
.TYPELOP ANOP  ,                            Beginning of loop      @L1C 91167000
&NDX     SETA  &NDX+1                       Increment counter      @L1C 91210000
         AIF   (&NDX GT &K1SIZE).EXTYPEL    End of list?           @L1C 91253000
         AIF   ('&KEYS1(&NDX)' EQ '').TYPELOP Value not specified  @L1C 91296000
         MNOTE 8,' &KEYN1(&NDX) &EM(1)'     Not valid with TYPE    @L1C 91339000
&IHBERR  SETB  1                            Indicate error              91382000
         AGO   .TYPELOP                     Loop back              @L1C 91425000
.EXTYPEL ANOP  ,                            End of keyword list    @L1C 91468000
         AIF   (&IHBERR EQ 1).EXIT      Exit if errors encountered      91511600
         AIF   ('&TYPE(1)' EQ 'FINAL').DOFINAL                          91518000
.*                                                                      91524400
.********************************************************************** 91530800
.*       Process TYPE=INITIAL                                         * 91537200
.********************************************************************** 91543600
.*                                                                      91550000
&NAME    DS    0D                  ENTRY TABLE DESCRIPTION LIST         91556400
         DC    XL1'01'             FORMAT NUMBER OF ETD                 91562800
         DC    AL1(0)              RESERVED. MUST BE ZERO               91569200
&IHAETDN SETC  'ETD&SYSNDX'        List name                            91575600
         DC    AL2(&IHAETDN)       NUMBER OF ENTRY DESCRIPTIONS         91582000
&IHAETDI SETA  0                   Set list counter                     91588400
         AGO   .EXIT               Done                                 91594800
.*                                                                      91601200
.********************************************************************** 91607600
.*       Process TYPE=FINAL                                           * 91614000
.********************************************************************** 91620400
.*                                                                      91626800
.DOFINAL ANOP  ,      Generate equate for number of entries in list     91633200
         AIF   ('&IHAETDN' EQ '').ERR08   Ensure INITIAL specified      91639600
         AIF   ('&NAME' EQ '').FINAME     No label specified            91646000
&NAME    EQU   *                                                        91652400
.FINAME  ANOP  ,                                                        91658800
&IHAETDN EQU   &IHAETDI            NUMBER OF ENTRIES IN LIST            91665200
&IHAETDN SETC  ''                  Reset list name                      91671600
         AGO   .EXIT               Done                                 91678000
.*                                                                      91684400
.********************************************************************** 91690800
.*                                                                    * 91697200
.*       TYPE=SET                                                     * 91703600
.*                                                                    * 91710000
.********************************************************************** 91716400
.*                                                                      91722800
.DOSET   ANOP  ,                    No invalid parameters               91729200
.*                                                                      91735600
.*                                  Check for required keywords         91742000
         AIF   ('&HEADER' NE '').DOSHEAD   HEADER specified             91748400
         AIF   ('&ETEADR' NE '').DOSENTR   ETEADR specified             91754800
         AGO   .ERR09               ETEADR or HEADER required           91761200
.*                                                                    * 91767600
.********************************************************************** 91774000
.*                                                                    * 91780400
.*       TYPE=SET,HEADER=addr                                         * 91786800
.*                                                                    * 91793200
.********************************************************************** 91799600
.DOSHEAD ANOP ,                Check for invalid parameters             91806000
&NDX     SETA  0                            Init index counter     @L1C 91847600
.HEADLOP ANOP  ,                            Beginning of loop      @L1C 91889200
&NDX     SETA  &NDX+1                       Increment counter      @L1C 91930800
         AIF  (&NDX GT &K2SIZE).EXHEADL     End of list?           @L1C 91972400
         AIF  ('&KEYS2(&NDX)' EQ '').HEADLOP Value not specified   @L1C 92014000
         MNOTE 8,' &KEYN2(&NDX) &EM(2)'     Not valid with HEADER  @L1C 92055600
&IHBERR  SETB  1                            Indicate error              92097200
         AGO   .HEADLOP                     Loop back              @L1C 92138800
.EXHEADL ANOP  ,                            End of keyword list    @L1C 92180400
.********************************************************************** 92222000
.*       HEADER parameter                                             * 92228400
.********************************************************************** 92234800
.*                                                                      92241200
         AIF   (N'&HEADER GT 1).ERR37B         Too many sublists        92247600
&ENTV    SETC  '+'.'&HEADER'                   RX type suffix           92254000
         AIF   ('&HEADER'(1,1) NE '(').EXHEAD  Not register format      92260400
&ENTV    SETC  '&HEADER(1)'                    Register format (Rx)     92266800
         AIF   (T'&HEADER NE 'N').EXHEAD       Must be a symbol         92273200
&AWK     SETA  K'&HEADER-2                     Length of register       92279600
&CWK     SETC  '&HEADER'(2,&AWK)               Isolate register number  92286000
         AIF   ('&CWK' LT '&ER1' OR '&CWK' GT '&ER2').ERR37A  Bad reg   92292400
.EXHEAD  ANOP  ,                                                        92298800
.*                                                                      92305200
.********************************************************************** 92311600
.*       NUMETE parameter                         ( 1 - 128 )         * 92318000
.********************************************************************** 92324400
.*                                                                      92330800
&L1      SETA  1                               Minimum value            92337200
&L2      SETA  128                             Maximum value            92343600
         AIF   ('&NUMETE(1)' EQ '').ERR39      NUMETE is required  @P1C 92350000
         AIF   (N'&NUMETE GT 1).ERR39B         Too many sublists        92356400
         AIF   ('&NUMETE'(1,1) EQ '(').NUMREG  Register form            92362800
         AIF   (T'&NUMETE NE 'N').NUMESET      Must be a symbol         92369200
         AIF   (&NUMETE LT &L1).ERR39A         Minimum value            92375600
         AIF   (&NUMETE GT &L2).ERR39A         Maximum value            92382000
         AGO   .NUMESET                        Done                     92388400
.NUMREG  ANOP  ,                                                        92394800
         AIF   (T'&NUMETE NE 'N').NUMESET      Must be a symbol         92401200
&AWK     SETA  K'&NUMETE-2                     Length of register       92407600
&CWK     SETC  '&NUMETE'(2,&AWK)               Isolate register         92414000
         AIF   ('&CWK' LT '&R1' OR '&CWK' GT '&R2').ERR39C Reg invalid  92420400
.NUMESET ANOP  ,                                                        92426800
&NUMV    SETC  '&NUMETE(1)'                    Value                    92433200
.EXNUMET ANOP  ,                                                        92439600
.*                                                                      92440100
.********************************************************************** 92440600
.*       RECORD parameter                         ( YES | NO )        * 92441100
.********************************************************************** 92441600
.*                                                                      92442100
         AIF   ('&RECORD' EQ '').EXRECRD       Not specified       @01A 92442600
         AIF   (N'&RECORD GT 1).ERR55B         Too many sublists   @01A 92443100
         AIF   ('&RECORD(1)' EQ 'YES').EXRECRD Default             @01A 92443600
         AIF   ('&RECORD(1)' NE 'NO').ERR55    Error               @01A 92444100
&ETDRCRD SETA 1                                Indicate RECORD(NO) @01A 92444600
.EXRECRD ANOP ,                                                    @01A 92445100
.*                                                                      92446000
.********************************************************************** 92452400
.*                                                                    * 92458800
.*       SET  Entry Table Descriptor entry for                        * 92465200
.*              TYPE=SET,HEADER=addr                                  * 92471600
.*                                                                    * 92478000
.********************************************************************** 92484400
         AIF   (&IHBERR EQ 1).EXIT        Exit if errors encountered    92490800
         AIF   ('&ENTV'(1,1) EQ '+').HEASYMF   Symbol form              92497200
.*                                             Register form            92503600
&NAME    MVI   &ETDFMT.(&ENTV),&ETDFMTE        FORMAT NUMBER            92510000
&CWK     SETC  '&ETDNUM.(&ETDNUML,&ENTV)'      Target of MVC for NUMETE 92516400
&CWK1    SETC  '&ETDRCO.(&ENTV)'               Target of OI for    @01A 92519600
.*                                             RECORD                   92522800
         AGO   .GENUREC                        Generate RECORD          92526000
.*                                                                      92529200
.HEASYMF ANOP  ,                               Symbolic name form       92535600
&NAME    MVI   &ETDFMT.&ENTV,&ETDFMTE          FORMAT NUMBER            92542000
&CWK     SETC  '&ETDNUM.&ENTV.(&ETDNUML)'      Target of MVC for NUMETE 92548400
&CWK1    SETC  '&ETDRCO.&ENTV'                 Target of OI for    @01A 92549200
.*                                             RECORD                   92550000
.*--------------------------------------------------------------------* 92550800
.GENUREC ANOP  ,                                                   @01A 92551600
         AIF   (&ETDRCRD EQ 0).GENUMET     If RECORD(YES) generate @01A 92552400
.*                                         NUMETE code                  92553200
.*                                                                      92553400
.*  The following OR sets ETDRCRD to indicate that this is a            92553600
.*  RECORD=NO entry table.  The hardcoded value allows the macro        92553800
.*  to be used without the inclusion of the ETD.                        92554000
.*                                                                      92554200
         OI    &CWK1,X'80'                     RECORD=NO TABLE     @01A 92554400
.*--------------------------------------------------------------------* 92554800
.GENUMET ANOP  ,                                                        92561200
         AIF   ('&NUMETE'(1,1) EQ '(').NUMEREG Register format          92567600
         AIF   (T'&NUMETE EQ 'N').NUMEDEC      Positive number          92574000
         MVC   &CWK,&NUMV                      NUMBER OF ENTRIES        92580400
         AGO   .EXIT                           Done                     92586800
.NUMEDEC ANOP  ,                                                        92593200
         MVC   &CWK,=Y(&NUMV)                  NUMBER OF ENTRIES        92599600
         AGO   .EXIT                           Done                     92606000
.NUMEREG ANOP  ,                                                        92612400
         AIF   ('&ENTV'(1,1) EQ '+').NUMHSYM   Symbol form              92618800
         STH   &NUMV,&ETDNUM.(,&ENTV)          NUMBER OF ENTRIES        92625200
         AGO   .EXIT                           Done                     92631600
.NUMHSYM ANOP  ,                                                        92638000
         STH   &NUMV,&ETDNUM.&ENTV             NUMBER OF ENTRIES        92644400
         AGO   .EXIT                           Done                     92650800
.*                                                                      92657200
.********************************************************************** 92663600
.*                                                                    * 92670000
.*       TYPE=SET,ETEADR=addr                                         * 92676400
.*                                                                    * 92682800
.********************************************************************** 92689200
.DOSENTR ANOP ,                        Check for invalid parameters     92695600
         AIF ('&NUMETE' EQ '').SENUM     Invalid parameter              92702000
         MNOTE 8,' NUMETE &EM(3)'        Not valid with ETEADR          92708400
&IHBERR  SETB  1                         Indicate error                 92714800
.SENUM   ANOP  ,                                                        92721200
.*        Note: The HEADER parameter is not valid with ETEADR=&ETEADR.  92727600
.*              This check was made at .DOSET above, which would not    92734000
.*              permit processing to arrive here.                       92740400
.*                                                                      92746800
.********************************************************************** 92753200
.*       ETEADR parameter                                             * 92759600
.********************************************************************** 92766000
.*                                                                      92772400
         AIF   (N'&ETEADR GT 1).ERR34B          Too many sublists       92778800
&ENTV    SETC  '+'.'&ETEADR'                    RX type suffix          92785200
         AIF   ('&ETEADR'(1,1) NE '(').EXETEAD  Not register format     92791600
&ENTV    SETC  '&ETEADR(1)'                     Register format (Rx)    92798000
         AIF   (T'&ETEADR NE 'N').EXETEAD       Must be a symbol        92804400
&AWK     SETA  K'&ETEADR-2                      Length of register      92810800
&CWK     SETC  '&ETEADR'(2,&AWK)                Isolate register number 92817200
         AIF   ('&CWK' LT '&ER1' OR '&CWK' GT '&ER2').ERR34  Bad reg    92823600
.EXETEAD ANOP  ,                                                        92830000
         AGO   .DOKEYS                 Continue keyword validation      92836400
.*                                                                      92842800
.********************************************************************** 92849200
.*                                                                    * 92855600
.*       TYPE=ENTRY                                                   * 92862000
.*                                                                    * 92868400
.********************************************************************** 92874800
.*                                                                      92881200
.DOENTRY ANOP ,                        Check for invalid parameters     92887600
&NDX     SETA  0                            Init index counter     @L1C 92895900
.ENTRLOP ANOP  ,                            Beginning of loop      @L1C 92904200
&NDX     SETA  &NDX+1                       Increment counter      @L1C 92912500
         AIF   (&NDX GT &K4SIZE).EXENTRL    End of list?           @L1C 92920800
         AIF   ('&KEYS4(&NDX)' EQ '').ENTRLOP Value not specified  @L1C 92929100
         MNOTE 8,' &KEYN4(&NDX) &EM(1)'     Not valid with ENTRY   @L1C 92937400
&IHBERR  SETB  1                            Indicate error              92945700
         AGO   .ENTRLOP                     Loop back              @L1C 92954000
.EXENTRL ANOP  ,                            End of keyword list    @L1C 92962300
.*                                                                      92970800
.********************************************************************** 92977200
.*                                                                    * 92983600
.*       TYPE=ENTRY or TYPE=SET,ETEADR=addr      Valid keywords       * 92990000
.*                                                                    * 92996400
.********************************************************************** 93002800
.*                                                                      93009200
.DOKEYS  ANOP  ,                       Process keywords                 93015600
.*                                                                      93022000
.********************************************************************** 93028400
.*                                                                    * 93034800
.*       AKM parameter                 (key list)   Required          * 93041200
.********************************************************************** 93047600
.*                                                                      93054000
         AIF   ('&AKM' EQ '').ERR22    AKM not specified                93060400
         AIF   ('&AKM' EQ '()').ERR22B No value within parens      @P2A 93066800
&L1      SETA  0                       Lower range value                93073200
&L2      SETA  15                      Upper range value                93079600
.*                                                                      93086000
.*                                     Reset the &IHBBIT bit array      93092400
&NDX     SETA  1                       Set index counter                93098800
.AKMRSET ANOP                          Loop to zero the bit array       93105200
&IHBBIT(&NDX) SETB 0                   Zero this bit                    93111600
&NDX     SETA  &NDX+1                  Increment the counter and        93118000
         AIF   (&NDX LE &IHBBITL).AKMRSET   loop for all bits           93124400
.*                                                                      93130800
.********************************************************************** 93137200
.*       Parse and isolate the lower and upper range value            * 93143600
.********************************************************************** 93150000
.*                                                                      93156400
.*                                 Process each sublist entry           93162800
&SUB     SETA  1                       Set sublist counter              93169200
.*                                                                      93175600
.AKMSET  ANOP  ,                       Loop for each sublist entry      93182000
         AIF   (T'&AKM(&SUB) EQ 'O').WAR22   Null sublist entry         93188400
&VALUE   SETC  '&AKM(&SUB)'            Isolate range sublist            93194800
.*                                                                      93201200
&RVAL    SETA  1                       First range value                93207600
&NDX     SETA  0                       Point at nothing                 93214000
&PAREN   SETA  0                       Initialize to no parens used     93220400
         AIF   ('&VALUE'(1,1) NE '(').AKMVALL  First char not '('       93226800
&PAREN   SETA  1                       Parenthesis used                 93233200
&NDX     SETA  1                       Point at parenthesis             93239600
.*                                                                      93246000
.********************************************************************** 93252400
.*                                                                      93258800
.AKMVALL ANOP                          Loop to isolate ranges           93265200
         AIF   (&RVAL GT 2).ERR22A     Too many entries                 93271600
&AWK     SETA  &NDX                    Index prior to number            93278000
.AKMCHRL ANOP                          Loop for number                  93284400
&NDX     SETA  &NDX+1                  Point to next character          93290800
         AIF   ('&VALUE'(&NDX,1) EQ ':').AKMSNUM    End of number       93297200
         AIF   ('&VALUE'(&NDX,1) EQ ')').AKMSNUM    End of number       93303600
         AIF   ('&VALUE'(&NDX,1) LT '0').ERR22A     Not decimal         93310000
         AIF   ('&VALUE'(&NDX,1) GT '9').ERR22A     Not decimal         93316400
         AIF   (&NDX LT K'&VALUE).AKMCHRL  Check next character         93322800
.AKMSNUM ANOP  ,                                                        93329200
         AIF   (&PAREN EQ 0).AKMSVAL      Number not in parens          93335600
         AIF   (&AWK+1 EQ &NDX).ERR22A    No number '(:' or ':)'        93342000
         AGO   .AKMRANG                   Go save value                 93348400
.AKMSVAL ANOP  ,                                                        93354800
         AIF   ('&VALUE'(&NDX,1) NE ':').AKMRANG    End of number       93361200
         AIF   (&NDX EQ K'&VALUE).ERR22A  Missing high range 'xx:'      93367600
&COLN    SETA  1                          Account for colon             93374000
.*                                                                      93380400
.AKMRANG ANOP  ,                          Save range value              93386800
&RANGE(&RVAL)  SETC  '&VALUE'(&AWK+1,&NDX-&AWK-&PAREN-&COLN)            93393200
&COLN    SETA  0                          Reset colon indicator         93399600
.*                                        Process next sublist entry    93406000
&RANGE(2) SETC '&RANGE(&RVAL)'            Set upper range...            93412400
&RVAL    SETA  &RVAL+1                    Next range value              93418800
         AIF   (&NDX LT K'&VALUE).AKMVALL  Another entry to process...  93425200
.*                                                                    * 93431600
.********************************************************************** 93438000
.*                                                                    * 93444400
         AIF   ('&RANGE(1)' LT '&L1').ERR22A  Less than lower bound     93450800
         AIF   ('&RANGE(2)' GT '&L2').ERR22A  Greater than upper bound  93457200
         AIF   ('&RANGE(1)' GT '&RANGE(2)').ERR22A  Invalid range       93463600
.*                                            Set the required bits     93470000
&AWK     SETA  &RANGE(1)-&L1+1                 Start bit position       93476400
.AKMBITL ANOP  ,                               Loop                     93482800
&IHBBIT(&AWK) SETB 1                           Set the required bit     93489200
&AWK     SETA  &AWK+1                          Next position            93495600
         AIF   (&AWK LE &RANGE(2)-&L1+1).AKMBITL  Loop for all bits     93502000
.*                                                                      93508400
.AKMNEXT ANOP  ,                                                        93514800
&SUB     SETA  &SUB+1                    Increment the counter          93521200
         AIF   (&SUB LE N'&AKM).AKMSET   and loop for each sublist      93527600
.*                                                                      93534000
.********************************************************************** 93540400
.*       Convert binary array (&IHBBIT) to decimal value              * 93546800
.********************************************************************** 93553200
.*                                                                    * 93559600
&AWK     SETA  1                            Binary power multiplier     93566000
&NDX     SETA  &IHBBITL                     Point at low order bit      93572400
&DECVAL  SETA  &IHBBIT(&NDX)                Initialize decimal value    93578800
.AKMDEC  ANOP  ,                                                        93585200
&NDX     SETA  &NDX-1                       Index to next bit           93591600
&AWK     SETA  &AWK*2                       Increment by power of 2     93598000
&DECVAL  SETA  &AWK*&IHBBIT(&NDX)+&DECVAL   Add to current value        93604400
         AIF   (&NDX GT 1).AKMDEC           Loop for all bits           93610800
&AKMV    SETA  &DECVAL                      Set result                  93617200
         AIF   (&DECVAL EQ 0).ERR22B        No bits were set       @P2A 93623600
.*                                                                      93630000
.********************************************************************** 93630400
.*       Check AKM for a user key (8-15) when CANCEL=NO               * 93630800
.********************************************************************** 93631200
.*                                                                      93631600
         AIF   ('&CANCEL' NE 'NO').EXAKM    CANCEL=NO not specifid @D4A 93632000
&NDX     SETA  &SYSKEY+2                    Init for indexing      @D4A 93632400
&AKMUSER SETB  1                            Init user key found    @D4A 93632800
.AKMUSE  ANOP  ,                                                   @D4A 93633200
         AIF   (&IHBBIT(&NDX) EQ 1).EXAKM   Exit if user key       @D4A 93633600
&NDX     SETA  &NDX+1                       Index to next bit      @D4A 93634000
         AIF   (&NDX LE &USERKEY+1).AKMUSE  Loop for all bits      @D4A 93634400
&AKMUSER SETB  0                            No user key found      @D4A 93634800
.*                                                                      93635200
.EXAKM   ANOP  ,                                                        93636400
.*                                                                      93642800
.********************************************************************** 93649200
.*                                                                    * 93655600
.*       ARR parameter                       (address)                * 93662000
.********************************************************************** 93668400
.*                                                                      93674800
&L2      SETA  8                               Maximum length      @D1A 93681200
         AIF   ('&ARR' EQ '').ARRDFLT          Take default             93687600
         AIF   (N'&ARR GT 1).ERR25B            Too many sublists        93694000
         AIF   ('&TYPE(1)' EQ 'SET').ARRVAL    Continue                 93700400
         AIF   ('&ARR'(1,1) EQ '(').ERR25      Register form invalid    93706800
.ARRVAL  ANOP  ,                                                        93713200
         AIF   ('&ARR'(1,1) NE '''').ARRSET    Address or register @D1A 93719600
         AIF   (K'&ARR-2 GT &L2).ERR25A        Maximum length      @D1A 93726000
.ARRSET  ANOP  ,                                                   @D1A 93732400
&ARRV    SETC  '&ARR'                          ARR value                93738800
         AIF   ('&ARR'(1,1) NE '(').EXARR      Not register form        93745200
         AIF   (T'&ARR NE 'N').EXARR            Must be a symbol        93751600
&AWK     SETA  K'&ARR-2                         Length of register      93758000
&CWK     SETC  '&ARR'(2,&AWK)                   Isolate register        93764400
         AIF   ('&CWK' LT '&R1' OR '&CWK' GT '&R2').ERR25C Reg invalid  93770800
         AGO   .EXARR                          Done                     93777200
.ARRDFLT ANOP  ,                                                        93783600
&ARRV    SETC  '0'                             Default value            93790000
.EXARR   ANOP  ,                                                        93796400
.*                                                                      93802800
.********************************************************************** 93809200
.*                                                                    * 93815600
.*       ASCMODE parameter                   ( PRIMARY | AR )         * 93822000
.********************************************************************** 93828400
.*                                                                      93834800
         AIF   ('&ASCMODE' EQ '').EXASCM           Set default value    93841200
         AIF   (N'&ASCMODE GT 1).ERR26B            Too many sublists    93847600
         AIF   ('&ASCMODE(1)' EQ 'PRIMARY').EXASCM Default value        93854000
         AIF   ('&ASCMODE(1)' NE 'AR').ERR26       Error...             93860400
&OBYTE   SETA  &OBYTE+&OBASC                       ASCMODE=AR           93866800
.EXASCM  ANOP ,                                                         93873200
.*                                                                      93879600
.********************************************************************** 93886000
.*                                                                    * 93892400
.*       ASYNCH parameter                   ( YES | NO )              * 93892600
.*                                                                    * 93892800
.*       The ARR will/will not be interrupted by asynchronous exits   * 93893000
.********************************************************************** 93893200
.*                                             ARR ASYNCH          @L2A 93893400
         AIF   ('&ASYNCH' EQ '').EXASYNC       Set default value   @L2A 93893600
         AIF   (N'&ASYNCH GT 1).ERR27B         Too many sublists   @L2A 93893800
         AIF   ('&ASYNCH(1)' EQ 'YES').EXASYNC Default             @L2A 93894000
         AIF   ('&ASYNCH(1)' NE 'NO').ERR27    Error               @L2A 93894200
&LPAFB1  SETA  &LPAFB1+&LPA1ASY                ASYNCH=NO           @L2A 93894400
.EXASYNC ANOP ,                                                    @L2A 93894600
.*                                                                      93894800
.********************************************************************** 93895000
.*                                                                    * 93895200
.*       CANCEL parameter                   ( YES | NO )              * 93895400
.*                                                                    * 93895600
.*  The ARR will/will not be interrupted by CANCEL/DETACH processing  * 93895800
.********************************************************************** 93896000
.*                                             ARR CANCEL          @L2A 93896200
         AIF   ('&CANCEL' EQ '').EXCANCL       Set default value   @L2A 93896400
         AIF   (N'&CANCEL GT 1).ERR28B         Too many sublists   @L2A 93896600
         AIF   ('&CANCEL(1)' EQ 'YES').EXCANCL Default             @L2A 93896800
         AIF   ('&CANCEL(1)' NE 'NO').ERR28    Error               @L2A 93897000
&LPAFB1  SETA  &LPAFB1+&LPA1CAN                CANCEL=NO           @L2A 93897200
.EXCANCL ANOP ,                                                    @L2A 93897400
.*                                                                      93897600
.********************************************************************** 93897800
.*                                                                    * 93898000
.*       EAX parameter                       (halfword value)         * 93898800
.********************************************************************** 93905200
.*                                                                      93911600
         AIF   ('&EAX' EQ '').EAXDFLT        Take default               93918000
         AIF   (N'&EAX GT 1).ERR29B          Too many sublists          93924400
         AIF   ('&TYPE(1)' EQ 'SET').EAXVAL  Continue                   93930800
         AIF   ('&EAX'(1,1) EQ '(').ERR29    Register form invalid      93937200
.EAXVAL  ANOP  ,                                                        93943600
&EAXV    SETC  '&EAX'                        Value                      93950000
&OBYTE   SETA  &OBYTE+&OBEAXC                Set EAX specified bit      93956400
         AIF   ('&EAX'(1,1) EQ '-').ERR29A   Negative value        @P4A 93959600
         AIF   ('&EAX'(1,1) NE '(').EXEAX    Not a register             93962800
.*                                           Register form              93969200
         AIF   (T'&EAX NE 'N').EXEAX            Must be a symbol        93975600
&AWK     SETA  K'&EAX-2                         Length of register      93982000
&CWK     SETC  '&EAX'(2,&AWK)                   Isolate register        93988400
         AIF   ('&CWK' LT '&R1' OR '&CWK' GT '&R2').ERR29C Reg invalid  93994800
         AGO   .EXEAX                        Done                       94001200
.EAXDFLT ANOP  ,                                                        94007600
&EAXV    SETC  '0'                           Default value              94014000
.EXEAX   ANOP  ,                                                        94020400
.*                                                                      94026800
.********************************************************************** 94033200
.*                                                                    * 94039600
.*       EK  parameter                       (0-15)                   * 94046000
.********************************************************************** 94052400
.*                                                                      94058800
&L1      SETA  0                             Minimum value              94065200
&L2      SETA  15                            Maximum value              94071600
         AIF   ('&EK' EQ '').EKDFLT          Take default               94078000
         AIF   (N'&EK GT 1).ERR31B           Too many sublists          94084400
&EKV     SETC  '&EK(1)'                      Value                      94090800
&OBYTE   SETA  &OBYTE+&OBPKC                 Set EK specified bit       94097200
         AIF   (T'&EK EQ 'N').EKDEC          Positive number       @P4C 94099000
         AIF   ('&EK'(1,1) EQ '-').ERR31     Negative value        @P4A 94100800
         AIF   ('&EK'(1,1) NE '(').EXEK      Must be a Constant    @P4A 94102600
         AIF   ('&EK'(2,1) EQ '-').ERR31     Negative value        @P4A 94104400
         AGO   .EXEK                         Done                  @P4A 94106200
.EKDEC   ANOP  ,                                                   @P4A 94108000
         AIF   (&EK(1) LT &L1 OR &EK(1) GT &L2).ERR31   Min/max value   94110000
         AGO   .EXEK                         Done                       94116400
.EKDFLT  ANOP  ,                                                        94122800
&EKV     SETC  '0'                           Default value              94129200
.EXEK    ANOP  ,                                                        94135600
.*                                                                      94142000
.********************************************************************** 94148400
.*                                                                    * 94154800
.*       EKM parameter                 (key list)                     * 94161200
.********************************************************************** 94167600
.*                                                                      94174000
         AIF   ('&EKM' EQ '').EXEKM    Take default of zero        @D2C 94180400
         AIF   ('&EKM' EQ '()').ERR32B No value within parens      @P2A 94186800
&L1      SETA  0                       Lower range value                94193200
&L2      SETA  15                      Upper range value                94199600
.*                                                                      94206000
.*                                     Reset the &IHBBIT bit array      94212400
&NDX     SETA  1                       Set index counter                94218800
.EKMRSET ANOP                          Loop to zero the bit array       94225200
&IHBBIT(&NDX) SETB 0                   Zero this bit                    94231600
&NDX     SETA  &NDX+1                  Increment the counter and        94238000
         AIF   (&NDX LE &IHBBITL).EKMRSET   loop for all bits           94244400
.*                                                                      94250800
.********************************************************************** 94257200
.*       Parse and isolate the lower and upper range value            * 94263600
.********************************************************************** 94270000
.*                                                                      94276400
.*                                 Process each sublist entry           94282800
&SUB     SETA  1                       Set sublist counter              94289200
.*                                                                      94295600
.EKMSET  ANOP  ,                       Loop for each sublist entry      94302000
         AIF   (T'&EKM(&SUB) EQ 'O').WAR32   Null sublist entry         94308400
&VALUE   SETC  '&EKM(&SUB)'            Isolate range sublist            94314800
.*                                                                      94321200
&RVAL    SETA  1                       First range value                94327600
&NDX     SETA  0                       Point at nothing                 94334000
&PAREN   SETA  0                       Initialize to no parens used     94340400
         AIF   ('&VALUE'(1,1) NE '(').EKMVALL  First char not '('       94346800
&PAREN   SETA  1                       Parenthesis used                 94353200
&NDX     SETA  1                       Point at parenthesis             94359600
.*                                                                      94366000
.********************************************************************** 94372400
.*                                                                      94378800
.EKMVALL ANOP                          Loop to isolate ranges           94385200
         AIF   (&RVAL GT 2).ERR32A     Too many entries                 94391600
&AWK     SETA  &NDX                    Index prior to number            94398000
.EKMCHRL ANOP                          Loop for number                  94404400
&NDX     SETA  &NDX+1                  Point to next character          94410800
         AIF   ('&VALUE'(&NDX,1) EQ ':').EKMSNUM    End of number       94417200
         AIF   ('&VALUE'(&NDX,1) EQ ')').EKMSNUM    End of number       94423600
         AIF   ('&VALUE'(&NDX,1) LT '0').ERR32A     Not decimal         94430000
         AIF   ('&VALUE'(&NDX,1) GT '9').ERR32A     Not decimal         94436400
         AIF   (&NDX LT K'&VALUE).EKMCHRL  Check next character         94442800
.EKMSNUM ANOP  ,                                                        94449200
         AIF   (&PAREN EQ 0).EKMSVAL      Number not in parens          94455600
         AIF   (&AWK+1 EQ &NDX).ERR32A    No number '(:' or ':)'        94462000
         AGO   .EKMRANG                   Go save value                 94468400
.EKMSVAL ANOP  ,                                                        94474800
         AIF   ('&VALUE'(&NDX,1) NE ':').EKMRANG    End of number       94481200
         AIF   (&NDX EQ K'&VALUE).ERR32A  Missing high range 'xx:'      94487600
&COLN    SETA  1                          Account for colon             94494000
.*                                                                      94500400
.EKMRANG ANOP  ,                          Save range value              94506800
&RANGE(&RVAL)  SETC  '&VALUE'(&AWK+1,&NDX-&AWK-&PAREN-&COLN)            94513200
&COLN    SETA  0                          Reset colon indicator         94519600
.*                                        Process next sublist entry    94526000
&RANGE(2) SETC '&RANGE(&RVAL)'            Set upper range...            94532400
&RVAL    SETA  &RVAL+1                    Next range value              94538800
         AIF   (&NDX LT K'&VALUE).EKMVALL  Another entry to process...  94545200
.*                                                                    * 94551600
.********************************************************************** 94558000
.*                                                                    * 94564400
         AIF   ('&RANGE(1)' LT '&L1').ERR32A  Less than lower bound     94570800
         AIF   ('&RANGE(2)' GT '&L2').ERR32A  Greater than upper bound  94577200
         AIF   ('&RANGE(1)' GT '&RANGE(2)').ERR32A  Invalid range       94583600
.*                                            Set the required bits     94590000
&AWK     SETA  &RANGE(1)-&L1+1                 Start bit position       94596400
.EKMBITL ANOP  ,                               Loop                     94602800
&IHBBIT(&AWK) SETB 1                           Set the required bit     94609200
&AWK     SETA  &AWK+1                          Next position            94615600
         AIF   (&AWK LE &RANGE(2)-&L1+1).EKMBITL  Loop for all bits     94622000
.*                                                                      94628400
.EKMNEXT ANOP  ,                                                        94634800
&SUB     SETA  &SUB+1                    Increment the counter          94641200
         AIF   (&SUB LE N'&EKM).EKMSET   and loop for each sublist      94647600
.*                                                                      94654000
.********************************************************************** 94660400
.*       Convert binary array (&IHBBIT) to decimal value              * 94666800
.********************************************************************** 94673200
.*                                                                    * 94679600
&AWK     SETA  1                            Binary power multiplier     94686000
&NDX     SETA  &IHBBITL                     Point at low order bit      94692400
&DECVAL  SETA  &IHBBIT(&NDX)                Initialize decimal value    94698800
.EKMDEC  ANOP  ,                                                        94705200
&NDX     SETA  &NDX-1                       Index to next bit           94711600
&AWK     SETA  &AWK*2                       Increment by power of 2     94718000
&DECVAL  SETA  &AWK*&IHBBIT(&NDX)+&DECVAL   Add to current value        94724400
         AIF   (&NDX GT 1).EKMDEC           Loop for all bits           94730800
&EKMV    SETA  &DECVAL                      Set result                  94737200
         AIF   (&DECVAL EQ 0).ERR32B        No bits were set       @P2A 94743600
.*                                                                      94750000
.********************************************************************** 94750400
.*       Check EKM for a system key (0-7) when CANCEL=NO              * 94750800
.********************************************************************** 94751200
.*                                                                      94751600
         AIF   ('&CANCEL' NE 'NO').EXEKM    CANCEL=NO not specifid @L2A 94752000
&NDX     SETA  0                            Init for indexing      @L2A 94752400
&EKMSYS  SETB  1                            Init system key found  @L2A 94752800
.EKMSYS  ANOP  ,                                                   @L2A 94753200
&NDX     SETA  &NDX+1                       Index to next bit      @L2A 94753600
         AIF   (&IHBBIT(&NDX) EQ 1).EXEKM   Exit if system key     @L2A 94754000
         AIF   (&NDX LE &SYSKEY).EKMSYS     Loop for all bits      @L2A 94754400
&EKMSYS  SETB  0                            No system key found    @L2A 94754800
.*                                                                      94755200
.EXEKM   ANOP  ,                                                        94756400
.*                                                                      94762800
.********************************************************************** 94769200
.*                                                                    * 94775600
.*       PARM1 parameter                      (user parm 1)           * 94782000
.********************************************************************** 94788400
.*                                                                      94794800
&L2      SETA  4                               Maximum length           94801200
         AIF   ('&PARM1' EQ '').PM1DFLT        Take default             94807600
         AIF   (N'&PARM1 GT 1).ERR43B          Too many sublists        94814000
         AIF   ('&TYPE(1)' EQ 'SET').PM1VAL    Continue                 94820400
         AIF   ('&PARM1'(1,1) EQ '(').ERR43    Register form invalid    94826800
.PM1VAL  ANOP  ,                                                        94833200
         AIF   ('&PARM1'(1,1) NE '''').PM1SET  Address or register      94839600
         AIF   (K'&PARM1-2 GT &L2).ERR43A      Maximum length           94846000
.PM1SET  ANOP  ,                                                        94852400
&PARM1V  SETC  '&PARM1'                        Value                    94858800
         AIF   ('&PARM1'(1,1) NE '(').EXPARM1  Not register form        94865200
         AIF   (T'&PARM1 NE 'N').EXPARM1        Must be a symbol        94871600
&AWK     SETA  K'&PARM1-2                       Length of register      94878000
&CWK     SETC  '&PARM1'(2,&AWK)                 Isolate register        94884400
         AIF   ('&CWK' LT '&R1' OR '&CWK' GT '&R2').ERR43C Reg invalid  94890800
         AGO   .EXPARM1                        Done                     94897200
.PM1DFLT ANOP ,                                                         94903600
&PARM1V  SETC  '0'                             Default value            94910000
.EXPARM1 ANOP  ,                                                        94916400
.*                                                                      94922800
.********************************************************************** 94929200
.*                                                                    * 94935600
.*       PARM2 parameter                       (user parm 2)          * 94942000
.********************************************************************** 94948400
.*                                                                      94954800
&L2      SETA  4                               Maximum length           94961200
         AIF   ('&PARM2' EQ '').PM2DFLT        Take default             94967600
         AIF   (N'&PARM2 GT 1).ERR44B          Too many sublists        94974000
         AIF   ('&TYPE(1)' EQ 'SET').PM2VAL    Continue                 94980400
         AIF   ('&PARM2'(1,1) EQ '(').ERR44    Register form invalid    94986800
.PM2VAL  ANOP  ,                                                        94993200
         AIF   ('&PARM2'(1,1) NE '''').PM2SET  Address or register      94999600
         AIF   (K'&PARM2-2 GT &L2).ERR44A      Maximum length           95006000
.PM2SET  ANOP  ,                                                        95012400
&PARM2V  SETC  '&PARM2'                        Value                    95018800
         AIF   ('&PARM2'(1,1) NE '(').EXPARM2  Not register form        95025200
         AIF   (T'&PARM2 NE 'N').EXPARM2        Must be a symbol        95031600
&AWK     SETA  K'&PARM2-2                       Length of register      95038000
&CWK     SETC  '&PARM2'(2,&AWK)                 Isolate register        95044400
         AIF   ('&CWK' LT '&R1' OR '&CWK' GT '&R2').ERR44C Reg invalid  95050800
         AGO   .EXPARM2                        Done                     95057200
.PM2DFLT ANOP ,                                                         95063600
&PARM2V  SETC  '0'                             Default value            95070000
.EXPARM2 ANOP  ,                                                        95076400
.*                                                                      95082800
.********************************************************************** 95089200
.*                                                                    * 95095600
.*       PC parameter                       ( STACKING | BASIC )      * 95102000
.********************************************************************** 95108400
.*                                                                      95114800
         AIF   ('&PC' EQ '').PCBITS         Set default value           95121200
         AIF   (N'&PC GT 1).ERR45B          Too many sublists           95127600
         AIF   ('&PC(1)' EQ 'STACKING').PCBITS   Default value          95134000
         AIF   ('&PC(1)' NE 'BASIC').ERR45       Error...               95140400
         AGO   .EXPC                        PC=BASIC                    95146800
.PCBITS ANOP ,                                                          95153200
&OBYTE   SETA  &OBYTE+&OBPCTC               PC=STACKING                 95159600
.EXPC ANOP ,                                                            95166000
.*                                                                      95172400
.********************************************************************** 95178800
.*                                                                    * 95185200
.*       PKM parameter                  ( OR | REPLACE )              * 95191600
.********************************************************************** 95198000
.*                                                                      95204400
         AIF   ('&PKM' EQ '').EXPKM         Set default value (OR)      95210800
         AIF   (N'&PKM GT 1).ERR46B         Too many sublists           95217200
         AIF   ('&PKM(1)' EQ 'OR').EXPKM    OR EKM with PKM             95223600
.*                                           in PKM Control reg         95230000
         AIF   ('&PKM(1)' NE 'REPLACE').ERR46 Error...                  95236400
&OBYTE   SETA  &OBYTE+&OBPKMC               REPLACE PKM                 95242800
.*                                           in PKM Control reg         95249200
.EXPKM   ANOP ,                                                         95255600
.*                                                                      95262000
.********************************************************************** 95268400
.*                                                                    * 95274800
.*       PROGRAM/ROUTINE parameters                                   * 95281200
.*                                    Mutually exclusive and required * 95287600
.********************************************************************** 95294000
.*                                                                      95300400
         AIF   ('&PROGRAM' EQ '').NOPROG1        PROGRAM not specified  95306800
         AIF   ('&ROUTINE' NE '').ERR48          ROUTINE specified too  95313200
         AIF   (N'&PROGRAM GT 1).ERR48B          Too many sublists @P1M 95319600
         AIF   ('&PROGRAM'(1,1) EQ '(').ERR48A   Register form invalid  95326000
&L2      SETA  8                                 Maximum name length    95332400
         AIF   ('&PROGRAM'(1,1) EQ '''').PROQUOT Are quotes used...     95338800
&PGM     SETC  '&PROGRAM'                        Set PROGRAM name       95345200
         AIF   (K'&PROGRAM GT &L2).ERR48C        Name too long          95351600
         AGO   .EXPROUT                                                 95358000
.PROQUOT ANOP  ,                                 Name in quotes         95364400
&PGM     SETC  '&PROGRAM'(2,K'&PROGRAM-2)        Set PROGRAM name       95370800
         AIF   (K'&PROGRAM-2 GT &L2).ERR48C      Name too long          95377200
         AGO   .EXPROUT                                                 95383600
.********************************************************************** 95390000
.*                                                                    * 95396400
.*       ROUTINE parameter                                            * 95402800
.********************************************************************** 95409200
.NOPROG1 ANOP  ,                                 Assume ROUTINE...      95415600
         AIF   ('&ROUTINE' EQ '').ERR49          ROUTINE not specified  95422000
         AIF   (N'&ROUTINE GT 1).ERR49B          Too many sublists      95428400
         AIF   ('&ROUTINE(1)' EQ '').ERR49D      ROUTINE=()        @P1A 95434800
         AIF   ('&TYPE(1)' EQ 'SET').RTNVAL      Continue               95441200
         AIF   ('&ROUTINE'(1,1) EQ '(').ERR49A   Register form invalid  95447600
.RTNVAL  ANOP  ,                                                        95454000
&RTNV    SETC  '&ROUTINE(1)'                     ROUTINE value     @D2A 95457200
         AIF   ('&ROUTINE'(1,1) NE '(').EXPROUT  Not register form      95460400
         AIF   (T'&ROUTINE NE 'N').EXPROUT       Must be a symbol       95466800
&AWK     SETA  K'&ROUTINE-2                      Length of register     95473200
&CWK     SETC  '&ROUTINE'(2,&AWK)                Isolate register       95479600
         AIF   ('&CWK' LT '&R1' OR '&CWK' GT '&R2').ERR49C Reg invalid  95486000
.EXPROUT ANOP  ,                                                        95492400
.*                                                                      95498800
.********************************************************************** 95505200
.*                                                                    * 95511600
.*       RAMODE parameter                   31 or 24                  * 95511900
.********************************************************************** 95512200
.*                                                                      95512500
         AIF   ('&RAMODE' EQ '').RAM31           Default AMODE=31  @D2A 95512800
         AIF   (N'&RAMODE GT 1).ERR50B           Too many sublists @D2A 95513100
         AIF   ('&RAMODE(1)' EQ '31').RAM31      Done              @D2A 95513400
         AIF   ('&RAMODE(1)' NE '24').ERR50A     Error             @D2A 95513700
&RTNAMOD SETC  'X''7F'''                         AMODE=24          @D2A 95514000
&AMOD    SETC  'NI'                              NI X'7F'          @D2A 95514300
         AGO   .EXRAMOD                          Done              @D2A 95514600
.RAM31   ANOP  ,                                                   @D2A 95514900
&RTNAMOD SETC  'X''80'''                         Default AMODE=31  @D2A 95515200
&AMOD    SETC  'OI'                              OI X'80'          @D2A 95515500
         AIF   ('&TYPE(1)' EQ 'SET').EXRAMOD     Done if TYPE=SET  @D2A 95515800
&RTNV    SETC  '&ROUTINE(1)+X''80000000'''       For TYPE=ENTRY    @D2A 95516100
.EXRAMOD ANOP  ,                                                   @D2A 95516400
.*                                                                      95516700
.********************************************************************** 95517000
.*                                                                    * 95517300
.*       SASN parameter                     ( OLD | NEW )             * 95518000
.********************************************************************** 95524400
.*                                                                      95530800
         AIF   ('&SASN' EQ '').EXSASN       Set default value (OLD)     95537200
         AIF   (N'&SASN GT 1).ERR52B        Too many sublists           95543600
         AIF   ('&SASN(1)' EQ 'OLD').EXSASN Default value SASN=PASN     95550000
         AIF   ('&SASN(1)' NE 'NEW').ERR52  Error...                    95556400
&OBYTE   SETA  &OBYTE+&OBSASN               SASN=PASN of stacking PC    95562800
.EXSASN  ANOP ,                                                         95569200
.*                                                                      95575600
.********************************************************************** 95582000
.*                                                                    * 95588400
.*       SSWITCH parameter                  ( NO | YES )              * 95594800
.********************************************************************** 95601200
.*                                             XM Space Switch          95607600
         AIF   ('&SSWITCH' EQ '').EXSSWIT      Set default value        95614000
         AIF   (N'&SSWITCH GT 1).ERR53B        Too many sublists        95620400
         AIF   ('&SSWITCH(1)' EQ 'NO').EXSSWIT Default                  95626800
         AIF   ('&SSWITCH(1)' NE 'YES').ERR53  Error                    95633200
&FBYTE   SETA  &FBYTE+&FBXMSS                  Space Switch             95639600
.EXSSWIT ANOP ,                                                         95646000
.*                                                                      95652400
.********************************************************************** 95658800
.*                                                                    * 95665200
.*       STATE parameter                    ( PROBLEM | SUPERVISOR )  * 95671600
.********************************************************************** 95678000
.*                                          Program Execution State     95684400
         AIF   ('&STATE' EQ '').EXSTATE     Set default value           95690800
         AIF   (N'&STATE GT 1).ERR54B       Too many sublists           95697200
         AIF   ('&STATE(1)' EQ 'PROBLEM').EXSTATE   Default value       95703600
         AIF   ('&STATE(1)' NE 'SUPERVISOR').ERR54  Error...            95710000
&FBYTE   SETA  &FBYTE+&FBSUP                Supervisor state            95716400
.EXSTATE ANOP ,                                                         95722800
.*                                                                      95729200
.********************************************************************** 95735600
.*                                                                    * 95742000
.*       Check for invalid parameter combinations                     * 95748400
.*                                                                    * 95754800
.********************************************************************** 95761200
         AIF   ('&PC(1)' NE 'BASIC').PCBASIC   PC is not BASIC          95767600
.*                                        PC=BASIC not valid with...    95774000
&NDX     SETA  0                            Init index counter     @L2C 95779200
.PCBLOOP ANOP  ,                            Beginning of loop      @L2C 95784400
&NDX     SETA  &NDX+1                       Increment counter      @L2C 95789600
         AIF   (&NDX GT &K5SIZE).PCBASIC    End of list?           @L2C 95794800
         AIF   ('&KEYS5(&NDX)' EQ '').PCBLOOP Value not specified  @L2C 95800000
         MNOTE 8,' &KEYN5(&NDX) &EM(8)'     Not valid with ENTRY   @L2C 95805200
&IHBERR  SETB  1                            Indicate error         @L2C 95810400
         AGO   .PCBLOOP                     Loop back              @L2C 95815600
.*                                                                      95820800
.PCBASIC ANOP  ,                          End of PC=BASIC checking      95826000
.*--------------------------------------------------------------------- 95831200
.*             If STATE=PROBLEM and EK specified - EKM required    @D3A 95836400
         AIF   ('&STATE' EQ 'PROBLEM' AND '&EK' NE '' AND '&EKM' EQ '')X95841600
               .ERR32C                                             @D3A 95846800
.EKMREQA ANOP  ,                                                   @D3A 95852000
.*                            If PKM=REPLACE then EKM is required  @D2A 95858100
         AIF   ('&PKM(1)' EQ 'REPLACE' AND '&EKM' EQ '').ERR32     @D2A 95859000
.EKMREQD ANOP  ,                                                   @D2A 95859900
.*                            RAMODE is valid only with ROUTINE    @D2A 95860800
         AIF   ('&RAMODE' NE '' AND '&ROUTINE' EQ '').ERR50        @D2A 95861700
.RTNOPT  ANOP  ,                                                   @D2A 95862600
.*--------------------------------------------------------------------- 95863000
.*                            ASYNCH is valid only with ARR        @L2A 95863400
         AIF   ('&ASYNCH' NE '' AND '&ARR' EQ '').ERR27C           @L2A 95863800
.ASYARR  ANOP  ,                                                   @L2A 95864200
.*                            CANCEL is valid only with ARR        @L2A 95864600
         AIF   ('&CANCEL' NE '' AND '&ARR' EQ '').ERR28C           @L2A 95865000
.CANARR  ANOP  ,                                                   @L2A 95865400
.*              CANCEL=NO is valid when the PC routine is in            95865800
.*              supervisor state, or EKM has a system key, or           95866200
.*              AKM has only system keys and PKM=OR                @L2A 95866600
         AIF   ('&CANCEL' EQ '' OR '&CANCEL' EQ 'YES').CANPCSK     @L2A 95867000
         AIF   ('&STATE' EQ 'SUPERVISOR').CANPCSK                  @L2A 95867400
         AIF   (&EKMSYS EQ 1).CANPCSK        System key specified  @D4C 95867800
         AIF   (&AKMUSER EQ 1 OR '&PKM' EQ 'REPLACE').ERR28D       @D4C 95868200
.CANPCSK ANOP  ,                                                   @L2A 95868600
.*                                                                      95869000
.********************************************************************** 95870000
.*                                                                    * 95876400
.*       Generate or set Entry Table Descriptor entry                 * 95882800
.*                                                                    * 95889200
.********************************************************************** 95895600
.*                                                                      95902000
         AIF   ('&TYPE(1)' EQ 'SET').ETDSET    Go reset table           95908400
.*                                                                      95914800
.********************************************************************** 95921200
.*                                                                    * 95927600
.*       GENERATE Entry Table Descriptor entry for                    * 95934000
.*                TYPE=ENTRY                                          * 95940400
.*                                                                    * 95946800
.********************************************************************** 95953200
.*                                                                      95959600
         AIF   ('&IHAETDN' EQ '').ERR08    Ensure INITIAL specified     95966000
         AIF   (&IHBERR EQ 1).EXIT         Exit if errors encountered   95972400
.*                                                                      95978800
&NAME    DC    AL1(&IHAETDI)       INDEX FOR THIS ENTRY                 95985200
&IHAETDI SETA  &IHAETDI+1          Increment ENTRY counter              95991600
         DC    AL1(&FBYTE)         FLAG BYTE                            95998000
         DC    H'0'                RESERVED                             96004400
.*                                            Generate PROGRAM name     96010800
.*                                             or ROUTINE address.      96017200
         AIF   ('&PROGRAM' EQ '').NOPROG2        No PROGRAM             96023600
         DC    CL8'&PGM'           PROGRAM NAME                         96030000
         AGO   .PGMRTNZ                                                 96036400
.NOPROG2 ANOP  ,                                 ROUTINE address        96042800
         DC    A(0)                ZERO PADDING                         96049200
         DC    A(&RTNV)            ROUTINE ADDRESS                 @D2C 96055600
.PGMRTNZ ANOP  ,                                                        96062000
.*                                 Generate AKM and EKM.                96068400
         DC    AL2(&AKMV)          AUTHORIZATION KEY MASK               96074800
         DC    AL2(&EKMV)          ENTRY KEY MASK                       96081200
.*                                                                      96087600
.*                                 Generate USER PARM 1                 96094000
         AIF   ('&PARM1V'(1,1) NE '''').PRM1ADR   Not quoted string     96100400
         DC    CL4&PARM1V          PARAMETER 1                          96106800
         AGO   .PARMX                                                   96113200
.PRM1ADR ANOP  ,                                                        96119600
         DC    A(&PARM1V)          PARAMETER 1                          96126000
.PARMX   ANOP  ,                                                        96132400
.*                                                                      96138800
.********************************************************************** 96145200
.*             FORMAT=1 extension                                     * 96151600
.********************************************************************** 96158000
.*                                 Generate option byte and EAX.        96164400
         DC    AL1(&OBYTE)         ETD OPTIONS BYTE 1                   96170800
         DC    AL1(&EKV.*16)       ENTRY KEY (HIGH ORDER 4 BITS)        96177200
         DC    AL2(&EAXV)          EXTENDED AUTHORIZATION INDEX         96183600
.*                                                                      96190000
.*                                 Generate ARR                         96196400
         AIF   ('&ARRV'(1,1) NE '''').ARRADR   Not quoted string        96202800
         DC    CL8&ARRV            ASSOCIATED RECOVERY ROUTINE NAME     96209200
         AGO   .ARRVX                                                   96215600
.ARRADR  ANOP  ,                                                        96222000
         DC    A(0)                ZERO PADDING                         96228400
         DC    A(&ARRV)            ASSOCIATED RECOVERY ROUTINE ADDRESS  96234800
.ARRVX   ANOP  ,                                                        96241200
.*                                                                      96247600
.*                                 Generate USER PARM 2                 96254000
         AIF   ('&PARM2V'(1,1) NE '''').PRM2ADR   Not quoted string     96260400
         DC    CL4&PARM2V          PARAMETER 2                          96266800
         AGO   .PARM2X                                                  96273200
.PRM2ADR ANOP  ,                                                        96279600
         DC    A(&PARM2V)          PARAMETER 2                          96286000
.PARM2X  ANOP  ,                                                        96292400
.*                                                                      96298800
         DC    AL1(&LPAFB1)        LPA FLAG BYTE 1                 @L2A 96303000
         DC    XL3'0'              RESERVED - MUST BE ZERO         @L2C 96307200
         AGO   .EXIT                                                    96311600
.********************************************************************** 96318000
.*                                                                    * 96324400
.*       SET  Entry Table Descriptor entry for                        * 96330800
.*              TYPE=SET,ETEADR=addr                                  * 96337200
.*                                                                    * 96343600
.********************************************************************** 96350000
.ETDSET  ANOP  ,                                                        96356400
         AIF   (&IHBERR EQ 1).EXIT         Exit if errors encountered   96362800
         AIF   ('&ENTV'(1,1) EQ '+').SETSYM    Symbol form              96369200
.*--------------------------------------------------------------------* 96375600
.*                                             BASE-Register form       96382000
&NAME    MVI   &ETDFLG.(&ENTV),&FBYTE          FLAG BYTE                96388400
.*                                             Reset the PROGRAM name   96394800
.*                                              or ROUTINE address.     96401200
         AIF   ('&PROGRAM' EQ '').RNOPRO3      No PROGRAM name          96407600
&CWK     SETC  '&ETDPRO.(&ETDPROL,&ENTV)'      Target of MVC            96414000
         MVC   &CWK,=CL8'&PGM'                 PROGRAM NAME             96420400
         AGO   .RPGMX                                                   96426800
.RNOPRO3 ANOP  ,                                                        96433200
.*                                             ROUTINE address          96439600
         MVC   &ETDPRO1.(&ETDPR1L,&ENTV),=F'0' ZEROS                    96446000
         AIF   ('&ROUTINE'(1,1) EQ '(').RRTNREG Register format         96452400
&CWK     SETC  '&ETDPRO2.(&ETDPR2L,&ENTV)'      Target of MVC           96458800
         MVC   &CWK,=A(&RTNV)                  ROUTINE ADDRESS     @D2C 96465200
         AGO   .RPGMX                                                   96471600
.RRTNREG ANOP  ,                                                        96478000
         ST    &RTNV,&ETDPRO2.(,&ENTV)         ROUTINE ADDRESS     @D2C 96484400
.RPGMX   ANOP  ,                                                        96490800
         &AMOD &ETDPRO2.(&ENTV),&RTNAMOD       AMODE QUALIFIER     @D2A 96494000
.*                                             Reset the AKM and EKM    96497200
&CWK     SETC  '&ETDAKM.(&ETDAKML,&ENTV)'      Target of MVC            96503600
         MVC   &CWK,=AL2(&AKMV)                AKM                      96510000
&CWK     SETC  '&ETDEKM.(&ETDEKML,&ENTV)'      Target of MVC            96516400
         MVC   &CWK,=AL2(&EKMV)                EKM                      96522800
.*                                                                      96529200
.*                                             Reset USER PARM 1.       96535600
         AIF   ('&PARM1V'(1,1) EQ '(').RPRMREG Register format          96542000
&CWK     SETC  '&ETDPAR.(&ETDPA1L,&ENTV)'      Target of MVC            96548400
         AIF   ('&PARM1V'(1,1) EQ '''').RPRMQU Enclosed in quotes       96554800
         MVC   &CWK,=A(&PARM1V)                PARAMETER 1              96561200
         AGO   .RPRM1X                                                  96567600
.RPRMQU  ANOP  ,                                                        96574000
         MVC   &CWK,=CL4&PARM1V                PARAMETER 1              96580400
         AGO   .RPRM1X                                                  96586800
.RPRMREG ANOP  ,                                                        96593200
         ST    &PARM1(1),&ETDPAR.(,&ENTV)      PARAMETER 1              96599600
.RPRM1X  ANOP  ,                                                        96606000
.*                                                                      96612400
.********************************************************************** 96618800
.*             FORMAT=1 extension              (BASE-register form)   * 96625200
.********************************************************************** 96631600
.*                                                                      96638000
         MVI   &ETDOPT1.(&ENTV),&OBYTE         ETD OPTION BYTE 1        96644400
.*                                             Reset the EK             96650800
         MVI   &ETDEK.(&ENTV),&EKV.*16         ENTRY KEY (HIGH 4 BITS)  96657200
.*                                             Reset the EAX            96663600
         AIF   ('&EAXV'(1,1) EQ '(').REAXREG   Register format          96670000
&CWK     SETC  '&ETDEAX.(&ETDEAXL,&ENTV)'      Target of MVC            96676400
         AIF   (T'&EAX EQ 'O').REAXDEC         Default value       @P5A 96680600
         AIF   (T'&EAX EQ 'N').REAXDEC         Positive number          96684800
         MVC   &CWK,&EAXV                      EAX                      96689200
         AGO   .REAXX                                                   96695600
.REAXDEC ANOP ,                                                         96702000
         MVC   &CWK,=AL2(&EAXV)                EAX                      96708400
         AGO   .REAXX                                                   96714800
.REAXREG ANOP  ,                                                        96721200
         STH   &EAX(1),&ETDEAX.(,&ENTV)        EAX                      96727600
.REAXX   ANOP  ,                                                        96734000
.*                       Reset the ASSOCIATED RECOVERY ROUTINE ADDRESS  96740400
         AIF   ('&ARRV'(1,1) NE '''').RNOARRQ  Not ARR quoted name      96746800
&CWK     SETC  '&ETDARR.(&ETDARRL,&ENTV)'      Target of MVC            96753200
         MVC   &CWK,=CL8&ARRV                  ASSOC RECOVERY RTN NAME  96759600
         AGO   .RARRX                                                   96766000
.RNOARRQ ANOP  ,                                                        96772400
.*                                             ARR address              96778800
         MVC   &ETDARR1.(&ETDAR1L,&ENTV),=F'0' ZEROS                    96785200
         AIF   ('&ARRV'(1,1) EQ '(').RARRREG   Register format          96791600
&CWK     SETC  '&ETDARR2.(&ETDAR2L,&ENTV)'      Target of MVC           96798000
         MVC   &CWK,=A(&ARRV)                  ASSOC RECOVERY RTN ADDR  96804400
         AGO   .RARRX                                                   96810800
.RARRREG ANOP  ,                                                        96817200
         ST    &ARR(1),&ETDARR2.(,&ENTV)       ASSOC RECOVERY RTN ADDR  96823600
.RARRX   ANOP  ,                                                        96830000
.*                                             Reset USER PARM2         96836400
         AIF   ('&PARM2V'(1,1) EQ '(').RPM2REG Register format          96842800
&CWK     SETC  '&ETDPAR2.(&ETDPA2L,&ENTV)'     Target of MVC            96849200
         AIF   ('&PARM2V'(1,1) EQ '''').RPM2QU Enclosed in quotes       96855600
         MVC   &CWK,=A(&PARM2V)                PARAMETER 2              96862000
         AGO   .RPRM2X                                                  96868400
.RPM2QU  ANOP  ,                                                        96874800
         MVC   &CWK,=CL4&PARM2V                PARAMETER 2              96881200
         AGO   .RPRM2X                                                  96887600
.RPM2REG ANOP ,                                                         96894000
         ST    &PARM2(1),&ETDPAR2.(,&ENTV)     PARAMETER 2              96900400
.RPRM2X  ANOP  ,                                                        96906800
         MVI   &ETDLPA1.(&ENTV),&LPAFB1        LPA FLAG BYTE 1     @L2A 96910000
         AGO   .EXIT                                                    96913200
.*                                                                      96919600
.*--------------------------------------------------------------------* 96926000
.SETSYM  ANOP  ,                                                        96932400
.*                                             BASE-Symbol form         96938800
&NAME    MVI   &ETDFLG.&ENTV,&FBYTE            FLAG BYTE                96945200
.*                                             Reset the PROGRAM name   96951600
.*                                              or ROUTINE address.     96958000
         AIF   ('&PROGRAM' EQ '').SNOPRO3      No PROGRAM name          96964400
&CWK     SETC  '&ETDPRO.&ENTV.(&ETDPROL)'      Target of MVC            96970800
         MVC   &CWK,=CL8'&PGM'                 PROGRAM NAME             96977200
         AGO   .SPGMX                                                   96983600
.SNOPRO3 ANOP  ,                                                        96990000
.*                                             ROUTINE address          96996400
         MVC   &ETDPRO1.&ENTV.(&ETDPR1L),=F'0' ZEROS                    97002800
         AIF   ('&ROUTINE'(1,1) EQ '(').SRTNREG Register format         97009200
&CWK     SETC  '&ETDPRO2.&ENTV.(&ETDPR2L)'      Target of MVC           97015600
         MVC   &CWK,=A(&RTNV)                  ROUTINE ADDRESS     @D2C 97022000
         AGO   .SPGMX                                                   97028400
.SRTNREG ANOP  ,                                                        97034800
         ST    &RTNV,&ETDPRO2.&ENTV            ROUTINE ADDRESS     @D2C 97041200
.SPGMX   ANOP  ,                                                        97047600
         &AMOD &ETDPRO2.&ENTV,&RTNAMOD         AMODE QUALIFIER     @D2A 97050800
.*                                             Reset the AKM and EKM    97054000
&CWK     SETC  '&ETDAKM.&ENTV.(&ETDAKML)'      Target of MVC            97060400
         MVC   &CWK,=AL2(&AKMV)                AKM                      97066800
&CWK     SETC  '&ETDEKM.&ENTV.(&ETDEKML)'      Target of MVC            97073200
         MVC   &CWK,=AL2(&EKMV)                EKM                      97079600
.*                                                                      97086000
.*                                             Reset USER PARM 1.       97092400
         AIF   ('&PARM1V'(1,1) EQ '(').SPRMREG Register format          97098800
&CWK     SETC  '&ETDPAR.&ENTV.(&ETDPA1L)'      Target of MVC            97105200
         AIF   ('&PARM1V'(1,1) EQ '''').SPRMQU Enclosed in quotes       97111600
         MVC   &CWK,=A(&PARM1V)                PARAMETER 1              97118000
         AGO   .SPRM1X                                                  97124400
.SPRMQU  ANOP  ,                                                        97130800
         MVC   &CWK,=CL4&PARM1V                PARAMETER 1              97137200
         AGO   .SPRM1X                                                  97143600
.SPRMREG ANOP  ,                                                        97150000
         ST    &PARM1(1),&ETDPAR.&ENTV         PARAMETER 1              97156400
.SPRM1X  ANOP  ,                                                        97162800
.*                                                                      97169200
.********************************************************************** 97175600
.*             FORMAT=1 extension              (BASE-symbol form)     * 97182000
.********************************************************************** 97188400
.*                                                                      97194800
         MVI   &ETDOPT1.&ENTV,&OBYTE           ETD OPTION BYTE 1        97201200
.*                                             Reset the EK             97207600
         MVI   &ETDEK.&ENTV,&EKV.*16           ENTRY KEY (HIGH 4 BITS)  97214000
.*                                             Reset the EAX            97220400
         AIF   ('&EAXV'(1,1) EQ '(').SEAXREG   Register format          97226800
&CWK     SETC  '&ETDEAX.&ENTV.(&ETDEAXL)'      Target of MVC            97233200
         AIF   (T'&EAX EQ 'O').SEAXDEC         Default value       @P5A 97237400
         AIF   (T'&EAX EQ 'N').SEAXDEC         Positive number          97241600
         MVC   &CWK,&EAXV                      EAX                      97246000
         AGO   .SEAXX                                                   97252400
.SEAXDEC ANOP ,                                                         97258800
         MVC   &CWK,=AL2(&EAXV)                EAX                      97265200
         AGO   .SEAXX                                                   97271600
.SEAXREG ANOP  ,                                                        97278000
         STH   &EAX(1),&ETDEAX.&ENTV           EAX                      97284400
.SEAXX   ANOP  ,                                                        97290800
.*                       Reset the ASSOCIATED RECOVERY ROUTINE ADDRESS  97297200
         AIF   ('&ARRV'(1,1) NE '''').SNOARRQ  Not ARR quoted name      97303600
&CWK     SETC  '&ETDARR.&ENTV.(&ETDARRL)'      Target of MVC            97310000
         MVC   &CWK,=CL8&ARRV                  ASSOC RECOVERY RTN NAME  97316400
         AGO   .SARRX                                                   97322800
.SNOARRQ ANOP  ,                                                        97329200
.*                                             ARR address              97335600
         MVC   &ETDARR1.&ENTV.(&ETDAR1L),=F'0' ZEROS                    97342000
         AIF   ('&ARRV'(1,1) EQ '(').SARRREG   Register format          97348400
&CWK     SETC  '&ETDARR2.&ENTV.(&ETDAR2L)'      Target of MVC           97354800
         MVC   &CWK,=A(&ARRV)                  ASSOC RECOVERY RTN ADDR  97361200
         AGO   .SARRX                                                   97367600
.SARRREG ANOP  ,                                                        97374000
         ST    &ARR(1),&ETDARR2.&ENTV          ASSOC RECOVERY RTN ADDR  97380400
.SARRX   ANOP  ,                                                        97386800
.*                                             Reset USER PARM2         97393200
         AIF   ('&PARM2V'(1,1) EQ '(').SPM2REG Register format          97399600
&CWK     SETC  '&ETDPAR2.&ENTV.(&ETDPA2L)'     Target of MVC            97406000
         AIF   ('&PARM2V'(1,1) EQ '''').SPM2QU Enclosed in quotes       97412400
         MVC   &CWK,=A(&PARM2V)                PARAMETER 2              97418800
         AGO   .SPRM2X                                                  97425200
.SPM2QU  ANOP  ,                                                        97431600
         MVC   &CWK,=CL4&PARM2V                PARAMETER 2              97438000
         AGO   .SPRM2X                                                  97444400
.SPM2REG ANOP ,                                                         97450800
         ST    &PARM2(1),&ETDPAR2.&ENTV        PARAMETER 2              97457200
.SPRM2X  ANOP  ,                                                        97463600
         MVI   &ETDLPA1.&ENTV,&LPAFB1          LPA FLAG BYTE 1     @L2A 97466800
         AGO   .EXIT                                                    97470000
.*                                                                      97476400
.********************************************************************** 97482800
.*                                                                    * 97489200
.*       MNOTES                                                       * 97495600
.*                                                                    * 97502000
.********************************************************************** 97508400
.*                                                                      97514800
.ERR01   ANOP  ,                                                        97521200
         MNOTE 8,' TOO MANY POSITIONAL PARAMETERS'                      97527600
&IHBERR  SETB  1                    Indicate error                      97534000
         AGO   .EXPOS               Continue keyword validation         97540400
.*                                                                      97546800
.ERR02   ANOP  ,                                                        97553200
         MNOTE 8,' TYPE PARAMETER IS REQUIRED'                          97559600
         AGO   .EXIT                Done                                97566000
.*                                                                      97572400
.ERR02A  ANOP  ,                                                   @P1C 97578800
         MNOTE 8,' TYPE &EM(4)'     Too many sublists              @P1C 97585200
&IHBERR  SETB  1                    Indicate error                      97591600
         AGO   .CKTYPE              Continue keyword validation         97598000
.*                                                                      97604400
.ERR02B  ANOP  ,                                                   @P1A 97610800
         MNOTE 8,' TYPE &EM(9)'     Missing sublist value          @P1A 97617200
         AGO   .EXIT                Done                           @P1A 97623600
.*                                                                      97630000
.ERR04   ANOP  ,                                                        97636400
         MNOTE 8,' TYPE PARAMETER IS NOT VALID - &TYPE'                 97642800
         AGO   .EXIT                Done                                97649200
.*                                                                      97655600
.ERR08   ANOP  ,                                                        97662000
         MNOTE 8,' ETDEF TYPE=&TYPE IS NOT PRECEDED BY ETDEF TYPE=INITIX97668400
               AL'                                                      97674800
         AGO   .EXIT                Done                                97681200
.*                                                                      97687600
.ERR09   ANOP  ,                                                        97694000
       MNOTE 8,' ETEADR OR HEADER MUST BE SPECIFIED WHEN TYPE=&TYPE'    97700400
         AGO   .EXIT                Done                                97706800
.********************************************************************** 97713200
.ERR22   ANOP  ,                                                        97719600
         MNOTE 8,' AKM &EM(5)'      Parameter is required               97726000
&IHBERR  SETB  1                    Indicate error                      97732400
         AGO   .EXAKM               Continue keyword validation         97738800
.*                                                                      97745200
.WAR22   ANOP    ,                                                      97751600
         MNOTE 4,' AKM &EM(6) &SUB - IGNORED'     Missing sublist  @P1C 97758000
         AGO   .AKMNEXT             Continue sublist validation         97764400
.*                                                                      97770800
.ERR22A  ANOP  ,                                                        97777200
         MNOTE 8,' AKM PARAMETER SUBLIST VALUE IS NOT VALID - &VALUE '  97783600
&IHBERR  SETB  1                    Indicate error                      97790000
         AGO   .AKMNEXT             Continue sublist validation         97796400
.*                                                                      97802800
.ERR22B  ANOP  ,                                                   @P2A 97809200
         MNOTE 8,' AKM &EM(9)'      No valid value                 @P2A 97815600
&IHBERR  SETB  1                    Indicate error                 @P2A 97822000
         AGO   .EXAKM               Continue keyword validation    @P2A 97828400
.********************************************************************** 97834800
.ERR25   ANOP  ,                                                        97841200
         MNOTE 8,' ARR &EM(7)'      Not use a register                  97847600
&IHBERR  SETB  1                    Indicate error                      97854000
         AGO   .EXARR               Continue keyword validation         97860400
.*                                                                      97866800
.ERR25A  ANOP  ,                                                   @D1A 97873200
         MNOTE 8,' ARR MUST BE FROM 1 TO &L2 CHARACTERS'           @D1A 97879600
&IHBERR  SETB  1                    Indicate error                 @D1A 97886000
         AGO   .EXARR               Continue keyword validation    @D1A 97892400
.*                                                                      97898800
.ERR25B  ANOP  ,                                                        97905200
         MNOTE 8,' ARR &EM(4)'      Too many sublists                   97911600
&IHBERR  SETB  1                    Indicate error                      97918000
         AGO   .EXARR               Continue keyword validation         97924400
.*                                                                      97930800
.ERR25C  ANOP  ,                                                        97937200
         MNOTE 8,' ARR MUST USE REGISTER &R1 THRU &R2'                  97943600
&IHBERR  SETB  1                    Indicate error                      97950000
         AGO   .EXARR               Continue keyword validation         97956400
.*                                                                      97962800
.********************************************************************** 97994800
.ERR26   ANOP  ,                                                        98001200
         MNOTE 8,' ASCMODE PARAMETER MUST BE ''PRIMARY'' OR ''AR'''     98007600
&IHBERR  SETB  1                    Indicate error                      98014000
         AGO   .EXASCM              Continue keyword validation         98020400
.*                                                                      98026800
.ERR26B  ANOP  ,                                                        98033200
         MNOTE 8,' ASCMODE &EM(4)'  Too many sublists                   98039600
&IHBERR  SETB  1                    Indicate error                      98046000
         AGO   .EXASCM              Continue keyword validation         98052400
.*                                                                      98058800
.********************************************************************** 98090800
.ERR27   ANOP  ,                                                   @L2A 98090900
         MNOTE 8,' ASYNCH &EM(10)'  Must be YES or NO              @L2A 98091000
&IHBERR  SETB  1                    Indicate error                 @L2A 98091100
         AGO   .EXASYNC             Continue keyword validation    @L2A 98091200
.*                                                                 @L2A 98091300
.ERR27B  ANOP  ,                                                   @L2A 98091400
         MNOTE 8,' ASYNCH &EM(4)'   Too many sublists              @L2A 98091500
&IHBERR  SETB  1                    Indicate error                 @L2A 98091600
         AGO   .EXASYNC             Continue keyword validation    @L2A 98091700
.*                                                                 @L2A 98091800
.ERR27C  ANOP  ,                                                   @L2A 98091900
         MNOTE 8,' ASYNCH &EM(11) ARR' Invalid without ARR         @L2A 98092000
&IHBERR  SETB  1                    Indicate error                 @L2A 98092100
         AGO   .ASYARR              Continue keyword validation    @L2A 98092200
.********************************************************************** 98092300
.ERR28   ANOP  ,                                                   @L2A 98092400
         MNOTE 8,' CANCEL &EM(10)'  Must be YES or NO              @L2A 98092500
&IHBERR  SETB  1                    Indicate error                 @L2A 98092600
         AGO   .EXCANCL             Continue keyword validation    @L2A 98092700
.*                                                                 @L2A 98092800
.ERR28B  ANOP  ,                                                   @L2A 98092900
         MNOTE 8,' CANCEL &EM(4)'   Too many sublists              @L2A 98093000
&IHBERR  SETB  1                    Indicate error                 @L2A 98093100
         AGO   .EXCANCL             Continue keyword validation    @L2A 98093200
.*                                                                 @L2A 98093300
.ERR28C  ANOP  ,                                                   @L2A 98093400
         MNOTE 8,' CANCEL &EM(11) ARR' Invalid without ARR         @L2A 98093500
&IHBERR  SETB  1                    Indicate error                 @L2A 98093600
         AGO   .CANARR              Continue keyword validation    @L2A 98093700
.*                                                                 @L2A 98093800
.ERR28D  ANOP  ,                                                   @L2A 98093900
         MNOTE 8,' CANCEL=NO IS ONLY VALID WHEN THE PC ROUTINE IS IN SU*98094000
               PERVISOR   STATE, OR EKM SPECIFIED A SYSTEM KEY, OR AKM *98094100
               HAS ONLY   SYSTEM KEYS AND PKM=OR.'                 @L2A 98094200
&IHBERR  SETB  1                    Indicate error                 @L2A 98094300
         AGO   .CANPCSK             Continue keyword validation    @L2A 98094400
.********************************************************************** 98094500
.ERR29   ANOP  ,                                                        98097200
         MNOTE 8,' EAX &EM(7)'      Not use a register                  98103600
&IHBERR  SETB  1                    Indicate error                      98110000
         AGO   .EXEAX               Continue keyword validation         98116400
.*                                                                      98122800
.ERR29A  ANOP  ,                                                   @P4A 98123800
         MNOTE 8,' EAX PARAMETER IS NOT VALID - &EAX(1) '          @P4A 98124800
&IHBERR  SETB  1                    Indicate error                 @P4A 98125800
         AGO   .EXEAX               Continue sublist validation    @P4A 98126800
.*                                                                      98127800
.ERR29B  ANOP  ,                                                        98129200
         MNOTE 8,' EAX &EM(4)'      Too many sublists                   98135600
&IHBERR  SETB  1                    Indicate error                      98142000
         AGO   .EXEAX               Continue keyword validation         98148400
.*                                                                      98154800
.ERR29C  ANOP  ,                                                        98161200
         MNOTE 8,' EAX MUST USE REGISTER &R1 THRU &R2'                  98167600
&IHBERR  SETB  1                    Indicate error                      98174000
         AGO   .EXEAX               Continue keyword validation         98180400
.*                                                                      98186800
.********************************************************************** 98218800
.ERR31   ANOP  ,                                                        98225200
        MNOTE 8,' EK PARAMETER MUST BE A DECIMAL VALUE FROM &L1 TO &L2' 98231600
&IHBERR  SETB  1                    Indicate error                      98238000
         AGO   .EXEK                Continue keyword validation         98244400
.*                                                                      98250800
.ERR31B  ANOP  ,                                                        98257200
         MNOTE 8,' EK &EM(4)'       Too many sublists                   98263600
&IHBERR  SETB  1                    Indicate error                      98270000
         AGO   .EXEK                Continue keyword validation         98276400
.*                                                                      98282800
.********************************************************************** 98314800
.ERR32   ANOP  ,                                                        98321200
         MNOTE 8,' EKM PARAMETER IS REQUIRED WITH PKM=REPLACE'     @D2C 98327600
&IHBERR  SETB  1                    Indicate error                      98334000
         AGO   .EKMREQD             Continue keyword validation    @D2C 98340400
.*                                                                      98346800
.WAR32   ANOP    ,                                                      98353200
         MNOTE 4,' EKM &EM(6) &SUB - IGNORED'     Missing sublist  @P1C 98359600
         AGO   .EKMNEXT             Continue sublist validation         98366000
.*                                                                      98372400
.ERR32A  ANOP  ,                                                        98378800
         MNOTE 8,' EKM PARAMETER SUBLIST VALUE IS NOT VALID - &VALUE '  98385200
&IHBERR  SETB  1                    Indicate error                      98391600
         AGO   .EKMNEXT             Continue sublist validation         98398000
.*                                                                      98404400
.ERR32B  ANOP  ,                                                   @P2A 98410800
         MNOTE 8,' EKM &EM(9)'      No valid value                 @P2A 98417200
&IHBERR  SETB  1                    Indicate error                 @P2A 98423600
         AGO   .EXEKM               Continue keyword validation    @P2A 98430000
.*                                                                      98431000
.ERR32C  ANOP  ,                                                   @D3A 98432000
        MNOTE 8,' EKM PARAMETER IS REQUIRED WITH EK AND STATE=PROBLEM'  98433000
&IHBERR  SETB  1                    Indicate error                 @D3A 98434000
         AGO   .EKMREQA             Continue keyword validation    @D3A 98435000
.********************************************************************** 98436400
.ERR34   ANOP  ,                                                        98442800
         MNOTE 8,' ETEADR MUST USE REGISTER &ER1 THRU &ER2'             98449200
&IHBERR  SETB  1                    Indicate error                      98455600
         AGO   .EXETEAD             Continue keyword validation         98462000
.*                                                                      98468400
.ERR34B  ANOP  ,                                                        98474800
         MNOTE 8,' ETEADR &EM(4)'   Too many sublists                   98481200
&IHBERR  SETB  1                    Indicate error                      98487600
         AGO   .EXETEAD             Continue keyword validation         98494000
.********************************************************************** 98500400
.ERR37A  ANOP  ,                                                        98506800
         MNOTE 8,' HEADER MUST USE REGISTER &ER1 THRU &ER2'             98513200
&IHBERR  SETB  1                    Indicate error                      98519600
         AGO   .EXHEAD              Continue keyword validation         98526000
.*                                                                      98532400
.ERR37B  ANOP  ,                                                        98538800
         MNOTE 8,' HEADER &EM(4)'   Too many sublists                   98545200
&IHBERR  SETB  1                    Indicate error                      98551600
         AGO   .EXHEAD              Continue keyword validation         98558000
.********************************************************************** 98564400
.ERR39   ANOP  ,                                                        98570800
         MNOTE 8,' NUMETE PARAMETER IS REQUIRED WITH HEADER'            98577200
&IHBERR  SETB  1                    Indicate error                      98583600
         AGO   .EXNUMET             Continue keyword validation         98590000
.*                                                                      98596400
.ERR39A  ANOP  ,                                                        98602800
         MNOTE 8,' NUMETE PARAMETER MUST BE A DECIMAL VALUE FROM &L1 TOX98609200
                &L2'                                                    98615600
&IHBERR  SETB  1                    Indicate error                      98622000
         AGO   .EXNUMET             Continue keyword validation         98628400
.*                                                                      98634800
.ERR39B  ANOP  ,                                                        98641200
         MNOTE 8,' NUMETE &EM(4)'   Too many sublists                   98647600
&IHBERR  SETB  1                    Indicate error                      98654000
         AGO   .EXNUMET             Continue keyword validation         98660400
.*                                                                      98666800
.ERR39C  ANOP  ,                                                        98673200
         MNOTE 8,' NUMETE MUST USE REGISTER &R1 THRU &R2'               98679600
&IHBERR  SETB  1                    Indicate error                      98686000
         AGO   .EXNUMET             Continue keyword validation         98692400
.********************************************************************** 98698800
.ERR43   ANOP  ,                                                        98705200
         MNOTE 8,' PARM1 &EM(7)'    Not use a register                  98711600
&IHBERR  SETB  1                    Indicate error                      98718000
         AGO   .EXPARM1             Continue keyword validation         98724400
.*                                                                      98730800
.ERR43A  ANOP  ,                                                        98737200
         MNOTE 8,' PARM1 MUST BE FROM 1 TO &L2 CHARACTERS'              98743600
&IHBERR  SETB  1                    Indicate error                      98750000
         AGO   .EXPARM1             Continue keyword validation         98756400
.*                                                                      98762800
.ERR43B  ANOP  ,                                                        98769200
         MNOTE 8,' PARM1 &EM(4)'    Too many sublists                   98775600
&IHBERR  SETB  1                    Indicate error                      98782000
         AGO   .EXPARM1             Continue keyword validation         98788400
.*                                                                      98794800
.ERR43C  ANOP  ,                                                        98801200
         MNOTE 8,' PARM1 MUST USE REGISTER &R1 THRU &R2'                98807600
&IHBERR  SETB  1                    Indicate error                      98814000
         AGO   .EXPARM1             Continue keyword validation         98820400
.********************************************************************** 98826800
.ERR44   ANOP  ,                                                        98833200
         MNOTE 8,' PARM2 &EM(7)'    Not use a register                  98839600
&IHBERR  SETB  1                    Indicate error                      98846000
         AGO   .EXPARM2             Continue keyword validation         98852400
.*                                                                      98858800
.ERR44A  ANOP  ,                                                        98865200
         MNOTE 8,' PARM2 MUST BE FROM 1 TO &L2 CHARACTERS'              98871600
&IHBERR  SETB  1                    Indicate error                      98878000
         AGO   .EXPARM2             Continue keyword validation         98884400
.*                                                                      98890800
.ERR44B  ANOP  ,                                                        98897200
         MNOTE 8,' PARM2 &EM(4)'    Too many sublists                   98903600
&IHBERR  SETB  1                    Indicate error                      98910000
         AGO   .EXPARM2             Continue keyword validation         98916400
.*                                                                      98922800
.ERR44C  ANOP  ,                                                        98929200
         MNOTE 8,' PARM2 MUST USE REGISTER &R1 THRU &R2'                98935600
&IHBERR  SETB  1                    Indicate error                      98942000
         AGO   .EXPARM2             Continue keyword validation         98948400
.********************************************************************** 98954800
.ERR45   ANOP  ,                                                        98961200
         MNOTE 8,' PC PARAMETER MUST BE ''STACKING'' OR ''BASIC'''      98967600
&IHBERR  SETB  1                    Indicate error                      98974000
         AGO   .EXPC                Continue keyword validation         98980400
.*                                                                      98986800
.ERR45B  ANOP  ,                                                        98993200
         MNOTE 8,' PC &EM(4)'       Too many sublists                   98999600
&IHBERR  SETB  1                    Indicate error                      99006000
         AGO   .EXPC                Continue keyword validation         99012400
.********************************************************************** 99018800
.ERR46   ANOP  ,                                                        99025200
         MNOTE 8,' PKM PARAMETER MUST BE ''OR'' OR ''REPLACE'''         99031600
&IHBERR  SETB  1                    Indicate error                      99038000
         AGO   .EXPKM               Continue keyword validation         99044400
.*                                                                      99050800
.ERR46B  ANOP  ,                                                        99057200
         MNOTE 8,' PKM &EM(4)'      Too many sublists                   99063600
&IHBERR  SETB  1                    Indicate error                      99070000
         AGO   .EXPKM               Continue keyword validation         99076400
.*                                                                      99082800
.********************************************************************** 99114800
.ERR48   ANOP  ,                                                        99121200
         MNOTE 8,' PROGRAM AND ROUTINE ARE MUTUALLY EXCLUSIVE'          99127600
&IHBERR  SETB  1                    Indicate error                      99134000
         AGO   .EXPROUT             Continue keyword validation         99140400
.*                                                                      99146800
.ERR48A  ANOP  ,                                                        99153200
         MNOTE 8,' PROGRAM &EM(7)'  Not use a register                  99159600
&IHBERR  SETB  1                    Indicate error                      99166000
         AGO   .EXPROUT             Continue keyword validation         99172400
.*                                                                      99178800
.ERR48B  ANOP  ,                                                        99185200
         MNOTE 8,' PROGRAM &EM(4)'  Too many sublists                   99191600
&IHBERR  SETB  1                    Indicate error                      99198000
         AGO   .EXPROUT             Continue keyword validation         99204400
.*                                                                      99210800
.ERR48C  ANOP  ,                                                        99217200
         MNOTE 8,' PROGRAM=&PGM EXCEEDS &L2 CHARACTERS'                 99223600
&IHBERR  SETB  1                    Indicate error                      99230000
         AGO   .EXPROUT             Continue keyword validation         99236400
.********************************************************************** 99242800
.ERR49   ANOP  ,                                                        99249200
         MNOTE 8,' PROGRAM OR ROUTINE MUST BE SPECIFIED'                99255600
&IHBERR  SETB  1                    Indicate error                      99262000
         AGO   .EXPROUT             Continue keyword validation         99268400
.*                                                                      99274800
.ERR49A  ANOP  ,                                                        99281200
         MNOTE 8,' ROUTINE &EM(7)'  Not use a register                  99287600
&IHBERR  SETB  1                    Indicate error                      99294000
         AGO   .EXPROUT             Continue keyword validation         99300400
.*                                                                      99306800
.ERR49B  ANOP  ,                                                        99313200
         MNOTE 8,' ROUTINE &EM(4)'  Too many sublists                   99319600
&IHBERR  SETB  1                    Indicate error                      99326000
         AGO   .EXPROUT             Continue keyword validation         99332400
.*                                                                      99338800
.ERR49C  ANOP  ,                                                        99345200
         MNOTE 8,' ROUTINE MUST USE REGISTER &R1 THRU &R2'              99351600
&IHBERR  SETB  1                    Indicate error                      99358000
         AGO   .EXPROUT             Continue keyword validation         99364400
.*                                                                      99370800
.ERR49D  ANOP  ,                                                   @P1A 99377200
         MNOTE 8,' ROUTINE &EM(9)'  Missing value                  @P1A 99383600
&IHBERR  SETB  1                    Indicate error                 @P1A 99390000
         AGO   .EXPROUT             Continue keyword validation    @P1A 99396400
.********************************************************************** 99402800
.ERR50   ANOP  ,                                                   @D2A 99403200
         MNOTE 8,' RAMODE &EM(11) ROUTINE'                         @L2C 99403600
&IHBERR  SETB  1                    Indicate error                 @D2A 99404000
         AGO   .RTNOPT              Continue keyword validation    @D2A 99404400
.*                                                                 @D2A 99404800
.ERR50A  ANOP  ,                                                   @D2A 99405200
         MNOTE 8,' RAMODE PARAMETER MUST BE ''31'' OR ''24'''      @D2A 99405600
&IHBERR  SETB  1                    Indicate error                 @D2A 99406000
         AGO   .EXRAMOD             Continue keyword validation    @D2A 99406400
.*                                                                 @D2A 99406800
.ERR50B  ANOP  ,                                                   @D2A 99407200
         MNOTE 8,' RAMODE &EM(4)' Too many sublists                @D2A 99407600
&IHBERR  SETB  1                    Indicate error                 @D2A 99408000
         AGO   .EXRAMOD             Continue keyword validation    @D2A 99408400
.********************************************************************** 99408800
.ERR52   ANOP  ,                                                        99409200
         MNOTE 8,' SASN PARAMETER MUST BE ''OLD'' OR ''NEW'''           99415600
&IHBERR  SETB  1                    Indicate error                      99422000
         AGO   .EXSASN              Continue keyword validation         99428400
.*                                                                      99434800
.ERR52B  ANOP  ,                                                        99441200
         MNOTE 8,' SASN &EM(4)'     Too many sublists                   99447600
&IHBERR  SETB  1                    Indicate error                      99454000
         AGO   .EXSASN              Continue keyword validation         99460400
.*                                                                      99466800
.********************************************************************** 99498800
.ERR53   ANOP  ,                                                        99505200
         MNOTE 8,' SSWITCH &EM(10)' Must be YES or NO                   99511600
&IHBERR  SETB  1                    Indicate error                      99518000
         AGO   .EXSSWIT             Continue keyword validation         99524400
.*                                                                      99530800
.ERR53B  ANOP  ,                                                        99537200
         MNOTE 8,' SSWITCH &EM(4)'  Too many sublists                   99543600
&IHBERR  SETB  1                    Indicate error                      99550000
         AGO   .EXSSWIT             Continue keyword validation         99556400
.********************************************************************** 99562800
.ERR54   ANOP  ,                                                        99569200
       MNOTE 8,' STATE PARAMETER MUST BE ''PROBLEM'' OR ''SUPERVISOR''' 99575600
&IHBERR  SETB  1                    Indicate error                      99582000
         AGO   .EXSTATE             Continue keyword validation         99588400
.*                                                                      99594800
.ERR54B  ANOP  ,                                                        99601200
         MNOTE 8,' STATE &EM(4)'    Too many sublists                   99607600
&IHBERR  SETB  1                    Indicate error                      99614000
         AGO   .EXSTATE             Continue keyword validation         99620400
.*                                                                      99626800
.********************************************************************** 99633200
.ERR55   ANOP  ,                                                   @01A 99633700
         MNOTE 8,' RECORD &EM(10)'  Must be YES or NO              @01A 99634200
&IHBERR  SETB  1                    Indicate error                 @01A 99634700
         AGO   .EXRECRD             Continue keyword validation    @01A 99635200
.*                                                                 @01A 99635700
.ERR55B  ANOP  ,                                                   @01A 99636200
         MNOTE 8,' RECORD &EM(4)'   Too many sublists              @01A 99636700
&IHBERR  SETB  1                    Indicate error                 @01A 99637200
         AGO   .EXRECRD             Continue keyword validation    @01A 99637700
.*                                                                      99638200
.********************************************************************** 99638700
.*                                                                    * 99639600
.*       EXIT                                                         * 99646000
.*                                                                    * 99652400
.********************************************************************** 99658800
.EXIT    ANOP  ,                                                        99665200
         MNOTE ' '                    Null MNOTES allow spacing to      99671600
         MNOTE ' '                     occur if NOGEN specified         99678000
         MEND ,                                                         99684400
**/                                                                     99690800
* ETDEF:                                                                99697200
*    MACRO                                                              99703600
*     KEYS     (TYPE,         /* INITIAL | ENTRY | SET | FINAL       */ 99710000
*               AKM,          /* Authorization Key Mask              */ 99716400
*               ARR,          /* Associated Recovery Routine Address */ 99722800
*               ASCMODE,      /* PRIMARY | AR                        */ 99729200
*               ASYNCH,       /* YES | NO                        @L2A*/ 99731300
*               CANCEL,       /* YES | NO                        @L2A*/ 99733400
*               EAX,          /* Extended Authorization index        */ 99735600
*               EK,           /* Entry Key                           */ 99742000
*               EKM,          /* Entry Key Mask                      */ 99748400
*               ETEADR,       /* ENTRY address/name                  */ 99754800
*               HEADER,       /* HEADER address/name                 */ 99761200
*               NUMETE,       /* Number of entries                   */ 99767600
*               PARM1,        /* User parameter 1                    */ 99774000
*               PARM2,        /* User parameter 2                    */ 99780400
*               PC,           /* STACKING | BASIC                    */ 99786800
*               PKM,          /* OR | REPLACE                        */ 99793200
*               PROGRAM,      /* Program name                        */ 99799600
*               RECORD,       /* YES | NO                        @01C*/ 99802800
*               ROUTINE,      /* Routine address                     */ 99806000
*               RAMODE,       /* Routine address AMODE           @D2A*/ 99809200
*               SASN,         /* OLD | NEW                           */ 99812400
*               SSWITCH,      /* NO | YES  XM Space Switch           */ 99818800
*               STATE,        /* PROBLEM | SUPERVISOR                */ 99825200
*               RELATED);     /* Any value                           */ 99831600
*     ANS('?'|| MACLABEL||' ETDEFP '||MACLIST||MACKEYS||';');           99838000
*%END    ETDEF;                                                         99844400
