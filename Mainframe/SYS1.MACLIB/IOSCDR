*/**** START OF SPECIFICATIONS **************************************** 00001000
*                                                                     * 00002000
*                                                                     * 00003000
*01* MACRO NAME:  IOSCDR                                -10/18/94-<1> * 00004000
*                                                                     * 00005000
*                                                                     * 00006000
*01* DESCRIPTIVE NAME:  I/O Configuration Data Record Interface       * 00007000
*                                                                     * 00008000
*01* PROPRIETARY STATEMENT:                                           * 00009000
*                                                                     * 00010000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00011000
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00012000
*     5655-068 (C) COPYRIGHT IBM CORP. 1993, 1994                     * 00013000
*     SEE COPYRIGHT INSTRUCTIONS                                      * 00014000
*                                                                     * 00015000
* STATUS= HBB5520                                                     * 00016000
*                                                                     * 00017000
*                                                                     * 00018000
*                                                                     * 00019000
*01* FUNCTION:                                                        * 00020000
*                                                                     * 00021000
*      IOSCDR provides a service which authorized callers can use to  * 00022000
*      retrieve Configuration Data Records (CDRs).  The caller can    * 00023000
*      retrieve the last CDR known to MVS or can have this service    * 00024000
*      read the CDR directly from the device for a specified device   * 00025000
*      and a specified CHPID.  The last CDR known to MVS may not be   * 00026000
*      current and therefore may not match the CDR that the device    * 00027000
*      would provide currently.  In addition the CDR known to MVS may * 00028000
*      not contain certain records present in the CDR read directly   * 00029000
*      from the device.  For example, level NEDs will have been       * 00030000
*      filtered and blank records removed.                            * 00031000
*                                                                     * 00032000
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00032200
*                                                                     * 00032400
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00032600
*                                                                     * 00032800
*01* ENVIRONMENT:                                                     * 00033000
*                                                                     * 00034000
*                                                                     * 00035000
*      Dispatchable unit mode: Task mode.                             * 00036000
*                                                                     * 00037000
*      Minimum authorization:                                         * 00038000
*                                                                     * 00039000
*                                                                     * 00039100
*                        LINKAGE=LINK                                 * 00039200
*                            Supervisor state, any PSW key            * 00039300
*                                                                     * 00039400
*                        LINKAGE=SYSTEM                               * 00039500
*                            One of the following:                    * 00039600
*                                                                     * 00039700
*                                                                     * 00039800
*                            o   Supervisor state                     * 00039900
*                                                                     * 00040000
*                            o   PKM 0-7                              * 00040100
*                                                                     * 00040200
*                            o   APF authorized                       * 00040300
*                                                                     * 00040400
*                            o   RACF authorized to class FACILITY    * 00040500
*                                and entity IOSCDR                    * 00040600
*                                                                     * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*                                                                     * 00041000
*                                                                     * 00041100
*      AMODE:                                                         * 00041200
*                                                                     * 00041300
*                                                                     * 00041400
*                        LINKAGE=LINK                                 * 00041500
*                            AMODE 31                                 * 00041600
*                                                                     * 00041700
*                        LINKAGE=SYSTEM                               * 00041800
*                            AMODE 24 or AMODE 31                     * 00041900
*                                                                     * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*      ASC mode:         Primary.                                     * 00042300
*                                                                     * 00043000
*      Serialization:    Enabled.  Unlocked                           * 00044000
*                                                                     * 00045000
*                                                                     * 00046000
*                                                                     * 00046500
*01* INPUT REGISTERS:  GR0-GR15    Undefined                          * 00047000
*                                                                     * 00048000
*01* OUTPUT REGISTERS: GR0         Reason code                        * 00049000
*                      GR1         Used by service                    * 00050000
*                      GR2-GR13    Unchanged                          * 00051000
*                      GR14        Used by service                    * 00052000
*                      GR15        Return code                        * 00053000
*                                                                     * 00054000
*01* SYNTAX:                                                          * 00055000
*                                                                     * 00056000
*[xlabel]  IOSCDR   [ PLISTVER=xplistver|IMPLIED_VERSION]           * 00056600
*                    ,DEVN=xdevn                                      * 00057200
*                    ,CHPID=xchpid                                    * 00058000
*                    ,CDRAREA=xcdrarea                                * 00059000
*                    ,CDRLEN=xcdrlen                                  * 00060000
*                   [,CDRSIZE=xcdrsize]                               * 00061000
*                    ,READ=NOIO|IO|COND                             * 00062000
*                   [,STATUS=xstatus|NONE]                          * 00063000
*                   [,TIME=xtime|5]                                 * 00064000
*                   [,IOCTOKEN=xioctoken|NONE]                      * 00065000
*                   [,LINKAGE=LINK|SYSTEM]                          * 00065500
*                   [,RETCODE=xretcode]                               * 00066000
*                   [,RSNCODE=xrsncode]                               * 00067000
*                  [,MF=S]                                           * 00068000
*                  [,MF=(L,xmfctrl,xmfattr|0D)]                    * 00069000
*                  [,MF=(E,xmfctrl,COMPLETE)]                      * 00070000
*                                                                     * 00071000
*                                                                     * 00072000
*      Where:                                                         * 00073000
*                                                                     * 00074000
*                                                                     * 00075000
*      [xlabel]                                                       * 00076000
*          is an optional symbol, starting in column 1, that is the   * 00077000
*          name on the IOSCDR macro invocation.  The name must        * 00078000
*          conform to the rules for an ordinary assembler language    * 00079000
*          symbol.                                                    * 00080000
*          DEFAULT: No name.                                          * 00081000
*                                                                     * 00081100
*                                                                     * 00081200
*                                                                     * 00081300
*                                                                     * 00081400
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00081500
*          is an optional byte input decimal value in the "1-1" range * 00081600
*          that specifies the macro version.  PLISTVER is the only    * 00081700
*          key allowed on the list form of MF and determines which    * 00081800
*          parameter list is generated.  Note that MAX may be         * 00081900
*          specified instead of a number, and the parameter list will * 00082000
*          be of the largest size currently supported. This size may  * 00082100
*          grow from release to release (thus possibly affecting the  * 00082200
*          amount of storage needed by your program).  If your        * 00082300
*          program can tolerate this, IBM recommends that you always  * 00082400
*          specify MAX when creating the list form parameter list as  * 00082500
*          that will ensure that the list form parameter list is      * 00082600
*          always long enough to hold whatever parameters might be    * 00082700
*          specified on the execute form.                             * 00082800
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00082900
*          default is the lowest version which allows all of the      * 00083000
*          parameters specified on the invocation to be processed.    * 00083100
*                                                                     * 00083200
*                                                                     * 00083300
*                                                                     * 00084000
*                                                                     * 00084500
*      DEVN=xdevn                                                     * 00085000
*          is the name (RS-type), or address in register (2)-(12), of * 00086000
*          a required halfword input which specifies the device       * 00087000
*          number in binary of the device for which a CDR is to be    * 00088000
*          retrieved.  The device will be pinned and unpinned by this * 00089000
*          service when this keyword is specified.                    * 00090000
*                                                                     * 00091000
*                                                                     * 00092000
*                                                                     * 00093000
*                                                                     * 00093500
*      CHPID=xchpid                                                   * 00094000
*          is the name (RS-type), or address in register (2)-(12), of * 00095000
*          a required byte input that contains the channel path ID    * 00096000
*          for which the CDR is to be retrieved.                      * 00097000
*                                                                     * 00098000
*                                                                     * 00099000
*                                                                     * 00100000
*                                                                     * 00100500
*      CDRAREA=xcdrarea                                               * 00101000
*          is a required input.  It is the name (RS-type), or address * 00102000
*          in register (2)-(12), of the work area which is to receive * 00103000
*          a copy of the CDR for the requested device-path.  The      * 00104000
*          caller must specify the CDRLEN keyword to indicate the     * 00105000
*          length of the CDRAREA.                                     * 00106000
*                                                                     * 00107000
*                                                                     * 00108000
*                                                                     * 00109000
*                                                                     * 00109500
*      CDRLEN=xcdrlen                                                 * 00110000
*          is the name (RS-type), or address in register (2)-(12), of * 00111000
*          a required fullword input variable which specifies the     * 00112000
*          length of the CDRAREA.  Value specified must be no larger  * 00113000
*          than 65535 bytes.                                          * 00114000
*                                                                     * 00115000
*                                                                     * 00116000
*                                                                     * 00117000
*                                                                     * 00117500
*      [CDRSIZE=xcdrsize]                                             * 00118000
*          is the name (RS-type), or address in register (2)-(12), of * 00119000
*          an optional fullword output variable which specifies the   * 00120000
*          actual size of the CDR for the specified device and path.  * 00121000
*          No more than the number of bytes specified on the CDRLEN   * 00122000
*          keyword will be copied into CDRAREA.                       * 00123000
*                                                                     * 00124000
*                                                                     * 00125000
*                                                                     * 00126000
*                                                                     * 00126500
*      READ=NOIO|IO|COND                                            * 00127000
*          is a required keyword input indicating the desired source  * 00128000
*          for the CDR.                                               * 00129000
*                                                                     * 00130000
*                                                                     * 00131000
*          NOIO      Indicates that the last CDR known to MVS will be * 00132000
*                    returned to the caller for the specified device  * 00133000
*                    and path.  This CDR may not be current.  Note    * 00134000
*                    that MVS may not have a last known CDR.  No I/O  * 00135000
*                    operations are performed when this option is     * 00136000
*                    specified.                                       * 00137000
*                                                                     * 00138000
*          IO        Indicates that the CDR will be read directly     * 00139000
*                    from the device and returned to the caller for   * 00140000
*                    the specified device and path.  Use of this      * 00141000
*                    option will NOT cause the last CDR known to MVS  * 00142000
*                    for a particular device and path to be updated.  * 00143000
*                    When this option is specified, I/O operations    * 00144000
*                    will be performed to the device.                 * 00145000
*                                                                     * 00146000
*          COND      Indicates that if the device and path are        * 00147000
*                    online, the last CDR known to MVS will be        * 00148000
*                    returned to the caller for the specified device  * 00149000
*                    and path.  Otherwise, the CDR will be obtained   * 00150000
*                    directly from the device as in the IO option.    * 00151000
*                                                                     * 00152000
*                                                                     * 00153000
*                                                                     * 00154000
*                                                                     * 00155000
*                                                                     * 00155300
*                                                                     * 00155600
*      [STATUS=xstatus|NONE]                                        * 00156000
*          is the name (RS-type), or address in register (2)-(12), of * 00157000
*          an optional 8 bit input/output that contains status        * 00158000
*          information for successful invocations of this service.  A * 00159000
*          description of the bit positions are as follows:           * 00160000
*                                                                     * 00161000
*                                                                     * 00162000
*          X'80'     Source of CDR.                                   * 00163000
*                                                                     * 00164000
*                                                                     * 00165000
*                    OFF       CDR returned was the last CDR known to * 00166000
*                              MVS.                                   * 00167000
*                                                                     * 00168000
*                    ON        CDR returned was read from the device. * 00169000
*                                                                     * 00170000
*                                                                     * 00171000
*                                                                     * 00171500
*          X'40'     Path status                                      * 00172000
*                                                                     * 00173000
*                                                                     * 00174000
*                    OFF       Specified CHPID was logically offline  * 00175000
*                              to device.                             * 00176000
*                                                                     * 00177000
*                    ON        Specified CHPID was logically online   * 00178000
*                              to device.                             * 00179000
*                                                                     * 00180000
*                                                                     * 00181000
*                                                                     * 00181500
*          X'20'     Device status                                    * 00182000
*                                                                     * 00183000
*                                                                     * 00184000
*                    OFF       Specified device was offline.          * 00185000
*                                                                     * 00186000
*                    ON        Specified device was online.           * 00187000
*                                                                     * 00188000
*                                                                     * 00189000
*                                                                     * 00189300
*                                                                     * 00189600
*          DEFAULT: NONE                                              * 00190000
*                                                                     * 00191000
*                                                                     * 00192000
*                                                                     * 00193000
*                                                                     * 00193500
*      [TIME=xtime|5]                                               * 00194000
*          is the name (RS-type), or address in register (2)-(12), of * 00195000
*          an optional 8 character input that contains an upper bound * 00196000
*          on the allowable length of I/O operations performed by     * 00197000
*          this service.  The time interval should be specified as on * 00198000
*          the DINTVL keyword of the STIMER macro.  Any I/O operation * 00199000
*          exceeding this time will be purged.  The actual time for   * 00200000
*          I/O operations performed by this service will be the       * 00201000
*          smaller of the following:                                  * 00202000
*                                                                     * 00203000
*                                                                     * 00204000
*          o   Actual time for I/O to complete when no time limit is  * 00205000
*              exceeded.  The I/O operation did not time-out and      * 00206000
*              completes either successfully or unsuccessfully.       * 00207000
*                                                                     * 00208000
*          o   I/O is cancelled due to Missing Interupt Handler (MIH) * 00209000
*              interval or I/O Timing interval expiration.  I/O is    * 00210000
*              not successful.  The length of the I/O operation       * 00211000
*              exceeded the time interval monitored by MIH or I/O     * 00212000
*              Timing and was purged.  The interval specified on the  * 00213000
*              TIME keyword must therefore have been greater than the * 00214000
*              MIH interval.                                          * 00215000
*                                                                     * 00216000
*          o   I/O is cancelled due to expiration of time interval    * 00217000
*              specified on this parameter.  I/O is not successful.   * 00218000
*              The length of the I/O operation exceeded the time      * 00219000
*              interval on the TIME keyword and was purged.           * 00220000
*                                                                     * 00221000
*                                                                     * 00222000
*                                                                     * 00222500
*          This keyword is used for the READ IO option or the READ    * 00223000
*          COND option when I/O is performed to the device.           * 00224000
*          DEFAULT: 5 seconds.                                        * 00225000
*                                                                     * 00226000
*                                                                     * 00227000
*                                                                     * 00228000
*                                                                     * 00228500
*      [IOCTOKEN=xioctoken|NONE]                                    * 00229000
*          is the name (RS-type), or address in register (2)-(12), of * 00230000
*          an optional 48 character input/output which specifies the  * 00231000
*          I/O configuration token. If the UCB definition represented * 00232000
*          by this token is inconsistent with the current UCB         * 00233000
*          definition, IOSCDR will notify the caller via a return     * 00234000
*          code.                                                      * 00235000
*                                                                     * 00236000
*          If the input IOCTOKEN is set to binary zeroes, then this   * 00237000
*          service will set IOCTOKEN to the current I/O configuration * 00238000
*          token at the start of the IOSCDR processing.               * 00239000
*          DEFAULT: NONE                                              * 00240000
*                                                                     * 00241000
*                                                                     * 00242000
*                                                                     * 00243000
*                                                                     * 00243500
*      [LINKAGE=LINK|SYSTEM]                                        * 00243600
*          is an optional keyword input that indicates whether a link * 00243700
*          macro should be generated or a Program Call should be      * 00243800
*          issued for the routine invocation.  See the environment    * 00243900
*          section for the environments allowed for each choice.      * 00244000
*          DEFAULT: LINK                                              * 00244100
*                                                                     * 00244200
*                                                                     * 00244300
*          LINK      requests that a LINK be issued to invoke the     * 00244400
*                    service routine.                                 * 00244500
*                                                                     * 00244600
*          SYSTEM    requests a PC instruction be issued to invoke    * 00244700
*                    the service routine.                             * 00244800
*                                                                     * 00244900
*                                                                     * 00245000
*                                                                     * 00245100
*                                                                     * 00245200
*                                                                     * 00245300
*                                                                     * 00245400
*      [RETCODE=xretcode]                                             * 00245500
*          is the name (RS-type) of an optional fullword output       * 00245600
*          variable, or register (2)-(12), into which the return code * 00245700
*          is to be copied from GPR 15.                               * 00246400
*                                                                     * 00247200
*                                                                     * 00248000
*                                                                     * 00249000
*                                                                     * 00250000
*      [RSNCODE=xrsncode]                                             * 00251000
*          is the name (RS-type) of an optional fullword output       * 00251800
*          variable, or register (2)-(12), into which the reason code * 00252600
*          is to be copied from GPR 0.                                * 00253400
*                                                                     * 00254200
*                                                                     * 00255000
*                                                                     * 00256000
*                                                                     * 00257000
*      [MF=S|L|E]                                                   * 00258000
*          is an optional keyword input which specifies the macro     * 00259000
*          form.                                                      * 00260000
*          DEFAULT: S                                                 * 00261000
*                                                                     * 00262000
*                                                                     * 00263000
*          [MF=S]                                                     * 00264000
*              specifies the standard form of the macro.  The "S"     * 00265000
*              form generates code to put the parameters into an      * 00266000
*              in-line parameter list and invoke the desired service. * 00267000
*              Full checking for required macro keys is done along    * 00268000
*              with supplying defaults for omitted optional           * 00269000
*              parameters.                                            * 00270000
*                                                                     * 00271000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00272000
*              specifies the list form of the macro.  The "L" form    * 00273000
*              defines an area to be used for the parameter list.     * 00274000
*              Only the PLISTVER key may be specified on the          * 00274400
*              invocation.  All other macro parameters are flagged as * 00274800
*              errors.  If PLISTVER is not specified, the original    * 00275200
*              parameter list definition is used.                     * 00275600
*                                                                     * 00276000
*            ,xmfctrl                                                 * 00277000
*              is a required input.  It is the name of a storage area * 00278000
*              for the parameter list.                                * 00279000
*                                                                     * 00280000
*            ,xmfattr|0D                                            * 00281000
*              is an optional 60 character input string that varies   * 00282000
*              from 1 to 60 characters. It can contain any value that * 00283000
*              is valid on an assembler DS pseudo-op. You can use     * 00284000
*              this parameter to force boundary alignment of the      * 00285000
*              parameter list.                                        * 00286000
*              DEFAULT: 0D which forces the parameter list to a       * 00287000
*              doubleword boundary.                                   * 00288000
*                                                                     * 00289000
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00290000
*              specifies the execute form of the macro.  The "E" form * 00291000
*              generates code to put the parameters into the          * 00292000
*              parameter list specified by xmfctrl and provides full  * 00293000
*              syntax checking with default setting.                  * 00294000
*                                                                     * 00295000
*            ,xmfctrl                                                 * 00296000
*              is a required input.  It is the name (RS-type), or     * 00297000
*              address in register (1)-(12), of a storage area for    * 00298000
*              the parameter list.                                    * 00299000
*                                                                     * 00300000
*            ,COMPLETE                                              * 00301000
*              is an optional keyword input which specifies the       * 00302000
*              degree of macro parameter syntax checking.             * 00303000
*              DEFAULT: COMPLETE                                      * 00304000
*                                                                     * 00305000
*                                                                     * 00306000
*              COMPLETE   Checking for required macro keys is done    * 00307000
*                        and defaults are supplied for omitted        * 00308000
*                        optional parameters.                         * 00309000
*                                                                     * 00310000
*                                                                     * 00311000
*                                                                     * 00312000
*                                                                     * 00313000
*                                                                     * 00313200
*                                                                     * 00313400
*                                                                     * 00313600
*01* RETURN CODES:                                                    * 00314000
*                                                                     * 00315000
*                                                                     * 00316000
*                 The following is a list of return and reason codes: * 00317000
*                                                                     * 00318000
*                                                                     * 00319000
*                 X'00'     Function completed successfully.  The CDR * 00320000
*                           was successfully retrieved on the         * 00321000
*                           specified device and path.                * 00322000
*                                                                     * 00323000
*                 X'04'     The CDR for the specified device and path * 00324000
*                           could not be retrieved.                   * 00325000
*                                                                     * 00326000
*                           Reason codes                              * 00327000
*                                                                     * 00328000
*                                                                     * 00329000
*                           X'04'     The CDR was retrieved, but the  * 00330000
*                                     CDRAREA specified was not large * 00331000
*                                     enough to receive it.  The      * 00332000
*                                     number of bytes specified on    * 00333000
*                                     the CDRLEN keyword specifies    * 00334000
*                                     the length of the CDRAREA.  If  * 00335000
*                                     the CDRSIZE keyword was         * 00336000
*                                     specified, the size that        * 00337000
*                                     CDRAREA would have needed to be * 00338000
*                                     will be returned in the area    * 00339000
*                                     specified on CDRSIZE.           * 00340000
*                                                                     * 00341000
*                           X'08'     Request failed, unable to       * 00341700
*                                     retrieve CDR.  Subchannel or    * 00342400
*                                     I/O error.                      * 00343100
*                                                                     * 00344000
*                           X'0C'     I/O was attempted to the        * 00345000
*                                     device, but the user specified  * 00346000
*                                     timer interval as specified on  * 00347000
*                                     the TIME keyword expired before * 00348000
*                                     the I/O completed.              * 00349000
*                                                                     * 00350000
*                           X'10'     MVS does not have a last known  * 00351000
*                                     CDR to return.  No I/O was      * 00352000
*                                     attempted.                      * 00353000
*                                                                     * 00354000
*                           X'14'     Unable to retrieve last known   * 00355000
*                                     CDR.  No I/O was attempted.     * 00356000
*                                                                     * 00357000
*                                                                     * 00358000
*                                                                     * 00358500
*                 X'08'     Unable to perform function.               * 00359000
*                                                                     * 00360000
*                                                                     * 00361000
*                           X'04'     The device specified does not   * 00362000
*                                     support the CCWs used to obtain * 00363000
*                                     configuration data records.     * 00364000
*                                                                     * 00365000
*                           X'08'     Device number specified on DEVN * 00366000
*                                     keyword is not valid.           * 00367000
*                                                                     * 00368000
*                           X'0C'     CHPID secified on CHPID keyword * 00369000
*                                     is not valid.                   * 00370000
*                                                                     * 00371000
*                           X'10'     An invalid time was specified.  * 00372000
*                                                                     * 00373000
*                           X'14'     An invalid CDRLEN was           * 00374000
*                                     specified.                      * 00375000
*                                                                     * 00376000
*                           X'20'     The UCB definition for the      * 00377000
*                                     device represented by the       * 00378000
*                                     look-up argument has changed    * 00379000
*                                     and is no longer consistent     * 00380000
*                                     with the UCB definition         * 00381000
*                                     represented by the input I/O    * 00382000
*                                     configuration token.  (This     * 00383000
*                                     return code is valid only for   * 00384000
*                                     callers using the IOCTOKEN      * 00385000
*                                     keyword.)                       * 00386000
*                                                                     * 00387000
*                           X'24'     Processing cannot be performed  * 00388000
*                                     before the IOS address space is * 00389000
*                                     available.                      * 00390000
*                                                                     * 00391000
*                           X'28'     Could not establish ESTAE.      * 00392000
*                                                                     * 00393000
*                                                                     * 00394000
*                                                                     * 00394500
*                 X'0C'     An unexpected error occurred.             * 00395000
*                                                                     * 00396000
*                                                                     * 00397000
*                                                                     * 00398000
*                                                                     * 00398300
*                                                                     * 00398600
*01* REASON CODES:                                                    * 00399000
*         Refer to the return codes section.                          * 00400000
*                                                                     * 00401000
*01* ABEND CODES:                                                     * 00402000
*                                                                     * 00403000
*                                                                     * 00404000
*       2C6       Failure occurred during validation checking or      * 00405000
*                 while using a caller passed variable.               * 00406000
*                                                                     * 00407000
*                                                                     * 00408000
*                                                                     * 00408500
*01* ABEND REASON CODES:                                              * 00409000
*                                                                     * 00410000
*       REASON    ABEND                                               * 00411000
*       CODE      CODE      DESCRIPTION                               * 00412000
*                                          * 00413000
*                                                                     * 00414000
*                                                                     * 00415000
*       00000100  2C6       Invalid  authorization.  For LINKAGE=LINK * 00415400
*                           callers,  the caller is not in supervisor * 00415800
*                           state.    For LINKAGE=SYSTEM callers, the * 00416200
*                           caller  is not supervisor state, PKM 0-7, * 00416600
*                           APF  authorized,  or  RACF  authorized to * 00417000
*                           class FACILITY and entity IOSCDR.         * 00417400
*                                                                     * 00418000
*       00000101  2C6       Invalid  dispatchable  unit mode.  Caller * 00419000
*                           is  not in task mode or is holding an EUT * 00419600
*                           FRR.                                      * 00420200
*                                                                     * 00421000
*       00000102  2C6       Invalid serialization.  Caller is locked. * 00422000
*                                                                     * 00423000
*       00000103  2C6       Invalid  AMODE.   Caller is not in 31-bit * 00424000
*                           mode.                                     * 00425000
*                                                                     * 00426000
*       00000200  2C6       Invalid parameter list.  Caller passed an * 00427000
*                           invalid version of the parameter list.    * 00428000
*                                                                     * 00429000
*       00000201  2C6       Invalid  parameter list.   Parameter list * 00430000
*                           integrity  compromised.    (For  example, * 00431000
*                           more  than  one  in  a  list  of mutually * 00432000
*                           exclusive keywords was specified.)        * 00433000
*                                                                     * 00434000
*       00000202  2C6       Invalid  parameter list. Caller passed an * 00435000
*                           invalid parameter list and error occurred * 00436000
*                           reading the list.                         * 00437000
*                                                                     * 00438000
*       00000203  2C6       Invalid  parameter list. Caller passed an * 00439000
*                           invalid parameter list and error occurred * 00440000
*                           updating the list.                        * 00441000
*                                                                     * 00442000
*       00000204  2C6       Invalid  IOCTOKEN  storage. Caller passed * 00443000
*                           an  invalid  IOCTOKEN  and error occurred * 00444000
*                           reading.                                  * 00445000
*                                                                     * 00446000
*       00000205  2C6       Invalid  IOCTOKEN  storage. Caller passed * 00447000
*                           an  invalid  IOCTOKEN  and error occurred * 00448000
*                           updating.                                 * 00449000
*                                                                     * 00450000
*       00000206  2C6       Invalid CDRAREA storage. Caller passed an * 00451000
*                           invalid   CDRAREA   and   error  occurred * 00452000
*                           updating.                                 * 00453000
*                                                                     * 00454000
*                                                                     * 00455000
*                                                                     * 00455500
*01* MODULE TYPE:  ASSEM MACRO                                        * 00456000
*                                                                     * 00457000
*02*   PROCESSOR:  ASSEM                                              * 00458000
*                                                                     * 00459000
*01* COMPONENT:  SC1C3                                                * 00460000
*                                                                     * 00461000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00462000
*                                                                     * 00463000
*01* MACRO USAGE NOTES:                                               * 00464000
*                                                                     * 00465000
*                                                                     * 00466000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00467000
*        global macro variable.  Any value other than 'NO' will       * 00468000
*        result in the macro expansion being printed.  The default is * 00469000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00470000
*        variable should be set.                                      * 00471000
*                                                                     * 00472000
*                    GBLC &ZPRINT                                     * 00473000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00474000
*                                                                     * 00475000
*                                                                     * 00477000
*    2.  All  keys currently contained in the IOSCDR macro correspond * 00477200
*        to  version 1.  If you specify PLISTVER, use a value of 1 or * 00477400
*        MAX.                                                         * 00477600
*                                                                     * 00477800
*                                                                     * 00478000
*    3.  Invokers of this service must not hold any EUT FRRs.         * 00478200
*                                                                     * 00479000
*                                                                     * 00480000
*                                                                     * 00480500
*01* CHANGE ACTIVITY:                                                 * 00481000
*                                                                     * 00482000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00483000
*                                                                     * 00484000
*    $L0=DEVSD    HBB5510 930305 PDLU:  Configuration Data Record     * 00485000
*                                         Service                     * 00486000
*    $P1=PIG1966  HBB5510 930715 PDLU:  Documentation updates         * 00486500
*    $P2=PN70653  HBB5520 940602 PDLU:  Changed to use Standard       * 00486700
*                                         Assembler form of LINK for  * 00486900
*                                         PLAS invocations so that    * 00487100
*                                         the EPILOG area is not      * 00487300
*                                         used.                       * 00487500
*    $P3=PN71096  HBB5520 941020 PDLU:  Allow authorized callers who  * 00487600
*                                         run in problem state to     * 00487700
*                                         invoke IOSCDR.              * 00487800
*    $P4=PN71743  HBB5520 941020 PDLP:  Add External Classification   * 00488000
*                                         in the PROLOG               * 00488200
****** END OF SPECIFICATIONS *****************************************/ 00488400
*/********************************************************************* 00488600
         MACRO                                                          00489000
&XLABEL  IOSCDR &PLISTVER=,&DEVN=,&CHPID=,&CDRAREA=,&CDRLEN=,&CDRSIZE=,*00489700
               &READ=,&STATUS=,&TIME=,&IOCTOKEN=,&LINKAGE=,&RETCODE=,  *00490400
               &RSNCODE=,&MF=                                           00491100
.*                                                                      00492000
*              MACDATE -10/18/94-<1>                                    00493000
.*                                                                      00494000
.*******************************************************************    00495000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00496000
.*******************************************************************    00497000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00498000
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00499000
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00500000
.*                                                                      00501000
              GBLC  &ZIOSCDR    YES=MACRO USED AT LEAST ONCE            00502000
.*******************************************************************    00503000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00504000
.*******************************************************************    00505000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00506000
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            00507000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00508000
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00509000
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00510000
              LCLA  &ZAWRK      USED AS A WORK AREA                     00511000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00512000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00513000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00514000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00515000
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00516000
              LCLA  &ZMACRET    MACRO RETURN CODE                       00517000
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00518000
.*                                                                      00519000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00520000
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00521000
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00522000
              LCLC  &ZENDBASEPL                 End of base PL          00522100
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   00522200
.*******************************************************************    00522300
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00522400
.*******************************************************************    00522500
              LCLA  &ZI         INDEX FOR ARRAY                         00522600
              LCLA  &ZJ         INDEX FOR PARMS                         00522700
              LCLA  &ZK         INDEX FOR PARSE                         00522800
              LCLA  &ZLO        LOW RANGE VALUE                         00522900
              LCLA  &ZHI        HIGH RANGE VALUE                        00523000
              LCLC  &ZW         WORK AREA FOR PARM                      00523100
.********************************************************************   00523200
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00524000
.********************************************************************   00525000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00526000
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00527000
.*                                                                      00528000
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00529000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00530000
              SPLEVEL  TEST                                             00531000
.ZSYS2        ANOP  ,                                                   00532000
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00533000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00534000
              SYSSTATE TEST                                             00535000
              AGO   .ZSYS4                                              00536000
.ZSYS3        ANOP  ,                                                   00537000
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00538000
.ZSYS4        ANOP  ,                                                   00539000
.*******************************************************************    00540000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00541000
.*******************************************************************    00542000
              LCLA  &XPLISTVER  ++ VALUE                                00542500
              LCLC  &XDEVN      ++ NAME                                 00543000
              LCLC  &XCHPID     ++ NAME                                 00544000
              LCLC  &XCDRAREA   ++ NAME                                 00545000
              LCLC  &XCDRLEN    ++ NAME                                 00546000
              LCLC  &XCDRSIZE   ++ NAME                                 00547000
              LCLC  &XREAD      ++ VALUE                                00548000
              LCLC  &XSTATUS    ++ NAME                                 00549000
              LCLC  &XTIME      ++ NAME                                 00550000
              LCLC  &XIOCTOKEN  ++ NAME                                 00551000
              LCLC  &XLINKAGE   ++ VALUE                                00551500
              LCLC  &XRETCODE   ++ NAME                                 00552000
              LCLC  &XRSNCODE   ++ NAME                                 00553000
              LCLC  &XMF        ++ VALUE                                00554000
              LCLC  &XMFCTRL    ++ NAME                                 00555000
              LCLC  &XMFATTR    ++ VALUE                                00556000
              LCLC  &XMFSCK     ++ VALUE                                00557000
.*******************************************************************    00558000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00559000
.*******************************************************************    00560000
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          00560500
              LCLC  &ZXDEVN     ++ INPUT NAME                           00561000
              LCLC  &ZXCHPID    ++ INPUT NAME                           00562000
              LCLC  &ZXCDRAREA  ++ INPUT NAME                           00563000
              LCLC  &ZXCDRLEN   ++ INPUT NAME                           00564000
              LCLC  &ZXCDRSIZE  ++ OUTPUT NAME                          00565000
              LCLC  &ZXREAD     ++ INPUT VALUE                          00566000
              LCLC  &ZXSTATUS   ++ INOUT NAME                           00567000
              LCLC  &ZXTIME     ++ INPUT NAME                           00568000
              LCLC  &ZXIOCTOKEN                 ++ INOUT NAME           00569000
              LCLC  &ZXLINKAGE  ++ INPUT VALUE                          00569500
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          00570000
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00571000
              LCLC  &ZXMF       ++ INPUT VALUE                          00572000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00573000
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00574000
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00575000
.********************************************************************   00576000
.***AC.PLV01  PROCESS PLISTVER                                      *   00576100
.********************************************************************   00576200
&XPLISTVER      SETA  1                                                 00576300
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00576400
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00576500
&XPLISTVER      SETA  1                                                 00576600
.ZPLV0          ANOP  ,                                                 00576700
.*                                                                      00576800
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00576900
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00577000
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00577100
.*-------------------------------------------------------------------   00577200
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00577300
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00577400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00577500
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00577600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00577700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00577800
                AGO   .ZPVCK2                                           00577900
.ZPVCK3         ANOP  ,                                                 00578000
.*-------------------------------------------------------------------   00578100
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00578200
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00578300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00578400
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00578500
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00578600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00578700
                AGO   .ZPVCKE                                           00578800
.ZPVCK2         ANOP  ,                                                 00578900
.*-------------------------------------------------------------------   00579000
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00579100
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00579200
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00579300
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00579400
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00579500
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00579600
                MNOTE 8,' &ZMS IS REQUIRED.'                            00579700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00579800
                AGO   .ZPVCK5                                           00579900
.ZPVCK4         ANOP  ,                                                 00580000
&XPLISTVER      SETA  &PLISTVER(1)                                      00580100
.ZPVCK5         ANOP  ,                                                 00580200
.*-------------------------------------------------------------------   00580300
&ZCVAL          SETC  '&PLISTVER(1)'                                    00580400
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00580500
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00580600
                AIF   (&XPLISTVER LT 1).ZPVCK6  TOO LOW                 00580700
                AIF   (&XPLISTVER LE 1).ZPVCKE  NOT HIGH                00580800
.ZPVCK6         ANOP   ,                                                00580900
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00581000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00581100
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00581200
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00581300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00581400
.ZPVCKE         ANOP   ,                                                00581500
.********************************************************************   00581600
.***AG.MF01 PROCESS MF MACRO FORMS                                      00581700
.********************************************************************   00581800
              ACTR  10000                                               00581900
.*------------------------------------------------------------------    00582000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00582100
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00582200
.*-------------------------------------------------------------------   00583000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00584000
.ZG47         ANOP  ,                                                   00585000
&ZTLC         SETC 'S'                                                  00586000
              AIF   ('&MF(1)' NE '&ZTLC').ZG48                          00587000
&XMF          SETC  'S'         SET KEYWORD                             00588000
              AIF   (N'&MF LE 1).ZG47A          CK NUM                  00589000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00590000
&ZMS          SETC  '&ZMS.&MF"'                                         00591000
&ZMS          SETC  '&ZMS "MF"'                                         00592000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00593000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00594000
.ZG47A        ANOP  ,                                                   00595000
.*-------------------------------------------------------------------   00596000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00597000
.ZG48         ANOP  ,                                                   00598000
&ZTLC         SETC 'L'                                                  00599000
              AIF   ('&MF(1)' NE '&ZTLC').ZG55                          00600000
&XMF          SETC  'L'         SET KEYWORD                             00601000
              AIF   (N'&MF LE 3).ZG48A          CK NUM                  00602000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00603000
&ZMS          SETC  '&ZMS.&MF"'                                         00604000
&ZMS          SETC  '&ZMS "MF"'                                         00605000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00606000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00607000
.ZG48A        ANOP  ,                                                   00608000
.*-------------------------------------------------------------------   00609000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00610000
              AIF   (N'&SYSLIST NE 0).ZG48B     POSITIONALS?            00610900
              AIF   ('&DEVN' NE '').ZG48B       KEYS?                   00611800
              AIF   ('&CHPID' NE '').ZG48B      KEYS?                   00612700
              AIF   ('&CDRAREA' NE '').ZG48B    KEYS?                   00613600
              AIF   ('&CDRLEN' NE '').ZG48B     KEYS?                   00614500
              AIF   ('&CDRSIZE' NE '').ZG48B    KEYS?                   00615400
              AIF   ('&READ' NE '').ZG48B       KEYS?                   00616300
              AIF   ('&STATUS' NE '').ZG48B     KEYS?                   00617200
              AIF   ('&TIME' NE '').ZG48B       KEYS?                   00618100
              AIF   ('&IOCTOKEN' NE '').ZG48B   KEYS?                   00619000
              AIF   ('&LINKAGE' NE '').ZG48B    KEYS?                   00619900
              AIF   ('&RETCODE' NE '').ZG48B    KEYS?                   00620800
              AIF   ('&RSNCODE' NE '').ZG48B    KEYS?                   00621700
              AGO    .ZG48C     INVOCATION OKAY                         00622600
.ZG48B        ANOP  ,                                                   00623500
&ZMS          SETC  'THE "L" FORM OF "MF"'      *MFLA* MNOTE            00624400
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                00625300
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           00626200
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              00627100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00629000
.ZG48C        ANOP  ,                                                   00630000
.*-------------------------------------------------------------------   00631000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00632000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00633000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00634000
              AIF   (N'&MF(2) GT 1).ZG50B       MULTI PARMS             00635000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00636000
.ZG50B        AIF   (K'&MF(2) GT 0).ZG50C                               00637000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00638000
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 00639000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00640000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00641000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00642000
.ZG50C        ANOP  ,                                                   00643000
.*-------------------------------------------------------------------   00644000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00645000
              AIF   (K'&ZXMFCTRL LE 0).ZG50P    NOT I/O                 00646000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG50P                      00647000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00648000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00649000
&ZMS          SETC  '&ZMS.&MF"'                                         00650000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00651000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00652000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00653000
.ZG50P        ANOP  ,                                                   00654000
.*-------------------------------------------------------------------   00655000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00656000
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00657000
&XMFATTR      SETC  '0D'                                                00658000
              AIF   (K'&MF(3) LE 0).ZG53B       PARM                    00659000
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00660000
              AIF   (N'&MF(3) GT 1).ZG53B       MULTI PARMS             00661000
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00662000
.ZG53B        ANOP  ,                                                   00663000
.*-------------------------------------------------------------------   00664000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00665000
              AIF   (K'&ZXMFATTR LE 0).ZG53P    NOT I/O                 00666000
              AIF   ('&XMFATTR'(1,1) NE '(').ZG53P                      00667000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00668000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00669000
&ZMS          SETC  '&ZMS.&MF"'                                         00670000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00671000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00672000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00673000
.ZG53P        ANOP  ,                                                   00674000
.*-------------------------------------------------------------------   00675000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00676000
              AIF   (K'&ZXMFATTR LE 0).ZG53S    NOT I/O                 00677000
              AIF   (K'&XMFATTR LE 60).ZG53S    LNG OK                  00678000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00679000
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           00680000
&ZMS          SETC  '&ZMS.&MF"'                                         00681000
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00682000
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00683000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00684000
.ZG53S        ANOP  ,                                                   00685000
.*-------------------------------------------------------------------   00686000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00687000
.ZG55         ANOP  ,                                                   00688000
&ZTLC         SETC 'E'                                                  00689000
              AIF   ('&MF(1)' NE '&ZTLC').ZG63                          00690000
&XMF          SETC  'E'         SET KEYWORD                             00691000
              AIF   (N'&MF LE 3).ZG55A          CK NUM                  00692000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00693000
&ZMS          SETC  '&ZMS.&MF"'                                         00694000
&ZMS          SETC  '&ZMS "MF"'                                         00695000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00696000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00697000
.ZG55A        ANOP  ,                                                   00698000
.*-------------------------------------------------------------------   00699000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00700000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00701000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00702000
              AIF   (N'&MF(2) GT 1).ZG57B       MULTI PARMS             00703000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00704000
.ZG57B        AIF   (K'&MF(2) GT 0).ZG57C                               00705000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00706000
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 00707000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00708000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00709000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00710000
.ZG57C        ANOP  ,                                                   00711000
.*-------------------------------------------------------------------   00712000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00713000
              AIF   (K'&ZXMFCTRL LE 0).ZG57R    NOT I/O                 00714000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG57R                      00715000
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00716000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG57P                        00717000
              AIF   (K'&ZCGPR GT 2).ZG57Q                               00718000
              AIF   ('&ZCGPR' EQ '0').ZG57Q                             00719000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00720000
              AIF   (T'&ZCGPR NE 'N').ZG57Q     INVALID REG NAME        00721000
.ZG57P        ANOP  ,                                                   00722000
              AIF   (T'&ZCGPR NE 'N').ZG57R     NON NUMERIC             00723000
              AIF   ('&ZCGPR' LT '1').ZG57Q                             00724000
              AIF   ('&ZCGPR' LE '12').ZG57R                            00725000
.ZG57Q        ANOP  ,                                                   00726000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00727000
&ZMS          SETC  '&ZMS.&MF"'                                         00728000
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00729000
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00730000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00731000
.ZG57R        ANOP  ,                                                   00732000
.*-------------------------------------------------------------------   00733000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00734000
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00735000
.ZG61A   AIF   ('&MF(3)' NE 'COMPLETE').ZG62A                           00736000
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00737000
.*-------------------------------------------------------------------   00738000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00739000
.ZG62A        AIF   (K'&XMFSCK GT 0).ZG62C      KEYWORD                 00740000
              AIF   (K'&MF(3) LE 0).ZG62B                               00741000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00742000
&ZMS          SETC  '&ZMS.&MF"'                                         00743000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00744000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00745000
&ZMS          SETC  '&ZMS "COMPLETE".'          VALID KEYWORD           00746000
              MNOTE 8,' &ZMS '                                          00747000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00748000
.ZG62B        ANOP  ,                                                   00749000
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00750000
.ZG62C        ANOP  ,                                                   00751000
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00752000
.*------------------------------------------------------------------    00753000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00754000
.ZG63         ANOP  ,                                                   00755000
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00756000
              AIF   (K'&XMF GT 0).ZG63E         VALID ARG               00757000
              AIF   (T'&MF EQ 'O').ZG63D        OMITTED                 00758000
&ZASYSLNDX    SETA  0                                                   00759000
.ZG63A        ANOP  ,           POSITIONAL MACRO KEY                    00760000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00761000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG63C                    00762000
&ZTLC         SETC 'MF'                                                 00763000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG63A           00764000
.ZG63B        ANOP  ,                                                   00765000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00766000
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           00767000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00768000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00769000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00770000
              AGO   .ZG63E                                              00771000
.ZG63C        ANOP  ,                                                   00772000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00773000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00774000
&ZMS          SETC  '&ZMS.&MF"'                                         00775000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00776000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00777000
&ZMS          SETC  '&ZMS "S",'                 VALID KEYWORD           00778000
&ZMS          SETC  '&ZMS "L",'                 VALID KEYWORD           00779000
&ZMS          SETC  '&ZMS OR "E".'              VALID KEYWORD           00780000
              MNOTE 8,' &ZMS '                                          00781000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00782000
              AGO   .ZG63E                                              00783000
.ZG63D        ANOP  ,                                                   00784000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00785000
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00786000
.ZG63E        ANOP  ,                                                   00787000
.********************************************************************   00788000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00789000
.********************************************************************   00790000
              ACTR  10000                                               00791000
.*-------------------------------------------------------------------   00792000
.***AG.MF03 MF=(SLE)                                                    00793000
              AIF   ('&XMF' EQ 'L').ZGMFX                               00794000
.*----------------------------------------------------------------***   00795000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00796000
              AIF   (N'&DEVN LE 1).ZG5A         CK NUM                  00797000
&ZMS          SETC  '"DEVN='    *KPOSA* MNOTE                           00798000
&ZMS          SETC  '&ZMS.&DEVN"'                                       00799000
&ZMS          SETC  '&ZMS "DEVN"'                                       00800000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00801000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00802000
.ZG5A         ANOP  ,                                                   00803000
.*-------------------------------------------------------------------   00804000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00805000
&ZXDEVN       SETC  'INPUT'     SET IN/OUTPUT                           00806000
&XDEVN        SETC  '&DEVN(1)'  SET XVARIABLE                           00807000
              AIF   (N'&DEVN GT 1).ZG5B         MULTI PARMS             00808000
&XDEVN        SETC  '&DEVN'     SET XVARIABLE                           00809000
.ZG5B         AIF   (K'&DEVN(1) GT 0).ZG5C                              00810000
&ZXDEVN       SETC  ''          RESET IN/OUTPUT                         00811000
&ZMS          SETC  ' '         *KRQDA*                                 00812000
&ZMS          SETC  '&ZMS "DEVN" KEY AND ITS ARGUMENT'                  00813000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00814000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00815000
.ZG5C         ANOP  ,                                                   00859000
.*-------------------------------------------------------------------   00860000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00861000
              AIF   (K'&ZXDEVN LE 0).ZG5R       NOT I/O                 00862000
              AIF   ('&XDEVN'(1,1) NE '(').ZG5R                         00863000
&ZCGPR        SETC  '&XDEVN'(2,K'&XDEVN-2)                              00864000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                         00865000
              AIF   (K'&ZCGPR GT 2).ZG5Q                                00866000
              AIF   ('&ZCGPR' EQ '0').ZG5Q                              00867000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00868000
              AIF   (T'&ZCGPR NE 'N').ZG5Q      INVALID REG NAME        00869000
.ZG5P         ANOP  ,                                                   00870000
              AIF   (T'&ZCGPR NE 'N').ZG5R      NON NUMERIC             00871000
              AIF   ('&ZCGPR' LT '2').ZG5Q                              00872000
              AIF   ('&ZCGPR' LE '12').ZG5R                             00873000
.ZG5Q         ANOP  ,                                                   00874000
&ZMS          SETC  '"DEVN='    *KGPRA* MNOTE                           00875000
&ZMS          SETC  '&ZMS.&DEVN"'                                       00876000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00877000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00878000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00879000
.ZG5R         ANOP  ,                                                   00880000
.*----------------------------------------------------------------***   00881000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00882000
              AIF   (N'&CHPID LE 1).ZG8A        CK NUM                  00883000
&ZMS          SETC  '"CHPID='   *KPOSA* MNOTE                           00884000
&ZMS          SETC  '&ZMS.&CHPID"'                                      00885000
&ZMS          SETC  '&ZMS "CHPID"'                                      00886000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00887000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00888000
.ZG8A         ANOP  ,                                                   00889000
.*-------------------------------------------------------------------   00890000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00891000
&ZXCHPID      SETC  'INPUT'     SET IN/OUTPUT                           00892000
&XCHPID       SETC  '&CHPID(1)'                 SET XVARIABLE           00893000
              AIF   (N'&CHPID GT 1).ZG8B        MULTI PARMS             00894000
&XCHPID       SETC  '&CHPID'    SET XVARIABLE                           00895000
.ZG8B         AIF   (K'&CHPID(1) GT 0).ZG8C                             00896000
&ZXCHPID      SETC  ''          RESET IN/OUTPUT                         00897000
&ZMS          SETC  ' '         *KRQDA*                                 00898000
&ZMS          SETC  '&ZMS "CHPID" KEY AND ITS ARGUMENT'                 00899000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00901000
.ZG8C         ANOP  ,                                                   00902000
.*-------------------------------------------------------------------   00903000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00904000
              AIF   (K'&ZXCHPID LE 0).ZG8R      NOT I/O                 00905000
              AIF   ('&XCHPID'(1,1) NE '(').ZG8R                        00906000
&ZCGPR        SETC  '&XCHPID'(2,K'&XCHPID-2)                            00907000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                         00908000
              AIF   (K'&ZCGPR GT 2).ZG8Q                                00909000
              AIF   ('&ZCGPR' EQ '0').ZG8Q                              00910000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00911000
              AIF   (T'&ZCGPR NE 'N').ZG8Q      INVALID REG NAME        00912000
.ZG8P         ANOP  ,                                                   00913000
              AIF   (T'&ZCGPR NE 'N').ZG8R      NON NUMERIC             00914000
              AIF   ('&ZCGPR' LT '2').ZG8Q                              00915000
              AIF   ('&ZCGPR' LE '12').ZG8R                             00916000
.ZG8Q         ANOP  ,                                                   00917000
&ZMS          SETC  '"CHPID='   *KGPRA* MNOTE                           00918000
&ZMS          SETC  '&ZMS.&CHPID"'                                      00919000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00920000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00921000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00922000
.ZG8R         ANOP  ,                                                   00923000
.*----------------------------------------------------------------***   00924000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00925000
              AIF   (N'&CDRAREA LE 1).ZG11A     CK NUM                  00926000
&ZMS          SETC  '"CDRAREA='                 *KPOSA* MNOTE           00927000
&ZMS          SETC  '&ZMS.&CDRAREA"'                                    00928000
&ZMS          SETC  '&ZMS "CDRAREA"'                                    00929000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00930000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00931000
.ZG11A        ANOP  ,                                                   00932000
.*-------------------------------------------------------------------   00933000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00934000
&ZXCDRAREA    SETC  'INPUT'     SET IN/OUTPUT                           00935000
&XCDRAREA     SETC  '&CDRAREA(1)'               SET XVARIABLE           00936000
              AIF   (N'&CDRAREA GT 1).ZG11B     MULTI PARMS             00937000
&XCDRAREA     SETC  '&CDRAREA'  SET XVARIABLE                           00938000
.ZG11B        AIF   (K'&CDRAREA(1) GT 0).ZG11C                          00939000
&ZXCDRAREA    SETC  ''          RESET IN/OUTPUT                         00940000
&ZMS          SETC  ' '         *KRQDA*                                 00941000
&ZMS          SETC  '&ZMS "CDRAREA" KEY AND ITS ARGUMENT'               00942000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00943000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00944000
.ZG11C        ANOP  ,                                                   00945000
.*-------------------------------------------------------------------   00946000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00947000
              AIF   (K'&ZXCDRAREA LE 0).ZG11R   NOT I/O                 00948000
              AIF   ('&XCDRAREA'(1,1) NE '(').ZG11R                     00949000
&ZCGPR        SETC  '&XCDRAREA'(2,K'&XCDRAREA-2)                        00950000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                        00951000
              AIF   (K'&ZCGPR GT 2).ZG11Q                               00952000
              AIF   ('&ZCGPR' EQ '0').ZG11Q                             00953000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00954000
              AIF   (T'&ZCGPR NE 'N').ZG11Q     INVALID REG NAME        00955000
.ZG11P        ANOP  ,                                                   00956000
              AIF   (T'&ZCGPR NE 'N').ZG11R     NON NUMERIC             00957000
              AIF   ('&ZCGPR' LT '2').ZG11Q                             00958000
              AIF   ('&ZCGPR' LE '12').ZG11R                            00959000
.ZG11Q        ANOP  ,                                                   00960000
&ZMS          SETC  '"CDRAREA='                 *KGPRA* MNOTE           00961000
&ZMS          SETC  '&ZMS.&CDRAREA"'                                    00962000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00963000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00964000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00965000
.ZG11R        ANOP  ,                                                   00966000
.*----------------------------------------------------------------***   00967000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00968000
              AIF   (N'&CDRLEN LE 1).ZG14A      CK NUM                  00969000
&ZMS          SETC  '"CDRLEN='  *KPOSA* MNOTE                           00970000
&ZMS          SETC  '&ZMS.&CDRLEN"'                                     00971000
&ZMS          SETC  '&ZMS "CDRLEN"'                                     00972000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00973000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00974000
.ZG14A        ANOP  ,                                                   00975000
.*-------------------------------------------------------------------   00976000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00976500
&ZXCDRLEN     SETC  'INPUT'     SET IN/OUTPUT                           00977000
&XCDRLEN      SETC  '&CDRLEN(1)'                SET XVARIABLE           00977500
              AIF   (N'&CDRLEN GT 1).ZG14B      MULTI PARMS             00978000
&XCDRLEN      SETC  '&CDRLEN'   SET XVARIABLE                           00978500
.ZG14B        AIF   (K'&CDRLEN(1) GT 0).ZG14C                           00979000
&ZXCDRLEN     SETC  ''          RESET IN/OUTPUT                         00979500
&ZMS          SETC  ' '         *KRQDA*                                 00980000
&ZMS          SETC  '&ZMS "CDRLEN" KEY AND ITS ARGUMENT'                00980500
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00981000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00981500
.ZG14C        ANOP  ,                                                   00983000
.*-------------------------------------------------------------------   00984000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00985000
              AIF   (K'&ZXCDRLEN LE 0).ZG14R    NOT I/O                 00986000
              AIF   ('&XCDRLEN'(1,1) NE '(').ZG14R                      00987000
&ZCGPR        SETC  '&XCDRLEN'(2,K'&XCDRLEN-2)                          00988000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                        00989000
              AIF   (K'&ZCGPR GT 2).ZG14Q                               00990000
              AIF   ('&ZCGPR' EQ '0').ZG14Q                             00991000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00992000
              AIF   (T'&ZCGPR NE 'N').ZG14Q     INVALID REG NAME        00993000
.ZG14P        ANOP  ,                                                   00994000
              AIF   (T'&ZCGPR NE 'N').ZG14R     NON NUMERIC             00995000
              AIF   ('&ZCGPR' LT '2').ZG14Q                             00996000
              AIF   ('&ZCGPR' LE '12').ZG14R                            00997000
.ZG14Q        ANOP  ,                                                   00998000
&ZMS          SETC  '"CDRLEN='  *KGPRA* MNOTE                           00999000
&ZMS          SETC  '&ZMS.&CDRLEN"'                                     01000000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01001000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01002000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01003000
.ZG14R        ANOP  ,                                                   01004000
.*----------------------------------------------------------------***   01005000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    01005100
              AIF   (N'&CDRSIZE LE 1).ZG17A     CK NUM                  01005200
&ZMS          SETC  '"CDRSIZE='                 *KPOSA* MNOTE           01005300
&ZMS          SETC  '&ZMS.&CDRSIZE"'                                    01005400
&ZMS          SETC  '&ZMS "CDRSIZE"'                                    01005500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01005600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01005700
.ZG17A        ANOP  ,                                                   01005800
.*-------------------------------------------------------------------   01005900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        01006000
              AIF   (K'&CDRSIZE(1) LE 0).ZG17C  NO PARM                 01006100
&ZXCDRSIZE    SETC  'OUTPUT'    SET OUTPUT                              01006200
&XCDRSIZE     SETC  '&CDRSIZE(1)'               SET XVARIABLE           01006300
              AIF   (N'&CDRSIZE GT 1).ZG17C                             01006400
&XCDRSIZE     SETC  '&CDRSIZE'  SET XVARIABLE                           01006500
.ZG17C        ANOP  ,                                                   01006600
.*-------------------------------------------------------------------   01006700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   01006800
              AIF   (K'&ZXCDRSIZE LE 0).ZG17R   NOT I/O                 01006900
              AIF   ('&XCDRSIZE'(1,1) NE '(').ZG17R                     01007000
&ZCGPR        SETC  '&XCDRSIZE'(2,K'&XCDRSIZE-2)                        01007100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                        01007200
              AIF   (K'&ZCGPR GT 2).ZG17Q                               01007300
              AIF   ('&ZCGPR' EQ '0').ZG17Q                             01007400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01007500
              AIF   (T'&ZCGPR NE 'N').ZG17Q     INVALID REG NAME        01007600
.ZG17P        ANOP  ,                                                   01007700
              AIF   (T'&ZCGPR NE 'N').ZG17R     NON NUMERIC             01007800
              AIF   ('&ZCGPR' LT '2').ZG17Q                             01007900
              AIF   ('&ZCGPR' LE '12').ZG17R                            01008000
.ZG17Q        ANOP  ,                                                   01008100
&ZMS          SETC  '"CDRSIZE='                 *KGPRA* MNOTE           01008200
&ZMS          SETC  '&ZMS.&CDRSIZE"'                                    01008300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01008400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01008500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01008600
.ZG17R        ANOP  ,                                                   01008700
.*----------------------------------------------------------------***   01008800
.***AG.KKWRD01 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             01008900
              AIF   (N'&READ LE 1).ZG20A        CK NUM                  01009000
&ZMS          SETC  '"READ='    *KPOSA* MNOTE                           01009100
&ZMS          SETC  '&ZMS.&READ"'                                       01009200
&ZMS          SETC  '&ZMS "READ"'                                       01010000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01011000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01012000
.ZG20A        ANOP  ,                                                   01013000
.*-------------------------------------------------------------------   01014000
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             01015000
&XREAD        SETC  ''          INITIALIZE XVARIABLE                    01016000
.ZG21A   AIF   ('&READ(1)' NE 'NOIO').ZG22A                             01017000
&XREAD        SETC  'NOIO'      SET KEYWORD                             01018000
.*-------------------------------------------------------------------   01019000
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             01020000
.ZG22A   AIF   ('&READ(1)' NE 'IO').ZG23A                               01021000
&XREAD        SETC  'IO'        SET KEYWORD                             01022000
.*-------------------------------------------------------------------   01023000
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             01024000
.ZG23A   AIF   ('&READ(1)' NE 'COND').ZG24A                             01025000
&XREAD        SETC  'COND'      SET KEYWORD                             01026000
.*-------------------------------------------------------------------   01027000
.***AG.KKWRD03 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             01028000
.ZG24A        AIF   (K'&XREAD GT 0).ZG24C       KEYWORD                 01029000
              AIF   (K'&READ(1) LE 0).ZG24B                             01030000
&ZMS          SETC  '"READ='    *KUKWA* MNOTE                           01031000
&ZMS          SETC  '&ZMS.&READ"'                                       01032000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           01033000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 01034000
&ZMS          SETC  '&ZMS "NOIO",'              VALID KEYWORD           01035000
&ZMS          SETC  '&ZMS "IO",'                VALID KEYWORD           01036000
&ZMS          SETC  '&ZMS OR "COND".'           VALID KEYWORD           01037000
              MNOTE 8,' &ZMS '                                          01038000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01039000
.ZG24B        ANOP  ,                                                   01040000
&XREAD        SETC  'NOIO'      SET DEFAULT KEYWORD                     01041000
.ZG24C        ANOP  ,                                                   01042000
&ZXREAD       SETC  'INPUT'     SET IN/OUTPUT                           01043000
.*-------------------------------------------------------------------   01044000
.***AG.KKWRD04 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             01045000
              AIF   (K'&READ(1) GT 0).ZG24D     VALID                   01046000
&ZXREAD       SETC  ''          RESET IN/OUTPUT                         01047000
&ZMS          SETC  'THE'                                               01048000
&ZMS          SETC  '&ZMS "READ" KEY AND ITS ARGUMENT'                  01049000
&ZMS          SETC  '&ZMS ARE REQUIRED.'                                01050000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 01051000
&ZMS          SETC  '&ZMS "NOIO",'              VALID KEYWORD           01052000
&ZMS          SETC  '&ZMS "IO",'                VALID KEYWORD           01053000
&ZMS          SETC  '&ZMS OR "COND".'           VALID KEYWORD           01054000
              MNOTE 8,' &ZMS '                                          01055000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01056000
.ZG24D        ANOP  ,                                                   01057000
.*----------------------------------------------------------------***   01058000
.***AG.KXVAR05 NAME, OPT INOUT, KEYS -XVARIABLE KEY                     01059000
              AIF   (N'&STATUS LE 1).ZG26A      CK NUM                  01060000
&ZMS          SETC  '"STATUS='  *KPOSA* MNOTE                           01061000
&ZMS          SETC  '&ZMS.&STATUS"'                                     01062000
&ZMS          SETC  '&ZMS "STATUS"'                                     01063000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01064000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01065000
.ZG26A        ANOP  ,                                                   01066000
.*-------------------------------------------------------------------   01067000
.***AG.KXVAR13 NAME, OPT INOUT, KEYS -XVARIABLE                         01068000
&ZXSTATUS     SETC  'INOUT'     SET IN/OUTPUT                           01069000
&XSTATUS      SETC  'NONE'                                              01070000
              AIF   (K'&STATUS(1) LE 0).ZG26B   PARM                    01071000
&XSTATUS      SETC  '&STATUS(1)'                SET XVARIABLE           01072000
              AIF   (N'&STATUS GT 1).ZG26B      MULTI PARMS             01073000
&XSTATUS      SETC  '&STATUS'   SET XVARIABLE                           01074000
.ZG26B        ANOP  ,                                                   01115000
.*-------------------------------------------------------------------   01116000
.***AG.KCK02 NAME, OPT INOUT, KEYS -GPR OUT OF RANGE                    01116800
              AIF   (K'&ZXSTATUS LE 0).ZG26R    NOT I/O                 01117600
              AIF   ('&XSTATUS' EQ 'NONE').ZG26R                        01118400
              AIF   ('&XSTATUS'(1,1) NE '(').ZG26R                      01119200
&ZCGPR        SETC  '&XSTATUS'(2,K'&XSTATUS-2)                          01120000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                        01121000
              AIF   (K'&ZCGPR GT 2).ZG26Q                               01122000
              AIF   ('&ZCGPR' EQ '0').ZG26Q                             01123000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01124000
              AIF   (T'&ZCGPR NE 'N').ZG26Q     INVALID REG NAME        01125000
.ZG26P        ANOP  ,                                                   01126000
              AIF   (T'&ZCGPR NE 'N').ZG26R     NON NUMERIC             01127000
              AIF   ('&ZCGPR' LT '2').ZG26Q                             01128000
              AIF   ('&ZCGPR' LE '12').ZG26R                            01129000
.ZG26Q        ANOP  ,                                                   01130000
&ZMS          SETC  '"STATUS='  *KGPRA* MNOTE                           01131000
&ZMS          SETC  '&ZMS.&STATUS"'                                     01132000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01133000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01134000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01135000
.ZG26R        ANOP  ,                                                   01136000
.*----------------------------------------------------------------***   01137000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     01138000
              AIF   (N'&TIME LE 1).ZG29A        CK NUM                  01139000
&ZMS          SETC  '"TIME='    *KPOSA* MNOTE                           01140000
&ZMS          SETC  '&ZMS.&TIME"'                                       01141000
&ZMS          SETC  '&ZMS "TIME"'                                       01142000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01143000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01144000
.ZG29A        ANOP  ,                                                   01145000
.*-------------------------------------------------------------------   01146000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         01147000
&ZXTIME       SETC  'INPUT'     SET IN/OUTPUT                           01148000
&XTIME        SETC  '5'                                                 01149000
              AIF   (K'&TIME(1) LE 0).ZG29B     PARM                    01150000
&XTIME        SETC  '&TIME(1)'  SET XVARIABLE                           01151000
              AIF   (N'&TIME GT 1).ZG29B        MULTI PARMS             01152000
&XTIME        SETC  '&TIME'     SET XVARIABLE                           01153000
.ZG29B        ANOP  ,                                                   01154000
.*-------------------------------------------------------------------   01155000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    01156200
              AIF   (K'&ZXTIME LE 0).ZG29R      NOT I/O                 01157400
              AIF   ('&XTIME'(1,1) NE '(').ZG29R                        01158600
&ZCGPR        SETC  '&XTIME'(2,K'&XTIME-2)                              01159800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                        01161000
              AIF   (K'&ZCGPR GT 2).ZG29Q                               01162000
              AIF   ('&ZCGPR' EQ '0').ZG29Q                             01163000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01164000
              AIF   (T'&ZCGPR NE 'N').ZG29Q     INVALID REG NAME        01165000
.ZG29P        ANOP  ,                                                   01166000
              AIF   (T'&ZCGPR NE 'N').ZG29R     NON NUMERIC             01167000
              AIF   ('&ZCGPR' LT '2').ZG29Q                             01168000
              AIF   ('&ZCGPR' LE '12').ZG29R                            01169000
.ZG29Q        ANOP  ,                                                   01170000
&ZMS          SETC  '"TIME='    *KGPRA* MNOTE                           01171000
&ZMS          SETC  '&ZMS.&TIME"'                                       01172000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01173000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01174000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01175000
.ZG29R        ANOP  ,                                                   01176000
.*----------------------------------------------------------------***   01177000
.***AG.KXVAR05 NAME, OPT INOUT, KEYS -XVARIABLE KEY                     01178000
              AIF   (N'&IOCTOKEN LE 1).ZG32A    CK NUM                  01179000
&ZMS          SETC  '"IOCTOKEN='                *KPOSA* MNOTE           01180000
&ZMS          SETC  '&ZMS.&IOCTOKEN"'                                   01181000
&ZMS          SETC  '&ZMS "IOCTOKEN"'                                   01182000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01183000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01184000
.ZG32A        ANOP  ,                                                   01185000
.*-------------------------------------------------------------------   01186000
.***AG.KXVAR13 NAME, OPT INOUT, KEYS -XVARIABLE                         01186800
&ZXIOCTOKEN   SETC  'INOUT'     SET IN/OUTPUT                           01187600
&XIOCTOKEN    SETC  'NONE'                                              01188400
              AIF   (K'&IOCTOKEN(1) LE 0).ZG32B  PARM                   01189200
&XIOCTOKEN    SETC  '&IOCTOKEN(1)'              SET XVARIABLE           01190000
              AIF   (N'&IOCTOKEN GT 1).ZG32B    MULTI PARMS             01190800
&XIOCTOKEN    SETC  '&IOCTOKEN'                 SET XVARIABLE           01191600
.ZG32B        ANOP  ,                                                   01192400
.*-------------------------------------------------------------------   01194000
.***AG.KCK02 NAME, OPT INOUT, KEYS -GPR OUT OF RANGE                    01194800
              AIF   (K'&ZXIOCTOKEN LE 0).ZG32R  NOT I/O                 01195600
              AIF   ('&XIOCTOKEN' EQ 'NONE').ZG32R                      01196400
              AIF   ('&XIOCTOKEN'(1,1) NE '(').ZG32R                    01197200
&ZCGPR        SETC  '&XIOCTOKEN'(2,K'&XIOCTOKEN-2)                      01198000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                        01199000
              AIF   (K'&ZCGPR GT 2).ZG32Q                               01200000
              AIF   ('&ZCGPR' EQ '0').ZG32Q                             01201000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01202000
              AIF   (T'&ZCGPR NE 'N').ZG32Q     INVALID REG NAME        01203000
.ZG32P        ANOP  ,                                                   01204000
              AIF   (T'&ZCGPR NE 'N').ZG32R     NON NUMERIC             01205000
              AIF   ('&ZCGPR' LT '2').ZG32Q                             01206000
              AIF   ('&ZCGPR' LE '12').ZG32R                            01207000
.ZG32Q        ANOP  ,                                                   01208000
&ZMS          SETC  '"IOCTOKEN='                *KGPRA* MNOTE           01209000
&ZMS          SETC  '&ZMS.&IOCTOKEN"'                                   01210000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01211000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01212000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01213000
.ZG32R        ANOP  ,                                                   01214000
.*----------------------------------------------------------------***   01215000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01215100
              AIF   (N'&LINKAGE LE 1).ZG35A     CK NUM                  01215200
&ZMS          SETC  '"LINKAGE='                 *KPOSA* MNOTE           01215300
&ZMS          SETC  '&ZMS.&LINKAGE"'                                    01215400
&ZMS          SETC  '&ZMS "LINKAGE"'                                    01215500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01215600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01215700
.ZG35A        ANOP  ,                                                   01215800
.*-------------------------------------------------------------------   01215900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01216000
&XLINKAGE     SETC  ''          INITIALIZE XVARIABLE                    01216100
.ZG36A   AIF   ('&LINKAGE(1)' NE 'LINK').ZG37A                          01216200
&XLINKAGE     SETC  'LINK'      SET KEYWORD                             01216300
.*-------------------------------------------------------------------   01216400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01216500
.ZG37A   AIF   ('&LINKAGE(1)' NE 'SYSTEM').ZG38A                        01216600
&XLINKAGE     SETC  'SYSTEM'    SET KEYWORD                             01216700
.*-------------------------------------------------------------------   01216800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             01216900
.ZG38A        AIF   (K'&XLINKAGE GT 0).ZG38C    KEYWORD                 01217000
              AIF   (K'&LINKAGE(1) LE 0).ZG38B                          01217100
&ZMS          SETC  '"LINKAGE='                 *KUKWA* MNOTE           01217200
&ZMS          SETC  '&ZMS.&LINKAGE"'                                    01217300
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           01217400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 01217500
&ZMS          SETC  '&ZMS "LINK"'               VALID KEYWORD           01217600
&ZMS          SETC  '&ZMS OR "SYSTEM".'         VALID KEYWORD           01217700
              MNOTE 8,' &ZMS '                                          01217800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01217900
.ZG38B        ANOP  ,                                                   01218000
&XLINKAGE     SETC  'LINK'      SET DEFAULT KEYWORD                     01218100
.ZG38C        ANOP  ,                                                   01218200
&ZXLINKAGE    SETC  'INPUT'     SET IN/OUTPUT                           01218300
.*----------------------------------------------------------------***   01218400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    01218500
              AIF   (N'&RETCODE LE 1).ZG40A     CK NUM                  01218600
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           01218700
&ZMS          SETC  '&ZMS.&RETCODE"'                                    01218800
&ZMS          SETC  '&ZMS "RETCODE"'                                    01218900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01219000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01219100
.ZG40A        ANOP  ,                                                   01219200
.*-------------------------------------------------------------------   01219300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        01219400
              AIF   (K'&RETCODE(1) LE 0).ZG40C  NO PARM                 01219500
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              01219600
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           01219700
              AIF   (N'&RETCODE GT 1).ZG40C                             01219800
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           01219900
.ZG40C        ANOP  ,                                                   01220000
.*-------------------------------------------------------------------   01220100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   01220200
              AIF   (K'&ZXRETCODE LE 0).ZG40R   NOT I/O                 01220300
              AIF   ('&XRETCODE'(1,1) NE '(').ZG40R                     01220400
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        01220500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG40P                        01220600
              AIF   (K'&ZCGPR GT 2).ZG40Q                               01220700
              AIF   ('&ZCGPR' EQ '0').ZG40Q                             01220800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01220900
              AIF   (T'&ZCGPR NE 'N').ZG40Q     INVALID REG NAME        01221000
.ZG40P        ANOP  ,                                                   01221100
              AIF   (T'&ZCGPR NE 'N').ZG40R     NON NUMERIC             01221200
              AIF   ('&ZCGPR' LT '2').ZG40Q                             01221300
              AIF   ('&ZCGPR' LE '12').ZG40R                            01221400
.ZG40Q        ANOP  ,                                                   01221500
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           01221600
&ZMS          SETC  '&ZMS.&RETCODE"'                                    01221700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01221800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01221900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01222000
.ZG40R        ANOP  ,                                                   01222100
.*----------------------------------------------------------------***   01222200
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    01222300
              AIF   (N'&RSNCODE LE 1).ZG43A     CK NUM                  01222400
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           01222500
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    01222600
&ZMS          SETC  '&ZMS "RSNCODE"'                                    01222700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 01222800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01222900
.ZG43A        ANOP  ,                                                   01223000
.*-------------------------------------------------------------------   01224000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        01225000
              AIF   (K'&RSNCODE(1) LE 0).ZG43C  NO PARM                 01226000
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              01227000
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           01228000
              AIF   (N'&RSNCODE GT 1).ZG43C                             01229000
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           01230000
.ZG43C        ANOP  ,                                                   01231000
.*-------------------------------------------------------------------   01232000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   01233000
              AIF   (K'&ZXRSNCODE LE 0).ZG43R   NOT I/O                 01234000
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG43R                     01235000
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        01236000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG43P                        01237000
              AIF   (K'&ZCGPR GT 2).ZG43Q                               01238000
              AIF   ('&ZCGPR' EQ '0').ZG43Q                             01239000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       01240000
              AIF   (T'&ZCGPR NE 'N').ZG43Q     INVALID REG NAME        01241000
.ZG43P        ANOP  ,                                                   01242000
              AIF   (T'&ZCGPR NE 'N').ZG43R     NON NUMERIC             01243000
              AIF   ('&ZCGPR' LT '2').ZG43Q                             01244000
              AIF   ('&ZCGPR' LE '12').ZG43R                            01245000
.ZG43Q        ANOP  ,                                                   01246000
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           01247000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    01248000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           01249000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    01250000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01251000
.ZG43R        ANOP  ,                                                   01252000
.******************************************************************     01253000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        01254000
.******************************************************************     01255000
              ACTR  10000                                               01256000
.*----------------------------------------------------------------***   01257000
.***AH.P02 EXTRA POSITIONALS                                            01258000
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               01259000
&ZCVAL        SETC  ''          ERROR FIELD                             01260000
&ZAWRK        SETA  0           POSITIONAL NUMBER                       01261000
.ZGLIST2      ANOP  ,                                                   01262000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         01263000
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                01264000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   01265000
              AGO   .ZGLIST2                                            01266000
.*                                                                      01267000
.ZGLIST3      ANOP  ,                                                   01268000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             01269000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           01270000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     01271000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              01272000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      01273000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              01274000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             01275000
.ZGLISTX      ANOP  ,                                                   01276000
&ZASYSLNDX    SETA  0                                                   01277000
.*-------------------------------------------------------------------   01278000
.***AG.MF04 MF=(SLE)                                                    01279000
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                01280000
.*******************************************************************    01281000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       01282000
.*******************************************************************    01283000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          01284000
.*******************************************************************    01285000
.***AE.01  START OF IOSCDR MACRO CODE                                   01286000
.*******************************************************************    01287000
              LCLC  &M0M0001                 NAME                       01288000
&M0M0001      SETC  '&XLABEL'                SET NAME                   01289000
              AIF   (K'&XLABEL NE 0).XLAB2                              01290000
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               01291000
.*                                                                      01292000
.XLAB2        ANOP  ,                                                   01293000
&M0M0001 DS    0H                             IOSCDR-1                  01294000
.*******************************************************************    01295000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              01296000
.*******************************************************************    01297000
              PUSH  PRINT                                               01298000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          01299000
              PRINT OFF         ++ PR01                                 01300000
              AGO   .ZPRNTXX                                            01301000
.ZPRINTX      PRINT ON                                                  01302000
.ZPRNTXX      ANOP  ,                                                   01303000
.********************************************************************   01306000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     01307000
.********************************************************************   01308000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       01309000
                      LCLA  &ZOPN1         INVOCATION INDEX             01310000
                      LCLC  &ZOPL(4095)    LABEL                        01311000
                      LCLC  &ZOPO(4095)    OPERATION                    01312000
                      LCLC  &ZOPV(4095)    VALUE                        01313000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  01314000
.*                                                                      01315000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     01316000
.******************************************************************     01317000
.***AL.L10 IOSCDR FMT=LIST MF=S|L PARAMETERS                            01318000
.******************************************************************     01319000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     01320000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     01321000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     01322000
&XMFATTR              SETC  '0D'                                        01323000
.*                                                                      01324000
&ZOPN                 SETA  &ZOPN+1                                     01325000
&ZOPL(&ZOPN)          SETC  ' '                                         01326000
&ZOPO(&ZOPN)          SETC  'B'                                         01327000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                01328000
&ZOPD(&ZOPN)          SETC  '++ IOSCDR ARG PARMS'                       01329000
.*                                                                      01330000
&ZOPN                 SETA  &ZOPN+1                                     01331000
&ZOPL(&ZOPN)          SETC  ' '                                         01332000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     01333000
&ZOPV(&ZOPN)          SETC  '1'                                         01334000
&ZOPD(&ZOPN)          SETC  ' '                                         01335000
.*                                                                      01336000
.ZLMFSL2              ANOP  ,                                           01337000
.*-------------------------------------------------------------------   01338000
.***AM.L01  IOSCDR FMT=LIST PARAMETERS                                  01339000
&ZOPN                 SETA &ZOPN+1                                      01340000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   01341000
&ZOPO(&ZOPN)          SETC 'DS'                                         01342000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   01343000
&ZOPD(&ZOPN)          SETC '++ IOSCDR PARM LIST'                        01344000
.*-------------------------------------------------------------------   01345000
.***AM.L02 XVERSION XL1                                                 01346000
&ZOPN                 SETA &ZOPN+1                                      01347000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         01348000
&ZOPO(&ZOPN)          SETC 'DS'                                         01349000
&ZOPV(&ZOPN)          SETC 'XL1'                                        01350000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          01351000
.*-------------------------------------------------------------------   01352000
.***AM.L03 XKEYUSEDFLAGS BL.8                                           01353000
&ZOPN                 SETA &ZOPN+1                                      01354000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XKEYUSEDFLAGS'                    01355000
&ZOPO(&ZOPN)          SETC 'DS'                                         01356000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       01357000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             01358000
.*                                                                      01359000
&ZOPN                 SETA  &ZOPN+1                                     01360000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_TIME'                    01361000
&ZOPO(&ZOPN)          SETC  'EQU'                                       01362000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             01363000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               01364000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).TIME'                         01365000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      01366000
.*                                                                      01367000
&ZOPN                 SETA  &ZOPN+1                                     01368000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_IOCTOKEN'                01369000
&ZOPO(&ZOPN)          SETC  'EQU'                                       01370000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             01371000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               01372000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).IOCTOKEN'                     01373000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      01374000
.*                                                                      01375000
&ZOPN                 SETA  &ZOPN+1                                     01376000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_STATUS'                  01377000
&ZOPO(&ZOPN)          SETC  'EQU'                                       01378000
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             01379000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               01380000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).STATUS'                       01381000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      01382000
.*                                                                      01383000
&ZOPN                 SETA  &ZOPN+1                                     01384000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CDRSIZE'                 01385000
&ZOPO(&ZOPN)          SETC  'EQU'                                       01386000
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             01387000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               01388000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CDRSIZE'                      01389000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      01390000
.*                                                                      01391000
&ZOPN                 SETA  &ZOPN+1                                     01392000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREAD_IO'                        01393000
&ZOPO(&ZOPN)          SETC  'EQU'                                       01394000
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             01395000
&ZOPD(&ZOPN)          SETC  '++ XREAD.'                                 01396000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).IO'                           01397000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      01398000
.*                                                                      01399000
&ZOPN                 SETA  &ZOPN+1                                     01400000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREAD_COND'                      01401000
&ZOPO(&ZOPN)          SETC  'EQU'                                       01402000
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             01403000
&ZOPD(&ZOPN)          SETC  '++ XREAD.'                                 01404000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).COND'                         01405000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      01406000
.*                                                                      01407000
&ZOPN                 SETA  &ZOPN+1                                     01408000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREAD_NOIO'                      01409000
&ZOPO(&ZOPN)          SETC  'EQU'                                       01410000
&ZOPV(&ZOPN)          SETC  'B''00000010'''                             01411000
&ZOPD(&ZOPN)          SETC  '++ XREAD.'                                 01412000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NOIO'                         01413000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      01414000
.*-------------------------------------------------------------------   01415000
.***AM.L09  XDEVN XL2                                                   01416000
&ZOPN                 SETA &ZOPN+1                                      01417000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDEVN'                            01418000
&ZOPO(&ZOPN)          SETC 'DS'                                         01419000
&ZOPV(&ZOPN)          SETC 'XL2'                                        01420000
&ZOPD(&ZOPN)          SETC '++ &ZXDEVN  XDEVN'                          01421000
.*-------------------------------------------------------------------   01422000
.***AM.L09  XTIME CL8                                                   01423000
&ZOPN                 SETA &ZOPN+1                                      01424000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTIME'                            01425000
&ZOPO(&ZOPN)          SETC 'DS'                                         01426000
&ZOPV(&ZOPN)          SETC 'CL8'                                        01427000
&ZOPD(&ZOPN)          SETC '++ &ZXTIME  XTIME'                          01428000
.*-------------------------------------------------------------------   01429000
.***AM.L09 ADDR XIOCTOKEN A                                             01430000
&ZOPN                 SETA &ZOPN+1                                      01431000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XIOCTOKEN_ADDR'                   01432000
&ZOPO(&ZOPN)          SETC 'DS'                                         01433000
&ZOPV(&ZOPN)          SETC 'A'                                          01434000
&ZOPD(&ZOPN)          SETC '++ &ZXIOCTOKEN ADDR XIOCTOKEN'              01435000
.*-------------------------------------------------------------------   01436000
.***AM.L09  XCDRAREA A                                                  01437000
&ZOPN                 SETA &ZOPN+1                                      01438000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCDRAREA'                         01439000
&ZOPO(&ZOPN)          SETC 'DS'                                         01440000
&ZOPV(&ZOPN)          SETC 'A'                                          01441000
&ZOPD(&ZOPN)          SETC '++ &ZXCDRAREA  XCDRAREA'                    01442000
.*-------------------------------------------------------------------   01443000
.***AM.L09  XCDRLEN F                                                   01444000
&ZOPN                 SETA &ZOPN+1                                      01445000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCDRLEN'                          01446000
&ZOPO(&ZOPN)          SETC 'DS'                                         01447000
&ZOPV(&ZOPN)          SETC 'F'                                          01448000
&ZOPD(&ZOPN)          SETC '++ &ZXCDRLEN  XCDRLEN'                      01449000
.*-------------------------------------------------------------------   01450000
.***AM.L09  XCDRSIZE F                                                  01451000
&ZOPN                 SETA &ZOPN+1                                      01452000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCDRSIZE'                         01453000
&ZOPO(&ZOPN)          SETC 'DS'                                         01454000
&ZOPV(&ZOPN)          SETC 'F'                                          01455000
&ZOPD(&ZOPN)          SETC '++ &ZXCDRSIZE  XCDRSIZE'                    01456000
.*-------------------------------------------------------------------   01457000
.***AM.L09  XSTATUS BL.8                                                01458000
&ZOPN                 SETA &ZOPN+1                                      01459000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTATUS'                          01460000
&ZOPO(&ZOPN)          SETC 'DS'                                         01461000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       01462000
&ZOPD(&ZOPN)          SETC '++ &ZXSTATUS  XSTATUS'                      01463000
.*-------------------------------------------------------------------   01464000
.***AM.L09  XRSV1000 CL1                                                01465000
&ZOPN                 SETA &ZOPN+1                                      01466000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV1000'                         01467000
&ZOPO(&ZOPN)          SETC 'DS'                                         01468000
&ZOPV(&ZOPN)          SETC 'CL1'                                        01469000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV1000'                      01470000
.*-------------------------------------------------------------------   01471000
.***AM.L09  XCHPID XL1                                                  01472000
&ZOPN                 SETA &ZOPN+1                                      01473000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCHPID'                           01474000
&ZOPO(&ZOPN)          SETC 'DS'                                         01475000
&ZOPV(&ZOPN)          SETC 'XL1'                                        01476000
&ZOPD(&ZOPN)          SETC '++ &ZXCHPID  XCHPID'                        01477000
.*-------------------------------------------------------------------   01478000
.***AM.L09  XRSV2000 CL5                                                01479000
&ZOPN                 SETA &ZOPN+1                                      01480000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV2000'                         01481000
&ZOPO(&ZOPN)          SETC 'DS'                                         01482000
&ZOPV(&ZOPN)          SETC 'CL5'                                        01483000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV2000'                      01484000
.*-------------------------------------------------------------------   01485000
.***AM.L10 END OF IOSCDR LIST PARAMETERS                                01486000
&ZOPN                 SETA &ZOPN+1                                      01487000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 01488000
&ZOPO(&ZOPN)          SETC 'EQU'                                        01489000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 01490000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         01491000
.*                                                                      01492000
&ZOPN                 SETA &ZOPN+1                                      01493000
&ZOPL(&ZOPN)          SETC ' '                                          01494000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      01495000
&ZOPV(&ZOPN)          SETC '1'                                          01496000
&ZOPD(&ZOPN)          SETC ' '                                          01497000
.*-------------------------------------------------------------------   01498000
.***AL.L12 IOSCDR FMT=LIST MF=S|L PARAMETERS                            01499000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         01500000
.*                                                                      01501000
&ZOPN                 SETA  &ZOPN+1                                     01502000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                01503000
&ZOPO(&ZOPN)          SETC  'DC'                                        01504000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   01505000
&ZOPD(&ZOPN)          SETC  '++ IOSCDR ARG PARMS'                       01506000
.*                                                                      01507000
.ZLMFSLX              ANOP  ,                                           01508000
.*-------------------------------------------------------------------   01509000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          01510000
&ZPLLEN               SETA 36                                           01511000
.*                                                                      01512000
.******************************************************************     01513000
.***AI.L01 IOSCDR FMT=LIST FILL IN PARAMETER AREA                       01514000
.******************************************************************     01515000
                      ACTR  10000                                       01516000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               01517000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    01518000
&ZCVAL                SETC  'LAE'          XAX MODE                     01519000
.ZIMFXA               ANOP ,                                            01520000
.*                                                                      01521000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    01522000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         01523000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 01524000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                01525000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 01526000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                01527000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   01528000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    01529000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   01530000
&ZOPN                 SETA  &ZOPN+1                                     01531000
&ZOPL(&ZOPN)          SETC  ' '                                         01532000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    01533000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              01534000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       01535000
                      AGO   .ZIMFNX                                     01536000
.*                                                                      01537000
.ZIMFN2               ANOP ,                                            01538000
&ZOPN                 SETA  &ZOPN+1                                     01539000
&ZOPL(&ZOPN)          SETC  ' '                                         01540000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    01541000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                01542000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       01543000
.ZIMFNX               ANOP ,                                            01544000
.********************************************************************   01545000
.***AI.L02 IOSCDR FMT=LIST INITIALIZE PARAMETER AREA                    01546000
.********************************************************************   01547000
.***AI.L03 MF=(SLE)                                                     01548000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      01549000
.*                                                                      01550000
&ZOPN                 SETA  &ZOPN+1                                     01551000
&ZOPL(&ZOPN)          SETC  ' '                                         01552000
&ZOPO(&ZOPN)          SETC  'XC'                                        01553000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         01554000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             01555000
.ZIMFLX               ANOP  ,                                           01556000
.*-------------------------------------------------------------------   01557000
.***AI.L04B XVERSION XL1                                                01558000
                      AIF   (&XPLISTVER EQ 0).ZIMFVX                    01558500
&ZOPN                 SETA  &ZOPN+1                                     01559000
&ZOPL(&ZOPN)          SETC  ' '                                         01560000
&ZOPO(&ZOPN)          SETC  'MVI'                                       01561000
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           01562000
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     01563000
.ZIMFVX               ANOP  ,                                           01563500
.*-------------------------------------------------------------------   01564000
.***AI.L05 XKEYUSEDFLAGS BL1                                            01565000
&ZW                   SETC  ''                                          01566000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            01567000
.*-------------------------------------------------------------------   01568000
.***AI.L08 XKEYUSEDFLAGS "TIME"                                         01569000
.***      BL1'1XXXXXXX'                                                 01570000
         AIF   ('&TIME' EQ '').ZI3A                                     01571000
&ZW                   SETC  '&ZW.1'                                     01572000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              01573000
                      AGO   .ZI3C                                       01574000
.*                                                                      01575000
.ZI3A                 ANOP  ,                                           01576000
&ZW                   SETC  '&ZW.0'                                     01577000
.ZI3C                 ANOP  ,                                           01578000
.*-------------------------------------------------------------------   01579000
.***AI.L08 XKEYUSEDFLAGS "IOCTOKEN"                                     01580000
.***      BL1'X1XXXXXX'                                                 01581000
         AIF   ('&IOCTOKEN' EQ '').ZI4A                                 01582000
         AIF   ('&IOCTOKEN' EQ 'NONE').ZI4A                             01583000
&ZW                   SETC  '&ZW.1'                                     01584000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              01585000
                      AGO   .ZI4C                                       01586000
.*                                                                      01587000
.ZI4A                 ANOP  ,                                           01588000
&ZW                   SETC  '&ZW.0'                                     01589000
.ZI4C                 ANOP  ,                                           01590000
.*-------------------------------------------------------------------   01591000
.***AI.L08 XKEYUSEDFLAGS "STATUS"                                       01592000
.***      BL1'XX1XXXXX'                                                 01593000
         AIF   ('&STATUS' EQ '').ZI5A                                   01594000
         AIF   ('&STATUS' EQ 'NONE').ZI5A                               01595000
&ZW                   SETC  '&ZW.1'                                     01596000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              01597000
                      AGO   .ZI5C                                       01598000
.*                                                                      01599000
.ZI5A                 ANOP  ,                                           01600000
&ZW                   SETC  '&ZW.0'                                     01601000
.ZI5C                 ANOP  ,                                           01602000
.*-------------------------------------------------------------------   01603000
.***AI.L08 XKEYUSEDFLAGS "CDRSIZE"                                      01604000
.***      BL1'XXX1XXXX'                                                 01605000
         AIF   ('&CDRSIZE' EQ '').ZI6A                                  01606000
&ZW                   SETC  '&ZW.1'                                     01607000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              01608000
                      AGO   .ZI6C                                       01609000
.*                                                                      01610000
.ZI6A                 ANOP  ,                                           01611000
&ZW                   SETC  '&ZW.0'                                     01612000
.ZI6C                 ANOP  ,                                           01613000
.*-------------------------------------------------------------------   01614000
.***AI.L08 XKEYUSEDFLAGS "IO"                                           01615000
.***      BL1'XXXX1XXX'                                                 01616000
         AIF   ('&XREAD' NE 'IO').ZI7A                                  01617000
&ZW                   SETC  '&ZW.1'                                     01618000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              01619000
                      AGO   .ZI7C                                       01620000
.*                                                                      01621000
.ZI7A                 ANOP  ,                                           01622000
&ZW                   SETC  '&ZW.0'                                     01623000
.ZI7C                 ANOP  ,                                           01624000
.*-------------------------------------------------------------------   01625000
.***AI.L08 XKEYUSEDFLAGS "COND"                                         01626000
.***      BL1'XXXXX1XX'                                                 01627000
         AIF   ('&XREAD' NE 'COND').ZI8A                                01628000
&ZW                   SETC  '&ZW.1'                                     01629000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              01630000
                      AGO   .ZI8C                                       01631000
.*                                                                      01632000
.ZI8A                 ANOP  ,                                           01633000
&ZW                   SETC  '&ZW.0'                                     01634000
.ZI8C                 ANOP  ,                                           01635000
.*-------------------------------------------------------------------   01636000
.***AI.L08 XKEYUSEDFLAGS "NOIO"                                         01637000
.***      BL1'XXXXXX1X'                                                 01638000
         AIF   ('&XREAD' NE 'NOIO').ZI9A                                01639000
&ZW                   SETC  '&ZW.10'                                    01640000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              01641000
                      AGO   .ZI9C                                       01642000
.*                                                                      01643000
.ZI9A                 ANOP  ,                                           01644000
&ZW                   SETC  '&ZW.00'                                    01645000
.ZI9C                 ANOP  ,                                           01646000
.*-------------------------------------------------------------------   01647000
.***AI.L11 XKEYUSEDFLAGS BL1                                            01648000
                      AIF   ('&ZCLNG' NE 'YES').ZI9E  ALL ZERO BITS     01649000
&ZOPN                 SETA  &ZOPN+1                                     01650000
&ZOPL(&ZOPN)          SETC  ' '                                         01651000
&ZOPO(&ZOPN)          SETC  'OI'                                        01652000
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             01653000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              01654000
.ZI9E                 ANOP  ,                                           01655000
.*-------------------------------------------------------------------   01656000
.***AI.L25  XDEVN XL2                                                   01657000
                      AIF   ('&ZXDEVN' EQ '').ZI10E  NOT USED           01658000
                      AIF   ('&ZXDEVN' EQ 'OUTPUT').ZI10E               01659000
&ZCGPR                SETC  '&XDEVN'                                    01660000
.*                                                                      01661000
                      AIF   ('&XDEVN'(1,1) NE '(').ZI10B                01662000
&ZCGPR   SETC  '0('.'&XDEVN'(2,K'&XDEVN-2).')'                          01663000
                      AGO   .ZI10D                                      01664000
.ZI10B                ANOP  ,                                           01665000
.*                                                                      01666000
&ZC                   SETC  '&XDEVN'(1,1)                               01667000
                      AIF   (T'&ZC NE 'N').ZI10D                        01668000
&ZC                   SETC  '&XDEVN'                                    01669000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               01670000
&ZCGPR                SETC  '=FL2''&XDEVN'''                            01671000
.*                                                                      01672000
.ZI10D                ANOP  ,                                           01673000
.*                                                                      01674000
&ZOPN                 SETA  &ZOPN+1                                     01675000
&ZOPL(&ZOPN)          SETC  ' '                                         01676000
&ZOPO(&ZOPN)          SETC  'MVC'                                       01677000
&ZOPV(&ZOPN)          SETC  '2(2,1),&ZCGPR'                             01678000
&ZOPD(&ZOPN)          SETC  '++ &ZXDEVN XDEVN XL2'                      01679000
.*                                                                      01680000
.ZI10E                ANOP  ,                                           01681000
.*-------------------------------------------------------------------   01682000
.***AI.L25  XTIME CL8                                                   01683000
                      AIF   ('&ZXTIME' EQ '').ZI11E  NOT USED           01684000
                      AIF   ('&ZXTIME' EQ 'OUTPUT').ZI11E               01685000
&ZCGPR                SETC  '&XTIME'                                    01686000
.*                                                                      01687000
                      AIF   ('&XTIME'(1,1) NE '(').ZI11B                01688000
&ZCGPR   SETC  '0('.'&XTIME'(2,K'&XTIME-2).')'                          01689000
                      AGO   .ZI11D                                      01690000
.ZI11B                ANOP  ,                                           01691000
.*                                                                      01692000
                      AIF   ('&TIME(1)' EQ '').ZI11I  OMITTED           01693000
&ZC                   SETC  '5'                                         01694000
                      AIF   ('&XTIME' NE '&ZC').ZI11C                   01695000
.ZI11I                ANOP  ,                                           01696000
&ZCGPR                SETC  '=CL8''&XTIME'''                            01697000
.ZI11C                ANOP  ,                                           01698000
.*                                                                      01699000
.ZI11D                ANOP  ,                                           01700000
.*                                                                      01701000
&ZOPN                 SETA  &ZOPN+1                                     01702000
&ZOPL(&ZOPN)          SETC  ' '                                         01703000
&ZOPO(&ZOPN)          SETC  'MVC'                                       01704000
&ZOPV(&ZOPN)          SETC  '4(8,1),&ZCGPR'                             01705000
&ZOPD(&ZOPN)          SETC  '++ &ZXTIME XTIME CL8'                      01706000
.*                                                                      01707000
.ZI11E                ANOP  ,                                           01708000
.*-------------------------------------------------------------------   01709000
.***AI.L18 ADDR XIOCTOKEN A                                             01710000
                      AIF   ('&XIOCTOKEN' NE 'NONE').ZI12               01711000
&ZXIOCTOKEN           SETC  ''             RESET INPUT/OUTPUT           01712000
.ZI12                 ANOP  ,                                           01713000
.*-------------------------------------------------------------------   01714000
.***AI.L19 ADDR XIOCTOKEN A                                             01715000
                      AIF   ('&ZXIOCTOKEN' EQ '').ZI12H  NOT USED       01716000
&ZCLNG                SETC  '&XIOCTOKEN'                                01717000
&ZCGPR                SETC  '14'                                        01718000
         AIF   ('&XIOCTOKEN'(1,1) EQ '(').ZI12F  IN GPR                 01719000
.*                                                                      01720000
&ZOPN                 SETA  &ZOPN+1                                     01721000
&ZOPL(&ZOPN)          SETC  ' '                                         01722000
&ZOPO(&ZOPN)          SETC  'LA'                                        01723000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             01724000
&ZOPD(&ZOPN)          SETC  '++ &ZXIOCTOKEN XIOCTOKEN A'                01725000
.*                                                                      01726000
                      AGO   .ZI12G                                      01727000
.*                                                                      01728000
.ZI12F                ANOP  ,                                           01729000
&ZCGPR   SETC  '&XIOCTOKEN'(2,K'&XIOCTOKEN-2)                           01730000
.*                                                                      01731000
.ZI12G                ANOP  ,                                           01732000
.*                                                                      01733000
&ZOPN                 SETA  &ZOPN+1                                     01734000
&ZOPL(&ZOPN)          SETC  ' '                                         01735000
&ZOPO(&ZOPN)          SETC  'ST'                                        01736000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,12(,1)'                             01737000
&ZOPD(&ZOPN)          SETC  '++ &ZXIOCTOKEN XIOCTOKEN A'                01738000
.*                                                                      01739000
.ZI12H                ANOP  ,                                           01740000
.*-------------------------------------------------------------------   01741000
.***AI.L19  XCDRAREA A                                                  01742000
                      AIF   ('&ZXCDRAREA' EQ '').ZI13H  NOT USED        01743000
&ZCLNG                SETC  '&XCDRAREA'                                 01744000
&ZCGPR                SETC  '14'                                        01745000
         AIF   ('&XCDRAREA'(1,1) EQ '(').ZI13F  IN GPR                  01746000
.*                                                                      01747000
&ZOPN                 SETA  &ZOPN+1                                     01748000
&ZOPL(&ZOPN)          SETC  ' '                                         01749000
&ZOPO(&ZOPN)          SETC  'LA'                                        01750000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             01751000
&ZOPD(&ZOPN)          SETC  '++ &ZXCDRAREA XCDRAREA A'                  01752000
.*                                                                      01753000
                      AGO   .ZI13G                                      01754000
.*                                                                      01755000
.ZI13F                ANOP  ,                                           01756000
&ZCGPR   SETC  '&XCDRAREA'(2,K'&XCDRAREA-2)                             01757000
.*                                                                      01758000
.ZI13G                ANOP  ,                                           01759000
.*                                                                      01760000
&ZOPN                 SETA  &ZOPN+1                                     01761000
&ZOPL(&ZOPN)          SETC  ' '                                         01762000
&ZOPO(&ZOPN)          SETC  'ST'                                        01763000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             01764000
&ZOPD(&ZOPN)          SETC  '++ &ZXCDRAREA XCDRAREA A'                  01765000
.*                                                                      01766000
.ZI13H                ANOP  ,                                           01767000
.*-------------------------------------------------------------------   01768000
.***AI.L25  XCDRLEN F                                                   01769000
                      AIF   ('&ZXCDRLEN' EQ '').ZI14E  NOT USED         01770000
                      AIF   ('&ZXCDRLEN' EQ 'OUTPUT').ZI14E             01771000
&ZCGPR                SETC  '&XCDRLEN'                                  01772000
.*                                                                      01773000
                      AIF   ('&XCDRLEN'(1,1) NE '(').ZI14B              01774000
&ZCGPR   SETC  '0('.'&XCDRLEN'(2,K'&XCDRLEN-2).')'                      01775000
                      AGO   .ZI14D                                      01776000
.ZI14B                ANOP  ,                                           01777000
.*                                                                      01778000
&ZC                   SETC  '&XCDRLEN'(1,1)                             01779000
                      AIF   (T'&ZC NE 'N').ZI14D                        01780000
&ZC                   SETC  '&XCDRLEN'                                  01781000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI14D               01782000
&ZCGPR                SETC  '=FL4''&XCDRLEN'''                          01783000
.*                                                                      01784000
.ZI14D                ANOP  ,                                           01785000
.*                                                                      01786000
&ZOPN                 SETA  &ZOPN+1                                     01787000
&ZOPL(&ZOPN)          SETC  ' '                                         01788000
&ZOPO(&ZOPN)          SETC  'MVC'                                       01789000
&ZOPV(&ZOPN)          SETC  '20(4,1),&ZCGPR'                            01790000
&ZOPD(&ZOPN)          SETC  '++ &ZXCDRLEN XCDRLEN F'                    01791000
.*                                                                      01792000
.ZI14E                ANOP  ,                                           01793000
.*-------------------------------------------------------------------   01794000
.***AI.L18  XSTATUS XL1                                                 01795000
                      AIF   ('&XSTATUS' NE 'NONE').ZI16                 01796000
&ZXSTATUS             SETC  ''             RESET INPUT/OUTPUT           01797000
.ZI16                 ANOP  ,                                           01798000
.*-------------------------------------------------------------------   01799000
.***AI.L25  XSTATUS XL1                                                 01800000
                      AIF   ('&ZXSTATUS' EQ '').ZI16E  NOT USED         01801000
                      AIF   ('&ZXSTATUS' EQ 'OUTPUT').ZI16E             01802000
&ZCGPR                SETC  '&XSTATUS'                                  01803000
.*                                                                      01804000
                      AIF   ('&XSTATUS'(1,1) NE '(').ZI16B              01805000
&ZCGPR   SETC  '0('.'&XSTATUS'(2,K'&XSTATUS-2).')'                      01806000
                      AGO   .ZI16D                                      01807000
.ZI16B                ANOP  ,                                           01808000
.*                                                                      01809000
&ZC                   SETC  '&XSTATUS'(1,1)                             01810000
                      AIF   (T'&ZC NE 'N').ZI16D                        01811000
&ZC                   SETC  '&XSTATUS'                                  01812000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI16D               01813000
&ZCGPR                SETC  '=BL1''&XSTATUS'''                          01814000
.*                                                                      01815000
.ZI16D                ANOP  ,                                           01816000
.*                                                                      01817000
&ZOPN                 SETA  &ZOPN+1                                     01818000
&ZOPL(&ZOPN)          SETC  ' '                                         01819000
&ZOPO(&ZOPN)          SETC  'MVC'                                       01820000
&ZOPV(&ZOPN)          SETC  '28(1,1),&ZCGPR'                            01821000
&ZOPD(&ZOPN)          SETC  '++ &ZXSTATUS XSTATUS XL1'                  01822000
.*                                                                      01823000
.ZI16E                ANOP  ,                                           01824000
.*-------------------------------------------------------------------   01825000
.***AI.L25  XCHPID XL1                                                  01826000
                      AIF   ('&ZXCHPID' EQ '').ZI18E  NOT USED          01827000
                      AIF   ('&ZXCHPID' EQ 'OUTPUT').ZI18E              01828000
&ZCGPR                SETC  '&XCHPID'                                   01829000
.*                                                                      01830000
                      AIF   ('&XCHPID'(1,1) NE '(').ZI18B               01831000
&ZCGPR   SETC  '0('.'&XCHPID'(2,K'&XCHPID-2).')'                        01832000
                      AGO   .ZI18D                                      01833000
.ZI18B                ANOP  ,                                           01834000
.*                                                                      01835000
&ZC                   SETC  '&XCHPID'(1,1)                              01836000
                      AIF   (T'&ZC NE 'N').ZI18D                        01837000
&ZC                   SETC  '&XCHPID'                                   01838000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI18D               01839000
&ZCGPR                SETC  '=AL1(&XCHPID)'                             01840000
.*                                                                      01841000
.ZI18D                ANOP  ,                                           01842000
.*                                                                      01843000
&ZOPN                 SETA  &ZOPN+1                                     01844000
&ZOPL(&ZOPN)          SETC  ' '                                         01845000
&ZOPO(&ZOPN)          SETC  'MVC'                                       01846000
&ZOPV(&ZOPN)          SETC  '30(1,1),&ZCGPR'                            01847000
&ZOPD(&ZOPN)          SETC  '++ &ZXCHPID XCHPID XL1'                    01848000
.*                                                                      01849000
.ZI18E                ANOP  ,                                           01850000
.*-------------------------------------------------------------------   01851000
&ZOPN1                SETA &ZOPN                                        01852000
.*******************************************************************    01853000
.***  PROCESS IOSCDR OUTPUT PARAMETERS                                  01854000
.*******************************************************************    01855000
                      ACTR  10000                                       01856000
.*------------------------------------------------------------------    01857000
.***AO.LVER01                                                           01857200
                      AIF  (&XPLISTVER LT 1).ZO15Z  PLVER               01857400
.*------------------------------------------------------------------    01857600
.***AO.L02 XCDRSIZE F                                                   01858000
         AIF   ('&ZXCDRSIZE' EQ 'OUTPUT').ZO15A  OUTPUT                 01859000
         AIF   ('&ZXCDRSIZE' NE 'INOUT').ZO15C  INOUT                   01860000
.ZO15A    AIF   ('&XCDRSIZE'(1,1) NE '(').ZO15B  ADDR IN GPR            01861000
&ZCGPR   SETC  '&XCDRSIZE'(2,K'&XCDRSIZE-2)                             01862000
&ZOPN                 SETA  &ZOPN+1                                     01863000
&ZOPL(&ZOPN)          SETC  ' '                                         01864000
&ZOPO(&ZOPN)          SETC  'MVC'                                       01865000
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),24(1)'                         01866000
&ZOPD(&ZOPN)          SETC  '++ XCDRSIZE F'                             01867000
                      AGO   .ZO15C                                      01868000
.*                                                                      01869000
.ZO15B                ANOP  ,                                           01870000
&ZAWRK   SETA  K'&XCDRSIZE                                              01871000
         AIF   ('&XCDRSIZE'(&ZAWRK,1) NE ')').ZO15G                     01872000
&ZN      SETA  2                                                        01873000
.ZO15H    ANOP                                                          01874000
         AIF   (&ZN GE &ZAWRK).ZO15G                                    01875000
         AIF   ('&XCDRSIZE'(&ZN,1) NE '(').ZO15I                        01876000
&ZC      SETC  '&XCDRSIZE'(1,&ZN).'4'.','                               01877000
&ZC      SETC  '&ZC'.'&XCDRSIZE'(&ZN+1,&ZAWRK-&ZN).',24(1)'             01878000
         AGO   .ZO15J                                                   01879000
.ZO15I    ANOP                                                          01880000
&ZN      SETA  &ZN+1                                                    01881000
         AGO   .ZO15H                                                   01882000
.ZO15G    ANOP                                                          01883000
&ZC      SETC  '&XCDRSIZE.(4),24(1)'                                    01884000
.ZO15J    ANOP                                                          01885000
&ZOPN                 SETA  &ZOPN+1                                     01886000
&ZOPL(&ZOPN)          SETC  ' '                                         01887000
&ZOPO(&ZOPN)          SETC  'MVC'                                       01888000
&ZOPV(&ZOPN)          SETC  '&ZC'                                       01889000
&ZOPD(&ZOPN)          SETC  '++ XCDRSIZE F'                             01890000
.ZO15C                ANOP  ,                                           01891000
.*------------------------------------------------------------------    01891100
.***AO.LVER02                                                           01891200
.ZO15Z                ANOP  ,                                           01891300
.*------------------------------------------------------------------    01891400
.***AO.LVER01                                                           01891500
                      AIF  (&XPLISTVER LT 1).ZO16Z  PLVER               01891600
.*------------------------------------------------------------------    01892000
.***AO.L01 XSTATUS XL1                                                  01893000
                      AIF   ('&XSTATUS' NE 'NONE').ZO16  CK *           01894000
&ZXSTATUS             SETC  ''             RESET OUTPUT/INOUT           01895000
.ZO16                 ANOP  ,                                           01896000
.*------------------------------------------------------------------    01897000
.***AO.L02 XSTATUS XL1                                                  01898000
         AIF   ('&XSTATUS' NE 'NONE').ZO16D  CK DEF                     01899000
         AIF   ('&ZXSTATUS' NE 'OUTPUT').ZO16C  CK DEF                  01900000
.ZO16D                ANOP  ,                                           01901000
         AIF   ('&ZXSTATUS' EQ 'OUTPUT').ZO16A  OUTPUT                  01902000
         AIF   ('&ZXSTATUS' NE 'INOUT').ZO16C  INOUT                    01903000
.ZO16A    AIF   ('&XSTATUS'(1,1) NE '(').ZO16B  ADDR IN GPR             01904000
&ZCGPR   SETC  '&XSTATUS'(2,K'&XSTATUS-2)                               01905000
&ZOPN                 SETA  &ZOPN+1                                     01906000
&ZOPL(&ZOPN)          SETC  ' '                                         01907000
&ZOPO(&ZOPN)          SETC  'MVC'                                       01908000
&ZOPV(&ZOPN)          SETC  '0(1,&ZCGPR),28(1)'                         01909000
&ZOPD(&ZOPN)          SETC  '++ XSTATUS XL1'                            01910000
                      AGO   .ZO16C                                      01911000
.*                                                                      01912000
.ZO16B                ANOP  ,                                           01913000
&ZAWRK   SETA  K'&XSTATUS                                               01914000
         AIF   ('&XSTATUS'(&ZAWRK,1) NE ')').ZO16G                      01915000
&ZN      SETA  2                                                        01916000
.ZO16H    ANOP                                                          01917000
         AIF   (&ZN GE &ZAWRK).ZO16G                                    01918000
         AIF   ('&XSTATUS'(&ZN,1) NE '(').ZO16I                         01919000
&ZC      SETC  '&XSTATUS'(1,&ZN).'1'.','                                01920000
&ZC      SETC  '&ZC'.'&XSTATUS'(&ZN+1,&ZAWRK-&ZN).',28(1)'              01921000
         AGO   .ZO16J                                                   01922000
.ZO16I    ANOP                                                          01923000
&ZN      SETA  &ZN+1                                                    01924000
         AGO   .ZO16H                                                   01925000
.ZO16G    ANOP                                                          01926000
&ZC      SETC  '&XSTATUS.(1),28(1)'                                     01927000
.ZO16J    ANOP                                                          01928000
&ZOPN                 SETA  &ZOPN+1                                     01929000
&ZOPL(&ZOPN)          SETC  ' '                                         01930000
&ZOPO(&ZOPN)          SETC  'MVC'                                       01931000
&ZOPV(&ZOPN)          SETC  '&ZC'                                       01932000
&ZOPD(&ZOPN)          SETC  '++ XSTATUS XL1'                            01933000
.ZO16C                ANOP  ,                                           01934000
.*------------------------------------------------------------------    01934200
.***AO.LVER02                                                           01934400
.ZO16Z                ANOP  ,                                           01934600
.*******************************************************************    01935000
.***AO.X02  RETURN CODE PROCESSING                                      01936000
.*******************************************************************    01937000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    01938000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            01939000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             01940000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             01941000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               01942000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                01943000
&ZOPN                 SETA  &ZOPN+1                                     01944000
&ZOPL(&ZOPN)          SETC  ' '                                         01945000
&ZOPO(&ZOPN)          SETC  'ST'                                        01946000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              01947000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        01948000
                      AGO   .ZMRETX                                     01949000
.*                                                                      01950000
.ZMRET2               ANOP  ,                                           01951000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                01952000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                01953000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                01954000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  01955000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   01956000
&ZOPN                 SETA  &ZOPN+1                                     01957000
&ZOPL(&ZOPN)          SETC  ' '                                         01958000
&ZOPO(&ZOPN)          SETC  'LR'                                        01959000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 01960000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        01961000
.ZMRETX               ANOP  ,                                           01962000
.*******************************************************************    01963000
.***AO.X03  REASON CODE PROCESSING                                      01964000
.*******************************************************************    01965000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    01966000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            01967000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              01968000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             01969000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              01970000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             01971000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                01972000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 01973000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                01974000
&ZOPN                 SETA  &ZOPN+1                                     01975000
&ZOPL(&ZOPN)          SETC  ' '                                         01976000
&ZOPO(&ZOPN)          SETC  'ST'                                        01977000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               01978000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        01979000
                      AGO   .ZMRSNX                                     01980000
.*                                                                      01981000
.ZMRSN2               ANOP  ,                                           01982000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                01983000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 01984000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                01985000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 01986000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                01987000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   01988000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    01989000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   01990000
&ZOPN                 SETA  &ZOPN+1                                     01991000
&ZOPL(&ZOPN)          SETC  ' '                                         01992000
&ZOPO(&ZOPN)          SETC  'LR'                                        01993000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  01994000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        01995000
.ZMRSNX               ANOP  ,                                           01996000
.*******************************************************************    01997000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   01998000
.*******************************************************************    01999000
.ZMFLX                ANOP  ,              MF=L PROCESSING              02000000
.*******************************************************************    02001000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               02002000
.*******************************************************************    02003000
                      ACTR  10000                                       02004000
.*                                                                      02005000
                      LCLA  &ZLC           COLUMN POSITION              02006000
                      LCLA  &ZOPX          LIST TABLE INDEX             02007000
                      LCLC  &ZLL           LABEL                        02008000
                      LCLC  &ZLOP          OPERATION                    02009000
                      LCLC  &ZLV           VALUE                        02010000
                      LCLC  &ZLD           DESCRIPTION                  02011000
.*                                                                      02012000
&ZOPX                 SETA  1                                           02013000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            02014000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              02015000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              02016000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              02017000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              02018000
                      AIF   (K'&ZLD LE 0).ZL5                           02019000
&ZLC                  SETA  35             COMMENT COLUMN               02020000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    02021000
&ZLC                  SETA  33             COMMMENT COLUMN              02022000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   02023000
&ZLV                  SETC  '&ZLV'.' '                                  02024000
                      AGO   .ZL3                                        02025000
.*                                                                      02026000
.ZL4                  ANOP  ,                                           02027000
&ZLV                  SETC  '&ZLV'.' '                                  02028000
.ZL5                  ANOP  ,                                           02029000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               02030000
.*                                                                      02031000
&ZLL     &ZLOP &ZLV                                                     02032000
.*                                                                      02033000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               02034000
                      AGO   .ZL2           CONTINUE LOOPING             02035000
.*                                                                      02036000
.ZLX                  ANOP  ,                                           02037000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                02038000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  02039000
.*********************************************************************  02039100
.*                                                                   *  02039200
.*  Branch or PC linkage                                             *  02039300
.*                                                                   *  02039400
.*********************************************************************  02039500
         AIF    ('&XLINKAGE' NE 'LINK').LNKPC1                          02039600
         LINK EP=IOSVCDRI      ++ LINK TO MODULE IOSVCDRI               02040000
         AGO   .DONE1                                                   02040100
.LNKPC1  ANOP                                                           02040200
         L     14,16(0,0)         ++ GET CVT ADDRESS                    02040300
         L     14,772(14,0)       ++ GET SFT ADDRESS                    02040400
.*********************************************************************  02040500
.*                                                                   *  02040600
.*  Get LX/EX for IOSCDR Service                                     *  02040700
.*                                                                   *  02040800
.*  Note: LX/EX is calculated by multiplying the PC number (112)     *  02040900
.*        times the length of a PC/AUTH table entry (4) and          *  02041000
.*        then subtracting 4.                                        *  02041100
.*                                                                   *  02041200
.*********************************************************************  02041300
         L     14,444(14,0)       ++ GET LX/EX FOR IOSCDR Service       02041400
         PC    0(14)              ++ PC TO IOSVCDRP                     02041500
.DONE1   ANOP                                                           02041600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  02041700
.ZLINKX               ANOP  ,                                           02042000
.*******************************************************************    02043000
.***AP.X01  FORMAT GENERATED CODE                                       02044000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            02045000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              02046000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              02047000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              02048000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              02049000
                      AIF   (K'&ZLD LE 0).ZL51                          02050000
&ZLC                  SETA  35             COMMENT COLUMN               02051000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   02052000
&ZLC                  SETA  33             COMMENT COLUMN               02053000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  02054000
&ZLV                  SETC  '&ZLV'.' '                                  02055000
                      AGO   .ZL31                                       02056000
.*                                                                      02057000
.ZL41                 ANOP  ,                                           02058000
&ZLV                  SETC  '&ZLV'.' '                                  02059000
.ZL51                 ANOP  ,                                           02060000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               02061000
.*                                                                      02062000
&ZLL     &ZLOP &ZLV                                                     02063000
.*                                                                      02064000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               02065000
                      AGO   .ZL21          CONTINUE LOOPING             02066000
.*                                                                      02067000
.ZLX1                 ANOP  ,                                           02068000
.*******************************************************************    02069000
.***AP.X02  END OF IOSCDR MACRO                                         02070000
&ZIOSCDR              SETC  'YES'          SET IOSCDR USED              02071000
         POP   PRINT                                                    02072000
*                                            IOSCDR-1                   02073000
         SPACE 1                                                        02074000
.ZLX2                 ANOP  ,                                           02075000
         MEND                                                           02076000
**********************************************************************/ 02077000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  02078000
*%IOSCDR: MACRO KEYS(PLISTVER,DEVN,CHPID,CDRAREA,CDRLEN,CDRSIZE,READ,   02079000
*                 STATUS,TIME,IOCTOKEN,LINKAGE,RETCODE,RSNCODE,MF);     02080000
*  ANS('?'||MACLABEL||' '||'IOSCDRP '||MACLIST||                        02081000
*         ' '||MACKEYS||';') COL(MACLMAR);                              02082000
*%END IOSCDR;                                                           02083000
