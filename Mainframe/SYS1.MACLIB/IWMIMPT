*/**** START OF SPECIFICATIONS **************************************** 00050000
*                                                                     * 00100000
*                                                                     * 00150000
*01* MACRO NAME:  IWMIMPT                               -09/22/99-<0> * 00200000
*                                                                     * 00250000
*                                                                     * 00300000
*01* DESCRIPTIVE NAME:  WLM Import Service                            * 00350000
*                                                                     * 00400000
*01* PROPRIETARY STATEMENT:                                           * 00450000
*                                                                     * 00500000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00550000
*     5647-A01 (C) COPYRIGHT IBM CORP. 2000                           * 00650000
*                                                                     * 00700000
* STATUS= JBB6609                                                     * 00750000
*                                                                     * 00800000
*                                                                     * 00850000
*                                                                     * 00900000
*01* FUNCTION:                                                        * 00950000
*                                                                     * 01000000
*                                                                     * 01050000
*      The IWMIMPT macro imports an enclave that has been previously  * 01100000
*      exported using the IWMEXPT macro.                              * 01150000
*                                                                     * 01200000
*      The caller must invoke the IWMUIMPT macro when it no longer    * 01250000
*      needs access to the enclave.                                   * 01300000
*                                                                     * 01350000
*      The primary address space must have connected to WLM using the * 01400000
*      IWMCONN macro.                                                 * 01450000
*                                                                     * 01500000
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 01550000
*                                                                     * 01600000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 01650000
*                                                                     * 01700000
*01* ENVIRONMENT:                                                     * 01750000
*                                                                     * 01800000
*                                                                     * 01850000
*      Minimum authorization: Supervisor state or program key mask    * 01900000
*                        (PKM) allowing keys 0-7.                     * 01950000
*                                                                     * 02000000
*      Dispatchable unit mode: Task or SRB mode.                      * 02050000
*                                                                     * 02100000
*      Cross Memory Mode: Any HASN, any SASN.  PASN must be the       * 02150000
*                        address space which connected to WLM.        * 02200000
*                                                                     * 02250000
*      AMODE:            31-bit.                                      * 02300000
*                                                                     * 02350000
*      ASC mode:         Primary.                                     * 02400000
*                                                                     * 02450000
*      Interrupt status: Enabled for I/O and external interrupts.     * 02500000
*                                                                     * 02550000
*      Locks:            No locks held.                               * 02600000
*                                                                     * 02650000
*      Control parameters: Control parameters must be in the primary  * 02700000
*                        address space.                               * 02750000
*                                                                     * 02800000
*                                                                     * 02850000
*                                                                     * 02900000
*01* PROGRAMMING REQUIREMENTS:                                        * 02950000
*                                                                     * 03000000
*                                                                     * 03050000
*    1.  The macro CVT must be included to use this macro.            * 03100000
*                                                                     * 03150000
*    2.  The macro IWMYCON must be included to use this macro.        * 03200000
*                                                                     * 03250000
*    3.  The macro IWMPB must be in the library concatenation, since  * 03300000
*        it is included by IWMYCON.                                   * 03350000
*                                                                     * 03400000
*    4.  Note that the high order halfword of register 0, and the     * 03450000
*        reason code variable when specified, may be non-zero and     * 03500000
*        represents diagnostic data which is NOT part of the external * 03550000
*        interface.  The high order halfword should thus be excluded  * 03600000
*        from comparison with the reason code values described above. * 03650000
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 03700000
*        be used for this purpose.                                    * 03750000
*                                                                     * 03800000
*                                                                     * 03850000
*                                                                     * 03900000
*01* RESTRICTIONS:                                                    * 03950000
*                                                                     * 04000000
*                                                                     * 04050000
*    1.  This macro may not be used prior to the completion of WLM    * 04100000
*        address space initialization.                                * 04150000
*                                                                     * 04200000
*    2.  This macro may only be used on MVS/ESA JBB6609 or higher.    * 04250000
*                                                                     * 04300000
*                                                                     * 04350000
*                                                                     * 04400000
*01* INPUT REGISTER INFORMATION:                                      * 04450000
*                                                                     * 04500000
*    Before issuing the IWMIMPT macro, the caller does not have to    * 04550000
*    place any information into any register unless using it in       * 04600000
*    register notation for a particular parameter, or using it as a   * 04650000
*    base register.                                                   * 04700000
*                                                                     * 04750000
*01* OUTPUT REGISTER INFORMATION:                                     * 04800000
*                                                                     * 04850000
*    When control returns to the caller, the GPRs contain:            * 04900000
*                                                                     * 04950000
*                                                                     * 05000000
*    REGISTER  CONTENTS                                               * 05050000
*                                                                     * 05100000
*    0         Reason code if GR15 return code is non-zero            * 05150000
*                                                                     * 05200000
*    1         Used as work registers by the system                   * 05250000
*                                                                     * 05300000
*    2-13      Unchanged                                              * 05350000
*                                                                     * 05400000
*    14        Used as work registers by the system                   * 05450000
*                                                                     * 05500000
*    15        Return code                                            * 05550000
*                                                                     * 05600000
*                                                                     * 05650000
*                                                                     * 05700000
*    When control returns to the caller, the ARs contain:             * 05750000
*                                                                     * 05800000
*                                                                     * 05850000
*    REGISTER  CONTENTS                                               * 05900000
*                                                                     * 05950000
*    0-1       Used as work registers by the system                   * 06000000
*                                                                     * 06050000
*    2-13      Unchanged                                              * 06100000
*                                                                     * 06150000
*    14-15     Used as work registers by the system                   * 06200000
*                                                                     * 06250000
*                                                                     * 06300000
*                                                                     * 06350000
*    Some callers depend on register contents remaining the same      * 06400000
*    before and after issuing a service.  If the system changes the   * 06450000
*    contents of registers on which the caller depends, the caller    * 06500000
*    must save them before issuing the service, and restore them      * 06550000
*    after the system returns control.                                * 06600000
*                                                                     * 06650000
*01* PERFORMANCE IMPLICATIONS:                                        * 06700000
*                                                                     * 06750000
*    None                                                             * 06800000
*                                                                     * 06850000
*01* SYNTAX:                                                          * 06900000
*                                                                     * 06950000
*[xlabel]  IWMIMPT     XTOKEN=xxtoken                                 * 07000000
*                     ,ETOKEN=xetoken                                 * 07050000
*                     ,CONNTKN=xconntkn                               * 07100000
*                    [,RETCODE=xretcode]                              * 07150000
*                    [,RSNCODE=xrsncode]                              * 07200000
*                    [,PLISTVER=xplistver|IMPLIED_VERSION]          * 07250000
*                   [,MF=S]                                          * 07300000
*                   [,MF=(L,xmfctrl,xmfattr|0D)]                   * 07350000
*                   [,MF=(E,xmfctrl,COMPLETE)]                     * 07400000
*                                                                     * 07450000
*                                                                     * 07500000
*      Where:                                                         * 07550000
*                                                                     * 07600000
*                                                                     * 07650000
*      [xlabel]                                                       * 07700000
*          is an optional symbol, starting in column 1, that is the   * 07750000
*          name on the IWMIMPT macro invocation.  The name must       * 07800000
*          conform to the rules for an ordinary assembler language    * 07850000
*          symbol.                                                    * 07900000
*          DEFAULT: No name.                                          * 07950000
*                                                                     * 08000000
*                                                                     * 08050000
*                                                                     * 08100000
*                                                                     * 08150000
*      XTOKEN=xxtoken                                                 * 08200000
*          is the name (RS-type), or address in register (2)-(12), of * 08250000
*          a required 32 character input that contains the export     * 08300000
*          token which identifies the exported enclave.               * 08350000
*                                                                     * 08400000
*                                                                     * 08450000
*                                                                     * 08500000
*                                                                     * 08550000
*      ETOKEN=xetoken                                                 * 08600000
*          is the name (RS-type), or address in register (2)-(12), of * 08650000
*          a required 8 character output that contains the enclave    * 08700000
*          token for the imported enclave.  The caller can pass this  * 08750000
*          token as input to all enclave services except IWMEDELE.    * 08800000
*          The enclave token is valid on the local system only.       * 08850000
*                                                                     * 08900000
*                                                                     * 08950000
*                                                                     * 09000000
*                                                                     * 09050000
*      CONNTKN=xconntkn                                               * 09100000
*          is the name (RS-type), or address in register (2)-(12), of * 09150000
*          a required 32 bit input that contains the connect token    * 09200000
*          for the primary address space's connection to WLM.         * 09250000
*                                                                     * 09300000
*                                                                     * 09350000
*                                                                     * 09400000
*                                                                     * 09450000
*      [RETCODE=xretcode]                                             * 09500000
*          is the name (RS-type) of an optional fullword output       * 09550000
*          variable, or register (2)-(12), into which the return code * 09600000
*          is to be copied from GPR 15.                               * 09650000
*                                                                     * 09700000
*                                                                     * 09750000
*                                                                     * 09800000
*                                                                     * 09850000
*      [RSNCODE=xrsncode]                                             * 09900000
*          is the name (RS-type) of an optional fullword output       * 09950000
*          variable, or register (2)-(12), into which the reason code * 10000000
*          is to be copied from GPR 0.                                * 10050000
*                                                                     * 10100000
*                                                                     * 10150000
*                                                                     * 10200000
*                                                                     * 10250000
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 10300000
*          is an optional byte input decimal value in the "0-0" range * 10350000
*          that specifies the macro version.  PLISTVER is the only    * 10400000
*          key allowed on the list form of MF and determines which    * 10450000
*          parameter list is generated.  Note that MAX may be         * 10500000
*          specified instead of a number, and the parameter list will * 10550000
*          be of the largest size currently supported. This size may  * 10600000
*          grow from release to release (thus possibly affecting the  * 10650000
*          amount of storage needed by your program).  If your        * 10700000
*          program can tolerate this, IBM recommends that you always  * 10750000
*          specify MAX when creating the list form parameter list as  * 10800000
*          that will ensure that the list form parameter list is      * 10850000
*          always long enough to hold whatever parameters might be    * 10900000
*          specified on the execute form.                             * 10950000
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 11000000
*          default is the lowest version which allows all of the      * 11050000
*          parameters specified on the invocation to be processed.    * 11100000
*                                                                     * 11150000
*                                                                     * 11200000
*                                                                     * 11250000
*                                                                     * 11300000
*      [MF=S|L|E]                                                   * 11350000
*          is an optional keyword input which specifies the macro     * 11400000
*          form.                                                      * 11450000
*          DEFAULT: S                                                 * 11500000
*                                                                     * 11550000
*                                                                     * 11600000
*          [MF=S]                                                     * 11650000
*              specifies the standard form of the macro.  The "S"     * 11700000
*              form generates code to put the parameters into an      * 11750000
*              in-line parameter list and invoke the desired service. * 11800000
*              Full checking for required macro keys is done along    * 11850000
*              with supplying defaults for omitted optional           * 11900000
*              parameters.                                            * 11950000
*                                                                     * 12000000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 12050000
*              specifies the list form of the macro.  The "L" form    * 12100000
*              defines an area to be used for the parameter list.     * 12150000
*              Only the PLISTVER key may be specified on the          * 12200000
*              invocation.  All other macro parameters are flagged as * 12250000
*              errors.  If PLISTVER is not specified, the original    * 12300000
*              parameter list definition is used.                     * 12350000
*                                                                     * 12400000
*            ,xmfctrl                                                 * 12450000
*              is a required input.  It is the name of a storage area * 12500000
*              for the parameter list.                                * 12550000
*                                                                     * 12600000
*            ,xmfattr|0D                                            * 12650000
*              is an optional 60 character input string that varies   * 12700000
*              from 1 to 60 characters. Use it to force boundary      * 12750000
*              alignment of the parameter list. Use only 0F or 0D.    * 12800000
*              DEFAULT: 0D which forces the parameter list to a       * 12850000
*              doubleword boundary.                                   * 12900000
*                                                                     * 12950000
*          [MF=(E,xmfctrl,COMPLETE)]                                * 13000000
*              specifies the execute form of the macro.  The "E" form * 13050000
*              generates code to put the parameters into the          * 13100000
*              parameter list specified by xmfctrl and provides full  * 13150000
*              syntax checking with default setting.                  * 13200000
*                                                                     * 13250000
*            ,xmfctrl                                                 * 13300000
*              is a required input.  It is the name (RS-type), or     * 13350000
*              address in register (1)-(12), of a storage area for    * 13400000
*              the parameter list.                                    * 13450000
*                                                                     * 13500000
*            ,COMPLETE                                              * 13550000
*              is an optional keyword input which specifies the       * 13600000
*              degree of macro parameter syntax checking.             * 13650000
*              DEFAULT: COMPLETE                                      * 13700000
*                                                                     * 13750000
*                                                                     * 13800000
*              COMPLETE                                               * 13850000
*                  Checking for required macro keys is done and       * 13900000
*                  defaults are supplied for omitted optional         * 13950000
*                  parameters.                                        * 14000000
*                                                                     * 14050000
*                                                                     * 14100000
*                                                                     * 14150000
*                                                                     * 14200000
*                                                                     * 14250000
*                                                                     * 14300000
*                                                                     * 14350000
*01* ABEND CODES:  None.                                              * 14400000
*                                                                     * 14450000
*01* RETURN CODES:                                                    * 14500000
*                                                                     * 14550000
*                                                                     * 14600000
*            0    Name: IwmRetCodeOk                                  * 14650000
*                                                                     * 14700000
*                 Meaning: Successful completion.                     * 14750000
*                                                                     * 14800000
*                 Action: None required.                              * 14850000
*                                                                     * 14900000
*                                                                     * 14950000
*            4    Name: IwmRetCodeWarning                             * 15000000
*                                                                     * 15050000
*                 Meaning: Successful completion, unusual conditions  * 15100000
*                 noted.                                              * 15150000
*                                                                     * 15200000
*                                                                     * 15250000
*                                                                     * 15300000
*                 HEX REASON  MEANING/ACTION                          * 15350000
*                 CODE                                                * 15400000
*                                                                     * 15450000
*                 xxxx0432    Name: IwmRsnCodeUnknownExportToken      * 15500000
*                                                                     * 15550000
*                             Meaning:  No enclave matching the       * 15600000
*                             export token was found.  The enclave    * 15650000
*                             may have been unexported or deleted, or * 15700000
*                             the WLM coupling facility structure may * 15750000
*                             have been lost.                         * 15800000
*                                                                     * 15850000
*                             Action:  Discontinue processing the     * 15900000
*                             unit of work.                           * 15950000
*                                                                     * 16000000
*                                                                     * 16050000
*                                                                     * 16100000
*                                                                     * 16150000
*            8    Name: IwmRetCodeInvocError                          * 16200000
*                                                                     * 16250000
*                 Meaning: Invalid invocation environment or          * 16300000
*                 parameters.                                         * 16350000
*                                                                     * 16400000
*                                                                     * 16450000
*                                                                     * 16500000
*                 HEX REASON  MEANING/ACTION                          * 16550000
*                 CODE                                                * 16600000
*                                                                     * 16650000
*                 xxxx0803    Name: IwmRsnCodeDisabled                * 16700000
*                                                                     * 16750000
*                             Meaning: Caller is disabled.            * 16800000
*                                                                     * 16850000
*                             Action: Avoid requesting this function  * 16900000
*                             while disabled.                         * 16950000
*                                                                     * 17000000
*                 xxxx0804    Name: IwmRsnCodeLocked                  * 17050000
*                                                                     * 17100000
*                             Meaning: Caller is locked.              * 17150000
*                                                                     * 17200000
*                             Action: Avoid requesting this function  * 17250000
*                             while locked.                           * 17300000
*                                                                     * 17350000
*                 xxxx080B    Name: IwmRsnCodeBadPl                   * 17400000
*                                                                     * 17450000
*                             Meaning: Error accessing parameter      * 17500000
*                             list.                                   * 17550000
*                                                                     * 17600000
*                             Action: Check for possible storage      * 17650000
*                             overlay.                                * 17700000
*                                                                     * 17750000
*                 xxxx0821    Name:IwmRsnCodeBadConn                  * 17800000
*                                                                     * 17850000
*                             Meaning: Input connect token does not   * 17900000
*                             pass validity checking.                 * 17950000
*                                                                     * 18000000
*                             Action: Make sure the primary address   * 18050000
*                             space connected to WLM using the        * 18100000
*                             IWMCONN service.  Make sure the connect * 18150000
*                             token returned by IWMCONN is passed     * 18200000
*                             correctly.                              * 18250000
*                                                                     * 18300000
*                 xxxx0824    Name: IwmRsnCodeAmode24                 * 18350000
*                                                                     * 18400000
*                             Meaning: Caller invoked service but was * 18450000
*                             in 24 bit addressing mode.              * 18500000
*                                                                     * 18550000
*                             Action: Request this function only when * 18600000
*                             you are in 31 bit addressing mode.      * 18650000
*                                                                     * 18700000
*                 xxxx0825    Name: IwmRsnCodeAscModeNotPrimary       * 18750000
*                                                                     * 18800000
*                             Meaning: Caller invoked service but was * 18850000
*                             not in primary ASC mode.                * 18900000
*                                                                     * 18950000
*                             Action: Avoid requesting this function  * 19000000
*                             in this environment.                    * 19050000
*                                                                     * 19100000
*                 xxxx0827    Name: IwmRsnCodeRsvdNot0                * 19150000
*                                                                     * 19200000
*                             Meaning: Reserved field in parameter    * 19250000
*                             list was non-zero.                      * 19300000
*                                                                     * 19350000
*                             Action:  Check for use of keywords that * 19400000
*                             are not supported by the OS/390 release * 19450000
*                             on which the program is running.        * 19500000
*                                                                     * 19550000
*                 xxxx0828    Name: IwmRsnCodeBadVersion              * 19600000
*                                                                     * 19650000
*                             Meaning: Version number in parameter    * 19700000
*                             list is not valid.                      * 19750000
*                                                                     * 19800000
*                             Action: Check for possible storage      * 19850000
*                             overlay of the parameter list.          * 19900000
*                                                                     * 20500000
*                 xxxx0840    Name: IwmRsnCodeServiceNotEnabled       * 20550000
*                                                                     * 20600000
*                             Meaning: Caller's connection is not     * 20650000
*                             enabled for this service.               * 20700000
*                                                                     * 20750000
*                             Action: Make sure that EXPTIMPT=YES is  * 20800000
*                             specified on the IWMCONN macro          * 20850000
*                             invocation.                             * 20900000
*                                                                     * 20950000
*                 xxxx0842    Name: IwmRsnCodeNoWLMConnect            * 21000000
*                                                                     * 21050000
*                             Meaning: Caller's primary address space * 21100000
*                             is not connected to WLM.                * 21150000
*                                                                     * 21200000
*                             Action: Invoke the IWMCONN macro before * 21250000
*                             invoking this macro.                    * 21300000
*                                                                     * 21350000
*                 xxxx0870    Name: IwmRsnCodeBadExportToken          * 21400000
*                                                                     * 21450000
*                             Meaning:  The export token is not       * 21500000
*                             validly formatted.                      * 21550000
*                                                                     * 21600000
*                             Action: Check for possible storage      * 21650000
*                             overlay of the export token.            * 21700000
*                                                                     * 21750000
*                                                                     * 21800000
*                                                                     * 21850000
*                                                                     * 21900000
*            C    Name: IwmRetCodeEnvError                            * 21950000
*                                                                     * 22000000
*                 Meaning: Environmental error.                       * 22050000
*                                                                     * 22100000
*                                                                     * 22150000
*                                                                     * 22200000
*                 HEX REASON  MEANING/ACTION                          * 22250000
*                 CODE                                                * 22300000
*                                                                     * 22350000
*                 xxxx0C01    Name: IwmRsnCodeNoStg                   * 22400000
*                                                                     * 22450000
*                             Meaning: Virtual storage is not         * 22500000
*                             available for the request.              * 22550000
*                                                                     * 22600000
*                             Action: Contact your system programmer. * 22650000
*                                                                     * 22700000
*                 xxxx0C36    Name: IwmRsnCodeStructureUnavailable    * 22750000
*                                                                     * 22800000
*                             Meaning: WLM does not have access to    * 22850000
*                             its coupling facility structure.        * 22900000
*                                                                     * 22950000
*                             Action: Check for WLM or XES messages   * 23000000
*                             which describe the problem.             * 23050000
*                                                                     * 23100000
*                 xxxx0C38    Name: IwmRsnCodeUplevelObject           * 23150000
*                                                                     * 23200000
*                             Meaning:  The multisystem enclave       * 23250000
*                             requires functions that are not         * 23300000
*                             available on this level of the          * 23350000
*                             operating system.                       * 23400000
*                                                                     * 23404100
*                             Action: Do not process the work request * 23408200
*                             on this system.                         * 23412300
*                                                                     * 23416400
*                 xxxx0C39    Name: IwmRsnCodeTooManySystems          * 23420500
*                                                                     * 23424600
*                             Meaning: The sysplex has exceeded 32    * 23428700
*                             systems with unique names.  This can    * 23432800
*                             occur when a system is reIPLed into the * 23436900
*                             sysplex with a different SYSNAME or CPU * 23441000
*                             Adjustment factor.                      * 23445100
*                                                                     * 23450000
*                             Action: Do not process the work request * 23500000
*                             on this system.                         * 23550000
*                                                                     * 23600000
*                                                                     * 23650000
*                                                                     * 23700000
*                                                                     * 23750000
*            10   Name: IwmRetCodeCompError                           * 23800000
*                                                                     * 23850000
*                 Meaning: Component error.                           * 23900000
*                                                                     * 23950000
*                 Action: Contact your system programmer.             * 24000000
*                                                                     * 24050000
*                                                                     * 24100000
*                                                                     * 24150000
*                                                                     * 24200000
*01* REASON CODES:                                                    * 24250000
*                                                                     * 24300000
*       A unique reason code will be returned whenever the return     * 24350000
*       code is non-zero.  Reason codes, as appropriate, are defined  * 24400000
*       under their corresponding return code.  Reason code and       * 24450000
*       return code constants are defined within IWMYCON.  Note that  * 24500000
*       the high order halfword of register 0, and the reason code    * 24550000
*       variable when specified, may be non-zero and represents       * 24600000
*       diagnostic data which is NOT part of the external interface.  * 24650000
*       The high order halfword should thus be excluded from          * 24700000
*       comparison with the reason code values described above.  The  * 24750000
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 24800000
*       used for this purpose.                                        * 24850000
*                                                                     * 24900000
*01* MODULE TYPE:  ASSEM MACRO                                        * 24950000
*                                                                     * 25000000
*02*   PROCESSOR:  ASSEM                                              * 25050000
*                                                                     * 25100000
*01* COMPONENT:  SCWLM                                                * 25150000
*                                                                     * 25200000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 25250000
*                                                                     * 25300000
*01* EXAMPLES:                                                        * 25350000
*                                                                     * 25400000
*               IWMIMPT XTOKEN=EXPORTT,ETOKEN=ENCLAVET,CONNTKN=CONNEC * 25450000
*      TT                                                             * 25500000
*      *                                                              * 25550000
*      * Storage areas                                                * 25600000
*      *                                                              * 25650000
*      ENCLAVET DS    CL8             Enclave token                   * 25700000
*      EXPORTT  DS    CL32            Export token                    * 25750000
*      CONNECTT DS    CL4             Connect token                   * 25800000
*                                                                     * 25850000
*                                                                     * 25900000
*01* MACRO USAGE NOTES:                                               * 25950000
*                                                                     * 26000000
*                                                                     * 26050000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 26100000
*        global macro variable.  Any value other than 'NO' will       * 26150000
*        result in the macro expansion being printed.  The default is * 26200000
*        'YES'.  The following examples illustrate how the ZPRINT     * 26250000
*        variable should be set.                                      * 26300000
*                                                                     * 26350000
*                    GBLC &ZPRINT                                     * 26400000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 26450000
*                                                                     * 26500000
*                                                                     * 26550000
*    2.  All keys currently contained in the IWMIMPT macro correspond * 26600000
*        to  version 0.  If you specify PLISTVER, use a value of 0 or * 26650000
*        MAX.                                                         * 26700000
*                                                                     * 26750000
*                                                                     * 26800000
*                                                                     * 26850000
*                                                                     * 26900000
*01* CHANGE ACTIVITY:                                                 * 26950000
*                                                                     * 27000000
*   Flag LineItem  FMID    Date   ID    Comment                       * 27050000
*                                                                     * 27100000
*    $L0=WLMP     JBB6609 971020 B9HAGD:  Multisystem enclaves        * 27150000
****** END OF SPECIFICATIONS *****************************************/ 27200000
*/* TLINE 1 *********************************************************** 27250000
         MACRO                                                          27300000
&XLABEL  IWMIMPT &XTOKEN=,&ETOKEN=,&CONNTKN=,&RETCODE=,&RSNCODE=,      *27350000
               &PLISTVER=,&MF=                                          27400000
.*                                                                      27450000
*              MACDATE -09/22/99-<0>                                    27500000
.*                                                                      27550000
.*******************************************************************    27600000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        27650000
.*******************************************************************    27700000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   27750000
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     27800000
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             27850000
.*                                                                      27900000
              GBLC  &ZIWMIMPT   YES=MACRO USED AT LEAST ONCE            27950000
.*******************************************************************    28000000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          28050000
.*******************************************************************    28100000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 28150000
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            28200000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              28250000
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             28300000
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             28350000
              LCLA  &ZAWRK      USED AS A WORK AREA                     28400000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  28450000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   28500000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 28550000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             28600000
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 28650000
              LCLA  &ZMACRET    MACRO RETURN CODE                       28700000
&ZMACRET      SETA  0           ASSUME NO ERRORS                        28750000
.*                                                                      28800000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      28850000
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              28900000
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   28950000
              LCLC  &ZENDBASEPL                 End of base PL          29000000
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   29050000
.*******************************************************************    29100000
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             29150000
.*******************************************************************    29200000
              LCLA  &ZI         INDEX FOR ARRAY                         29250000
              LCLA  &ZJ         INDEX FOR PARMS                         29300000
              LCLA  &ZK         INDEX FOR PARSE                         29350000
              LCLA  &ZLO        LOW RANGE VALUE                         29400000
              LCLA  &ZHI        HIGH RANGE VALUE                        29450000
              LCLC  &ZW         WORK AREA FOR PARM                      29500000
.********************************************************************   29550000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 29600000
.********************************************************************   29650000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 29700000
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          29750000
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        29775000
.*                                                                      29800000
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       29850000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        29900000
              SPLEVEL  TEST                                             29950000
.ZSYS2        ANOP  ,                                                   30000000
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              30050000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              30100000
              SYSSTATE TEST                                             30150000
              AGO   .ZSYS4                                              30200000
.ZSYS3        ANOP  ,                                                   30250000
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 30300000
.ZSYS4        ANOP  ,                                                   30350000
.*******************************************************************    30400000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   30450000
.*******************************************************************    30500000
              LCLC  &XXTOKEN    ++ NAME                                 30550000
              LCLC  &XETOKEN    ++ NAME                                 30600000
              LCLC  &XCONNTKN   ++ NAME                                 30650000
              LCLC  &XRETCODE   ++ NAME                                 30700000
              LCLC  &XRSNCODE   ++ NAME                                 30750000
              LCLA  &XPLISTVER  ++ VALUE                                30800000
              LCLC  &XMF        ++ VALUE                                30850000
              LCLC  &XMFCTRL    ++ NAME                                 30900000
              LCLC  &XMFATTR    ++ VALUE                                30950000
              LCLC  &XMFSCK     ++ VALUE                                31000000
.*******************************************************************    31050000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           31100000
.*******************************************************************    31150000
              LCLC  &ZXXTOKEN   ++ INPUT NAME                           31200000
              LCLC  &ZXETOKEN   ++ OUTPUT NAME                          31250000
              LCLC  &ZXCONNTKN  ++ INPUT NAME                           31300000
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          31350000
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          31400000
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          31450000
              LCLC  &ZXMF       ++ INPUT VALUE                          31500000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           31550000
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          31600000
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          31650000
.********************************************************************   31700000
.***AC.PLV01  PROCESS PLISTVER                                      *   31750000
.********************************************************************   31800000
&XPLISTVER      SETA  0                                                 31850000
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       31900000
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   31950000
&XPLISTVER      SETA  0                                                 32000000
.ZPLV0          ANOP  ,                                                 32050000
.*                                                                      32100000
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      32150000
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      32200000
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  32250000
.*-------------------------------------------------------------------   32300000
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 32350000
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                32400000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 32450000
&ZMS            SETC  '&ZMS "PLISTVER"'                                 32500000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               32550000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                32600000
                AGO   .ZPVCK2                                           32650000
.ZPVCK3         ANOP  ,                                                 32700000
.*-------------------------------------------------------------------   32750000
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  32800000
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                32850000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 32900000
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         32950000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 33000000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                33050000
                AGO   .ZPVCKE                                           33100000
.ZPVCK2         ANOP  ,                                                 33150000
.*-------------------------------------------------------------------   33200000
&ZCVAL          SETC  '&PLISTVER(1)'                                    33250000
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             33300000
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             33350000
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        33400000
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      33450000
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     33500000
.ZPVCK6         ANOP  ,                                                 33550000
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                33600000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 33650000
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         33700000
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         33750000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                33800000
&XPLISTVER      SETA  0                                                 33850000
                AGO   .ZPVCKE                                           33900000
.*-------------------------------------------------------------------   33950000
.ZPVCK4A        ANOP  ,                                                 34000000
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        34050000
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                34100000
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               34150000
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          34200000
&ZMS            SETC  '&ZMS &XPLISTVER'                                 34250000
                MNOTE 8,' &ZMS IS REQUIRED.'                            34300000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                34350000
                AGO   .ZPVCK5                                           34400000
.ZPVCK4         ANOP  ,                                                 34450000
&XPLISTVER      SETA  &PLISTVER(1)                                      34500000
.ZPVCK5         ANOP  ,                                                 34550000
.ZPVCKE         ANOP  ,                                                 34600000
.********************************************************************   34650000
.***AG.MF01 PROCESS MF MACRO FORMS                                      34700000
.********************************************************************   34750000
              ACTR  10000                                               34800000
.*------------------------------------------------------------------    34850000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           34900000
&XMF          SETC  ''          INITIALIZE XVARIABLE                    34950000
.*-------------------------------------------------------------------   35000000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           35050000
.ZG21         ANOP  ,                                                   35100000
&ZTLC         SETC 'S'                                                  35150000
              AIF   ('&MF(1)' NE '&ZTLC').ZG22                          35200000
&XMF          SETC  'S'         SET KEYWORD                             35250000
              AIF   (N'&MF LE 1).ZG21A          CK NUM                  35300000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           35350000
&ZMS          SETC  '&ZMS.&MF"'                                         35400000
&ZMS          SETC  '&ZMS "MF"'                                         35450000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 35500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             35550000
.ZG21A        ANOP  ,                                                   35600000
.*-------------------------------------------------------------------   35650000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           35700000
.ZG22         ANOP  ,                                                   35750000
&ZTLC         SETC 'L'                                                  35800000
              AIF   ('&MF(1)' NE '&ZTLC').ZG29                          35850000
&XMF          SETC  'L'         SET KEYWORD                             35900000
              AIF   (N'&MF LE 3).ZG22A          CK NUM                  35950000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           36000000
&ZMS          SETC  '&ZMS.&MF"'                                         36050000
&ZMS          SETC  '&ZMS "MF"'                                         36100000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                36150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             36200000
.ZG22A        ANOP  ,                                                   36250000
.*-------------------------------------------------------------------   36300000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     36350000
              AIF   (N'&SYSLIST NE 0).ZG22B     POSITIONALS?            36400000
              AIF   ('&XTOKEN' NE '').ZG22B     KEYS?                   36450000
              AIF   ('&ETOKEN' NE '').ZG22B     KEYS?                   36500000
              AIF   ('&CONNTKN' NE '').ZG22B    KEYS?                   36550000
              AIF   ('&RETCODE' NE '').ZG22B    KEYS?                   36600000
              AIF   ('&RSNCODE' NE '').ZG22B    KEYS?                   36650000
              AGO    .ZG22C     INVOCATION OKAY                         36700000
.ZG22B        ANOP  ,                                                   36750000
&ZMS          SETC  'THE "L" FORM OF "MF"'      *MFLA* MNOTE            36800000
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                36850000
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           36900000
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              36950000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             37000000
.ZG22C        ANOP  ,                                                   37050000
.*-------------------------------------------------------------------   37100000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   37150000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           37200000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           37250000
              AIF   (N'&MF(2) GT 1).ZG24B       MULTI PARMS             37300000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           37350000
.ZG24B        AIF   (K'&MF(2) GT 0).ZG24C                               37400000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         37450000
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 37500000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 37550000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        37600000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             37650000
.ZG24C        ANOP  ,                                                   37700000
.*-------------------------------------------------------------------   37750000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               37800000
              AIF   (K'&ZXMFCTRL LE 0).ZG24P    NOT I/O                 37850000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG24P                      37900000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         37950000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           38000000
&ZMS          SETC  '&ZMS.&MF"'                                         38050000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           38100000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   38150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             38200000
.ZG24P        ANOP  ,                                                   38250000
.*-------------------------------------------------------------------   38300000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      38350000
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           38400000
&XMFATTR      SETC  '0D'                                                38450000
              AIF   (K'&MF(3) LE 0).ZG27B       PARM                    38500000
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           38550000
              AIF   (N'&MF(3) GT 1).ZG27B       MULTI PARMS             38600000
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           38650000
.ZG27B        ANOP  ,                                                   38700000
.*-------------------------------------------------------------------   38750000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  38800000
              AIF   (K'&ZXMFATTR LE 0).ZG27P    NOT I/O                 38850000
              AIF   ('&XMFATTR'(1,1) NE '(').ZG27P                      38900000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         38950000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           39000000
&ZMS          SETC  '&ZMS.&MF"'                                         39050000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           39100000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   39150000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             39200000
.ZG27P        ANOP  ,                                                   39250000
.*-------------------------------------------------------------------   39300000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 39350000
              AIF   (K'&ZXMFATTR LE 0).ZG27S    NOT I/O                 39400000
              AIF   (K'&XMFATTR LE 60).ZG27S    LNG OK                  39450000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         39500000
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           39550000
&ZMS          SETC  '&ZMS.&MF"'                                         39600000
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               39650000
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  39700000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             39750000
.ZG27S        ANOP  ,                                                   39800000
.*-------------------------------------------------------------------   39850000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           39900000
.ZG29         ANOP  ,                                                   39950000
&ZTLC         SETC 'E'                                                  40000000
              AIF   ('&MF(1)' NE '&ZTLC').ZG37                          40050000
&XMF          SETC  'E'         SET KEYWORD                             40100000
              AIF   (N'&MF LE 3).ZG29A          CK NUM                  40150000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           40200000
&ZMS          SETC  '&ZMS.&MF"'                                         40250000
&ZMS          SETC  '&ZMS "MF"'                                         40300000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                40350000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             40400000
.ZG29A        ANOP  ,                                                   40450000
.*-------------------------------------------------------------------   40500000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   40550000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           40600000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           40650000
              AIF   (N'&MF(2) GT 1).ZG31B       MULTI PARMS             40700000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           40750000
.ZG31B        AIF   (K'&MF(2) GT 0).ZG31C                               40800000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         40850000
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 40900000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 40950000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        41000000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             41050000
.ZG31C        ANOP  ,                                                   41100000
.*-------------------------------------------------------------------   41150000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              41200000
              AIF   (K'&ZXMFCTRL LE 0).ZG31R    NOT I/O                 41250000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG31R                      41300000
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          41350000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                        41400000
              AIF   (K'&ZCGPR GT 2).ZG31Q                               41450000
              AIF   ('&ZCGPR' EQ '0').ZG31Q                             41500000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       41550000
              AIF   (T'&ZCGPR NE 'N').ZG31Q     INVALID REG NAME        41600000
.ZG31P        ANOP  ,                                                   41650000
              AIF   (T'&ZCGPR NE 'N').ZG31R     NON NUMERIC             41700000
              AIF   ('&ZCGPR' LT '1').ZG31Q                             41750000
              AIF   ('&ZCGPR' LE '12').ZG31R                            41800000
.ZG31Q        ANOP  ,                                                   41850000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           41900000
&ZMS          SETC  '&ZMS.&MF"'                                         41950000
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           42000000
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    42050000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             42100000
.ZG31R        ANOP  ,                                                   42150000
.*-------------------------------------------------------------------   42200000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             42250000
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    42300000
.ZG35A   AIF   ('&MF(3)' NE 'COMPLETE').ZG36A                           42350000
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             42400000
.*-------------------------------------------------------------------   42450000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             42500000
.ZG36A        AIF   (K'&XMFSCK GT 0).ZG36C      KEYWORD                 42550000
              AIF   (K'&MF(3) LE 0).ZG36B                               42600000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           42650000
&ZMS          SETC  '&ZMS.&MF"'                                         42700000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           42750000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 42800000
&ZMS          SETC  '&ZMS "COMPLETE".'                                  42850000
              MNOTE 8,' &ZMS '                                          42900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             42950000
.ZG36B        ANOP  ,                                                   43000000
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     43050000
.ZG36C        ANOP  ,                                                   43100000
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           43150000
.*------------------------------------------------------------------    43200000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           43250000
.ZG37         ANOP  ,                                                   43300000
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           43350000
              AIF   (K'&XMF GT 0).ZG37E         VALID ARG               43400000
              AIF   (T'&MF EQ 'O').ZG37D        OMITTED                 43450000
&ZASYSLNDX    SETA  0                                                   43500000
.ZG37A        ANOP  ,           POSITIONAL MACRO KEY                    43550000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        43600000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG37C                    43650000
&ZTLC         SETC 'MF'                                                 43700000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG37A           43750000
.ZG37B        ANOP  ,                                                   43800000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         43850000
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           43900000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             43950000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    44000000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             44050000
              AGO   .ZG37E                                              44100000
.ZG37C        ANOP  ,                                                   44150000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         44200000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           44250000
&ZMS          SETC  '&ZMS.&MF"'                                         44300000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           44350000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 44400000
&ZMS          SETC  '&ZMS "S",'                                         44450000
&ZMS          SETC  '&ZMS "L",'                                         44500000
&ZMS          SETC  '&ZMS OR "E".'                                      44550000
              MNOTE 8,' &ZMS '                                          44600000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             44650000
              AGO   .ZG37E                                              44700000
.ZG37D        ANOP  ,                                                   44750000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     44800000
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       44850000
.ZG37E        ANOP  ,                                                   44900000
.********************************************************************   44950000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 45000000
.********************************************************************   45050000
              ACTR  10000                                               45100000
.*-------------------------------------------------------------------   45150000
.***AG.MF03 MF=(SLE)                                                    45200000
              AIF   ('&XMF' EQ 'L').ZGMFX                               45250000
.*----------------------------------------------------------------***   45300000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     45350000
              AIF   (N'&XTOKEN LE 1).ZG2A       CK NUM                  45400000
&ZMS          SETC  '"XTOKEN='  *KPOSA* MNOTE                           45450000
&ZMS          SETC  '&ZMS.&XTOKEN"'                                     45500000
&ZMS          SETC  '&ZMS "XTOKEN"'                                     45550000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 45600000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             45650000
.ZG2A         ANOP  ,                                                   45700000
.*-------------------------------------------------------------------   45750000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         45800000
&ZXXTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           45850000
&XXTOKEN      SETC  '&XTOKEN(1)'                SET XVARIABLE           45900000
              AIF   (N'&XTOKEN GT 1).ZG2B       MULTI PARMS             45950000
&XXTOKEN      SETC  '&XTOKEN'   SET XVARIABLE                           46000000
.ZG2B         AIF   (K'&XTOKEN(1) GT 0).ZG2C                            46050000
&ZXXTOKEN     SETC  ''          RESET IN/OUTPUT                         46100000
&ZMS          SETC  ' '         *KRQDA*                                 46150000
&ZMS          SETC  '&ZMS "XTOKEN" KEY AND ITS'                         46200000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    46250000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             46300000
.ZG2C         ANOP  ,                                                   46350000
.*-------------------------------------------------------------------   46400000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    46450000
              AIF   (K'&ZXXTOKEN LE 0).ZG2R     NOT I/O                 46500000
              AIF   ('&XXTOKEN'(1,1) NE '(').ZG2R                       46550000
&ZCGPR        SETC  '&XXTOKEN'(2,K'&XXTOKEN-2)                          46600000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                         46650000
              AIF   (K'&ZCGPR GT 2).ZG2Q                                46700000
              AIF   ('&ZCGPR' EQ '0').ZG2Q                              46750000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       46800000
              AIF   (T'&ZCGPR NE 'N').ZG2Q      INVALID REG NAME        46850000
.ZG2P         ANOP  ,                                                   46900000
              AIF   (T'&ZCGPR NE 'N').ZG2R      NON NUMERIC             46950000
              AIF   ('&ZCGPR' LT '2').ZG2Q                              47000000
              AIF   ('&ZCGPR' LE '12').ZG2R                             47050000
.ZG2Q         ANOP  ,                                                   47100000
&ZMS          SETC  '"XTOKEN='  *KGPRA* MNOTE                           47150000
&ZMS          SETC  '&ZMS.&XTOKEN"'                                     47200000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           47250000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    47300000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             47350000
.ZG2R         ANOP  ,                                                   47400000
.*----------------------------------------------------------------***   47450000
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    47500000
              AIF   (N'&ETOKEN LE 1).ZG5A       CK NUM                  47550000
&ZMS          SETC  '"ETOKEN='  *KPOSA* MNOTE                           47600000
&ZMS          SETC  '&ZMS.&ETOKEN"'                                     47650000
&ZMS          SETC  '&ZMS "ETOKEN"'                                     47700000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 47750000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             47800000
.ZG5A         ANOP  ,                                                   47850000
.*-------------------------------------------------------------------   47900000
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        47950000
&ZXETOKEN     SETC  'OUTPUT'    SET IN/OUTPUT                           48000000
&XETOKEN      SETC  '&ETOKEN(1)'                SET XVARIABLE           48050000
              AIF   (N'&ETOKEN GT 1).ZG5B       MULTI PARMS             48100000
&XETOKEN      SETC  '&ETOKEN'   SET XVARIABLE                           48150000
.ZG5B         AIF   (K'&ETOKEN(1) GT 0).ZG5C                            48200000
&ZXETOKEN     SETC  ''          RESET IN/OUTPUT                         48250000
&ZMS          SETC  ' '         *KRQDA*                                 48300000
&ZMS          SETC  '&ZMS "ETOKEN" KEY AND ITS'                         48350000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    48400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             48450000
.ZG5C         ANOP  ,                                                   48500000
.*-------------------------------------------------------------------   48550000
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   48600000
              AIF   (K'&ZXETOKEN LE 0).ZG5R     NOT I/O                 48650000
              AIF   ('&XETOKEN'(1,1) NE '(').ZG5R                       48700000
&ZCGPR        SETC  '&XETOKEN'(2,K'&XETOKEN-2)                          48750000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                         48800000
              AIF   (K'&ZCGPR GT 2).ZG5Q                                48850000
              AIF   ('&ZCGPR' EQ '0').ZG5Q                              48900000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       48950000
              AIF   (T'&ZCGPR NE 'N').ZG5Q      INVALID REG NAME        49000000
.ZG5P         ANOP  ,                                                   49050000
              AIF   (T'&ZCGPR NE 'N').ZG5R      NON NUMERIC             49100000
              AIF   ('&ZCGPR' LT '2').ZG5Q                              49150000
              AIF   ('&ZCGPR' LE '12').ZG5R                             49200000
.ZG5Q         ANOP  ,                                                   49250000
&ZMS          SETC  '"ETOKEN='  *KGPRA* MNOTE                           49300000
&ZMS          SETC  '&ZMS.&ETOKEN"'                                     49350000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           49400000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    49450000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             49500000
.ZG5R         ANOP  ,                                                   49550000
.*----------------------------------------------------------------***   49600000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     49650000
              AIF   (N'&CONNTKN LE 1).ZG8A      CK NUM                  49700000
&ZMS          SETC  '"CONNTKN='                 *KPOSA* MNOTE           49750000
&ZMS          SETC  '&ZMS.&CONNTKN"'                                    49800000
&ZMS          SETC  '&ZMS "CONNTKN"'                                    49850000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 49900000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             49950000
.ZG8A         ANOP  ,                                                   50000000
.*-------------------------------------------------------------------   50050000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         50100000
&ZXCONNTKN    SETC  'INPUT'     SET IN/OUTPUT                           50150000
&XCONNTKN     SETC  '&CONNTKN(1)'               SET XVARIABLE           50200000
              AIF   (N'&CONNTKN GT 1).ZG8B      MULTI PARMS             50250000
&XCONNTKN     SETC  '&CONNTKN'  SET XVARIABLE                           50300000
.ZG8B         AIF   (K'&CONNTKN(1) GT 0).ZG8C                           50350000
&ZXCONNTKN    SETC  ''          RESET IN/OUTPUT                         50400000
&ZMS          SETC  ' '         *KRQDA*                                 50450000
&ZMS          SETC  '&ZMS "CONNTKN" KEY AND ITS'                        50500000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    50550000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             50600000
.ZG8C         ANOP  ,                                                   50650000
.*-------------------------------------------------------------------   50700000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    50750000
              AIF   (K'&ZXCONNTKN LE 0).ZG8R    NOT I/O                 50800000
              AIF   ('&XCONNTKN'(1,1) NE '(').ZG8R                      50850000
&ZCGPR        SETC  '&XCONNTKN'(2,K'&XCONNTKN-2)                        50900000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                         50950000
              AIF   (K'&ZCGPR GT 2).ZG8Q                                51000000
              AIF   ('&ZCGPR' EQ '0').ZG8Q                              51050000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       51100000
              AIF   (T'&ZCGPR NE 'N').ZG8Q      INVALID REG NAME        51150000
.ZG8P         ANOP  ,                                                   51200000
              AIF   (T'&ZCGPR NE 'N').ZG8R      NON NUMERIC             51250000
              AIF   ('&ZCGPR' LT '2').ZG8Q                              51300000
              AIF   ('&ZCGPR' LE '12').ZG8R                             51350000
.ZG8Q         ANOP  ,                                                   51400000
&ZMS          SETC  '"CONNTKN='                 *KGPRA* MNOTE           51450000
&ZMS          SETC  '&ZMS.&CONNTKN"'                                    51500000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           51550000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    51600000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             51650000
.ZG8R         ANOP  ,                                                   51700000
.*----------------------------------------------------------------***   51750000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    51800000
              AIF   (N'&RETCODE LE 1).ZG11A     CK NUM                  51850000
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           51900000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    51950000
&ZMS          SETC  '&ZMS "RETCODE"'                                    52000000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 52050000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             52100000
.ZG11A        ANOP  ,                                                   52150000
.*-------------------------------------------------------------------   52200000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        52250000
              AIF   (K'&RETCODE(1) LE 0).ZG11C  NO PARM                 52300000
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              52350000
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           52400000
              AIF   (N'&RETCODE GT 1).ZG11C                             52450000
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           52500000
.ZG11C        ANOP  ,                                                   52550000
.*-------------------------------------------------------------------   52600000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   52650000
              AIF   (K'&ZXRETCODE LE 0).ZG11R   NOT I/O                 52700000
              AIF   ('&XRETCODE'(1,1) NE '(').ZG11R                     52750000
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        52800000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                        52850000
              AIF   (K'&ZCGPR GT 2).ZG11Q                               52900000
              AIF   ('&ZCGPR' EQ '0').ZG11Q                             52950000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       53000000
              AIF   (T'&ZCGPR NE 'N').ZG11Q     INVALID REG NAME        53050000
.ZG11P        ANOP  ,                                                   53100000
              AIF   (T'&ZCGPR NE 'N').ZG11R     NON NUMERIC             53150000
              AIF   ('&ZCGPR' LT '2').ZG11Q                             53200000
              AIF   ('&ZCGPR' LE '12').ZG11R                            53250000
.ZG11Q        ANOP  ,                                                   53300000
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           53350000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    53400000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           53450000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    53500000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             53550000
.ZG11R        ANOP  ,                                                   53600000
.*----------------------------------------------------------------***   53650000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    53700000
              AIF   (N'&RSNCODE LE 1).ZG14A     CK NUM                  53750000
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           53800000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    53850000
&ZMS          SETC  '&ZMS "RSNCODE"'                                    53900000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 53950000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             54000000
.ZG14A        ANOP  ,                                                   54050000
.*-------------------------------------------------------------------   54100000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        54150000
              AIF   (K'&RSNCODE(1) LE 0).ZG14C  NO PARM                 54200000
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              54250000
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           54300000
              AIF   (N'&RSNCODE GT 1).ZG14C                             54350000
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           54400000
.ZG14C        ANOP  ,                                                   54450000
.*-------------------------------------------------------------------   54500000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   54550000
              AIF   (K'&ZXRSNCODE LE 0).ZG14R   NOT I/O                 54600000
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG14R                     54650000
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        54700000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                        54750000
              AIF   (K'&ZCGPR GT 2).ZG14Q                               54800000
              AIF   ('&ZCGPR' EQ '0').ZG14Q                             54850000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       54900000
              AIF   (T'&ZCGPR NE 'N').ZG14Q     INVALID REG NAME        54950000
.ZG14P        ANOP  ,                                                   55000000
              AIF   (T'&ZCGPR NE 'N').ZG14R     NON NUMERIC             55050000
              AIF   ('&ZCGPR' LT '2').ZG14Q                             55100000
              AIF   ('&ZCGPR' LE '12').ZG14R                            55150000
.ZG14Q        ANOP  ,                                                   55200000
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           55250000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    55300000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           55350000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    55400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             55450000
.ZG14R        ANOP  ,                                                   55500000
.******************************************************************     55550000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        55600000
.******************************************************************     55650000
              ACTR  10000                                               55700000
.*----------------------------------------------------------------***   55750000
.***AH.P02 EXTRA POSITIONALS                                            55800000
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               55850000
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                55900000
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            55950000
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             56000000
.ZGLISTX1     ANOP  ,                                                   56050000
&ZCVAL        SETC  ''          ERROR FIELD                             56100000
&ZAWRK        SETA  0           POSITIONAL NUMBER                       56150000
.ZGLIST2      ANOP  ,                                                   56200000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         56250000
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                56300000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   56350000
              AGO   .ZGLIST2                                            56400000
.*                                                                      56450000
.ZGLIST3      ANOP  ,                                                   56500000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             56550000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           56600000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     56650000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              56700000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      56750000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              56800000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             56850000
.ZGLISTX      ANOP  ,                                                   56900000
&ZASYSLNDX    SETA  0                                                   56950000
.*-------------------------------------------------------------------   57000000
.***AG.MF04 MF=(SLE)                                                    57050000
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                57100000
.*******************************************************************    57150000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       57200000
.*******************************************************************    57250000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          57300000
.*******************************************************************    57350000
.***AE.01  START OF IWMIMPT MACRO CODE                                  57400000
.*******************************************************************    57450000
              LCLC  &M0M0001                 NAME                       57500000
&M0M0001      SETC  '&XLABEL'                SET NAME                   57550000
              AIF   (K'&XLABEL NE 0).XLAB2                              57600000
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               57650000
.*                                                                      57700000
.XLAB2        ANOP  ,                                                   57750000
              AIF   ('&XMF' EQ 'L').XLAB3                               57800000
&M0M0001 DS    0H                             IWMIMPT-0                 57850000
.XLAB3        ANOP  ,                                                   57900000
.*******************************************************************    57950000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              58000000
.*******************************************************************    58050000
              PUSH  PRINT                                               58100000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          58150000
              PRINT OFF         ++ PR01                                 58200000
              AGO   .ZPRNTXX                                            58250000
.ZPRINTX      PRINT ON                                                  58300000
.ZPRNTXX      ANOP  ,                                                   58350000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  58400000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  58450000
.********************************************************************   58500000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     58550000
.********************************************************************   58600000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       58650000
                      LCLA  &ZOPN1         INVOCATION INDEX             58700000
                      LCLC  &ZOPL(4095)    LABEL                        58750000
                      LCLC  &ZOPO(4095)    OPERATION                    58800000
                      LCLC  &ZOPV(4095)    VALUE                        58850000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  58900000
.*                                                                      58950000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     59000000
.******************************************************************     59050000
.***AL.L10 IWMIMPT FMT=LIST MF=S|L PARAMETERS                           59100000
.******************************************************************     59150000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     59200000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     59250000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     59300000
&XMFATTR              SETC  '0D'                                        59350000
.*                                                                      59400000
&ZOPN                 SETA  &ZOPN+1                                     59450000
&ZOPL(&ZOPN)          SETC  ' '                                         59500000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     59525000
&ZOPO(&ZOPN)          SETC  'B'                                         59550000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                59600000
                      AGO   .ZALVL6B                                    59608300
.ZALVL6A              ANOP                                              59616600
&ZOPO(&ZOPN)          SETC  'BRAS'                                      59624900
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              59633200
.ZALVL6B              ANOP                                              59641500
&ZOPD(&ZOPN)          SETC  '++ IWMIMPT ARG PARMS'                      59650000
.*                                                                      59700000
&ZOPN                 SETA  &ZOPN+1                                     59750000
&ZOPL(&ZOPN)          SETC  ' '                                         59800000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     59850000
&ZOPV(&ZOPN)          SETC  '1'                                         59900000
&ZOPD(&ZOPN)          SETC  ' '                                         59950000
.*                                                                      60000000
.ZLMFSL2              ANOP  ,                                           60050000
.*-------------------------------------------------------------------   60100000
.***AM.L00  IWMIMPT FMT=LIST name                                       60150000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    60200000
&ZOPN                 SETA &ZOPN+1                                      60250000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   60300000
&ZOPO(&ZOPN)          SETC 'EQU'                                        60350000
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   60400000
&ZOPD(&ZOPN)          SETC '++ IWMIMPT NAME'                            60450000
.ZLMFSL2M             ANOP  ,                                           60500000
.*-------------------------------------------------------------------   60550000
.***AM.L01  IWMIMPT FMT=LIST PARAMETERS                                 60600000
&ZOPN                 SETA &ZOPN+1                                      60650000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   60700000
&ZOPO(&ZOPN)          SETC 'DS'                                         60750000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   60800000
&ZOPD(&ZOPN)          SETC '++ IWMIMPT PARM LIST'                       60850000
.*-------------------------------------------------------------------   60900000
.***AM.L02 XVERSION XL1                                                 60950000
&ZOPN                 SETA &ZOPN+1                                      61000000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         61050000
&ZOPO(&ZOPN)          SETC 'DS'                                         61100000
&ZOPV(&ZOPN)          SETC 'XL1'                                        61150000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          61200000
.*-------------------------------------------------------------------   61250000
.***AM.L09  XRSV0001 CL1                                                61300000
&ZOPN                 SETA &ZOPN+1                                      61350000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         61400000
&ZOPO(&ZOPN)          SETC 'DS'                                         61450000
&ZOPV(&ZOPN)          SETC 'CL1'                                        61500000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      61550000
.*-------------------------------------------------------------------   61600000
.***AM.L09  XPLISTLEN XL2                                               61650000
&ZOPN                 SETA &ZOPN+1                                      61700000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        61750000
&ZOPO(&ZOPN)          SETC 'DS'                                         61800000
&ZOPV(&ZOPN)          SETC 'XL2'                                        61850000
&ZOPD(&ZOPN)          SETC '++ INPUT  XPLISTLEN'                        61900000
.*-------------------------------------------------------------------   61950000
.***AM.L09  XETOKEN CL8                                                 62000000
&ZOPN                 SETA &ZOPN+1                                      62050000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XETOKEN'                          62100000
&ZOPO(&ZOPN)          SETC 'DS'                                         62150000
&ZOPV(&ZOPN)          SETC 'CL8'                                        62200000
&ZOPD(&ZOPN)          SETC '++ &ZXETOKEN  XETOKEN'                      62250000
.*-------------------------------------------------------------------   62300000
.***AM.L09  XXTOKEN CL32                                                62350000
&ZOPN                 SETA &ZOPN+1                                      62400000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XXTOKEN'                          62450000
&ZOPO(&ZOPN)          SETC 'DS'                                         62500000
&ZOPV(&ZOPN)          SETC 'CL32'                                       62550000
&ZOPD(&ZOPN)          SETC '++ &ZXXTOKEN  XXTOKEN'                      62600000
.*-------------------------------------------------------------------   62650000
.***AM.L09  XCONNTKN BL.32                                              62700000
&ZOPN                 SETA &ZOPN+1                                      62750000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCONNTKN'                         62800000
&ZOPO(&ZOPN)          SETC 'DS'                                         62850000
&ZOPV(&ZOPN)          SETC 'BL.32'                                      62900000
&ZOPD(&ZOPN)          SETC '++ &ZXCONNTKN  XCONNTKN'                    62950000
.*-------------------------------------------------------------------   63000000
.***AM.L09  XRSV0002 CL8                                                63050000
&ZOPN                 SETA &ZOPN+1                                      63100000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         63150000
&ZOPO(&ZOPN)          SETC 'DS'                                         63200000
&ZOPV(&ZOPN)          SETC 'CL8'                                        63250000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0002'                      63300000
.*-------------------------------------------------------------------   63350000
.***AM.L10 END OF IWMIMPT LIST PARAMETERS                               63400000
&ZOPN                 SETA &ZOPN+1                                      63450000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 63500000
&ZOPO(&ZOPN)          SETC 'EQU'                                        63550000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 63600000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         63650000
.*                                                                      63700000
&ZOPN                 SETA &ZOPN+1                                      63750000
&ZOPL(&ZOPN)          SETC ' '                                          63800000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      63850000
&ZOPV(&ZOPN)          SETC '1'                                          63900000
&ZOPD(&ZOPN)          SETC ' '                                          63950000
.*-------------------------------------------------------------------   64000000
.***AL.L12 IWMIMPT FMT=LIST MF=S|L PARAMETERS                           64050000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         64100000
.*                                                                      64150000
&ZOPN                 SETA  &ZOPN+1                                     64200000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                64250000
&ZOPO(&ZOPN)          SETC  'DC'                                        64300000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   64350000
&ZOPD(&ZOPN)          SETC  '++ IWMIMPT ARG PARMS'                      64400000
.*                                                                      64450000
.ZLMFSLX              ANOP  ,                                           64500000
.*-------------------------------------------------------------------   64550000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          64600000
&ZPLLEN               SETA 56                                           64650000
.*                                                                      64700000
.******************************************************************     64750000
.***AI.L01 IWMIMPT FMT=LIST FILL IN PARAMETER AREA                      64800000
.******************************************************************     64850000
                      ACTR  10000                                       64900000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               64950000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    65000000
&ZCVAL                SETC  'LAE'          XAX MODE                     65050000
.ZIMFXA               ANOP ,                                            65100000
.*                                                                      65150000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    65200000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         65250000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 65300000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                65350000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 65400000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                65450000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   65500000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    65550000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   65600000
&ZOPN                 SETA  &ZOPN+1                                     65650000
&ZOPL(&ZOPN)          SETC  ' '                                         65700000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    65750000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              65800000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       65850000
                      AGO   .ZIMFNX                                     65900000
.*                                                                      65950000
.ZIMFN2               ANOP ,                                            66000000
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     66004500
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     66009000
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  66013500
&ZOPN                 SETA  &ZOPN+1                                     66018000
&ZOPL(&ZOPN)          SETC  ' '                                         66022500
&ZOPO(&ZOPN)          SETC  'LAE'                                       66027000
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  66031500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       66036000
                      AGO   .ZIMFNX                                     66040500
.ZIMFNX1              ANOP ,                                            66045000
&ZOPN                 SETA  &ZOPN+1                                     66050000
&ZOPL(&ZOPN)          SETC  ' '                                         66100000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    66150000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                66200000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       66250000
.ZIMFNX               ANOP ,                                            66300000
.********************************************************************   66350000
.***AI.L02 IWMIMPT FMT=LIST INITIALIZE PARAMETER AREA                   66400000
.********************************************************************   66450000
.***AI.L03 MF=(SLE)                                                     66500000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      66550000
.*                                                                      66600000
&ZOPN                 SETA  &ZOPN+1                                     66650000
&ZOPL(&ZOPN)          SETC  ' '                                         66700000
&ZOPO(&ZOPN)          SETC  'XC'                                        66750000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         66800000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             66850000
.ZIMFLX               ANOP  ,                                           66900000
.*-------------------------------------------------------------------   66950000
.***AI.L04 XPLISTLEN XL2                                                67000000
&ZOPN                 SETA  &ZOPN+1                                     67050000
&ZOPL(&ZOPN)          SETC  ' '                                         67100000
&ZOPO(&ZOPN)          SETC  'MVC'                                       67150000
&ZOPV(&ZOPN)          SETC  '2(2,1),=AL2(&ZPLLEN)'                      67200000
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    67250000
.*-------------------------------------------------------------------   67300000
.***AI.L25  XXTOKEN CL32                                                67350000
                      AIF   ('&ZXXTOKEN' EQ '').ZI5E                    67400000
                      AIF   ('&ZXXTOKEN' EQ 'OUTPUT').ZI5E              67450000
&ZCGPR                SETC  '&XXTOKEN'                                  67500000
.*                                                                      67550000
                      AIF   ('&XXTOKEN'(1,1) NE '(').ZI5B               67600000
&ZCGPR   SETC  '0('.'&XXTOKEN'(2,K'&XXTOKEN-2).')'                      67650000
.ZI5B                 ANOP  ,                                           67700000
.*                                                                      67750000
&ZOPN                 SETA  &ZOPN+1                                     67800000
&ZOPL(&ZOPN)          SETC  ' '                                         67850000
&ZOPO(&ZOPN)          SETC  'MVC'                                       67900000
&ZOPV(&ZOPN)          SETC  '12(32,1),&ZCGPR'                           67950000
&ZOPD(&ZOPN)          SETC  '++ &ZXXTOKEN XXTOKEN'                      68000000
.*                                                                      68050000
.ZI5E                 ANOP  ,                                           68100000
.*-------------------------------------------------------------------   68150000
.***AI.L25  XCONNTKN XL4                                                68200000
                      AIF   ('&ZXCONNTKN' EQ '').ZI6E                   68250000
                      AIF   ('&ZXCONNTKN' EQ 'OUTPUT').ZI6E             68300000
&ZCGPR                SETC  '&XCONNTKN'                                 68350000
.*                                                                      68400000
                      AIF   ('&XCONNTKN'(1,1) NE '(').ZI6B              68450000
&ZCGPR   SETC  '0('.'&XCONNTKN'(2,K'&XCONNTKN-2).')'                    68500000
                      AGO   .ZI6D                                       68550000
.ZI6B                 ANOP  ,                                           68600000
.*                                                                      68650000
&ZC                   SETC  '&XCONNTKN'(1,1)                            68700000
                      AIF   (T'&ZC NE 'N').ZI6D                         68750000
&ZC                   SETC  '&XCONNTKN'                                 68800000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI6D                68850000
&ZCGPR                SETC  '=BL4''&XCONNTKN'''                         68900000
.*                                                                      68950000
.ZI6D                 ANOP  ,                                           69000000
.*                                                                      69050000
&ZOPN                 SETA  &ZOPN+1                                     69100000
&ZOPL(&ZOPN)          SETC  ' '                                         69150000
&ZOPO(&ZOPN)          SETC  'MVC'                                       69200000
&ZOPV(&ZOPN)          SETC  '44(4,1),&ZCGPR'                            69250000
&ZOPD(&ZOPN)          SETC  '++ &ZXCONNTKN XCONNTKN'                    69300000
.*                                                                      69350000
.ZI6E                 ANOP  ,                                           69400000
.*-------------------------------------------------------------------   69450000
&ZOPN1                SETA &ZOPN                                        69500000
.*******************************************************************    69550000
.***  PROCESS IWMIMPT OUTPUT PARAMETERS                                 69600000
.*******************************************************************    69650000
                      ACTR  10000                                       69700000
.*------------------------------------------------------------------    69750000
.***AO.L02 XETOKEN CL8                                                  69800000
         AIF   ('&ZXETOKEN' EQ 'OUTPUT').ZO4A  OUTPUT                   69850000
         AIF   ('&ZXETOKEN' NE 'INOUT').ZO4C  INOUT                     69900000
.ZO4A    AIF   ('&XETOKEN'(1,1) NE '(').ZO4B  ADDR IN GPR               69950000
&ZCGPR   SETC  '&XETOKEN'(2,K'&XETOKEN-2)                               70000000
&ZOPN                 SETA  &ZOPN+1                                     70050000
&ZOPL(&ZOPN)          SETC  ' '                                         70100000
&ZOPO(&ZOPN)          SETC  'MVC'                                       70150000
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),4(1)'                          70200000
&ZOPD(&ZOPN)          SETC  '++ XETOKEN CL8'                            70250000
                      AGO   .ZO4C                                       70300000
.*                                                                      70350000
.ZO4B                 ANOP  ,                                           70400000
&ZAWRK   SETA  K'&XETOKEN                                               70450000
         AIF   ('&XETOKEN'(&ZAWRK,1) NE ')').ZO4G                       70500000
&ZN      SETA  2                                                        70550000
.ZO4H    ANOP                                                           70600000
         AIF   (&ZN GE &ZAWRK).ZO4G                                     70650000
         AIF   ('&XETOKEN'(&ZN,1) NE '(').ZO4I                          70700000
&ZC      SETC  '&XETOKEN'(1,&ZN).'8'.','                                70750000
&ZC      SETC  '&ZC'.'&XETOKEN'(&ZN+1,&ZAWRK-&ZN).',4(1)'               70800000
         AGO   .ZO4J                                                    70850000
.ZO4I    ANOP                                                           70900000
&ZN      SETA  &ZN+1                                                    70950000
         AGO   .ZO4H                                                    71000000
.ZO4G    ANOP                                                           71050000
&ZC      SETC  '&XETOKEN.(8),4(1)'                                      71100000
.ZO4J    ANOP                                                           71150000
&ZOPN                 SETA  &ZOPN+1                                     71200000
&ZOPL(&ZOPN)          SETC  ' '                                         71250000
&ZOPO(&ZOPN)          SETC  'MVC'                                       71300000
&ZOPV(&ZOPN)          SETC  '&ZC'                                       71350000
&ZOPD(&ZOPN)          SETC  '++ XETOKEN CL8'                            71400000
.ZO4C                 ANOP  ,                                           71450000
.*******************************************************************    71500000
.***AO.X02  RETURN CODE PROCESSING                                      71550000
.*******************************************************************    71600000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    71650000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            71700000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             71750000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             71800000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               71850000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                71900000
&ZOPN                 SETA  &ZOPN+1                                     71950000
&ZOPL(&ZOPN)          SETC  ' '                                         72000000
&ZOPO(&ZOPN)          SETC  'ST'                                        72050000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              72100000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        72150000
                      AGO   .ZMRETX                                     72200000
.*                                                                      72250000
.ZMRET2               ANOP  ,                                           72300000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                72350000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                72400000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                72450000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  72500000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   72550000
&ZOPN                 SETA  &ZOPN+1                                     72600000
&ZOPL(&ZOPN)          SETC  ' '                                         72650000
&ZOPO(&ZOPN)          SETC  'LR'                                        72700000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 72750000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        72800000
.ZMRETX               ANOP  ,                                           72850000
.*******************************************************************    72900000
.***AO.X03  REASON CODE PROCESSING                                      72950000
.*******************************************************************    73000000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    73050000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            73100000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              73150000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             73200000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              73250000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             73300000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                73350000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 73400000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                73450000
&ZOPN                 SETA  &ZOPN+1                                     73500000
&ZOPL(&ZOPN)          SETC  ' '                                         73550000
&ZOPO(&ZOPN)          SETC  'ST'                                        73600000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               73650000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        73700000
                      AGO   .ZMRSNX                                     73750000
.*                                                                      73800000
.ZMRSN2               ANOP  ,                                           73850000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                73900000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 73950000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                74000000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 74050000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                74100000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   74150000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    74200000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   74250000
&ZOPN                 SETA  &ZOPN+1                                     74300000
&ZOPL(&ZOPN)          SETC  ' '                                         74350000
&ZOPO(&ZOPN)          SETC  'LR'                                        74400000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  74450000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        74500000
.ZMRSNX               ANOP  ,                                           74550000
.*******************************************************************    74600000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   74650000
.*******************************************************************    74700000
.ZMFLX                ANOP  ,              MF=L PROCESSING              74750000
.*******************************************************************    74800000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               74850000
.*******************************************************************    74900000
                      ACTR  10000                                       74950000
.*                                                                      75000000
                      LCLA  &ZLC           COLUMN POSITION              75050000
                      LCLA  &ZOPX          LIST TABLE INDEX             75100000
                      LCLC  &ZLL           LABEL                        75150000
                      LCLC  &ZLOP          OPERATION                    75200000
                      LCLC  &ZLV           VALUE                        75250000
                      LCLC  &ZLD           DESCRIPTION                  75300000
.*                                                                      75350000
&ZOPX                 SETA  1                                           75400000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            75450000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              75500000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              75550000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              75600000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              75650000
                      AIF   (K'&ZLD LE 0).ZL5                           75700000
&ZLC                  SETA  35             COMMENT COLUMN               75750000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    75800000
&ZLC                  SETA  33             COMMMENT COLUMN              75850000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   75900000
&ZLV                  SETC  '&ZLV'.' '                                  75950000
                      AGO   .ZL3                                        76000000
.*                                                                      76050000
.ZL4                  ANOP  ,                                           76100000
&ZLV                  SETC  '&ZLV'.' '                                  76150000
.ZL5                  ANOP  ,                                           76200000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               76250000
.*                                                                      76300000
&ZLL     &ZLOP &ZLV                                                     76350000
.*                                                                      76400000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               76450000
                      AGO   .ZL2           CONTINUE LOOPING             76500000
.*                                                                      76550000
.ZLX                  ANOP  ,                                           76600000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                76650000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  76700000
         L     14,16(0,0)              GET CVT ADDRESS                  76750000
         L     14,772(14,0)            GET SFT ADDRESS                  76800000
         L     14,380(14,0)            GET LX FOR SERVICE ROUTINE       76850000
         LA    15,87                   GET EX FOR SERVICE ROUTINE       76900000
         OR    14,15                   GET PC NUMBER                    76950000
         PC    0(14)                                                    77000000
END&SYSNDX DS    0H                    END LABEL                        77050000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  77100000
.ZLINKX               ANOP  ,                                           77150000
.*******************************************************************    77200000
.***AP.X01  FORMAT GENERATED CODE                                       77250000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            77300000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              77350000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              77400000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              77450000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              77500000
                      AIF   (K'&ZLD LE 0).ZL51                          77550000
&ZLC                  SETA  35             COMMENT COLUMN               77600000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   77650000
&ZLC                  SETA  33             COMMENT COLUMN               77700000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  77750000
&ZLV                  SETC  '&ZLV'.' '                                  77800000
                      AGO   .ZL31                                       77850000
.*                                                                      77900000
.ZL41                 ANOP  ,                                           77950000
&ZLV                  SETC  '&ZLV'.' '                                  78000000
.ZL51                 ANOP  ,                                           78050000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               78100000
.*                                                                      78150000
&ZLL     &ZLOP &ZLV                                                     78200000
.*                                                                      78250000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               78300000
                      AGO   .ZL21          CONTINUE LOOPING             78350000
.*                                                                      78400000
.ZLX1                 ANOP  ,                                           78450000
.*******************************************************************    78500000
.***AP.X02  END OF IWMIMPT MACRO                                        78550000
&ZIWMIMPT             SETC  'YES'          SET IWMIMPT USED             78600000
         POP   PRINT                                                    78650000
*                                            IWMIMPT-0                  78700000
         SPACE 1                                                        78750000
.ZLX2                 ANOP  ,                                           78800000
         MEND                                                           78850000
**********************************************************************/ 78900000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  78950000
*%IWMIMPT: MACRO KEYS(XTOKEN,ETOKEN,CONNTKN,RETCODE,RSNCODE,PLISTVER,   79000000
*                 MF);                                                  79050000
*  ANS('?'||MACLABEL||' '||'IWMIMPTP '||MACLIST||                       79100000
*         ' '||MACKEYS||';') COL(MACLMAR);                              79150000
*%END IWMIMPT;                                                          79200000
