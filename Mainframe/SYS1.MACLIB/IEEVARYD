*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IEEVARYD                              -03/23/94-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  VARY Device Online/Offline/Autoswitch Service * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     5655-068 (C) COPYRIGHT IBM CORP. 1994                           * 00001300
*     SEE COPYRIGHT INSTRUCTIONS                                      * 00001400
*                                                                     * 00001500
* STATUS= HBB5520                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*                                                                     * 00001900
*01* FUNCTION:                                                        * 00002000
*                                                                     * 00002100
*                                                                     * 00002200
*      IEEVARYD is a programming interface to the function performed  * 00002300
*      by the MVS VARY device online/offline/autoswitch system        * 00002400
*      command.                                                       * 00002500
*                                                                     * 00002600
*      You provide a device array which contains an entry for each    * 00002700
*      device upon which the function is to be performed.  IEEVARYD   * 00002800
*      sets a return and reason code for each device in the device    * 00002900
*      array to indicate the results of each VARY device operation    * 00003000
*      rather than issuing messages to a console.                     * 00003100
*                                                                     * 00003200
*      The macro expansion alters the contents of registers 0, 1, 14, * 00003300
*      and 15.                                                        * 00003400
*                                                                     * 00003500
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00003600
*                                                                     * 00003700
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003800
*                                                                     * 00003900
*01* ENVIRONMENT:                                                     * 00004000
*                                                                     * 00004100
*                                                                     * 00004200
*      Dispatchable unit mode: Task mode.                             * 00004300
*                                                                     * 00004400
*      Minimum authorization: Supervisor state or PSW Key Mask (PKM)  * 00004500
*                        allowing keys 0-7.                           * 00004600
*                                                                     * 00004700
*      AMODE:            31-bit.                                      * 00004800
*                                                                     * 00004900
*      ASC mode:         Primary.  PASN=HASN=SASN.                    * 00005000
*                                                                     * 00005100
*      Serialization:    Enabled.  Unlocked.                          * 00005200
*                                                                     * 00005300
*      Restrictions:                                                  * 00005400
*                                                                     * 00005500
*                        The caller's address space must be           * 00005600
*                        non-swappable.                               * 00005700
*                                                                     * 00005800
*                        The control parameters must be in the        * 00005900
*                        caller's primary address space.              * 00006000
*                                                                     * 00006100
*                        The IEEVARYD macro does not invoke SAF.  If  * 00006200
*                        you require that the calling program's       * 00006300
*                        authority to perform a vary device operation * 00006400
*                        be checked, issue RACROUTE REQUEST=AUTH      * 00006500
*                        before issuing the IEEVARYD macro.           * 00006600
*                                                                     * 00006700
*                        The calling program must perform any logging * 00006800
*                        of information associated with the operation * 00006900
*                        (for example, in the system log (SYSLOG)).   * 00007000
*                                                                     * 00007100
*                                                                     * 00007200
*                                                                     * 00007300
*01* INPUT REGISTERS:  GR0-GR1     Reserved                           * 00007400
*                      GR2-GR13    Undefined                          * 00007500
*                      GR14-GR15   Reserved                           * 00007600
*                      AR0-AR1     Reserved                           * 00007700
*                      AR2-AR13    Undefined                          * 00007800
*                      AR14-AR15   Reserved                           * 00007900
*                                                                     * 00008000
*01* OUTPUT REGISTERS: GR0         Reason code                        * 00008100
*                      GR1         Unpredictable                      * 00008200
*                      GR2-GR13    Unchanged                          * 00008300
*                      GR14        Unpredictable                      * 00008400
*                      GR15        Return code                        * 00008500
*                      AR0-AR1     Unpredictable                      * 00008600
*                      AR2-AR13    Unchanged                          * 00008700
*                      AR14-AR15   Unpredictable                      * 00008800
*                                                                     * 00008900
*01* SYNTAX:                                                          * 00009000
*                                                                     * 00009100
*[xlabel]  IEEVARYD     OPERATION=xoperation                          * 00009200
*                      ,DEVICES=xdevices                              * 00009300
*                     [,NUMDEVS=xnumdevs|1]                         * 00009400
*                     [,RESULTS=xresults]                             * 00009500
*                     [,CALLERID=xcallerid|NO_CALLERID]             * 00009600
*                     [,RETCODE=xretcode]                             * 00009700
*                     [,RSNCODE=xrsncode]                             * 00009800
*                    [,MF=S]                                         * 00009900
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 00010000
*                    [,MF=(E,xmfctrl,COMPLETE)]                    * 00010100
*                                                                     * 00010200
*                                                                     * 00010300
*      Where:                                                         * 00010400
*                                                                     * 00010500
*                                                                     * 00010600
*      [xlabel]                                                       * 00010700
*          is an optional symbol, starting in column 1, that is the   * 00010800
*          name on the IEEVARYD macro invocation.  The name must      * 00010900
*          conform to the rules for an ordinary assembler language    * 00011000
*          symbol.                                                    * 00011100
*          DEFAULT: No name.                                          * 00011200
*                                                                     * 00011300
*                                                                     * 00011400
*                                                                     * 00011500
*                                                                     * 00011600
*      OPERATION=xoperation                                           * 00011700
*          is the name (RS-type), or address in register (2)-(12), of * 00011800
*          a required character input which identifies the VARY       * 00011900
*          device operation to be performed on the device(s)          * 00012000
*          specified in the DEVICES parameter.  The OPERATION area is * 00012100
*          mapped by the IEEZB833 macro.                              * 00012200
*                                                                     * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*                                                                     * 00012600
*      DEVICES=xdevices                                               * 00012700
*          is the name (RS-type), or address in register (2)-(12), of * 00012800
*          a required character input variable length area which      * 00012900
*          identifies the devices upon which the VARY operation is to * 00013000
*          be performed.  The DEVICES area is an array which is       * 00013100
*          mapped by the IEEZB833 macro.                              * 00013200
*                                                                     * 00013300
*                                                                     * 00013400
*                                                                     * 00013500
*                                                                     * 00013600
*      [NUMDEVS=xnumdevs|1]                                         * 00013700
*          is the name (RS-type), or address in register (2)-(12), of * 00013800
*          an optional fullword input which specifies the number of   * 00013900
*          devices in the device array.                               * 00014000
*          DEFAULT: 1                                                 * 00014100
*                                                                     * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*      [RESULTS=xresults]                                             * 00014600
*          is the name (RS-type), or address in register (2)-(12), of * 00014700
*          an optional character output variable length area which    * 00014800
*          contains the results of the VARY operation.  The RESULTS   * 00014900
*          area, which is mapped by the IEEZB834 macro, is an array   * 00015000
*          which contains results for the VARY operation on each      * 00015100
*          device specified in the DEVICES area.                      * 00015200
*                                                                     * 00015300
*                                                                     * 00015400
*                                                                     * 00015500
*                                                                     * 00015600
*      [CALLERID=xcallerid|NO_CALLERID]                             * 00015700
*          is the name (RS-type), or address in register (2)-(12), of * 00015800
*          an optional 8 character input which identifies the caller  * 00015900
*          of the VARY operation.  If CALLERID is specified, then MVS * 00016000
*          will use this identifier as an insert in the message(s)    * 00016100
*          that MVS issues to hardcopy which indicate that a device   * 00016200
*          was brought online/offline or the autoswitch attribute was * 00016300
*          changed.  The CALLERID insert identifies the initiator of  * 00016400
*          the VARY operation.                                        * 00016500
*          DEFAULT: NO_CALLERID                                       * 00016600
*                                                                     * 00016700
*                                                                     * 00016800
*                                                                     * 00016900
*                                                                     * 00017000
*      [RETCODE=xretcode]                                             * 00017100
*          is the name (RS-type) of an optional fullword output       * 00017200
*          variable, or register (2)-(12), into which the return code * 00017300
*          is to be copied from GPR 15.                               * 00017400
*                                                                     * 00017500
*                                                                     * 00017600
*                                                                     * 00017700
*                                                                     * 00017800
*      [RSNCODE=xrsncode]                                             * 00017900
*          is the name (RS-type) of an optional fullword output       * 00018000
*          variable, or register (2)-(12), into which the reason code * 00018100
*          is to be copied from GPR 0.                                * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*                                                                     * 00018500
*                                                                     * 00018600
*      [MF=S|L|E]                                                   * 00018700
*          is an optional keyword input which specifies the macro     * 00018800
*          form.                                                      * 00018900
*          DEFAULT: S                                                 * 00019000
*                                                                     * 00019100
*                                                                     * 00019200
*          [MF=S]                                                     * 00019300
*              specifies the standard form of the macro.  The "S"     * 00019400
*              form generates code to put the parameters into an      * 00019500
*              in-line parameter list and invoke the desired service. * 00019600
*              Full checking for required macro keys is done along    * 00019700
*              with supplying defaults for omitted optional           * 00019800
*              parameters.                                            * 00019900
*                                                                     * 00020000
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00020100
*              specifies the list form of the macro.  The "L" form    * 00020200
*              defines an area to be used for the parameter list.     * 00020300
*              Any other macro parameters are flagged as errors.      * 00020400
*                                                                     * 00020500
*            ,xmfctrl                                                 * 00020600
*              is a required input.  It is the name of a storage area * 00020700
*              for the parameter list.                                * 00020800
*                                                                     * 00020900
*            ,xmfattr|0D                                            * 00021000
*              is an optional 60 character input string that varies   * 00021100
*              from 1 to 60 characters. It can contain any value that * 00021200
*              is valid on an assembler DS pseudo-op. You can use     * 00021300
*              this parameter to force boundary alignment of the      * 00021400
*              parameter list.                                        * 00021500
*              DEFAULT: 0D which forces the parameter list to a       * 00021600
*              doubleword boundary.                                   * 00021700
*                                                                     * 00021800
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00021900
*              specifies the execute form of the macro.  The "E" form * 00022000
*              generates code to put the parameters into the          * 00022100
*              parameter list specified by xmfctrl and provides full  * 00022200
*              syntax checking with default setting.                  * 00022300
*                                                                     * 00022400
*            ,xmfctrl                                                 * 00022500
*              is a required input.  It is the name (RS-type), or     * 00022600
*              address in register (1)-(12), of a storage area for    * 00022700
*              the parameter list.                                    * 00022800
*                                                                     * 00022900
*            ,COMPLETE                                              * 00023000
*              is an optional keyword input which specifies the       * 00023100
*              degree of macro parameter syntax checking.             * 00023200
*              DEFAULT: COMPLETE                                      * 00023300
*                                                                     * 00023400
*                                                                     * 00023500
*              COMPLETE   Checking for required macro keys is done    * 00023600
*                        and defaults are supplied for omitted        * 00023700
*                        optional parameters.                         * 00023800
*                                                                     * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*01* RETURN CODES:                                                    * 00024600
*                                                                     * 00024700
*                                                                     * 00024800
*                                                                     * 00024900
*                 X'00'     The operation was performed against each  * 00025000
*                           specified device and MVS set the          * 00025100
*                           VDRSARR_RETCODE field to 0 for each       * 00025200
*                           device in the device array (VDRSARR).     * 00025300
*                                                                     * 00025400
*                 X'04'     The operation was performed against all   * 00025500
*                           specified devices, but MVS set the        * 00025600
*                           VDRSARR_RETCODE field to a non-zero value * 00025700
*                           for at least one device in the device     * 00025800
*                           array (VDRSARR).                          * 00025900
*                                                                     * 00026000
*                 X'08'     Error in caller's parameters.             * 00026100
*                                                                     * 00026200
*                           Reason codes                              * 00026300
*                                                                     * 00026400
*                                                                     * 00026500
*                           X'01'     MVS could not access the        * 00026600
*                                     control parameter list.         * 00026700
*                                                                     * 00026800
*                           X'02'     MVS could not access the        * 00026900
*                                     storage area specified on the   * 00027000
*                                     DEVICES parameter.              * 00027100
*                                                                     * 00027200
*                           X'03'     MVS could not access the        * 00027300
*                                     storage area specified on the   * 00027400
*                                     OPERATION parameter.            * 00027500
*                                                                     * 00027600
*                           X'04'     MVS could not access the        * 00027700
*                                     storage area specified on the   * 00027800
*                                     RESULTS parameter.              * 00027900
*                                                                     * 00028000
*                           X'05'     Command keyword specification   * 00028100
*                                     in the OPERATION area is not    * 00028200
*                                     valid.                          * 00028300
*                                                                     * 00028400
*                           X'06'     The combination of vary device  * 00028500
*                                     options specified in the        * 00028600
*                                     OPERATION area is not valid.    * 00028700
*                                                                     * 00028800
*                           X'07'     The NUMDEVS value is not valid. * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*                                                                     * 00029200
*                 X'10'     MVS encountered an unexpected error and   * 00029300
*                           was unable to attempt the operation       * 00029400
*                           against one or more devices.  Record this * 00029500
*                           return code and supply it to the          * 00029600
*                           appropriate IBM support personnel.        * 00029700
*                                                                     * 00029800
*                                                                     * 00029900
*                                                                     * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*01* REASON CODES:                                                    * 00030300
*                                                                     * 00030400
*       See return codes section.                                     * 00030500
*                                                                     * 00030600
*01* MODULE TYPE:  ASSEM MACRO                                        * 00030700
*                                                                     * 00030800
*02*   PROCESSOR:  ASSEM                                              * 00030900
*                                                                     * 00031000
*01* COMPONENT:  SC1B8                                                * 00031100
*                                                                     * 00031200
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00031300
*                                                                     * 00031400
*01* MACRO USAGE NOTES:                                               * 00031500
*                                                                     * 00031600
*                                                                     * 00031700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00031800
*        global macro variable.  Any value other than 'NO' will       * 00031900
*        result in the macro expansion being printed.  The default is * 00032000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00032100
*        variable should be set.                                      * 00032200
*                                                                     * 00032300
*                    GBLC &ZPRINT                                     * 00032400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00032500
*                                                                     * 00032600
*                                                                     * 00032700
*                                                                     * 00032800
*01* CHANGE ACTIVITY:                                                 * 00032900
*                                                                     * 00033000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00033100
*                                                                     * 00033200
*    $L0=SYSOP4LC HBB5510 921205 PDLC:  Sysplex Operations            * 00033300
*    $D1=DMN4005  HBB5510 930121 PDLC:  Add reason codes              * 00033400
*    $P1=PIG2764  HBB5510 930830 PDLC:  Fix Assembler version         * 00033500
*    $P2=PIG3394  HBB5510 931019 PDLC:  Fix description of OPERATION  * 00033600
*                                         parameter                   * 00033700
*    $L1=SHRTP83J HBB5520 940415 PD3J:  Add VARY AUTOSWITCH to        * 00033800
*                                         descriptions.               * 00033900
****** END OF SPECIFICATIONS *****************************************/ 00034000
*/********************************************************************* 00034100
         MACRO                                                          00034200
&XLABEL  IEEVARYD &OPERATION=,&DEVICES=,&NUMDEVS=,&RESULTS=,&CALLERID=,*00034300
               &RETCODE=,&RSNCODE=,&MF=                                 00034400
.*                                                                      00034500
*               MACDATE -03/23/94-<1>                                   00034600
.*                                                                      00034700
.*******************************************************************    00034800
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00034900
.*******************************************************************    00035000
               GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                  00035100
               GBLC  &ZTEST      YES=TEST NO=NO TEST                    00035200
               GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX            00035300
.*                                                                      00035400
               GBLC  &ZIEEVARYD  YES=MACRO USED AT LEAST ONCE           00035500
.*******************************************************************    00035600
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00035700
.*******************************************************************    00035800
               LCLC  &ZMS        ERROR MESSAGE WORK AREA                00035900
               LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS           00036000
               LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED             00036100
               LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR            00036200
               LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE            00036300
               LCLA  &ZAWRK      USED AS A WORK AREA                    00036400
               LCLA  &ZASIZ      USED FOR SIZE OF VALUE                 00036500
               LCLA  &ZN         NUMERIC WORK VARIABLE                  00036600
               LCLC  &ZC         CHARACTER WORK VARIABLE                00036700
               LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE            00036800
               LCLA  &ZTLA       VALUE TOO LONG VARIABLE                00036900
               LCLA  &ZMACRET    MACRO RETURN CODE                      00037000
&ZMACRET       SETA  0           ASSUME NO ERRORS                       00037100
.*                                                                      00037200
               LCLC  &ZCSYSLIST(255)            NONXKEY, POS ARRAY      00037300
               LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()             00037400
               LCLA  &ZPLLEN     PARAMETER LIST LENGTH                  00037500
.********************************************************************   00037600
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00037700
.********************************************************************   00037800
               GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                00037900
               GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE         00038000
.*                                                                      00038100
               AIF   (K'&SYSASCE GT 0).ZSYS4    SYS STATE DEFINED       00038200
               AIF   (K'&SYSSPLV GT 0).ZSYS2    SP LEVEL DEFINED        00038300
               SPLEVEL  TEST                                            00038400
.ZSYS2         ANOP  ,                                                  00038500
               AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1              00038600
               AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1              00038700
               SYSSTATE TEST                                            00038800
               AGO   .ZSYS4                                             00038900
.ZSYS3         ANOP  ,                                                  00039000
&SYSASCE       SETC  'P'         ASSUME SYSSTATE PRIMARY                00039100
.ZSYS4         ANOP  ,                                                  00039200
.*******************************************************************    00039300
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00039400
.*******************************************************************    00039500
               LCLC  &XOPERATION                ++ NAME                 00039600
               LCLC  &XDEVICES   ++ NAME                                00039700
               LCLC  &XNUMDEVS   ++ NAME                                00039800
               LCLC  &XRESULTS   ++ NAME                                00039900
               LCLC  &XCALLERID  ++ NAME                                00040000
               LCLC  &XRETCODE   ++ NAME                                00040100
               LCLC  &XRSNCODE   ++ NAME                                00040200
               LCLC  &XMF        ++ VALUE                               00040300
               LCLC  &XMFCTRL    ++ NAME                                00040400
               LCLC  &XMFATTR    ++ VALUE                               00040500
               LCLC  &XMFSCK     ++ VALUE                               00040600
.*******************************************************************    00040700
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00040800
.*******************************************************************    00040900
               LCLC  &ZXOPERATION               ++ INPUT NAME           00041000
               LCLC  &ZXDEVICES  ++ INPUT NAME                          00041100
               LCLC  &ZXNUMDEVS  ++ INPUT NAME                          00041200
               LCLC  &ZXRESULTS  ++ OUTPUT NAME                         00041300
               LCLC  &ZXCALLERID                ++ INPUT NAME           00041400
               LCLC  &ZXRETCODE  ++ OUTPUT NAME                         00041500
               LCLC  &ZXRSNCODE  ++ OUTPUT NAME                         00041600
               LCLC  &ZXMF       ++ INPUT VALUE                         00041700
               LCLC  &ZXMFCTRL   ++ INPUT NAME                          00041800
               LCLC  &ZXMFATTR   ++ INPUT VALUE                         00041900
               LCLC  &ZXMFSCK    ++ INPUT VALUE                         00042000
.********************************************************************   00042100
.***AG.MF01 PROCESS MF MACRO FORMS                                      00042200
.********************************************************************   00042300
               ACTR  10000                                              00042400
.*------------------------------------------------------------------    00042500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00042600
&XMF           SETC  ''          INITIALIZE XVARIABLE                   00042700
.*-------------------------------------------------------------------   00042800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00042900
.ZG24          ANOP  ,                                                  00043000
&ZTLC          SETC 'S'                                                 00043100
               AIF   ('&MF(1)' NE '&ZTLC').ZG25                         00043200
&XMF           SETC  'S'         SET KEYWORD                            00043300
               AIF   (N'&MF LE 1).ZG24A         CK NUM                  00043400
&ZMS           SETC  '"MF='      *KPOSA* MNOTE                          00043500
&ZMS           SETC  '&ZMS.&MF"'                                        00043600
&ZMS           SETC  '&ZMS "MF"'                                        00043700
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00043800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00043900
.ZG24A         ANOP  ,                                                  00044000
.*-------------------------------------------------------------------   00044100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00044200
.ZG25          ANOP  ,                                                  00044300
&ZTLC          SETC 'L'                                                 00044400
               AIF   ('&MF(1)' NE '&ZTLC').ZG32                         00044500
&XMF           SETC  'L'         SET KEYWORD                            00044600
               AIF   (N'&MF LE 3).ZG25A         CK NUM                  00044700
&ZMS           SETC  '"MF='      *KPOSA* MNOTE                          00044800
&ZMS           SETC  '&ZMS.&MF"'                                        00044900
&ZMS           SETC  '&ZMS "MF"'                                        00045000
               MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'               00045100
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00045200
.ZG25A         ANOP  ,                                                  00045300
.*-------------------------------------------------------------------   00045400
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00045500
               AIF   (N'&SYSLIST NE 0).ZG25B    POSITIONALS?            00045600
               AIF   ('&OPERATION' NE '').ZG25B  KEYS?                  00045700
               AIF   ('&DEVICES' NE '').ZG25B   KEYS?                   00045800
               AIF   ('&NUMDEVS' NE '').ZG25B   KEYS?                   00045900
               AIF   ('&RESULTS' NE '').ZG25B   KEYS?                   00046000
               AIF   ('&CALLERID' NE '').ZG25B  KEYS?                   00046100
               AIF   ('&RETCODE' NE '').ZG25B   KEYS?                   00046200
               AIF   ('&RSNCODE' NE '').ZG25B   KEYS?                   00046300
               AGO    .ZG25C     INVOCATION OKAY                        00046400
.ZG25B         ANOP  ,                                                  00046500
&ZMS           SETC  'THE "L" FORM OF "MF" CANNOT'  *MFLA* MNOTE        00046600
&ZMS           SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                  00046700
&ZMS           SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'             00046800
               MNOTE 8,' &ZMS ON THE INVOCATION.'                       00046900
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00047000
.ZG25C         ANOP  ,                                                  00047100
.*-------------------------------------------------------------------   00047200
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00047300
&ZXMFCTRL      SETC  'INPUT'     SET IN/OUTPUT                          00047400
&XMFCTRL       SETC  '&MF(2,1)'  SET XVARIABLE                          00047500
               AIF   (N'&MF(2) GT 1).ZG27B      MULTI PARMS             00047600
&XMFCTRL       SETC  '&MF(2)'    SET XVARIABLE                          00047700
.ZG27B         AIF   (K'&MF(2) GT 0).ZG27C                              00047800
&ZXMFCTRL      SETC  ''          RESET IN/OUTPUT                        00047900
&ZMS           SETC  'WHEN "L" IS SPECIFIED'    *KRQDA*                 00048000
&ZMS           SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                00048100
               MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                       00048200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00048300
.ZG27C         ANOP  ,                                                  00048400
.*-------------------------------------------------------------------   00048500
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00048600
               AIF   (K'&ZXMFCTRL LE 0).ZG27P   NOT I/O                 00048700
               AIF   ('&XMFCTRL'(1,1) NE '(').ZG27P                     00048800
&ZXMFCTRL      SETC  ''          RESET IN/OUTPUT                        00048900
&ZMS           SETC  '"MF='      *KGPRA* MNOTE                          00049000
&ZMS           SETC  '&ZMS.&MF"'                                        00049100
&ZMS           SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'          00049200
               MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                  00049300
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00049400
.ZG27P         ANOP  ,                                                  00049500
.*-------------------------------------------------------------------   00049600
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00049700
&ZXMFATTR      SETC  'INPUT'     SET IN/OUTPUT                          00049800
&XMFATTR       SETC  '0D'                                               00049900
               AIF   (K'&MF(3) LE 0).ZG30B      PARM                    00050000
&XMFATTR       SETC  '&MF(3,1)'  SET XVARIABLE                          00050100
               AIF   (N'&MF(3) GT 1).ZG30B      MULTI PARMS             00050200
&XMFATTR       SETC  '&MF(3)'    SET XVARIABLE                          00050300
.ZG30B         ANOP  ,                                                  00050400
.*-------------------------------------------------------------------   00050500
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00050600
               AIF   (K'&ZXMFATTR LE 0).ZG30P   NOT I/O                 00050700
               AIF   ('&XMFATTR'(1,1) NE '(').ZG30P                     00050800
&ZXMFATTR      SETC  ''          RESET IN/OUTPUT                        00050900
&ZMS           SETC  '"MF='      *KGPRA* MNOTE                          00051000
&ZMS           SETC  '&ZMS.&MF"'                                        00051100
&ZMS           SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'          00051200
               MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                  00051300
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00051400
.ZG30P         ANOP  ,                                                  00051500
.*-------------------------------------------------------------------   00051600
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00051700
               AIF   (K'&ZXMFATTR LE 0).ZG30S   NOT I/O                 00051800
               AIF   (K'&XMFATTR LE 60).ZG30S   LNG OK                  00051900
&ZXMFATTR      SETC  ''          RESET IN/OUTPUT                        00052000
&ZMS           SETC  '"MF='      *KLNGA* MNOTE                          00052100
&ZMS           SETC  '&ZMS.&MF"'                                        00052200
&ZMS           SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'              00052300
               MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                 00052400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00052500
.ZG30S         ANOP  ,                                                  00052600
.*-------------------------------------------------------------------   00052700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00052800
.ZG32          ANOP  ,                                                  00052900
&ZTLC          SETC 'E'                                                 00053000
               AIF   ('&MF(1)' NE '&ZTLC').ZG40                         00053100
&XMF           SETC  'E'         SET KEYWORD                            00053200
               AIF   (N'&MF LE 3).ZG32A         CK NUM                  00053300
&ZMS           SETC  '"MF='      *KPOSA* MNOTE                          00053400
&ZMS           SETC  '&ZMS.&MF"'                                        00053500
&ZMS           SETC  '&ZMS "MF"'                                        00053600
               MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'               00053700
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00053800
.ZG32A         ANOP  ,                                                  00053900
.*-------------------------------------------------------------------   00054000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00054100
&ZXMFCTRL      SETC  'INPUT'     SET IN/OUTPUT                          00054200
&XMFCTRL       SETC  '&MF(2,1)'  SET XVARIABLE                          00054300
               AIF   (N'&MF(2) GT 1).ZG34B      MULTI PARMS             00054400
&XMFCTRL       SETC  '&MF(2)'    SET XVARIABLE                          00054500
.ZG34B         AIF   (K'&MF(2) GT 0).ZG34C                              00054600
&ZXMFCTRL      SETC  ''          RESET IN/OUTPUT                        00054700
&ZMS           SETC  'WHEN "E" IS SPECIFIED'    *KRQDA*                 00054800
&ZMS           SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                00054900
               MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                       00055000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00055100
.ZG34C         ANOP  ,                                                  00055200
.*-------------------------------------------------------------------   00055300
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00055400
               AIF   (K'&ZXMFCTRL LE 0).ZG34R   NOT I/O                 00055500
               AIF   ('&XMFCTRL'(1,1) NE '(').ZG34R                     00055600
&ZCGPR         SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                         00055700
               AIF   ('&ZCGPR'(1,1) NE '0').ZG34P                       00055800
               AIF   (K'&ZCGPR GT 2).ZG34Q                              00055900
               AIF   ('&ZCGPR' EQ '0').ZG34Q                            00056000
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00056100
               AIF   (T'&ZCGPR NE 'N').ZG34Q    INVALID REG NAME        00056200
.ZG34P         ANOP  ,                                                  00056300
               AIF   (T'&ZCGPR NE 'N').ZG34R    NON NUMERIC             00056400
               AIF   ('&ZCGPR' LT '1').ZG34Q                            00056500
               AIF   ('&ZCGPR' LE '12').ZG34R                           00056600
.ZG34Q         ANOP  ,                                                  00056700
&ZMS           SETC  '"MF='      *KGPRA* MNOTE                          00056800
&ZMS           SETC  '&ZMS.&MF"'                                        00056900
&ZMS           SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'          00057000
               MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                   00057100
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00057200
.ZG34R         ANOP  ,                                                  00057300
.*-------------------------------------------------------------------   00057400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00057500
&XMFSCK        SETC  ''          INITIALIZE XVARIABLE                   00057600
.ZG38A   AIF   ('&MF(3)' NE 'COMPLETE').ZG39A                           00057700
&XMFSCK        SETC  'COMPLETE'  SET KEYWORD                            00057800
.*-------------------------------------------------------------------   00057900
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00058000
.ZG39A         AIF   (K'&XMFSCK GT 0).ZG39C     KEYWORD                 00058100
               AIF   (K'&MF(3) LE 0).ZG39B                              00058200
&ZMS           SETC  '"MF='      *KUKWA* MNOTE                          00058300
&ZMS           SETC  '&ZMS.&MF"'                                        00058400
&ZMS           SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '          00058500
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                00058600
&ZMS           SETC  '&ZMS "COMPLETE".'         VALID KEYWORD           00058700
               MNOTE 8,' &ZMS '                                         00058800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00058900
.ZG39B         ANOP  ,                                                  00059000
&XMFSCK        SETC  'COMPLETE'  SET DEFAULT KEYWORD                    00059100
.ZG39C         ANOP  ,                                                  00059200
&ZXMFSCK       SETC  'INPUT'     SET IN/OUTPUT                          00059300
.*------------------------------------------------------------------    00059400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00059500
.ZG40          ANOP  ,                                                  00059600
&ZXMF          SETC  'INPUT'     SET IN/OUTPUT                          00059700
               AIF   (K'&XMF GT 0).ZG40E        VALID ARG               00059800
               AIF   (T'&MF EQ 'O').ZG40D       OMITTED                 00059900
&ZASYSLNDX     SETA  0                                                  00060000
.ZG40A         ANOP  ,           POSITIONAL MACRO KEY                   00060100
&ZASYSLNDX     SETA  &ZASYSLNDX+1                                       00060200
               AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG40C                   00060300
&ZTLC          SETC 'MF'                                                00060400
               AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG40A          00060500
.ZG40B         ANOP  ,                                                  00060600
&ZXMF          SETC  ''          RESET IN/OUTPUT                        00060700
&ZMS           SETC  'THE "MF" KEY'             *KOPTA* MNOTE           00060800
&ZMS           SETC  '&ZMS MUST CONTAIN ONE'                            00060900
               MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                   00061000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00061100
               AGO   .ZG40E                                             00061200
.ZG40C         ANOP  ,                                                  00061300
&ZXMF          SETC  ''          RESET IN/OUTPUT                        00061400
&ZMS           SETC  '"MF='      *KUKWA* MNOTE                          00061500
&ZMS           SETC  '&ZMS.&MF"'                                        00061600
&ZMS           SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '          00061700
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                00061800
&ZMS           SETC  '&ZMS "S",'                VALID KEYWORD           00061900
&ZMS           SETC  '&ZMS "L",'                VALID KEYWORD           00062000
&ZMS           SETC  '&ZMS OR "E".'             VALID KEYWORD           00062100
               MNOTE 8,' &ZMS '                                         00062200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00062300
               AGO   .ZG40E                                             00062400
.ZG40D         ANOP  ,                                                  00062500
&XMF           SETC  'S'         SET DEFAULT KEYWORD                    00062600
&XMFSCK        SETC  'COMPLETE'  COMPLETE CHECKING                      00062700
.ZG40E         ANOP  ,                                                  00062800
.********************************************************************   00062900
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00063000
.********************************************************************   00063100
               ACTR  10000                                              00063200
.*-------------------------------------------------------------------   00063300
.***AG.MF03 MF=(SLE)                                                    00063400
               AIF   ('&XMF' EQ 'L').ZGMFX                              00063500
.*----------------------------------------------------------------***   00063600
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00063700
               AIF   (N'&OPERATION LE 1).ZG2A   CK NUM                  00063800
&ZMS           SETC  '"OPERATION='              *KPOSA* MNOTE           00063900
&ZMS           SETC  '&ZMS.&OPERATION"'                                 00064000
&ZMS           SETC  '&ZMS "OPERATION"'                                 00064100
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00064200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00064300
.ZG2A          ANOP  ,                                                  00064400
.*-------------------------------------------------------------------   00064500
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00064600
&ZXOPERATION   SETC  'INPUT'     SET IN/OUTPUT                          00064700
&XOPERATION    SETC  '&OPERATION(1)'            SET XVARIABLE           00064800
               AIF   (N'&OPERATION GT 1).ZG2B   MULTI PARMS             00064900
&XOPERATION    SETC  '&OPERATION'               SET XVARIABLE           00065000
.ZG2B          AIF   (K'&OPERATION(1) GT 0).ZG2C                        00065100
&ZXOPERATION   SETC  ''          RESET IN/OUTPUT                        00065200
&ZMS           SETC  ' '         *KRQDA*                                00065300
&ZMS           SETC  '&ZMS "OPERATION" KEY AND ITS ARGUMENT'            00065400
               MNOTE 8,' &ZMS ARE REQUIRED.'                            00065500
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00065600
.ZG2C          ANOP  ,                                                  00065700
.*-------------------------------------------------------------------   00065800
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00065900
               AIF   (K'&ZXOPERATION LE 0).ZG2R  NOT I/O                00066000
               AIF   ('&XOPERATION'(1,1) NE '(').ZG2R                   00066100
&ZCGPR         SETC  '&XOPERATION'(2,K'&XOPERATION-2)                   00066200
               AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                        00066300
               AIF   (K'&ZCGPR GT 2).ZG2Q                               00066400
               AIF   ('&ZCGPR' EQ '0').ZG2Q                             00066500
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00066600
               AIF   (T'&ZCGPR NE 'N').ZG2Q     INVALID REG NAME        00066700
.ZG2P          ANOP  ,                                                  00066800
               AIF   (T'&ZCGPR NE 'N').ZG2R     NON NUMERIC             00066900
               AIF   ('&ZCGPR' LT '2').ZG2Q                             00067000
               AIF   ('&ZCGPR' LE '12').ZG2R                            00067100
.ZG2Q          ANOP  ,                                                  00067200
&ZMS           SETC  '"OPERATION='              *KGPRA* MNOTE           00067300
&ZMS           SETC  '&ZMS.&OPERATION"'                                 00067400
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00067500
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00067600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00067700
.ZG2R          ANOP  ,                                                  00067800
.*----------------------------------------------------------------***   00067900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00068000
               AIF   (N'&DEVICES LE 1).ZG5A     CK NUM                  00068100
&ZMS           SETC  '"DEVICES='                *KPOSA* MNOTE           00068200
&ZMS           SETC  '&ZMS.&DEVICES"'                                   00068300
&ZMS           SETC  '&ZMS "DEVICES"'                                   00068400
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00068500
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00068600
.ZG5A          ANOP  ,                                                  00068700
.*-------------------------------------------------------------------   00068800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00068900
&ZXDEVICES     SETC  'INPUT'     SET IN/OUTPUT                          00069000
&XDEVICES      SETC  '&DEVICES(1)'              SET XVARIABLE           00069100
               AIF   (N'&DEVICES GT 1).ZG5B     MULTI PARMS             00069200
&XDEVICES      SETC  '&DEVICES'  SET XVARIABLE                          00069300
.ZG5B          AIF   (K'&DEVICES(1) GT 0).ZG5C                          00069400
&ZXDEVICES     SETC  ''          RESET IN/OUTPUT                        00069500
&ZMS           SETC  ' '         *KRQDA*                                00069600
&ZMS           SETC  '&ZMS "DEVICES" KEY AND ITS ARGUMENT'              00069700
               MNOTE 8,' &ZMS ARE REQUIRED.'                            00069800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00069900
.ZG5C          ANOP  ,                                                  00070000
.*-------------------------------------------------------------------   00070100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00070200
               AIF   (K'&ZXDEVICES LE 0).ZG5R   NOT I/O                 00070300
               AIF   ('&XDEVICES'(1,1) NE '(').ZG5R                     00070400
&ZCGPR         SETC  '&XDEVICES'(2,K'&XDEVICES-2)                       00070500
               AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                        00070600
               AIF   (K'&ZCGPR GT 2).ZG5Q                               00070700
               AIF   ('&ZCGPR' EQ '0').ZG5Q                             00070800
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00070900
               AIF   (T'&ZCGPR NE 'N').ZG5Q     INVALID REG NAME        00071000
.ZG5P          ANOP  ,                                                  00071100
               AIF   (T'&ZCGPR NE 'N').ZG5R     NON NUMERIC             00071200
               AIF   ('&ZCGPR' LT '2').ZG5Q                             00071300
               AIF   ('&ZCGPR' LE '12').ZG5R                            00071400
.ZG5Q          ANOP  ,                                                  00071500
&ZMS           SETC  '"DEVICES='                *KGPRA* MNOTE           00071600
&ZMS           SETC  '&ZMS.&DEVICES"'                                   00071700
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00071800
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00071900
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00072000
.ZG5R          ANOP  ,                                                  00072100
.*----------------------------------------------------------------***   00072200
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00072300
               AIF   (N'&NUMDEVS LE 1).ZG8A     CK NUM                  00072400
&ZMS           SETC  '"NUMDEVS='                *KPOSA* MNOTE           00072500
&ZMS           SETC  '&ZMS.&NUMDEVS"'                                   00072600
&ZMS           SETC  '&ZMS "NUMDEVS"'                                   00072700
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00072800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00072900
.ZG8A          ANOP  ,                                                  00073000
.*-------------------------------------------------------------------   00073100
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00073200
&ZXNUMDEVS     SETC  'INPUT'     SET IN/OUTPUT                          00073300
&XNUMDEVS      SETC  '1'                                                00073400
               AIF   (K'&NUMDEVS(1) LE 0).ZG8B  PARM                    00073500
&XNUMDEVS      SETC  '&NUMDEVS(1)'              SET XVARIABLE           00073600
               AIF   (N'&NUMDEVS GT 1).ZG8B     MULTI PARMS             00073700
&XNUMDEVS      SETC  '&NUMDEVS'  SET XVARIABLE                          00073800
.ZG8B          ANOP  ,                                                  00073900
.*-------------------------------------------------------------------   00074000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00074100
               AIF   (K'&ZXNUMDEVS LE 0).ZG8R   NOT I/O                 00074200
               AIF   ('&XNUMDEVS'(1,1) NE '(').ZG8R                     00074300
&ZCGPR         SETC  '&XNUMDEVS'(2,K'&XNUMDEVS-2)                       00074400
               AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                        00074500
               AIF   (K'&ZCGPR GT 2).ZG8Q                               00074600
               AIF   ('&ZCGPR' EQ '0').ZG8Q                             00074700
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00074800
               AIF   (T'&ZCGPR NE 'N').ZG8Q     INVALID REG NAME        00074900
.ZG8P          ANOP  ,                                                  00075000
               AIF   (T'&ZCGPR NE 'N').ZG8R     NON NUMERIC             00075100
               AIF   ('&ZCGPR' LT '2').ZG8Q                             00075200
               AIF   ('&ZCGPR' LE '12').ZG8R                            00075300
.ZG8Q          ANOP  ,                                                  00075400
&ZMS           SETC  '"NUMDEVS='                *KGPRA* MNOTE           00075500
&ZMS           SETC  '&ZMS.&NUMDEVS"'                                   00075600
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00075700
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00075800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00075900
.ZG8R          ANOP  ,                                                  00076000
.*----------------------------------------------------------------***   00076100
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00076200
               AIF   (N'&RESULTS LE 1).ZG11A    CK NUM                  00076300
&ZMS           SETC  '"RESULTS='                *KPOSA* MNOTE           00076400
&ZMS           SETC  '&ZMS.&RESULTS"'                                   00076500
&ZMS           SETC  '&ZMS "RESULTS"'                                   00076600
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00076700
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00076800
.ZG11A         ANOP  ,                                                  00076900
.*-------------------------------------------------------------------   00077000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00077100
               AIF   (K'&RESULTS(1) LE 0).ZG11C  NO PARM                00077200
&ZXRESULTS     SETC  'OUTPUT'    SET OUTPUT                             00077300
&XRESULTS      SETC  '&RESULTS(1)'              SET XVARIABLE           00077400
               AIF   (N'&RESULTS GT 1).ZG11C                            00077500
&XRESULTS      SETC  '&RESULTS'  SET XVARIABLE                          00077600
.ZG11C         ANOP  ,                                                  00077700
.*-------------------------------------------------------------------   00077800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00077900
               AIF   (K'&ZXRESULTS LE 0).ZG11R  NOT I/O                 00078000
               AIF   ('&XRESULTS'(1,1) NE '(').ZG11R                    00078100
&ZCGPR         SETC  '&XRESULTS'(2,K'&XRESULTS-2)                       00078200
               AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                       00078300
               AIF   (K'&ZCGPR GT 2).ZG11Q                              00078400
               AIF   ('&ZCGPR' EQ '0').ZG11Q                            00078500
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00078600
               AIF   (T'&ZCGPR NE 'N').ZG11Q    INVALID REG NAME        00078700
.ZG11P         ANOP  ,                                                  00078800
               AIF   (T'&ZCGPR NE 'N').ZG11R    NON NUMERIC             00078900
               AIF   ('&ZCGPR' LT '2').ZG11Q                            00079000
               AIF   ('&ZCGPR' LE '12').ZG11R                           00079100
.ZG11Q         ANOP  ,                                                  00079200
&ZMS           SETC  '"RESULTS='                *KGPRA* MNOTE           00079300
&ZMS           SETC  '&ZMS.&RESULTS"'                                   00079400
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00079500
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00079600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00079700
.ZG11R         ANOP  ,                                                  00079800
.*----------------------------------------------------------------***   00079900
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00080000
               AIF   (N'&CALLERID LE 1).ZG14A   CK NUM                  00080100
&ZMS           SETC  '"CALLERID='               *KPOSA* MNOTE           00080200
&ZMS           SETC  '&ZMS.&CALLERID"'                                  00080300
&ZMS           SETC  '&ZMS "CALLERID"'                                  00080400
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00080500
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00080600
.ZG14A         ANOP  ,                                                  00080700
.*-------------------------------------------------------------------   00080800
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00080900
&ZXCALLERID    SETC  'INPUT'     SET IN/OUTPUT                          00081000
&XCALLERID     SETC  'NO_CALLERID'                                      00081100
               AIF   (K'&CALLERID(1) LE 0).ZG14B  PARM                  00081200
&XCALLERID     SETC  '&CALLERID(1)'             SET XVARIABLE           00081300
               AIF   (N'&CALLERID GT 1).ZG14B   MULTI PARMS             00081400
&XCALLERID     SETC  '&CALLERID'                SET XVARIABLE           00081500
.ZG14B         ANOP  ,                                                  00081600
.*-------------------------------------------------------------------   00081700
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00081800
               AIF   (K'&ZXCALLERID LE 0).ZG14R  NOT I/O                00081900
               AIF   ('&XCALLERID' EQ 'NO_CALLERID').ZG14R              00082000
               AIF   ('&XCALLERID'(1,1) NE '(').ZG14R                   00082100
&ZCGPR         SETC  '&XCALLERID'(2,K'&XCALLERID-2)                     00082200
               AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                       00082300
               AIF   (K'&ZCGPR GT 2).ZG14Q                              00082400
               AIF   ('&ZCGPR' EQ '0').ZG14Q                            00082500
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00082600
               AIF   (T'&ZCGPR NE 'N').ZG14Q    INVALID REG NAME        00082700
.ZG14P         ANOP  ,                                                  00082800
               AIF   (T'&ZCGPR NE 'N').ZG14R    NON NUMERIC             00082900
               AIF   ('&ZCGPR' LT '2').ZG14Q                            00083000
               AIF   ('&ZCGPR' LE '12').ZG14R                           00083100
.ZG14Q         ANOP  ,                                                  00083200
&ZMS           SETC  '"CALLERID='               *KGPRA* MNOTE           00083300
&ZMS           SETC  '&ZMS.&CALLERID"'                                  00083400
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00083500
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00083600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00083700
.ZG14R         ANOP  ,                                                  00083800
.*----------------------------------------------------------------***   00083900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00084000
               AIF   (N'&RETCODE LE 1).ZG17A    CK NUM                  00084100
&ZMS           SETC  '"RETCODE='                *KPOSA* MNOTE           00084200
&ZMS           SETC  '&ZMS.&RETCODE"'                                   00084300
&ZMS           SETC  '&ZMS "RETCODE"'                                   00084400
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00084500
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00084600
.ZG17A         ANOP  ,                                                  00084700
.*-------------------------------------------------------------------   00084800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00084900
               AIF   (K'&RETCODE(1) LE 0).ZG17C  NO PARM                00085000
&ZXRETCODE     SETC  'OUTPUT'    SET OUTPUT                             00085100
&XRETCODE      SETC  '&RETCODE(1)'              SET XVARIABLE           00085200
               AIF   (N'&RETCODE GT 1).ZG17C                            00085300
&XRETCODE      SETC  '&RETCODE'  SET XVARIABLE                          00085400
.ZG17C         ANOP  ,                                                  00085500
.*-------------------------------------------------------------------   00085600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00085700
               AIF   (K'&ZXRETCODE LE 0).ZG17R  NOT I/O                 00085800
               AIF   ('&XRETCODE'(1,1) NE '(').ZG17R                    00085900
&ZCGPR         SETC  '&XRETCODE'(2,K'&XRETCODE-2)                       00086000
               AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                       00086100
               AIF   (K'&ZCGPR GT 2).ZG17Q                              00086200
               AIF   ('&ZCGPR' EQ '0').ZG17Q                            00086300
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00086400
               AIF   (T'&ZCGPR NE 'N').ZG17Q    INVALID REG NAME        00086500
.ZG17P         ANOP  ,                                                  00086600
               AIF   (T'&ZCGPR NE 'N').ZG17R    NON NUMERIC             00086700
               AIF   ('&ZCGPR' LT '2').ZG17Q                            00086800
               AIF   ('&ZCGPR' LE '12').ZG17R                           00086900
.ZG17Q         ANOP  ,                                                  00087000
&ZMS           SETC  '"RETCODE='                *KGPRA* MNOTE           00087100
&ZMS           SETC  '&ZMS.&RETCODE"'                                   00087200
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00087300
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00087400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00087500
.ZG17R         ANOP  ,                                                  00087600
.*----------------------------------------------------------------***   00087700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00087800
               AIF   (N'&RSNCODE LE 1).ZG20A    CK NUM                  00087900
&ZMS           SETC  '"RSNCODE='                *KPOSA* MNOTE           00088000
&ZMS           SETC  '&ZMS.&RSNCODE"'                                   00088100
&ZMS           SETC  '&ZMS "RSNCODE"'                                   00088200
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00088300
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00088400
.ZG20A         ANOP  ,                                                  00088500
.*-------------------------------------------------------------------   00088600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00088700
               AIF   (K'&RSNCODE(1) LE 0).ZG20C  NO PARM                00088800
&ZXRSNCODE     SETC  'OUTPUT'    SET OUTPUT                             00088900
&XRSNCODE      SETC  '&RSNCODE(1)'              SET XVARIABLE           00089000
               AIF   (N'&RSNCODE GT 1).ZG20C                            00089100
&XRSNCODE      SETC  '&RSNCODE'  SET XVARIABLE                          00089200
.ZG20C         ANOP  ,                                                  00089300
.*-------------------------------------------------------------------   00089400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00089500
               AIF   (K'&ZXRSNCODE LE 0).ZG20R  NOT I/O                 00089600
               AIF   ('&XRSNCODE'(1,1) NE '(').ZG20R                    00089700
&ZCGPR         SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                       00089800
               AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                       00089900
               AIF   (K'&ZCGPR GT 2).ZG20Q                              00090000
               AIF   ('&ZCGPR' EQ '0').ZG20Q                            00090100
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00090200
               AIF   (T'&ZCGPR NE 'N').ZG20Q    INVALID REG NAME        00090300
.ZG20P         ANOP  ,                                                  00090400
               AIF   (T'&ZCGPR NE 'N').ZG20R    NON NUMERIC             00090500
               AIF   ('&ZCGPR' LT '2').ZG20Q                            00090600
               AIF   ('&ZCGPR' LE '12').ZG20R                           00090700
.ZG20Q         ANOP  ,                                                  00090800
&ZMS           SETC  '"RSNCODE='                *KGPRA* MNOTE           00090900
&ZMS           SETC  '&ZMS.&RSNCODE"'                                   00091000
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00091100
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00091200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00091300
.ZG20R         ANOP  ,                                                  00091400
.******************************************************************     00091500
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00091600
.******************************************************************     00091700
               ACTR  10000                                              00091800
.*----------------------------------------------------------------***   00091900
.***AH.P02 EXTRA POSITIONALS                                            00092000
               AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS               00092100
&ZCVAL         SETC  ''          ERROR FIELD                            00092200
&ZAWRK         SETA  0           POSITIONAL NUMBER                      00092300
.ZGLIST2       ANOP  ,                                                  00092400
&ZAWRK         SETA  &ZAWRK+1    NEXT POSITIONAL                        00092500
               AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE               00092600
&ZCVAL         SETC '&ZCVAL,&SYSLIST(&ZAWRK)'   EXTRA                   00092700
               AGO   .ZGLIST2                                           00092800
.*                                                                      00092900
.ZGLIST3       ANOP  ,                                                  00093000
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)      STRIP COMMA             00093100
&ZMS           SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE           00093200
&ZMS           SETC  '&ZMS "&ZCVAL"'                                    00093300
&ZMS           SETC  '&ZMS CANNOT BE USED.'                             00093400
&ZMS           SETC  '&ZMS NO POSITIONAL ARGUMENTS'                     00093500
               MNOTE 8,' &ZMS ARE ALLOWED.'                             00093600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00093700
.ZGLISTX       ANOP  ,                                                  00093800
&ZASYSLNDX     SETA  0                                                  00093900
.*-------------------------------------------------------------------   00094000
.***AG.MF04 MF=(SLE)                                                    00094100
.ZGMFX         ANOP  ,           END OF FULL SYNTAX CHECK               00094200
.*******************************************************************    00094300
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00094400
.*******************************************************************    00094500
               AIF   (&ZMACRET NE 0).ZLX2       ERROR DETECTED          00094600
.*******************************************************************    00094700
.***AE.01  START OF IEEVARYD MACRO CODE                                 00094800
.*******************************************************************    00094900
               LCLC  &M0M0001                 NAME                      00095000
&M0M0001       SETC  '&XLABEL'                SET NAME                  00095100
               AIF   (K'&XLABEL NE 0).XLAB2                             00095200
&M0M0001       SETC  'M00M&SYSNDX'            DEFAULT NAME              00095300
.*                                                                      00095400
.XLAB2         ANOP  ,                                                  00095500
&M0M0001 DS    0H                             IEEVARYD-1                00095600
.*******************************************************************    00095700
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00095800
.*******************************************************************    00095900
              PUSH  PRINT                                               00096000
               AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON         00096100
               PRINT OFF         ++ PR01                                00096200
               AGO   .ZPRNTXX                                           00096300
.ZPRINTX       PRINT ON                                                 00096400
.ZPRNTXX       ANOP  ,                                                  00096500
.********************************************************************   00096600
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00096700
.********************************************************************   00096800
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00096900
                      LCLA  &ZOPN1         INVOCATION INDEX             00097000
                      LCLC  &ZOPL(4095)    LABEL                        00097100
                      LCLC  &ZOPO(4095)    OPERATION                    00097200
                      LCLC  &ZOPV(4095)    VALUE                        00097300
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00097400
.*                                                                      00097500
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00097600
.******************************************************************     00097700
.***AL.L10 IEEVARYD FMT=LIST MF=S|L PARAMETERS                          00097800
.******************************************************************     00097900
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00098000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00098100
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00098200
&XMFATTR              SETC  '0D'                                        00098300
.*                                                                      00098400
&ZOPN                 SETA  &ZOPN+1                                     00098500
&ZOPL(&ZOPN)          SETC  ' '                                         00098600
&ZOPO(&ZOPN)          SETC  'B'                                         00098700
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00098800
&ZOPD(&ZOPN)          SETC  '++ IEEVARYD ARG PARMS'                     00098900
.*                                                                      00099000
&ZOPN                 SETA  &ZOPN+1                                     00099100
&ZOPL(&ZOPN)          SETC  ' '                                         00099200
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00099300
&ZOPV(&ZOPN)          SETC  '1'                                         00099400
&ZOPD(&ZOPN)          SETC  ' '                                         00099500
.*                                                                      00099600
.ZLMFSL2              ANOP  ,                                           00099700
.*-------------------------------------------------------------------   00099800
.***AM.L01  IEEVARYD FMT=LIST PARAMETERS                                00099900
&ZOPN                 SETA &ZOPN+1                                      00100000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00100100
&ZOPO(&ZOPN)          SETC 'DS'                                         00100200
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00100300
&ZOPD(&ZOPN)          SETC '++ IEEVARYD PARM LIST'                      00100400
.*-------------------------------------------------------------------   00100500
.***AM.L02 XVERSION XL1                                                 00100600
&ZOPN                 SETA &ZOPN+1                                      00100700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00100800
&ZOPO(&ZOPN)          SETC 'DS'                                         00100900
&ZOPV(&ZOPN)          SETC 'XL1'                                        00101000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00101100
.*-------------------------------------------------------------------   00101200
.***AM.L03 XFLAGS BL.8                                                  00101300
&ZOPN                 SETA &ZOPN+1                                      00101400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00101500
&ZOPO(&ZOPN)          SETC 'DS'                                         00101600
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00101700
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00101800
.*                                                                      00101900
&ZOPN                 SETA  &ZOPN+1                                     00102000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_RESULTS'                 00102100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00102200
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00102300
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00102400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RESULTS'                      00102500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00102600
.*                                                                      00102700
&ZOPN                 SETA  &ZOPN+1                                     00102800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CALLERID'                00102900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00103000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00103100
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00103200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CALLERID'                     00103300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00103400
.*-------------------------------------------------------------------   00103500
.***AM.L09  XRESERVED1 CL2                                              00103600
&ZOPN                 SETA &ZOPN+1                                      00103700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED1'                       00103800
&ZOPO(&ZOPN)          SETC 'DS'                                         00103900
&ZOPV(&ZOPN)          SETC 'CL2'                                        00104000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED1'                 00104100
.*-------------------------------------------------------------------   00104200
.***AM.L09 ADDR XOPERATION A                                            00104300
&ZOPN                 SETA &ZOPN+1                                      00104400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOPERATION_ADDR'                  00104500
&ZOPO(&ZOPN)          SETC 'DS'                                         00104600
&ZOPV(&ZOPN)          SETC 'A'                                          00104700
&ZOPD(&ZOPN)          SETC '++ &ZXOPERATION ADDR XOPERATION'            00104800
.*-------------------------------------------------------------------   00104900
.***AM.L09 ADDR XDEVICES A                                              00105000
&ZOPN                 SETA &ZOPN+1                                      00105100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDEVICES_ADDR'                    00105200
&ZOPO(&ZOPN)          SETC 'DS'                                         00105300
&ZOPV(&ZOPN)          SETC 'A'                                          00105400
&ZOPD(&ZOPN)          SETC '++ &ZXDEVICES ADDR XDEVICES'                00105500
.*-------------------------------------------------------------------   00105600
.***AM.L09  XNUMDEVS F                                                  00105700
&ZOPN                 SETA &ZOPN+1                                      00105800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XNUMDEVS'                         00105900
&ZOPO(&ZOPN)          SETC 'DS'                                         00106000
&ZOPV(&ZOPN)          SETC 'F'                                          00106100
&ZOPD(&ZOPN)          SETC '++ &ZXNUMDEVS  XNUMDEVS'                    00106200
.*-------------------------------------------------------------------   00106300
.***AM.L09 ADDR XRESULTS A                                              00106400
&ZOPN                 SETA &ZOPN+1                                      00106500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESULTS_ADDR'                    00106600
&ZOPO(&ZOPN)          SETC 'DS'                                         00106700
&ZOPV(&ZOPN)          SETC 'A'                                          00106800
&ZOPD(&ZOPN)          SETC '++ &ZXRESULTS ADDR XRESULTS'                00106900
.*-------------------------------------------------------------------   00107000
.***AM.L09  XCALLERID CL8                                               00107100
&ZOPN                 SETA &ZOPN+1                                      00107200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCALLERID'                        00107300
&ZOPO(&ZOPN)          SETC 'DS'                                         00107400
&ZOPV(&ZOPN)          SETC 'CL8'                                        00107500
&ZOPD(&ZOPN)          SETC '++ &ZXCALLERID  XCALLERID'                  00107600
.*-------------------------------------------------------------------   00107700
.***AM.L09  XRESERVED2 CL16                                             00107800
&ZOPN                 SETA &ZOPN+1                                      00107900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED2'                       00108000
&ZOPO(&ZOPN)          SETC 'DS'                                         00108100
&ZOPV(&ZOPN)          SETC 'CL16'                                       00108200
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED2'                 00108300
.*-------------------------------------------------------------------   00108400
.***AM.L10 END OF IEEVARYD LIST PARAMETERS                              00108500
&ZOPN                 SETA &ZOPN+1                                      00108600
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00108700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00108800
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00108900
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00109000
.*                                                                      00109100
&ZOPN                 SETA &ZOPN+1                                      00109200
&ZOPL(&ZOPN)          SETC ' '                                          00109300
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00109400
&ZOPV(&ZOPN)          SETC '1'                                          00109500
&ZOPD(&ZOPN)          SETC ' '                                          00109600
.*-------------------------------------------------------------------   00109700
.***AL.L12 IEEVARYD FMT=LIST MF=S|L PARAMETERS                          00109800
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00109900
.*                                                                      00110000
&ZOPN                 SETA  &ZOPN+1                                     00110100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00110200
&ZOPO(&ZOPN)          SETC  'DC'                                        00110300
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00110400
&ZOPD(&ZOPN)          SETC  '++ IEEVARYD ARG PARMS'                     00110500
.*                                                                      00110600
.ZLMFSLX              ANOP  ,                                           00110700
.*-------------------------------------------------------------------   00110800
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00110900
&ZPLLEN               SETA 44                                           00111000
.*                                                                      00111100
.******************************************************************     00111200
.***AI.L01 IEEVARYD FMT=LIST FILL IN PARAMETER AREA                     00111300
.******************************************************************     00111400
                      ACTR  10000                                       00111500
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00111600
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00111700
&ZCVAL                SETC  'LAE'          XAX MODE                     00111800
.ZIMFXA               ANOP ,                                            00111900
.*                                                                      00112000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00112100
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00112200
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00112300
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00112400
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00112500
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00112600
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00112700
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00112800
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00112900
&ZOPN                 SETA  &ZOPN+1                                     00113000
&ZOPL(&ZOPN)          SETC  ' '                                         00113100
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00113200
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00113300
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00113400
                      AGO   .ZIMFNX                                     00113500
.*                                                                      00113600
.ZIMFN2               ANOP ,                                            00113700
&ZOPN                 SETA  &ZOPN+1                                     00113800
&ZOPL(&ZOPN)          SETC  ' '                                         00113900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00114000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00114100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00114200
.ZIMFNX               ANOP ,                                            00114300
.********************************************************************   00114400
.***AI.L02 IEEVARYD FMT=LIST INITIALIZE PARAMETER AREA                  00114500
.********************************************************************   00114600
.***AI.L03 MF=(SLE)                                                     00114700
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00114800
.*                                                                      00114900
&ZOPN                 SETA  &ZOPN+1                                     00115000
&ZOPL(&ZOPN)          SETC  ' '                                         00115100
&ZOPO(&ZOPN)          SETC  'XC'                                        00115200
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00115300
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00115400
.ZIMFLX               ANOP  ,                                           00115500
.*-------------------------------------------------------------------   00115600
.***AI.L04A XVERSION XL1                                                00115700
&ZOPN                 SETA  &ZOPN+1                                     00115800
&ZOPL(&ZOPN)          SETC  ' '                                         00115900
&ZOPO(&ZOPN)          SETC  'MVI'                                       00116000
&ZOPV(&ZOPN)          SETC  '0(1),1'                                    00116100
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00116200
.*-------------------------------------------------------------------   00116300
.***AI.L05 XFLAGS BL1                                                   00116400
&ZW                   SETC  ''                                          00116500
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00116600
.*-------------------------------------------------------------------   00116700
.***AI.L08 XFLAGS "RESULTS"                                             00116800
.***      BL1'1XXXXXXX'                                                 00116900
         AIF   ('&RESULTS' EQ '').ZI3A                                  00117000
&ZW                   SETC  '&ZW.1'                                     00117100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00117200
                      AGO   .ZI3C                                       00117300
.*                                                                      00117400
.ZI3A                 ANOP  ,                                           00117500
&ZW                   SETC  '&ZW.0'                                     00117600
.ZI3C                 ANOP  ,                                           00117700
.*-------------------------------------------------------------------   00117800
.***AI.L08 XFLAGS "CALLERID"                                            00117900
.***      BL1'X1XXXXXX'                                                 00118000
         AIF   ('&CALLERID' EQ '').ZI4A                                 00118100
         AIF   ('&CALLERID' EQ 'NO_CALLERID').ZI4A                      00118200
&ZW                   SETC  '&ZW.1000000'                               00118300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00118400
                      AGO   .ZI4C                                       00118500
.*                                                                      00118600
.ZI4A                 ANOP  ,                                           00118700
&ZW                   SETC  '&ZW.0000000'                               00118800
.ZI4C                 ANOP  ,                                           00118900
.*-------------------------------------------------------------------   00119000
.***AI.L11 XFLAGS BL1                                                   00119100
                      AIF   ('&ZCLNG' NE 'YES').ZI4E  ALL ZERO BITS     00119200
&ZOPN                 SETA  &ZOPN+1                                     00119300
&ZOPL(&ZOPN)          SETC  ' '                                         00119400
&ZOPO(&ZOPN)          SETC  'OI'                                        00119500
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00119600
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00119700
.ZI4E                 ANOP  ,                                           00119800
.*-------------------------------------------------------------------   00119900
.***AI.L19 ADDR XOPERATION A                                            00120000
                      AIF   ('&ZXOPERATION' EQ '').ZI6H  NOT USED       00120100
&ZCLNG                SETC  '&XOPERATION'                               00120200
&ZCGPR                SETC  '14'                                        00120300
         AIF   ('&XOPERATION'(1,1) EQ '(').ZI6F  IN GPR                 00120400
.*                                                                      00120500
&ZOPN                 SETA  &ZOPN+1                                     00120600
&ZOPL(&ZOPN)          SETC  ' '                                         00120700
&ZOPO(&ZOPN)          SETC  'LA'                                        00120800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00120900
&ZOPD(&ZOPN)          SETC  '++ &ZXOPERATION XOPERATION A'              00121000
.*                                                                      00121100
                      AGO   .ZI6G                                       00121200
.*                                                                      00121300
.ZI6F                 ANOP  ,                                           00121400
&ZCGPR   SETC  '&XOPERATION'(2,K'&XOPERATION-2)                         00121500
.*                                                                      00121600
.ZI6G                 ANOP  ,                                           00121700
.*                                                                      00121800
&ZOPN                 SETA  &ZOPN+1                                     00121900
&ZOPL(&ZOPN)          SETC  ' '                                         00122000
&ZOPO(&ZOPN)          SETC  'ST'                                        00122100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4(,1)'                              00122200
&ZOPD(&ZOPN)          SETC  '++ &ZXOPERATION XOPERATION A'              00122300
.*                                                                      00122400
.ZI6H                 ANOP  ,                                           00122500
.*-------------------------------------------------------------------   00122600
.***AI.L19 ADDR XDEVICES A                                              00122700
                      AIF   ('&ZXDEVICES' EQ '').ZI7H  NOT USED         00122800
&ZCLNG                SETC  '&XDEVICES'                                 00122900
&ZCGPR                SETC  '14'                                        00123000
         AIF   ('&XDEVICES'(1,1) EQ '(').ZI7F  IN GPR                   00123100
.*                                                                      00123200
&ZOPN                 SETA  &ZOPN+1                                     00123300
&ZOPL(&ZOPN)          SETC  ' '                                         00123400
&ZOPO(&ZOPN)          SETC  'LA'                                        00123500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00123600
&ZOPD(&ZOPN)          SETC  '++ &ZXDEVICES XDEVICES A'                  00123700
.*                                                                      00123800
                      AGO   .ZI7G                                       00123900
.*                                                                      00124000
.ZI7F                 ANOP  ,                                           00124100
&ZCGPR   SETC  '&XDEVICES'(2,K'&XDEVICES-2)                             00124200
.*                                                                      00124300
.ZI7G                 ANOP  ,                                           00124400
.*                                                                      00124500
&ZOPN                 SETA  &ZOPN+1                                     00124600
&ZOPL(&ZOPN)          SETC  ' '                                         00124700
&ZOPO(&ZOPN)          SETC  'ST'                                        00124800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              00124900
&ZOPD(&ZOPN)          SETC  '++ &ZXDEVICES XDEVICES A'                  00125000
.*                                                                      00125100
.ZI7H                 ANOP  ,                                           00125200
.*-------------------------------------------------------------------   00125300
.***AI.L25  XNUMDEVS F                                                  00125400
                      AIF   ('&ZXNUMDEVS' EQ '').ZI8E  NOT USED         00125500
                      AIF   ('&ZXNUMDEVS' EQ 'OUTPUT').ZI8E             00125600
&ZCGPR                SETC  '&XNUMDEVS'                                 00125700
.*                                                                      00125800
                      AIF   ('&XNUMDEVS'(1,1) NE '(').ZI8B              00125900
&ZCGPR   SETC  '0('.'&XNUMDEVS'(2,K'&XNUMDEVS-2).')'                    00126000
                      AGO   .ZI8D                                       00126100
.ZI8B                 ANOP  ,                                           00126200
.*                                                                      00126300
&ZC                   SETC  '&XNUMDEVS'(1,1)                            00126400
                      AIF   (T'&ZC NE 'N').ZI8D                         00126500
&ZC                   SETC  '&XNUMDEVS'                                 00126600
                      AIF   ('&ZC'(K'&ZC,K'&ZC) EQ ')').ZI8D            00126700
&ZCGPR                SETC  '=FL4''&XNUMDEVS'''                         00126800
.*                                                                      00126900
.ZI8D                 ANOP  ,                                           00127000
.*                                                                      00127100
&ZOPN                 SETA  &ZOPN+1                                     00127200
&ZOPL(&ZOPN)          SETC  ' '                                         00127300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00127400
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            00127500
&ZOPD(&ZOPN)          SETC  '++ &ZXNUMDEVS XNUMDEVS F'                  00127600
.*                                                                      00127700
.ZI8E                 ANOP  ,                                           00127800
.*-------------------------------------------------------------------   00127900
.***AI.L19 ADDR XRESULTS A                                              00128000
                      AIF   ('&ZXRESULTS' EQ '').ZI9H  NOT USED         00128100
&ZCLNG                SETC  '&XRESULTS'                                 00128200
&ZCGPR                SETC  '14'                                        00128300
         AIF   ('&XRESULTS'(1,1) EQ '(').ZI9F  IN GPR                   00128400
.*                                                                      00128500
&ZOPN                 SETA  &ZOPN+1                                     00128600
&ZOPL(&ZOPN)          SETC  ' '                                         00128700
&ZOPO(&ZOPN)          SETC  'LA'                                        00128800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00128900
&ZOPD(&ZOPN)          SETC  '++ &ZXRESULTS XRESULTS A'                  00129000
.*                                                                      00129100
                      AGO   .ZI9G                                       00129200
.*                                                                      00129300
.ZI9F                 ANOP  ,                                           00129400
&ZCGPR   SETC  '&XRESULTS'(2,K'&XRESULTS-2)                             00129500
.*                                                                      00129600
.ZI9G                 ANOP  ,                                           00129700
.*                                                                      00129800
&ZOPN                 SETA  &ZOPN+1                                     00129900
&ZOPL(&ZOPN)          SETC  ' '                                         00130000
&ZOPO(&ZOPN)          SETC  'ST'                                        00130100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             00130200
&ZOPD(&ZOPN)          SETC  '++ &ZXRESULTS XRESULTS A'                  00130300
.*                                                                      00130400
.ZI9H                 ANOP  ,                                           00130500
.*-------------------------------------------------------------------   00130600
.***AI.L18  XCALLERID CL8                                               00130700
                      AIF   ('&XCALLERID' NE 'NO_CALLERID').ZI10        00130800
&ZXCALLERID           SETC  ''             RESET INPUT/OUTPUT           00130900
.ZI10                 ANOP  ,                                           00131000
.*-------------------------------------------------------------------   00131100
.***AI.L25  XCALLERID CL8                                               00131200
                      AIF   ('&ZXCALLERID' EQ '').ZI10E  NOT USED       00131300
                      AIF   ('&ZXCALLERID' EQ 'OUTPUT').ZI10E           00131400
&ZCGPR                SETC  '&XCALLERID'                                00131500
.*                                                                      00131600
                      AIF   ('&XCALLERID'(1,1) NE '(').ZI10B            00131700
&ZCGPR   SETC  '0('.'&XCALLERID'(2,K'&XCALLERID-2).')'                  00131800
.ZI10B                ANOP  ,                                           00131900
.*                                                                      00132000
&ZOPN                 SETA  &ZOPN+1                                     00132100
&ZOPL(&ZOPN)          SETC  ' '                                         00132200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00132300
&ZOPV(&ZOPN)          SETC  '20(8,1),&ZCGPR'                            00132400
&ZOPD(&ZOPN)          SETC  '++ &ZXCALLERID XCALLERID CL8'              00132500
.*                                                                      00132600
.ZI10E                ANOP  ,                                           00132700
.*-------------------------------------------------------------------   00132800
&ZOPN1                SETA &ZOPN                                        00132900
.*******************************************************************    00133000
.***  PROCESS IEEVARYD OUTPUT PARAMETERS                                00133100
.*******************************************************************    00133200
                      ACTR  10000                                       00133300
.*******************************************************************    00133400
.***AO.X02  RETURN CODE PROCESSING                                      00133500
.*******************************************************************    00133600
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00133700
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00133800
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00133900
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00134000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00134100
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00134200
&ZOPN                 SETA  &ZOPN+1                                     00134300
&ZOPL(&ZOPN)          SETC  ' '                                         00134400
&ZOPO(&ZOPN)          SETC  'ST'                                        00134500
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00134600
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00134700
                      AGO   .ZMRETX                                     00134800
.*                                                                      00134900
.ZMRET2               ANOP  ,                                           00135000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00135100
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00135200
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00135300
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00135400
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00135500
&ZOPN                 SETA  &ZOPN+1                                     00135600
&ZOPL(&ZOPN)          SETC  ' '                                         00135700
&ZOPO(&ZOPN)          SETC  'LR'                                        00135800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00135900
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00136000
.ZMRETX               ANOP  ,                                           00136100
.*******************************************************************    00136200
.***AO.X03  REASON CODE PROCESSING                                      00136300
.*******************************************************************    00136400
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00136500
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00136600
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00136700
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00136800
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00136900
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00137000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00137100
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00137200
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00137300
&ZOPN                 SETA  &ZOPN+1                                     00137400
&ZOPL(&ZOPN)          SETC  ' '                                         00137500
&ZOPO(&ZOPN)          SETC  'ST'                                        00137600
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00137700
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00137800
                      AGO   .ZMRSNX                                     00137900
.*                                                                      00138000
.ZMRSN2               ANOP  ,                                           00138100
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00138200
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00138300
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00138400
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00138500
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00138600
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00138700
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00138800
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00138900
&ZOPN                 SETA  &ZOPN+1                                     00139000
&ZOPL(&ZOPN)          SETC  ' '                                         00139100
&ZOPO(&ZOPN)          SETC  'LR'                                        00139200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00139300
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00139400
.ZMRSNX               ANOP  ,                                           00139500
.*******************************************************************    00139600
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00139700
.*******************************************************************    00139800
.ZMFLX                ANOP  ,              MF=L PROCESSING              00139900
.*******************************************************************    00140000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00140100
.*******************************************************************    00140200
                      ACTR  10000                                       00140300
.*                                                                      00140400
                      LCLA  &ZLC           COLUMN POSITION              00140500
                      LCLA  &ZOPX          LIST TABLE INDEX             00140600
                      LCLC  &ZLL           LABEL                        00140700
                      LCLC  &ZLOP          OPERATION                    00140800
                      LCLC  &ZLV           VALUE                        00140900
                      LCLC  &ZLD           DESCRIPTION                  00141000
.*                                                                      00141100
&ZOPX                 SETA  1                                           00141200
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00141300
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00141400
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00141500
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00141600
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00141700
                      AIF   (K'&ZLD LE 0).ZL5                           00141800
&ZLC                  SETA  35             COMMENT COLUMN               00141900
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00142000
&ZLC                  SETA  33             COMMMENT COLUMN              00142100
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00142200
&ZLV                  SETC  '&ZLV'.' '                                  00142300
                      AGO   .ZL3                                        00142400
.*                                                                      00142500
.ZL4                  ANOP  ,                                           00142600
&ZLV                  SETC  '&ZLV'.' '                                  00142700
.ZL5                  ANOP  ,                                           00142800
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00142900
.*                                                                      00143000
&ZLL     &ZLOP &ZLV                                                     00143100
.*                                                                      00143200
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00143300
                      AGO   .ZL2           CONTINUE LOOPING             00143400
.*                                                                      00143500
.ZLX                  ANOP  ,                                           00143600
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00143700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00143800
.*-----------BAL invocation code-------------                           00143900
.********************************************************************** 00144000
.*                                                                      00144100
.*  Invoke PC for VARY Device Interface Routine                         00144200
.*                                                                      00144300
.********************************************************************** 00144400
         L     15,16(0,0)         GET ADDRESS OF CVT FROM PSA           00144500
         L     15,772(,15)        GET ADDRESS OF SFT FROM CVT           00144600
         LA    14,16(0,0)         GET IEEVARYD INDEX IN LINKAGE TABLE   00144700
         AL    14,100(,15)        POINT REG14 TO IEEVARYD ETD ENTRY     00144800
         PC    0(14)              PC TO IEEVARYD SERVICE                00144900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00145000
.ZLINKX               ANOP  ,                                           00145100
.*******************************************************************    00145200
.***AP.X01  FORMAT GENERATED CODE                                       00145300
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00145400
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00145500
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00145600
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00145700
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00145800
                      AIF   (K'&ZLD LE 0).ZL51                          00145900
&ZLC                  SETA  35             COMMENT COLUMN               00146000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00146100
&ZLC                  SETA  33             COMMENT COLUMN               00146200
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00146300
&ZLV                  SETC  '&ZLV'.' '                                  00146400
                      AGO   .ZL31                                       00146500
.*                                                                      00146600
.ZL41                 ANOP  ,                                           00146700
&ZLV                  SETC  '&ZLV'.' '                                  00146800
.ZL51                 ANOP  ,                                           00146900
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00147000
.*                                                                      00147100
&ZLL     &ZLOP &ZLV                                                     00147200
.*                                                                      00147300
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00147400
                      AGO   .ZL21          CONTINUE LOOPING             00147500
.*                                                                      00147600
.ZLX1                 ANOP  ,                                           00147700
.*******************************************************************    00147800
.***AP.X02  END OF IEEVARYD MACRO                                       00147900
&ZIEEVARYD            SETC  'YES'          SET IEEVARYD USED            00148000
         POP   PRINT                                                    00148100
*                                            IEEVARYD-1                 00148200
         SPACE 1                                                        00148300
.ZLX2                 ANOP  ,                                           00148400
         MEND                                                           00148500
**********************************************************************/ 00148600
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00148700
*%IEEVARYD: MACRO KEYS(OPERATION,DEVICES,NUMDEVS,RESULTS,CALLERID,      00148800
*                 RETCODE,RSNCODE,MF);                                  00148900
*  ANS('?'||MACLABEL||' '||'IEEVARYP '||MACLIST||                       00149000
*         ' '||MACKEYS||';') COL(MACLMAR);                              00149100
*%END IEEVARYD;                                                         00149200
