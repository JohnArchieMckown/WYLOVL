*/********************************************************************/ 00050000
*/*                                                                  */ 00100000
*/* MACRO: VSMLIST                                                   */ 00150000
*/*                                                                  */ 00200000
*/* PROPRIETARY STATEMENT =                                          */ 00233300
*/*  LICENSED MATERIALS - PROPERTY OF IBM                            */ 00266600
*/*  THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     */ 00299900
*/*  5647-A01 (C) COPYRIGHT IBM CORP. 1982, 2000                     */ 00349900
*/*                                                                  */ 00400000
*/* STATUS = HBB7703                                                 */ 00450000
*/*                                                                  */ 00500000
*/* EXTERNAL CLASSIFICATION: PI                                      */ 00509300
*/* END OF EXTERNAL CLASSIFICATION                                   */ 00518600
*/*                                                                  */ 00525000
*/* FUNCTION: INTERFACE TO VSMLIST ROUTINE (IGVSLIST)                */ 00550000
*/*                                                                  */ 00600000
*/* SYNTAX: VSMLIST SP=SQA|CSA|LSQA|PVT|SYMBOL1                      */ 00650000
*/*                ,WKAREA=(SYMBOL2,SYMBOL3)                         */ 00700000
*/*                <,TCB=SYMBOL4|(SYMBOL4,ALL)|(,ALL)>               */ 00750000
*/*                <,SPACE=ALLOC|FREE|UNALLOC>                       */ 00800000
*/*                <,LOC=24|31>                                      */ 00850000
*/*                <,LINKAGE=SYSTEM|BRANCH|SVC>                  @L4C*/ 00900000
*/*                <,REAL | ,REAL31 | ,REAL64                    @L5C*/ 00918700
*/*                <,PVTSP=ALL|OWNED>                            @01A*/ 00937500
*/*                                                                  */ 00950000
*/*           SYMBOL1 = SUBPOOL LIST (REGISTER 0 2-12                */ 01000000
*/*                                   RX ADDRESS)                    */ 01050000
*/*                                                                  */ 01100000
*/*           SYMBOL2 = AREA ADDRESS (REGISTER 1-12                  */ 01150000
*/*                                   RX ADDRESS)                    */ 01200000
*/*                                                                  */ 01250000
*/*           SYMBOL3 = AREA LENGTH (REGISTER 0 2-12                 */ 01300000
*/*                                  SYMBOL                          */ 01350000
*/*                                  DECIMAL DIGIT)                  */ 01400000
*/*                                                                  */ 01450000
*/*           SYMBOL4 = TCB (REGISTER 0 2-12                         */ 01500000
*/*                          RX ADDRESS)                             */ 01550000
*/*                                                                  */ 01600000
*/*         VSMLIST SP(SQA|CSA|LSQA|PVT|VARIABLE1|(VARIABLE1))       */ 01650000
*/*                 WKAREA(VARIABLE2|(VARIABLE2),VARIABLE3)          */ 01700000
*/*                 <TCB(<VARIABLE4|(VARIABLE4)><,ALL>)>             */ 01750000
*/*                 <SPACE(ALLOC|FREE|UNALLOC)>                      */ 01800000
*/*                 <LOC(24|31)>                                     */ 01837500
*/*                 <LINKAGE(SYSTEM|BRANCH|SVC)>                 @L4C*/ 01875000
*/*                 <RTNCODE(VARIABLE5)>                             */ 01900000
*/*                 <REAL | REAL31 | REAL64>                     @L5C*/ 01918700
*/*                 <PVTSP(ALL|OWNED)>                           @01A*/ 01937500
*/*                                                                  */ 01950000
*/*            VARIABLE1 = SUBPOOL LIST | (SUBPOOL LIST ADDRESS)     */ 02000000
*/*                                                                  */ 02050000
*/*            VARIABLE2 = WORK AREA | (WORK AREA ADDRESS)           */ 02100000
*/*                                                                  */ 02150000
*/*            VARIABLE3 = AREA LENGTH                               */ 02200000
*/*                                                                  */ 02250000
*/*            VARIABLE4 = TCB | (TCB ADDRESS)                       */ 02300000
*/*                                                                  */ 02350000
*/*            VARIABLE5 = RETURN CODE                               */ 02400000
*/*                                                                  */ 02450000
*/* NOTE: THE DEFAULT FOR THE SPACE OPERAND IS 'ALLOC'               */ 02500000
*/*       THE DEFAULT FOR THE LINKAGE OPERAND IS 'SYSTEM'            */ 02550000
*/*       THE DEFAULT FOR THE LOC OPERAND IS '31'                    */ 02600000
*/*       SPACE(UNALLOC) IS ALLOWED ONLY FOR SP(CSA) AND SP(PVT)     */ 02650000
*/*                                                                  */ 02700000
*/* RESTRICTION: The SVC linkage option is only for use by           */ 02710000
*/*       standalone dump. Others invoking it may get unexpected     */ 02720000
*/*       results                                                @L4A*/ 02730000
*/*                                                                  */ 02740000
*/* MACROS: NONE                                                     */ 02750000
*/*                                                                  */ 02800000
*/* EXTERNAL MACRO VARIABLES : EHAREGS, EHAMAPS (PLS ONLY)           */ 02850000
*/*                                                                  */ 02900000
*/* CHANGE ACTIVITY:                                                 */ 02933300
*/*                                                                  */ 02949900
*/*         $L1=VSMPLAS,HBB3310,850925,PDFT: PL/AS CONVERSION    @L1A*/ 02966600
*/*                                                                  */ 03000000
*/*         $L2=PROD310,HBB3310,860716,PDF5:                         */ 03012500
*/*               Correct the copyright notice in the prolog.    @L2A*/ 03025000
*/*                                                                  */ 03037500
*/*         $L3=PROD310,HBB3310,870603,PDF5:  Copyright changes  @L3A*/ 03041600
*/*                                                                  */ 03045700
*/*         $L4=SADEN,HBB4410,890216,PDDS:  SADUMP enhancement   @L4A*/ 03047100
*/*         $P1=PKB0212,HBB4430,920617,PDXB: Flows for STM...LM      */ 03047800
*/*         $01=OWxxxxx,HBB6601,98xxxx,PDH6: PVTSP parameter         */ 03048000
*/*        $L5=64BITVSM HBB7703 980101 PD00XB: 64-bit real           */ 03048200
*/*        $P2=PXD0399  HBB7703 990902 PD00XB: Fix assembler LOC     */ 03048300
*/*                                                                  */ 03048500
*/********************************************************************/ 03050000
*/* A - 000000-999999                                        @G860P9T*/ 03100000
*  @EJECT;                                                              03150000
* %/*                                                                   03200000
         MACRO                                                          03250000
&LABEL   VSMLIST &SP=,&WKAREA=,&SPACE=ALLOC,&TCB=,&LINKAGE=SYSTEM,     +03300000
               &LOC=31,&PVTSP=ALL                                  @L5C 03350000
         LCLC  &ILINK,&ITCB,&ISPADDR                                    03400000
         LCLA  &ISP,&ISPACE,&ICNTL,&IALL,&ERROR,&ILOC,&IREAL            03450000
         LCLA  &IPVTSPOWNED                                        @01A 03475000
.*                                                                      03500000
.*       CHECK VALIDITY OF MACRO OPERANDS                               03550000
.*                                                                      03600000
&ERROR   SETA 0                                                         03800000
&IREAL   SETA 0                                                         03803300
&IPVTSPOWNED SETA 0                                                @01A 03804900
         AIF (N'&SYSLIST EQ 0).NOLIST IF MACLIST PRESENT                03806600
         AIF (N'&SYSLIST EQ 1).LIST1  IF MORE THAN ONE MACLIST ITEM     03809900
         MNOTE 4,'IHB331 MACLIST IS TOO LONG. ARGUMENTS ARE IGNORED AFT+03813200
               ER &SYSLIST(1)..'                                        03816500
.LIST1   ANOP                                                           03819800
         AIF ('&SYSLIST(1)' EQ 'REAL').REAL31 IF MACLIST INVALID        03822000
         AIF ('&SYSLIST(1)' EQ 'REAL31').REAL31 IF MACLIST INVALID      03824200
         AIF ('&SYSLIST(1)' EQ 'REAL64').REAL64 IF MACLIST INVALID @L5A 03826400
         MNOTE 12,'IHB343 MACLIST(1) MUST BE REAL31 OR REAL64. NO TEXT +03828600
               IS GENERATED.'                                      @L5C 03830800
&ERROR   SETA 1                                                         03833000
         AGO  .NOLIST                                                   03836300
.REAL31  ANOP                                                           03839600
&IREAL   SETA 32*256                                                    03842900
         AGO  .NOLIST                                              @L5A 03843700
.REAL64  ANOP                                                      @L5A 03844500
&IREAL   SETA 8*256                                                @L5A 03845300
.NOLIST  ANOP                                                           03846200
         AIF ('&SP(1)' NE '').TYPE    IF NO SP SPECIFIED                03850000
         MNOTE  12,'IHB313 SP IS REQUIRED BUT IS NOT SUPPLIED. NO TEXT +03900000
               IS GENERATED.'                                           03950000
&ERROR   SETA 1                                                         04000000
.TYPE    ANOP                                                           04050000
         AIF (N'&SP LT 2).SP1       IF TOO MANY TYPE SUBFIELDS          04100000
         MNOTE 4,'IHB331 SP=&SP IS TOO LONG. ARGUMENTS ARE IGNORED AFTE+04150000
               R &SP(1)..'                                              04200000
.SP1     ANOP                                                           04250000
&ISPADDR SETC '0(0,0)'                                                  04300000
         AIF ('&SP(1)' NE 'SQA').NOTSQA IF SQA SPECIFIED                04350000
&ISP     SETA 0                                                         04400000
         AGO  .SPOK                                                     04450000
.NOTSQA  ANOP                                                           04500000
         AIF ('&SP(1)' NE 'CSA').NOTCSA IF CSA SPECIFIED                04550000
&ISP     SETA 1*16777216                                                04600000
         AGO  .SPOK                                                     04650000
.NOTCSA  ANOP                                                           04700000
         AIF ('&SP(1)' NE 'LSQA').NOTLSQA IF LSQA SPECIFIED             04750000
&ISP     SETA 2*16777216                                                04800000
         AGO  .SPOK                                                     04850000
.NOTLSQA ANOP                                                           04900000
         AIF ('&SP(1)' NE 'PVT').NOTPVT IF PVT SPECIFIED                04950000
&ISP     SETA 3*16777216                                                05000000
         AGO  .SPOK                                                     05050000
.NOTPVT  ANOP                                                           05100000
&ISP     SETA -1*16777216                                               05150000
&ISPADDR SETC '&SP(1)'                                                  05200000
.SPOK    ANOP                                                           05250000
         AIF ('&WKAREA(1)' NE '' AND '&WKAREA(2)' NE '').WKAREA         05300000
.*                                  IF WKAREA OR SUBFIELDS ARE MISSING  05350000
         MNOTE 12,'IHB313 WORK AREA ADDRESS AND LENGTH IS REQUIRED BUT +05400000
               IS NOT SUPPLIED. NO TEXT IS GENERATED.'                  05450000
&ERROR   SETA 1                                                         05500000
.WKAREA  ANOP                                                           05550000
         AIF (N'&WKAREA LT 3).WKAREA1 IF TOO MANY AREA SUBFIELDS        05600000
         MNOTE 4,'IHB331 WKAREA=&WKAREA IS TOO LONG. ARGUMENTS ARE IGNO+05650000
               RED AFTER &WKAREA(2)..'                                  05700000
.WKAREA1 ANOP                                                           05750000
         AIF (N'&LINKAGE LT 2).LINKCK  IF TOO MANY LINKAGE SUBFIELDS    05800000
         MNOTE 4,'IHB331 LINKAGE=&LINKAGE IS TOO LONG. ARGUMENTS ARE IG+05850000
               NORED AFTER &LINKAGE(1)..'                               05900000
.LINKCK  ANOP                                                           05950000
&ILINK   SETC  '&LINKAGE(1)'                                            06000000
         AIF ('&LINKAGE' EQ '').LINKOK  IF LINKAGE SPECIFIED            06050000
         AIF ('&LINKAGE(1)' EQ 'SYSTEM' OR '&LINKAGE(1)' EQ            +06100000
               'BRANCH' OR '&LINKAGE(1)' EQ                            +06140000
               'SVC').LINKOK     IF INCORRECT LINKAGE SPECIFIED  @L4C   06180000
         MNOTE 12,'IHB343 LINKAGE=&LINKAGE MUST BE SYSTEM, BRANCH OR SV+06220000
               C. NO TEXT IS GENERATED.'                         @L4C   06260000
&ERROR   SETA  1                                                        06300000
.LINKOK  ANOP                                                           06350000
         AIF ('&SPACE' NE '').SPACE IF SPACE OPERAND OMITTED            06400000
&ISPACE  SETA 0                                                         06450000
         AGO  .TCBCK                                                    06500000
.SPACE   ANOP                                                           06550000
         AIF (N'&SPACE LT 2).SPACEOK IF TOO MANY SUBFIELDS              06600000
         MNOTE 4,'IHB331 SPACE=&SPACE IS TOO LONG. ARGUMENTS ARE IGNORE+06650000
               D AFTER &SPACE(1)..'                                     06700000
.SPACEOK ANOP                                                           06750000
         AIF ('&SPACE(1)' NE 'ALLOC').NOALLOC IF ALLOC SPECIFIED        06800000
&ISPACE  SETA 0                                                         06850000
         AGO  .TCBCK                                                    06900000
.NOALLOC ANOP                                                           06950000
         AIF ('&SPACE(1)' NE 'FREE').NOFREE IF FREE SPECIFIED           07000000
&ISPACE  SETA 1*65536                                                   07050000
         AGO  .TCBCK                                                    07100000
.NOFREE  ANOP                                                           07150000
         AIF ('&SPACE(1)' NE 'UNALLOC').NOUNALL IF UNALLOC SPECIFIED    07200000
&ISPACE  SETA 2*65536                                                   07250000
         AIF (&ISP EQ 16777216 OR &ISP EQ 3*16777216).TCBCK IF          07300000
.*                                  SUBPOOL IS NOT CSA OR PVT           07350000
         MNOTE 12,'IHB323 SPACE=UNALLOC IS INVALID WITH SP=&SP.. NO TEX+07400000
               T IS GENERATED.'                                         07450000
&ERROR   SETA  1                                                        07500000
         AGO  .TCBCK                                                    07550000
.NOUNALL ANOP                                                           07600000
&ISPACE  SETA 0                                                         07650000
         MNOTE 12,'IHB343 SPACE=&SPACE MUST BE ALLOC, FREE OR UNALLOC. +07700000
               NO TEXT IS GENERATED.'                                   07750000
&ERROR   SETA  1                                                        07800000
.TCBCK   ANOP                                                           07850000
         AIF ('&TCB' NE '').TCBCK1  IF TCB OPERAND OMITTED              07900000
&ITCB    SETC '0(0,0)'                                                  07950000
&IALL    SETA 0                                                         08000000
         AGO  .LOCCK                                                    08050000
.TCBCK1  ANOP                                                           08100000
         AIF (N'&TCB LT 3).TCBOK    IF TOO MANY SUBFIELDS               08150000
         MNOTE  4,'IHB331 TCB=&TCB IS TOO LONG. ARGUMENTS ARE IGNORED A+08200000
               FTER &TCB(2)..'                                          08250000
.TCBOK   ANOP                                                           08300000
&ITCB    SETC '&TCB(1)'                                                 08350000
         AIF ('&ITCB' NE '').REGCK  IF FIRST SUBFIELD OMITTED           08400000
&ITCB    SETC '0(0,0)'                                                  08450000
         AGO  .ALLCK                                                    08500000
.REGCK   ANOP                                                           08550000
         AIF (N'&TCB GT 1 OR '&TCB'(1,1) NE '(').ALLCK IF ONLY ONE      08600000
.*                                  SUBFIELD AND IT IS A REGISTER       08650000
&ITCB    SETC '&TCB'                                                    08700000
         AGO  .LOCCK                                                    08750000
.ALLCK   ANOP                                                           08800000
         AIF ('&TCB(2)' NE '').TCBALL IF SECOND SUBFIELD OMITTED        08850000
&IALL    SETA 0                                                         08900000
         AGO  .LOCCK                                                    08950000
.TCBALL  ANOP                                                           09000000
         AIF ('&TCB(2)' NE 'ALL').BADALL IF ALL SPECIFIED               09050000
&IALL    SETA 128*256                                                   09100000
         AGO  .LOCCK                                                    09150000
.BADALL  ANOP                                                           09200000
&IALL    SETA 0                                                         09250000
         MNOTE 12,'IHB343 TCB=(,&TCB(2).) MUST BE ALL. NO TEXT IS GENER+09300000
               ATED.'                                                   09350000
&ERROR   SETA  1                                                        09400000
.LOCCK   ANOP                                                           09450000
         AIF (N'&LOC LT 2).LOCOK       IF TOO MANY SUBFIELDS            09500000
         MNOTE 4,'IHB331 LOC=&LOC IS TOO LONG. ARGUMENTS ARE IGNORED AF+09550000
               TER &LOC(1)..'                                           09600000
.LOCOK   ANOP                                                           09650000
         AIF ('&LOC(1)' EQ 'ANY').ISANY   IF LOC=ANY SPECIFIED     @P2C 09687500
         AIF ('&LOC(1)' NE '31').NOTANY IF LOC=ANY SPECIFIED            09725000
.ISANY   ANOP                                                      @P2A 09737500
&ILOC    SETA 64*256                                                    09750000
         AGO  .PVTSPCK                                             @01C 09800000
.NOTANY  ANOP                                                           09850000
         AIF ('&LOC(1)' EQ 'BELOW').ISBLOW IF LOC=BELOW SPECIFIED  @P2C 09887500
         AIF ('&LOC(1)' NE '24').NOTBLOW IF LOC=24 SPECIFIED            09925000
.ISBLOW  ANOP                                                      @P2A 09937500
&ILOC    SETA 0                                                         09950000
         AGO  .PVTSPCK                                             @01C 10000000
.NOTBLOW ANOP                                                           10050000
&ILOC    SETA  64*256                                                   10100000
         AIF ('&LOC' EQ '').GENTEXT  IF LOC SPECIFIED                   10150000
       MNOTE 12,'IHB343 LOC=&LOC MUST BE 24 OR 31. NO TEXT IS GENERATED+10200000
               .'                                                       10250000
&ERROR   SETA 1                                                         10300000
.PVTSPCK ANOP                                                      @01A 10303100
         AIF (N'&PVTSP LT 2).PVTSPOK   IF TOO MANY SUBFIELDS       @01A 10306200
         MNOTE 4,'IHB331 PVTSP=&PVTSP IS TOO LONG. ARGUMENTS ARE IGNORE+10309300
               D AFTER &PVTSP(1)..'                                @01A 10312400
.PVTSPOK ANOP                                                      @01A 10315500
         AIF ('&PVTSP(1)' EQ 'ALL').GENTEXT IF PVTSP=ALL SPECIFIED @01A 10318600
         AIF ('&PVTSP(1)' NE 'OWNED').NOTOWNED IF PVTSP=OWNED SPECIFIED 10321700
.*                                                                 @01A 10324800
&IPVTSPOWNED SETA 16*256                                           @01A 10327900
         AGO  .GENTEXT                                             @01A 10331000
.NOTOWNED ANOP                                                     @01A 10334100
         AIF ('&PVTSP' EQ '').GENTEXT IF PVTSP SPECIFIED           @01A 10337200
         MNOTE 12,'IHB343 PVTSP=&PVTSP MUST BE ALL OR OWNED. NO TEXT IS+10340300
                GENERATED.'                                        @01A 10343400
&ERROR   SETA 1                                                    @01A 10346500
.GENTEXT ANOP                                                           10350000
.*                                                                      10400000
.*       GENERATE TEXT                                                  10450000
.*                                                                      10500000
         AIF (&ERROR EQ 0).GENOK    IF ANY ERRORS OCCURRED              10550000
         MEXIT                                                          10600000
.GENOK   ANOP                                                           10650000
         AIF ('&LABEL' EQ '').NOLABEL IF A LABEL SPECIFIED              10700000
&LABEL   DS  0H                                                         10750000
.NOLABEL ANOP                                                           10800000
         AIF ('&WKAREA(1)'(1,1) NE '(').NOTREGA IF WKAREA ADDRESS IS A  10850000
.*                                  REGISTER                            10900000
         AIF ('&WKAREA(1,1)' EQ '1').GENLEN IF WKAREA ADDRESS IS NOT    10950000
.*                                  REGISTER 1                          11000000
         LR  1,&WKAREA(1,1)         ADDRESS OF WORK AREA                11050000
         AGO .GENLEN                                                    11100000
.NOTREGA ANOP                                                           11150000
         LA  1,&WKAREA(1)           ADDRESS OF WORK AREA                11200000
.GENLEN  ANOP                                                           11250000
         AIF ('&WKAREA(2)'(1,1) NE '(').NOTREGB IF WKAREA LENGTH IS A   11300000
.*                                  REGISTER                            11350000
         ST  &WKAREA(2,1),12(,1)    LENGTH OF WORK AREA                 11400000
         AGO .GENCNTL                                                   11450000
.NOTREGB ANOP                                                           11500000
         AIF (T'&WKAREA(2) NE 'N').ADCON IF LENGTH IS A SYMBOL OR       11550000
         AIF (&WKAREA(2) LE 4095).USELA GREATER THAN 4095               11600000
.ADCON   ANOP                                                           11650000
         L   15,=A(&WKAREA(2))                                          11700000
         ST  15,12(,1)              LENGTH OF WORK AREA                 11750000
         AGO .GENCNTL                                                   11800000
.USELA   ANOP                                                           11850000
         LA  15,&WKAREA(2).(0,0)                                        11900000
         ST  15,12(,1)              LENGTH OF WORK AREA                 11950000
.GENCNTL ANOP                                                           12000000
&ICNTL   SETA &ISP+&ISPACE+&IALL+&ILOC+&IREAL+&IPVTSPOWNED         @01C 12050000
         AIF (&ICNTL LT 0).NEG      IF POSITIVE                         12100000
         L   15,=F'&ICNTL'                                              12150000
         AGO .CONTA                                                     12200000
.NEG     ANOP                                                           12250000
         L   15,=F'-&ICNTL'                                             12300000
.CONTA   ANOP                                                           12350000
         ST  15,16(,1)              CONTROL INFORMATION                 12400000
         AIF ('&ITCB'(1,1) NE '(').NOTREGC IF TCB OPERAND IS A          12450000
.*                                  REGISTER                            12500000
&ITCB    SETC '&ITCB'(2,K'&ITCB-2)  STRIP PARENS                        12550000
         ST  &ITCB,20(,1)           TCB ADDRESS                         12600000
         AGO .GENSP                                                     12650000
.NOTREGC ANOP                                                           12700000
         AIF ('&ITCB' EQ '0(0,0)').NULL1 IF TCB SPECIFIED               12750000
         LA  15,&ITCB                                                   12800000
         AGO .CONTB                                                     12850000
.NULL1   ANOP                                                           12900000
         SLR 15,15                                                      12950000
.CONTB   ANOP                                                           13000000
         ST  15,20(,1)              TCB ADDRESS                         13050000
.GENSP   ANOP                                                           13100000
         AIF (&ISP NE -16777216 OR '&SP'(1,1) NE '(').NOTREGD IF SP     13150000
.*                                  OPERAND IS A REGISTER               13200000
         ST  &ISPADDR,24(,1)        SUBPOOL LIST ADDRESS                13250000
         AGO .GENRESV                                                   13300000
.NOTREGD ANOP                                                           13350000
         AIF ('&ISPADDR' EQ '0(0,0)').NULL2 IF SP SPECIFIED             13400000
         LA  15,&ISPADDR                                                13450000
         AGO .CONTC                                                     13500000
.NULL2   ANOP                                                           13550000
         AIF ('&ITCB' EQ '0(0,0)').CONTC IF TCB SPECIFIED               13600000
         SLR 15,15                                                      13650000
.CONTC   ANOP                                                           13700000
         ST  15,24(,1)              SUBPOOL LIST ADDRESS                13750000
.GENRESV ANOP                                                           13800000
         AIF ('&ISPADDR' EQ '0(0,0)').CONTD IF SP SPECIFIED             13850000
         SLR 15,15                                                      13900000
.CONTD   ANOP                                                           13950000
         ST  15,28(,1)              RESERVED FIELD                      14000000
.*                                                                      14050000
.*       GENERATE LINKAGE                                               14100000
.*                                                                      14150000
         AIF ('&ILINK' NE 'BRANCH').SYSLINK IF BRANCH SPECIFIED         14200000
         L   15,16(,0)              OBTAIN CVT ADDRESS                  14250000
         L   15,1140(,15)           VSMLIST ENTRY ADDRESS               14300000
         BASSM 14,15                BRANCH TO VSMLIST ROUTINE           14350000
         MEXIT                                                          14400000
.SYSLINK ANOP                                                           14450000
         AIF ('&ILINK' NE 'SYSTEM').SVCLINK IF SYSTEM SPECIFIED @L4A    14466600
         ESAR 15                    GET SECONDARY ASN                   14483300
         STM  15,12,16(13)          SAVE REGISTERS                      14516600
         L    2,16(0,0)             OBTAIN CVT ADDRESS                  14550000
         L    2,772(,2)             ADDRESS OF SYSTEM LINKAGE TABLE     14600000
         L    2,88(,2)              OBTAIN PC NUMBER                    14650000
         PC   0(2)                  PC TO VSMLIST ROUTINE               14700000
         L    2,16(13)              RESTORE REGISTERS                   14716600
         SSAR 2                     RESTORE SECONDARY ASN               14733200
         LM   2,12,28(13)           RESTORE REGISTERS                   14750000
         MEXIT                      EXIT                       @L4A     14762500
.SVCLINK ANOP                       IF SVC SPECIFIED           @L4A     14775000
         SVC  72                    INVOKE VSMLIST SERVICE     @L4A     14787500
         MEND                                                           14800000
* */                                                                    14850000
*  @EJECT;                                                              14900000
* VSMLIST:                                                              14950000
*  MACRO KEYS(SP,WKAREA,SPACE,TCB,RTNCODE,LINKAGE,LOC,REAL,PVTSP,       14983300
*             REAL31,REAL64);       /*                           @L5C*/ 15016600
*                                                                       15050000
*  DCL                                                                  15100000
*                                                                       15150000
*    EHAMAPS CHAR EXTERNAL,         /* INTERFACE TO EPILOG MACRO     */ 15200000
*    EHAREGS CHAR EXTERNAL,         /* INTERFACE TO EPILOG MACRO     */ 15250000
*    ERROR FIXED,                   /* MACRO ISSUED ERROR MESSAGES   */ 15300000
*    IALL CHAR,                     /* INTERNAL ALL VALUE            */ 15350000
*    IREGS CHAR,                    /* RESTRICTS REGISTER 15         */ 15400000
*    IRTNCODE CHAR,                 /* INTERNAL RTNCODE VALUE        */ 15450000
*    ISP   CHAR,                    /* INTERNAL STORAGE TYPE         */ 15500000
*    ISPADDR CHAR,                  /* INTERNAL SUPBOOL LIST         */ 15550000
*    IADDR CHAR,                    /* INTERNAL AREA ADDRESS         */ 15600000
*    ILEN  CHAR,                    /* INTERNAL AREA ADDRESS         */ 15650000
*    ILINK CHAR,                    /* INTERNAL LINKAGE              */ 15700000
*    ILOC  CHAR,                    /* INTERNAL LOC                  */ 15750000
*    IREAL CHAR,                    /* INTERNAL REAL                 */ 15775000
*    IREAL64 CHAR,                  /* INTERNAL REAL64           @L5A*/ 15787500
*    ITCB CHAR,                     /* INTERNAL TCB                  */ 15800000
*    ISPACE CHAR,                   /* INTERNAL SPACE                */ 15850000
*    IPVTSPOWNED CHAR,              /* INTERNAL PVTSP            @01A*/ 15875000
*    WARN  FIXED;                   /* MACRO ISSUED WARNING MESSAGES */ 15900000
*                                                                       15950000
*  /******************************************************************/ 16000000
*  /*                                                                */ 16050000
*  /* INITIALIZE VARIABLES                                           */ 16100000
*  /*                                                                */ 16150000
*  /******************************************************************/ 16200000
*                                                                       16250000
*  ERROR=0;                         /* ASSUME NO ERRORS              */ 16300000
*  WARN=0;                          /* ASSUME NO WARNINGS            */ 16350000
*  IREGS='';                        /* DON'T RESTRICT ANY REGISTERS  */ 16400000
*                                                                       16450000
*  @EJECT;                                                              16500000
*                                                                       16550000
*  /******************************************************************/ 16600000
*  /*                                                                */ 16650000
*  /* CHECK VALIDITY OF MACRO OPERANDS AND OBTAIN VALUES             */ 16700000
*  /*                                                                */ 16750000
*  /******************************************************************/ 16800000
*                                                                       16850000
*  IF SP(1) = '' THEN               /* IF STORAGE TYPE NOT SPECIFIED */ 16900000
*    DO;                                                                16950000
*      ERROR=1;                     /* INDICATE ERROR MESSAGE        */ 17000000
*      ANS MSG('AHA0013 SP IS REQUIRED BUT IS NOT SUPPLIED. NO TEXT' || 17050000
*              ' IS GENERATED.') NORESCAN;                              17100000
*    END;                                                               17150000
*  ELSE                             /* STORAGE TYPE SPECIFIED        */ 17200000
*    DO;                                                                17250000
*      IF NUMBER(SP) > 1 THEN       /* IF TOO MANY SP VALUES         */ 17300000
*        DO;                                                            17350000
*          WARN=1;                  /* INDICATE WARNING MESSAGE      */ 17400000
*          ANS MSG('AHA0031 SP'||SP||' IS TOO LONG. ARGUMENTS ARE ' ||  17450000
*                  'IGNORED AFTER '||SP(1)||'.') NORESCAN;              17500000
*        END;                                                           17550000
*      ISPADDR='0';                 /* ASSUME NO SUBPOOL LIST    @L1C*/ 17600000
*      IF SP(1) = 'SQA' THEN        /* IF SQA SPECIFIED              */ 17650000
*        ISP='0';                   /* INDICATE SQA STORAGE          */ 17700000
*      ELSE                                                             17750000
*        IF SP(1) = 'CSA' THEN /* IF CSA SPECIFIED                   */ 17800000
*          ISP='1';                 /* INDICATE CSA STORAGE          */ 17850000
*        ELSE                                                           17900000
*          IF SP(1) = 'LSQA' THEN /* IF LSQA SPECIFIED               */ 17950000
*            ISP='2';               /* INDICATE LSQA STORAGE         */ 18000000
*          ELSE                                                         18050000
*            IF SP(1) = 'PVT' THEN /* IF PVT SPECIFIED               */ 18100000
*              ISP='3';             /* INDICATE PVT STORAGE          */ 18150000
*            ELSE                   /* INCORRECT STORAGE TYPE        */ 18200000
*              DO;                                                      18250000
*                ISP='''FF''X';     /* INDICATE NO STORAGE TYPE      */ 18300000
*                IF SP(1,1:1) = '(' &                                   18350000
*                   SP(1,LENGTH(SP(1)):LENGTH(SP(1))) = ')' THEN /*     18400000
*                                      IF SUBPOOL LIST ADDRESS       */ 18450000
*                  ISPADDR=SP(1,1); /* OBTAIN SUBPOOL LIST ADDRESS   */ 18500000
*                ELSE                                                   18550000
*                  ISPADDR='ADDR('||SP(1)||')'; /* OBTAIN SP LIST    */ 18600000
*              END;                                                     18650000
*    END;                                                               18700000
*                                                                       18750000
*  IF WKAREA(1) = '' | WKAREA(2) = '' THEN /* IF WKAREA AND TWO         18800000
*                                      SUBFIELDS AREA NOT SPECIFIED  */ 18850000
*    DO;                                                                18900000
*      ERROR=1;                     /* INDICATE ERROR MESSAGE        */ 18950000
*      ANS MSG('AHA0013 WKAREA ADDRESS AND LENGTH IS REQUIRED BUT ' ||  19000000
*              'IS NOT SUPPLIED. NO TEXT IS GENERATED.') NORESCAN;      19050000
*    END;                                                               19100000
*  ELSE                             /* WKAREA AND TWO SUBFIELDS         19150000
*                                      SPECIFIED                     */ 19200000
*    DO;                                                                19250000
*      IF NUMBER(WKAREA) > 2 THEN   /* IF TOO MANY SUBFIELDS            19300000
*                                      SPECIFIED                     */ 19350000
*        DO;                                                            19400000
*          WARN=1;                  /* INDICATE WARNING MESSAGE      */ 19450000
*          ANS MSG('AHA0031 WKAREA'||WKAREA||' IS TOO LONG. ARGUMENTS'  19500000
*                  ||' ARE IGNORED AFTER '||WKAREA(2)||'.') NORESCAN;   19550000
*        END;                                                           19600000
*      IF WKAREA(1,1:1) = '(' &                                         19650000
*         WKAREA(1,LENGTH(WKAREA(1)):LENGTH(WKAREA(1))) = ')' THEN /*   19700000
*                                      IF WORK AREA ADDRESS          */ 19750000
*        IADDR=WKAREA(1,1);         /* OBTAIN WKAREA ADDRESS         */ 19800000
*      ELSE                                                             19850000
*        IADDR='ADDR('||WKAREA(1)||')'; /* OBTAIN WORK AREA VALUE    */ 19900000
*      ILEN=WKAREA(2);              /* OBTAIN WKAREA LENGTH          */ 19950000
*    END;                                                               20000000
*                                                                       20050000
*  IF LINKAGE = '' THEN             /* IF LINKAGE NOT SPECIFIED      */ 20100000
*    ILINK='PC';                    /* INDICATE PC LINKAGE           */ 20150000
*  ELSE                             /* LINKAGE SPECIFIED             */ 20200000
*    DO;                                                                20250000
*      IF NUMBER(LINKAGE) > 1 THEN  /* IF TOO MANY SUBFIELDS            20300000
*                                      SPECIFIED                     */ 20350000
*        DO;                                                            20400000
*          WARN=1;                  /* INDICATE WARNING MESSAGE      */ 20450000
*          ANS MSG('AHA0031 LINKAGE'||LINKAGE||' IS TOO LONG. ' ||      20500000
*                  'ARGUMENTS ARE IGNORED AFTER '||LINKAGE(1)||'.')     20550000
*                  NORESCAN;                                            20600000
*        END;                                                           20650000
*      IF LINKAGE(1)='SYSTEM' THEN /* IF SYSTEM SPECIFIED            */ 20700000
*        ILINK='PC';                /* INDICATE PC LINKAGE           */ 20750000
*      ELSE                                                             20800000
*      IF LINKAGE(1)='BRANCH' THEN /* IF BRANCH SPECIFIED            */ 20814200
*        ILINK='BASSM';             /* INDICATE BASSM LINKAGE        */ 20828400
*      ELSE                         /* @L4A*/                           20842600
*      IF LINKAGE(1)='SVC' THEN /*    @L4A*/                            20856800
*        ILINK='SVC';             /* INDICATE SVC LINKAGE   @L4A */     20871000
*      ELSE                         /* INCORRECT LINKAGE SPECIFIED   */ 20885200
*          DO;                                                          20900000
*            ILINK='PC';            /* INDICATE PC LINKAGE           */ 21150000
*            IF LINKAGE(1) = '' THEN /* IF NO SUBFIELDS              */ 21200000
*              DO;                                                      21250000
*                WARN=1;            /* INDICATE WARNING MESSAGE      */ 21300000
*                ANS MSG('AHA0061 LINKAGE TYPE IS NOT SPECIFIED BUT '   21350000
*                      || 'MAY BE REQUIRED.') NORESCAN;                 21400000
*              END;                                                     21450000
*            ELSE                   /* A SUBFIELD SPECIFIED          */ 21500000
*              DO;                                                      21550000
*                ERROR=1;           /* INDICATE ERROR MESSAGE        */ 21600000
*               ANS MSG('AHA0043 LINKAGE'||LINKAGE||' MUST BE SYSTEM, ' 21637500
*                      || 'SVC OR BRANCH. NO TEXT IS GENERATED.')       21675000
*                      NORESCAN;                              /* @L4C*/ 21712500
*              END;                                                     21750000
*          END;                                                         21800000
*    END;                                                               21850000
*                                                                       21900000
*  IF SPACE = '' THEN               /* IF SPACE OPERAND OMITTED      */ 21950000
*    ISPACE='0';                    /* SET DEFAULT                   */ 22000000
*  ELSE                             /* SPACE SPECIFIED               */ 22050000
*    DO;                                                                22100000
*      IF NUMBER(SPACE) > 1 THEN    /* IF TOO MANY SUBFIELDS         */ 22150000
*        DO;                                                            22200000
*          WARN=1;                  /* INDICATE WARNING MESSAGE      */ 22250000
*          ANS MSG('AHA0031 SPACE'||SPACE||' IS TOO LONG. ARGUMENTS '|| 22300000
*                  'ARE IGNORED AFTER '||SPACE(1)||'.') NORESCAN;       22350000
*        END;                                                           22400000
*      IF SPACE(1) = 'ALLOC' THEN   /* IF ALLOC SPECIFIED            */ 22450000
*        ISPACE='0';                /* INDICATE SO                   */ 22500000
*      ELSE                                                             22550000
*        IF SPACE(1) = 'FREE' THEN  /* IF FREE SPECIFIED             */ 22600000
*          ISPACE='1';              /* INDICATE SO                   */ 22650000
*        ELSE                                                           22700000
*          IF SPACE(1) = 'UNALLOC' THEN /* IF UNALLOC SPECIFIED      */ 22750000
*            DO;                                                        22800000
*              ISPACE='2';          /* INDICATE SO                   */ 22850000
*              IF ISP ^= '1' & ISP ^= '3' THEN /* IF SUBPOOL IS NOT CSA 22900000
*                                      AND NOT PVT                   */ 22950000
*                DO;                                                    23000000
*                  ERROR=1;         /* INDICATE ERROR MESSAGE        */ 23050000
*                  ANS MSG('AHA0023 SPACE(UNALLOC) IS INVALID WITH ' || 23100000
*                          'SP'||SP||'. NO TEXT IS GENERATED.')         23150000
*                          NORESCAN;                                    23200000
*                END;                                                   23250000
*            END;                                                       23300000
*          ELSE                     /* INCORRECT VALUE               */ 23350000
*            DO;                                                        23400000
*              ISPACE='0';          /* DEFAULT TO ALLOC              */ 23450000
*              IF SPACE(1) = '' THEN /* IF NO SUBFIELDS              */ 23500000
*                DO;                                                    23550000
*                  WARN=1;          /* INDICATE WARNING MESSAGE      */ 23600000
*                  ANS MSG('AHA0061 SPACE TYPE IS NOT SPECIFIED BUT '   23650000
*                        ||'MAY BE REQUIRED.') NORESCAN;                23700000
*                END;                                                   23750000
*              ELSE                 /* A SUBFIELD SPECIFIED          */ 23800000
*                DO;                                                    23850000
*                  ERROR=1;         /* INDICATE ERROR MESSAGE        */ 23900000
*                  ANS MSG('AHA0043 SPACE'||SPACE||' MUST BE ALLOC, '   23950000
*                        ||'FREE OR UNALLOC.'                           24000000
*                        ||' NO TEXT IS GENERATED.') NORESCAN;          24050000
*                END;                                                   24100000
*            END;                                                       24150000
*    END;                                                               24200000
*                                                                       24250000
*  IF TCB = '' THEN                 /* IF TCB OPERAND OMITTED        */ 24300000
*    DO;                                                                24350000
*      ITCB='0';                    /* INDICATE NO TCB           @L1C*/ 24400000
*      IALL='0';                                                        24450000
*    END;                                                               24500000
*  ELSE                             /* TCB OPERAND SPECIFIED         */ 24550000
*    IF TCB = 'TCB' | TCB = '()' THEN /* IF SUBFIELD OMITTED         */ 24600000
*      DO;                                                              24650000
*        WARN=1;                    /* INDICATE WARNING MESSAGE      */ 24700000
*        ANS MSG('AHA0061 TCB ADDRESS OR ALL IS NOT SPECIFIED ' ||      24750000
*                'BUT MAY BE REQUIRED.') NORESCAN;                      24800000
*        ITCB='0';                  /* INDICATE NO TCB           @L1C*/ 24850000
*        IALL='0';                                                      24900000
*      END;                                                             24950000
*    ELSE                           /* SUBFIELD SPECIFIED            */ 25000000
*      DO;                                                              25050000
*        IF TCB(1) = '' THEN        /* IF TCB ADDRESS OMITTED        */ 25100000
*          ITCB='0';                /* USE DEFAULT               @L1C*/ 25150000
*        ELSE                       /* TCB ADDRESS SPECIFIED         */ 25200000
*          IF TCB(1,1:1) = '(' &                                        25250000
*             TCB(1,LENGTH(TCB(1)):LENGTH(TCB(1))) = ')' THEN /*        25300000
*                                      IF TCB ADDRESS                */ 25350000
*            ITCB=TCB(1,1);         /* OBTAIN TCB ADDRESS            */ 25400000
*          ELSE                                                         25450000
*            ITCB='ADDR('||TCB(1)||')'; /* OBTAIN TCB VALUE          */ 25500000
*        IF TCB(2) ^= '' THEN       /* IF SECOND SUBFIELD SPECIFIED  */ 25550000
*          IF TCB(2) = 'ALL' THEN   /* IF ALL SPECIFIED              */ 25600000
*            IALL='1';              /* INDICATE SO                   */ 25650000
*          ELSE                                                         25700000
*            DO;                                                        25750000
*              TALL='0';            /* DEFAULT TO ALL OMITTED        */ 25800000
*              ERROR=1;             /* INDICATE ERROR MESSAGE        */ 25850000
*              ANS MSG('AHA0043 TCB(,'||TCB(2)||') MUST BE ALL. ' ||    25900000
*                      'NO TEXT IS GENERATED.') NORESCAN;               25950000
*            END;                                                       26000000
*        ELSE                       /* NO SECOND SUBFIELD            */ 26050000
*          IALL='0';                /* ALL NOT SPECIFIED             */ 26100000
*        IF NUMBER(TCB) > 2 THEN    /* IF TOO MANY SUBFIELDS         */ 26150000
*          DO;                                                          26200000
*            WARN=1;                /* INDICATE WARNING MESSAGE      */ 26250000
*            ANS MSG('AHA0031 TCB'||TCB||' IS TOO LONG. ARGUMENTS ' ||  26300000
*                    'ARE IGNORED AFTER '||TCB(2)||'.') NORESCAN;       26350000
*          END;                                                         26400000
*      END;                                                             26450000
*                                                                       26500000
*  IF LOC(1) ^= '' THEN             /* IF LOC OPERAND AND SUBFIELD      26550000
*                                      SPECIFIED                     */ 26600000
*    DO;                                                                26650000
*      IF LOC(1) = 'ANY'            /* IF LOC(ANY) SPECIFIED         */ 26683300
*       | LOC(1) = '31' THEN        /* IF LOC(31) SPECIFIED          */ 26716600
*        ILOC='1';                  /* INDICATE SO                   */ 26750000
*      ELSE                                                             26800000
*        IF LOC(1) = 'BELOW' |      /* IF LOC(BELOW) SPECIFIED       */ 26833300
*           LOC(1) = '24' THEN      /* IF LOC(24) SPECIFIED          */ 26866600
*          ILOC='0';                /* INDICATE SO                   */ 26900000
*        ELSE                       /* INVALID LOC SUBFIELD          */ 26950000
*          DO;                                                          27000000
*            ILOC='1';              /* DEFAULT TO 31                 */ 27050000
*            ERROR=1;               /* INDICATE ERROR MESSAGE        */ 27100000
*            ANS MSG('AHA0043 LOC'||LOC||' MUST BE 24 OR 31. ' ||       27150000
*                    'NO TEXT IS GENERATED.') NORESCAN;                 27200000
*          END;                                                         27250000
*      IF NUMBER(LOC) > 1 THEN      /* IF MORE THAN ONE SUBFIELD     */ 27300000
*        DO;                                                            27350000
*          ILOC='1';                /* DEFAULT TO 31                 */ 27400000
*          WARN=1;                  /* INDICATE WARNING MESSAGE      */ 27450000
*          ANS MSG('AHA0031 LOC'||LOC||' IS TOO LONG. ARGUMENTS ARE' || 27500000
*                  'IGNORED AFTER '||LOC(1)||'.') NORESCAN;             27550000
*        END;                                                           27600000
*    END;                                                               27650000
*  ELSE                             /* LOC SUBFIELD OMITTED          */ 27700000
*    IF LOC = '' THEN               /* IF LOC OPERAND OMITTED        */ 27750000
*      ILOC='1';                    /* DEFAULT TO 31                 */ 27800000
*    ELSE                           /* LOC SPECIFIED                 */ 27850000
*      DO;                                                              27900000
*        ILOC='1';                  /* DEFAULT TO 31                 */ 27950000
*        WARN=1;                    /* INDICATE WARNING MESSAGE      */ 28000000
*        ANS MSG('AHA0061 LOC VALUE IS NOT SPECIFIED BUT MAY BE ' ||    28050000
*                'REQUIRED.') NORESCAN;                                 28100000
*      END;                                                             28150000
*  IF PVTSP(1) ^= '' THEN           /* IF PVTSP OPERAND AND SUBFIELD    28150200
*                                      SPECIFIED                 @01A*/ 28150400
*    DO;                            /*                           @01A*/ 28150600
*      IF PVTSP(1) = 'ALL' THEN     /* IF PVTSP(ALL) SPECIFIED   @01A*/ 28150800
*        IPVTSPOWNED='0';           /* INDICATE SO               @01A*/ 28151000
*      ELSE                         /*                           @01A*/ 28151200
*        IF PVTSP(1) = 'OWNED' THEN /* IF PVTSP(OWNED) SPECIFIED @01A*/ 28151400
*          IPVTSPOWNED='1';         /* INDICATE SO               @01A*/ 28151600
*        ELSE                       /* INVALID PVTSP SUBFIELD    @01A*/ 28151800
*          DO;                      /*                           @01A*/ 28152000
*            IPVTSPOWNED='0';       /* DEFAULT TO ALL            @01A*/ 28152200
*            ERROR=1;               /* INDICATE ERROR MESSAGE    @01A*/ 28152400
*            ANS MSG('AHA0043 PVTSP'||PVTSP||' MUST BE ALL OR OWNED. '  28152600
*                    || 'NO TEXT IS GENERATED.') NORESCAN;   /*  @01A*/ 28152800
*          END;                     /*                           @01A*/ 28153000
*      IF NUMBER(PVTSP) > 1 THEN    /* IF MORE THAN ONE SUBFIELD @01A*/ 28153200
*        DO;                        /*                           @01A*/ 28153400
*          WARN=1;                  /* INDICATE WARNING MESSAGE  @01A*/ 28153600
*          ANS MSG('AHA0031 PVTSP'||PVTSP||                             28153800
*                  ' IS TOO LONG. ARGUMENTS ARE ' ||                    28154000
*                  'IGNORED AFTER '||PVTSP(1)||'.') NORESCAN; /* @01A*/ 28154200
*        END;                       /*                           @01A*/ 28154400
*    END;                           /*                           @01A*/ 28154600
*  ELSE                             /* PVTSP SUBFIELD OMITTED    @01A*/ 28154800
*    IF PVTSP = '' THEN             /* IF PVTSP OPERAND OMITTED  @01A*/ 28155000
*      IPVTSPOWNED='0';             /* DEFAULT TO ALL            @01A*/ 28155200
*    ELSE                           /* PVTSP SPECIFIED           @01A*/ 28155400
*      DO;                          /*                           @01A*/ 28155600
*        IPVTSPOWNED='0';           /* DEFAULT TO ALL            @01A*/ 28155800
*        WARN=1;                    /* INDICATE WARNING MESSAGE  @01A*/ 28156000
*        ANS MSG('AHA0061 PVTSP VALUE IS NOT SPECIFIED BUT MAY BE ' ||  28156200
*                'REQUIRED.') NORESCAN;        /*                @01A*/ 28156400
*      END;                         /*                           @01A*/ 28156600
*  IF REAL = '' & REAL31 = '' THEN  /* IF REAL NOT SPECIFIED     @L5C*/ 28160900
*    IREAL='0';                     /* INDICATE SO                   */ 28165200
*  ELSE                             /* ELSE REAL SPECIFIED           */ 28172800
*    IF REAL(1) ^= '' |             /* IF SUBFIELD SPECIFIED         */ 28177800
*       REAL31(1) ^= '' THEN        /* IF SUBFIELD SPECIFIED     @L5A*/ 28182900
*      DO;                                                              28188000
*        WARN=1;                    /* INDICATE WARNING MESSAGE      */ 28195600
*        ANS MSG('AHA0051 '||REAL||REAL31||                             28201300
*                ' SUPPLIED WITH REAL31 IS NOT '||                      28207000
*                'ALLOWED. IT IS IGNORED.') NORESCAN;  /*        @L5C*/ 28212700
*        IREAL='1';                 /* INDICATE REAL SPECIFIED       */ 28218400
*      END;                                                             28226000
*    ELSE                           /* ELSE NO SUBFIELD              */ 28233600
*      IREAL='1';                   /* INDICATE REAL SPECIFIED       */ 28241200
*  IF REAL64 = '' THEN              /* IF REAL64 NOT SPECIFIED   @L5A*/ 28241800
*    IREAL64='0';                   /* INDICATE SO               @L5A*/ 28242400
*  ELSE                             /* ELSE REAL64 SPECIFIED     @L5A*/ 28243000
*    IF REAL64(1) ^= '' THEN        /* IF SUBFIELD SPECIFIED     @L5A*/ 28243600
*      DO;                          /*                           @L5A*/ 28244200
*        WARN=1;                    /* INDICATE WARNING MESSAGE  @L5A*/ 28244800
*        ANS MSG('AHA0051 '||REAL64||' SUPPLIED WITH REAL64 IS NOT '||  28245400
*                'ALLOWED. IT IS IGNORED.') NORESCAN;     /*     @L5A*/ 28246100
*        IREAL64='1';               /* INDICATE REAL64 SPECIFIED @L5A*/ 28246800
*      END;                         /*                           @L5A*/ 28247500
*    ELSE                           /* ELSE NO SUBFIELD          @L5A*/ 28248200
*      IREAL64='1';                 /* INDICATE REAL64 SPECIFIED @L5A*/ 28248900
*  IF RTNCODE(1) ^= '' THEN         /* IF RTNCODE OPERAND AND SUBFIELD  28250000
*                                       SPECIFIED                    */ 28300000
*    DO;                                                                28350000
*      IRTNCODE=RTNCODE(1);         /* OBTAIN RTNCODE VALUE          */ 28400000
*      IREGS=IREGS||',GPR15F';      /* NEED TO RESTRICT REGISTER 15  */ 28450000
*      IF NUMBER(RTNCODE) > 1 THEN  /* IF MORE THAN ONE SUBFIELD     */ 28500000
*        DO;                                                            28550000
*          WARN=1;                  /* INDICATE WARNING MESSAGE      */ 28600000
*          ANS MSG('AHA0031 RTNCODE'||RTNCODE||' IS TOO LONG. ' ||      28650000
*                  'ARGUMENTS ARE IGNORED AFTER '||TCB(2)||'.')         28700000
*                  NORESCAN;                                            28750000
*        END;                                                           28800000
*    END;                                                               28850000
*  ELSE                             /* RTNCODE SUBFIELD NOT             28900000
*                                      SPECIFIED                     */ 28950000
*    IF RTNCODE ^= '' THEN          /* IF RTNCODE OPERAND SPECIFIED  */ 29000000
*      DO;                                                              29050000
*        WARN=1;                    /* INDICATE WARNING MESSAGE      */ 29100000
*        ANS MSG('AHA0061 RTNCODE VARIABLE IS NOT SPECIFIED BUT MAY' || 29150000
*                'BE REQUIRED.') NORESCAN;                              29200000
*      END;                                                             29250000
*                                                                       29300000
*  IF MACLIST(1) ^= '' THEN         /* IF POSITIONAL OPERANDS           29350000
*                                       SPECIFIED                    */ 29400000
*    DO;                                                                29450000
*      WARN=1;                      /* INDICATE WARNING MESSAGE      */ 29500000
*      ANS MSG('AHA0051 THE MACLIST '||MACLIST||' IS NOT ALLOWED. ' ||  29550000
*              'IT IS IGNORED.') NORESCAN;                              29600000
*    END;                                                               29650000
*  IF ILINK = 'PC' THEN             /* IF SYSTEM LINKAGE             */ 29700000
*    IREGS=IREGS||',GPR02P';        /* RESTRICT REGISTER 2           */ 29750000
*  @EJECT;                                                              29800000
*                                                                       29850000
*  /******************************************************************/ 29900000
*  /*                                                                */ 29950000
*  /* GENERATE TEXT                                                  */ 30000000
*  /*                                                                */ 30050000
*  /******************************************************************/ 30100000
*                                                                       30150000
*  ANS (MACLABEL) COL(MACLMAR) NORESCAN;                                30200000
*  ANS ('DO; /* '||MACNAME||' '||MACLIST||' '||MACKEYS||' */')          30250000
*      COL(MACCOL) NORESCAN;                                            30300000
*  IF ERROR = 0 THEN                /* IF NO ERROR MESSAGES          */ 30350000
*    DO;                                                                30400000
*      IF INDEX(EHAMAPS,'XM@') = 0 THEN                                 30450000
*        EHAMAPS=EHAMAPS||'XM@';                                        30500000
*      IF INDEX(EHAREGS,'01P') = 0 THEN                                 30550000
*        EHAREGS=EHAREGS||'01P';                                        30600000
*      ANS('RFY (GPR01P'||IREGS||') RSTD;')                             30650000
*         COL(MACCOL+2) NORESCAN;                                       30700000
*      ANS('GPR01P='||IADDR||'; /* ADDRESS OF AREA */')                 30750000
*         COL(MACCOL+2) NORESCAN;                                       30800000
*      ANS('(GPR01P+12)->I031F='||ILEN||                                30850000
*          '; /* LENGTH OF WORK AREA */') NORESCAN COL(MACCOL+2);       30900000
*      ANS('(GPR01P+16)->I031F=('||ISP||'*16777216)+('/* MOVE SUBPOOL TO30911900
*                                      THE FIRST HIGH-ORDER BYTE  @L1C*/30923800
*          ||ISPACE||'*65536)+'||   /* MOVE KEY TO THE 2ND HIGH-ORDER   30935700
*                                      BYTE                       @L1C*/30947600
*          '(((128*'||IALL||')'||   /* IALL='0' => ALL WAS NOT SPECIFIED30959500
*                                      ON TCB PARAMETER                 30971400
*                                      IALL='1' => ALL WAS SPECIFIED    30983300
*                                      ON TCB PARAMETER           @L1C*/30995200
*        '+(64*'||ILOC||')'||     /* ILOC='0' => 31 WAS NOT SPECIFIED   31007100
*                                      ON LOC PARAMETER                 31019000
*                                    ILOC='1' => 31 WAS SPECIFIED       31030900
*                                      ON LOC PARAMETER           @L1C*/31042800
*          '+(32*'||IREAL||')'||    /* IREAL='0' => REAL WAS NOT        31054700
*                                      SPECIFIED                        31066600
*                                      IREAL='1' => REAL WAS SPECIFIED  31078500
*                                                                 @L1C*/31090400
*          '+(16*'||IPVTSPOWNED||')'||    /* IPVTSPOWNED='1' =>         31096300
*                                      PVTSP=OWNED WAS SPECIFIED  @01A*/31102200
*          '+(8*'||IREAL64||')'||  /* IREAL64='0' => REAL64 WAS NOT     31104200
*                                      SPECIFIED                        31106200
*                                    IREAL64='1' => REAL64 WAS SPECIFIED31108200
*                                                                 @L5A*/31110200
*          '+000)'||                /* RESERVED                   @L5C*/31112200
*          '*256); /* CONTROL INFORMATION */')/* MOVE FLAGS TO THE      31114200
*                                      3RD HIGH-ORDER BYTE        @L1C*/31126100
*          NORESCAN COL(MACCOL+2);                                      31138000
*      ANS('(GPR01P+20)->I031P='||ITCB||                                31150000
*          '; /* TCB ADDRESS */') NORESCAN COL(MACCOL+2);               31200000
*      ANS('(GPR01P+24)->I031P='||ISPADDR||                             31250000
*          '; /* SUBPOOL LIST ADDRESS */') NORESCAN COL(MACCOL+2);      31300000
*      ANS('GPR01P->I256C(29:32)=''''B; /* RESERVED */')                31350000
*         NORESCAN COL(MACCOL+2);                                       31400000
*      IF ILINK='BASSM' THEN       /* IF BRANCH ENTRY LINKAGE      */   31450000
*        DO;                                                            31500000
*          ANS('CALL ((XM@CVT+1140)->I031P)->IPDEF; '||                 31550000
*              '/* INVOKE VSMLIST ROUTINE */')                          31600000
*             COL(MACCOL+2) NORESCAN;                                   31650000
*        END;                                                           31700000
*      ELSE                                                             31716600
*       IF ILINK='SVC' THEN                 /* IF SVC LINKAGE    @L4C*/ 31733200
*        ANS('SVC(72); /* INVOKE VSMLIST */')                           31749800
*         COL(MACCOL+2) NORESCAN;                         /*     @L4A*/ 31766400
*       ELSE                                /* IF PC LINKAGE     @L4A*/ 31783000
*        DO;                                                            31800000
*          IF INDEX(EHAREGS,'02P') = 0 THEN                             31850000
*            EHAREGS=EHAREGS||'02P';                                    31900000
*          IF INDEX(EHAREGS,'13P') = 0 THEN                             31950000
*            EHAREGS=EHAREGS||'13P';                                    32000000
*          ANS('GEN CODE(ESAR 15); '||                                  32020000
*             '/* GET SECONDARY ASN */')                                32040000
*             COL(MACCOL+2) NORESCAN;                                   32060000
*          /* The GEN FLOWS will enable the compiler to understand      32066600
*             that when it gets to the target, it has the same          32073200
*             register contents as at the time of this STM       @P1A*/ 32079800
*          ANS('GEN FLOWS(VL' || MACINDEX || 'A)' ||                    32086400
*                 ' CODE(STM  15,12,16(GPR13P)); '||                    32093000
*             '/* SAVE REGISTERS */')                                   32100000
*             COL(MACCOL+2) NORESCAN;        /*                  @P1A*/ 32150000
*          ANS('GPR02P=XM@(23); '||                                     32200000
*             '/* OBTAIN PC NUMBER */')                                 32250000
*             COL(MACCOL+2) NORESCAN;                                   32300000
*          ANS('PC(GPR02P); '||                                         32350000
*             '/* PC TO VSMLIST ROUTINE */')                            32400000
*             COL(MACCOL+2) NORESCAN;                                   32450000
*          ANS('GEN CODE(L  2,16(GPR13P)); '||                          32457100
*             '/* RESTORE SECONDARY ASN */')                            32464200
*             COL(MACCOL+2) NORESCAN;                                   32471300
*          ANS('GEN CODE(SSAR 2); '||                                   32478400
*             '/* RESTORE SECONDARY ASN */')                            32485500
*             COL(MACCOL+2) NORESCAN;                                   32492600
*          ANS('GEN CODE(LM   2,12,28(GPR13P)); '||                     32500000
*             '/* RESTORE REGISTERS */')                                32550000
*             COL(MACCOL+2) NORESCAN;                                   32600000
*          ANS('VL' || MACINDEX || 'A:;'||                              32612500
*             '/* FLOWS LABEL FOR OPTIMIZATION */')                     32625000
*             COL(MACCOL+2) NORESCAN;        /*                  @P1A*/ 32637500
*        END;                                                           32650000
*      IF IRTNCODE ^= '' THEN       /* IF RTNCODE OPERAND SPECIFIED  */ 32700000
*        DO;                                                            32750000
*          IF INDEX(EHAREGS,'15F') = 0 THEN                             32800000
*            EHAREGS=EHAREGS||'15F';                                    32850000
*          ANS(IRTNCODE||'=GPR15F; /* SAVE RETURN CODE */')             32900000
*             COL(MACCOL+2) NORESCAN;                                   32950000
*        END;                                                           33000000
*      ANS('RFY (GPR01P'||IREGS||') UNRSTD;')                           33050000
*         COL(MACCOL+2) NORESCAN;                                       33100000
*    END;                                                               33150000
*  ANS('END; /* '||MACNAME||' '||MACLIST||' '||MACKEYS||' */')          33200000
*     COL(MACCOL) NORESCAN;                                             33250000
*  IF ERROR = 1 THEN                /* IF ERROR MESSAGES ISSUED      */ 33300000
*    RETURN CODE(12);                                                   33350000
*  ELSE                                                                 33400000
*    IF WARN = 1 THEN               /* IF WARNING MESSAGES ISSUED    */ 33450000
*      RETURN CODE(4);                                                  33500000
*    ELSE                           /* NO MESSAGES ISSUED            */ 33550000
*      RETURN CODE(0);                                                  33600000
*%END VSMLIST;                                                          33650000
