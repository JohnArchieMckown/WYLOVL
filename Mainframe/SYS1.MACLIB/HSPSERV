*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  HSPSERV                               -92/07/31-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Hiperspace Services                           * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     5695-047 (C) COPYRIGHT IBM CORP. 1988, 1992                     * 00001300
*     SEE COPYRIGHT INSTRUCTIONS                                      * 00001400
*                                                                     * 00001500
* STATUS= HBB4430                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*                                                                     * 00001900
*01* FUNCTION:                                                        * 00002000
*                                                                     * 00002100
*                                                                     * 00002200
*                                                                     * 00002300
*      HSPSERV provides the interface to the hiperspace read and      * 00002400
*      write services SREAD, CREAD, SWRITE, and CWRITE.  These        * 00002500
*      services are used to read one or more blocks of data from a    * 00002600
*      hiperspace to an address space or to write one or more blocks  * 00002700
*      of data from an address space to a hiperspace.  A block is a   * 00002800
*      unit of 4K bytes starting on a 4k boundary.  The HSPSERV user  * 00002900
*      specifies the area in the hiperspace to be read or written by  * 00003000
*      indicating the STOKEN of the hiperspace and the starting VSA   * 00003100
*      in the hiperspace.  The area of the address space from which   * 00003200
*      to read or write is specified via the starting VSA in the      * 00003300
*      caller's home address space.  As an option, for CACHE type     * 00003400
*      hiperspaces only, the caller's primary address space or the    * 00003500
*      Common Storage Area (CSA) may be specified for a read or write * 00003600
*      in lieu of the caller's home address space.                    * 00003700
*                                                                     * 00003800
*      The caller may also optionally specify an ALET, via the        * 00003900
*      HSPALET keyword, that addresses the hiperspace on the caller's * 00004000
*      current DU or PASN access list.  Providing an ALET will, in    * 00004100
*      many environments, serve to expedite the processing of an      * 00004200
*      HSPSERV request.                                               * 00004300
*                                                                     * 00004400
*      Problem programs running with PSW key 8-F are required to      * 00004500
*      specify an ALET when accessing a shared SCROLL type            * 00004600
*      hiperspace, as are programs that access a non-shared SCROLL    * 00004700
*      hiperspace and whose home and primary address spaces are       * 00004800
*      different.  HSPSERV with HSPALET may not be invoked while a    * 00004900
*      DIV SAVE is current for the hiperspace being accessed, and     * 00005000
*      HSPALET may not be specified in conjunction with the           * 00005100
*      RELEASE=YES option on SREAD.                                   * 00005200
*                                                                     * 00005300
*      If HSPALET is specified, the caller must provide a 144 byte    * 00005400
*      work area in the caller's primary address space and addressed  * 00005500
*      by AR/GPR 13 (note that AR 13 must accurately address this     * 00005600
*      area, even for non-AR mode callers), and must also issue the   * 00005700
*      SYSSTATE macro prior to invoking HSPSERV so that the caller's  * 00005800
*      ASC mode is appropriately reflected.  The use of HSPALET may   * 00005900
*      cause the parameter list and range list to be modified by      * 00006000
*      hiperspace services.                                           * 00006100
*                                                                     * 00006200
*      If any I/O is required to read or write a data page (I/O will  * 00006300
*      be required only for SCROLL type hiperspaces and only when     * 00006400
*      reading or writing to auxiliary storage or to a DIV object on  * 00006500
*      permanent DASD), it will be done asynchronously with the       * 00006600
*      request.  That is, the caller will receive control back after  * 00006700
*      the I/O is initiated, but possibly before the I/O physically   * 00006800
*      completes.  Even though the I/O may not be complete the        * 00006900
*      address space virtual storage can be immediately used upon     * 00007000
*      return.  The system will ensure that the correct data is       * 00007100
*      available when referenced.  CACHE reads and writes are always  * 00007200
*      done synchronously with the request.                           * 00007300
*                                                                     * 00007400
*      The following restrictions apply:                              * 00007500
*                                                                     * 00007600
*                                                                     * 00007700
*      1.  The HSPSERV read and write services cannot be used for a   * 00007800
*          hiperspace that is mapped as a DIV object.  A SCROLL type  * 00007900
*          hiperspace itself, however, may map a DIV object on        * 00008000
*          permanent storage.                                         * 00008100
*                                                                     * 00008200
*      2.  If a hiperspace maps a DIV object, then an SWRITE may not  * 00008300
*          be issued against any range in the hiperspace while a DIV  * 00008400
*          SAVE for any part of that range is current.  Furthermore,  * 00008500
*          if HSPALET is specified then neither SWRITE nor SREAD may  * 00008600
*          be issued against any portion of the hiperspace while a    * 00008700
*          DIV SAVE is current for any part of the hiperspace.        * 00008800
*                                                                     * 00008900
*      3.  All READ and WRITE calls for a non-shared SCROLL type      * 00009000
*          hiperspace must be done while in non-cross memory mode     * 00009100
*          (i.e., home=primary=secondary), except when the HSPALET    * 00009200
*          keyword is used.  The caller's home and primary address    * 00009300
*          spaces may be different for all READs and WRITEs to a      * 00009400
*          shared SCROLL type hiperspace, independent of the HSPALET  * 00009500
*          keyword.                                                   * 00009600
*                                                                     * 00009700
*          Regardless of whether the SCROLL type hiperspace is shared * 00009800
*          or non-shared and whether or not HSPALET is specified, the * 00009900
*          virtual storage in the address space must be in a private  * 00010000
*          area subpool in the caller's home address space.           * 00010100
*                                                                     * 00010200
*          For a READ or WRITE against a CACHE type hiperspace, the   * 00010300
*          caller's home address space may be different from the      * 00010400
*          caller's primary address space. In this case, the          * 00010500
*          specified virtual storage in the address space may be in a * 00010600
*          private area subpool of the caller's primary address space * 00010700
*          in lieu of the private area in the caller's home address   * 00010800
*          space or in the Common Storage Area (CSA).                 * 00010900
*                                                                     * 00011000
*      4.  The address space virtual for a SCROLL type hiperspace     * 00011100
*          must be from a non-DREF private area subpool and cannot be * 00011200
*          page fixed.  For a CACHE type hiperspace, the address      * 00011300
*          space virtual may be from a private area subpool (DREF or  * 00011400
*          non-DREF) or from the common area, but not both on the     * 00011500
*          same invocation.  It may be page fixed. For both types of  * 00011600
*          hiperspaces, the address space virtual cannot be part of a * 00011700
*          VIO window nor may it map a DIV object.                    * 00011800
*                                                                     * 00011900
*          Unless the caller is executing with PSW key zero, the      * 00012000
*          access key of the address space virtual will be compared   * 00012100
*          with the caller's PSW key.  If there is a mismatch, an     * 00012200
*          SREAD, SWRITE, or CREAD request will not be honored. A     * 00012300
*          CWRITE request, on a key mismatch, will be honored only if * 00012400
*          the address space virtual storage is not fetch protected.  * 00012500
*                                                                     * 00012600
*          NOTE: On a key mismatch an SWRITE is not honored even if   * 00012700
*          the address space virtual storage is not fetch protected   * 00012800
*          because an SWRITE, as explained later, is a destructive    * 00012900
*          write.                                                     * 00013000
*                                                                     * 00013100
*      5.  If the specified hiperspace is a non-shared SCROLL type    * 00013200
*          and HSPALET is not specified, then any non-authorized      * 00013300
*          (problem program, PSW key 8-F) HSPSERV caller must run     * 00013400
*          under the task that owns the hiperspace.  If HSPALET is    * 00013500
*          specified or the caller is authorized, the hiperspace may  * 00013600
*          be owned by any task within the caller's home address      * 00013700
*          space.                                                     * 00013800
*                                                                     * 00013900
*          If the specified hiperspace is a CACHE type or a shared    * 00014000
*          SCROLL type, it may be owned by any task in the system     * 00014100
*          provided that any one of the following is true:            * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*          o   the owner is in the caller's home address space        * 00014500
*                                                                     * 00014600
*          o   the owner is in the caller's primary address space     * 00014700
*                                                                     * 00014800
*          o   the owner is in a non-swappable address space.         * 00014900
*                                                                     * 00015000
*                                                                     * 00015100
*                                                                     * 00015200
*          Unless the caller is executing with PSW key zero, the      * 00015300
*          access key of the hiperspace will be compared with the     * 00015400
*          caller's PSW key.  If there is a mismatch, an SWRITE or    * 00015500
*          CWRITE request or an SREAD with RELEASE request will not   * 00015600
*          be honored. An SREAD (without RELEASE) or a CREAD request, * 00015700
*          on a key mismatch, will be honored only if the hiperspace  * 00015800
*          was created with fetch protection off.                     * 00015900
*                                                                     * 00016000
*      6.  The specified VSA of both the hiperspace and the address   * 00016100
*          space must be on a 4k boundary.  Data can only be moved in * 00016200
*          units of 4k bytes.                                         * 00016300
*                                                                     * 00016400
*                                                                     * 00016500
*                                                                     * 00016600
*      REGISTER USAGE:                                                * 00016700
*                                                                     * 00016800
*                                                                     * 00016900
*   GPRs 2 through 13 and ARs 2 through 13 are preserved.  GPRs 14    * 00017000
*   through 1 and ARs 14 through 1 are unpredictable.                 * 00017100
*                                                                     * 00017200
*01* ENVIRONMENT:                                                     * 00017300
*                                                                     * 00017400
*                                                                     * 00017500
*      Dispatchable unit mode: Task or SRB mode.                      * 00017600
*                                                                     * 00017700
*      Minimum authorization: Problem or Supervisor state.  Any PSW   * 00017800
*                        key.                                         * 00017900
*                                                                     * 00018000
*                        In order to do a CREAD or CWRITE, the caller * 00018100
*                        must be executing in supervisor state and/or * 00018200
*                        with a system key (0-7).                     * 00018300
*                                                                     * 00018400
*      AMODE:            31-bit.                                      * 00018500
*                                                                     * 00018600
*      ASC mode:         Primary or Access Register.                  * 00018700
*                                                                     * 00018800
*      Serialization:                                                 * 00018900
*                                                                     * 00019000
*                        SCROLL type hiperspace calls must be issued  * 00019100
*                        while enabled and unlocked.                  * 00019200
*                                                                     * 00019300
*                        CACHE type hiperspace calls may be issued    * 00019400
*                        while enabled or disabled.  Locks below the  * 00019500
*                        RSM lock in the locking hierarchy may be     * 00019600
*                        held. The RSM lock and any locks higher than * 00019700
*                        the RSM lock may not be held.                * 00019800
*                                                                     * 00019900
*      Restrictions:     For a CACHE type hiperspace, the input       * 00020000
*                        parameter list, range list, and, if HSPALET  * 00020100
*                        was specified, work area must be in          * 00020200
*                        non-pageable storage and be either in the    * 00020300
*                        common area or in the private area of the    * 00020400
*                        caller's primary address space.              * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*                                                                     * 00020800
*01* SYNTAX:                                                          * 00020900
*                                                                     * 00021000
*[xlabel]  HSPSERV   [ PLISTVER                                       * 00021100
*                               =xplistver|IMPLIED_VERSION]         * 00021200
*                    ,SREAD                                          * 00021300
*                   |     ,STOKEN=xstoken                             * 00021400
*                   |    [,NUMRANGE=xnumrange|1]                    * 00021500
*                   |     ,RANGLIST=xranglist                         * 00021600
*                   |   [,RELEASE=NO                                 * 00021700
*                   |   |    [,HSPALET=xhspalet|0]]                 * 00021800
*                   |   [,RELEASE=YES]                               * 00021900
*                    ,SWRITE                                         * 00022000
*                   |     ,STOKEN=xstoken                             * 00022100
*                   |    [,NUMRANGE=xnumrange|1]                    * 00022200
*                   |     ,RANGLIST=xranglist                         * 00022300
*                   |    [,HSPALET=xhspalet|0]                      * 00022400
*                    ,CREAD                                          * 00022500
*                   |     ,STOKEN=xstoken                             * 00022600
*                   |    [,ADDRSP=HOME|PRIMARY|COMMON]              * 00022700
*                   |    [,NUMRANGE=xnumrange|1]                    * 00022800
*                   |     ,RANGLIST=xranglist                         * 00022900
*                   |    [,HSPALET=xhspalet|0]                      * 00023000
*                    ,CWRITE                                         * 00023100
*                         ,STOKEN=xstoken                             * 00023200
*                        [,ADDRSP=HOME|PRIMARY|COMMON]              * 00023300
*                        [,NUMRANGE=xnumrange|1]                    * 00023400
*                         ,RANGLIST=xranglist                         * 00023500
*                        [,KEEP=YES|NO]                             * 00023600
*                        [,HSPALET=xhspalet|0]                      * 00023700
*                    [,RETCODE=xretcode]                              * 00023800
*                    [,RSNCODE=xrsncode]                              * 00023900
*                   [,MF=S]                                          * 00024000
*                   [,MF=(L,xmfctrl,xmfattr|0D)]                   * 00024100
*                   [,MF=(M,xmfctrl,COMPLETE|NOCHECK)]             * 00024200
*                   [,MF=(E,xmfctrl,COMPLETE|NOCHECK)]             * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*      Where:                                                         * 00024600
*                                                                     * 00024700
*                                                                     * 00024800
*      [xlabel]                                                       * 00024900
*          is an optional symbol, starting in column 1, that is the   * 00025000
*          name on the HSPSERV macro invocation.  The name must       * 00025100
*          conform to the rules for an ordinary assembler language    * 00025200
*          symbol.                                                    * 00025300
*          DEFAULT: No name.                                          * 00025400
*                                                                     * 00025500
*                                                                     * 00025600
*                                                                     * 00025700
*                                                                     * 00025800
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00025900
*          is an optional byte input decimal value in the "0-1" range * 00026000
*          that specifies the macro version.  PLISTVER is the only    * 00026100
*          key allowed on the list form of MF and determines which    * 00026200
*          parameter list is generated (see Macro USAGE NOTE 2).  The * 00026300
*          macro keys associated with each supported version of the   * 00026400
*          macro are listed in MACRO USAGE NOTE 3.                    * 00026500
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00026600
*          default is the lowest version which allows all of the      * 00026700
*          parameters specified on the invocation to be processed.    * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*                                                                     * 00027200
*      The following is a set of mutually exclusive keys.  This set   * 00027300
*      is required; only one key must be specified.                   * 00027400
*                                                                     * 00027500
*                                                                     * 00027600
*      SREAD                                                          * 00027700
*          is a keyword used to request that data be read from a      * 00027800
*          SCROLL hiperspace.                                         * 00027900
*                                                                     * 00028000
*          For a SCROLL type hiperspace, the data is always           * 00028100
*          retrievable (compare to CACHE type), but may or may not be * 00028200
*          read synchronously with the request.  That is, if physical * 00028300
*          I/O is required to satisfy the request, it may not be      * 00028400
*          complete when control is returned to the caller.  The      * 00028500
*          caller may, however, always reference the data immediately * 00028600
*          upon return from SREAD.  The system will automatically     * 00028700
*          ensure that the correct data is presented.                 * 00028800
*                                                                     * 00028900
*                                                                     * 00029000
*          STOKEN=xstoken                                             * 00029100
*              is the name (RS-type), or address in register          * 00029200
*              (2)-(12), of a required 8 character input variable     * 00029300
*              that contains the STOKEN for the SCROLL hiperspace     * 00029400
*              from which the data is to be read.  For non-authorized * 00029500
*              callers, the hiperspace must be owned by the           * 00029600
*              requesting task.  For authorized callers (supervisor   * 00029700
*              state and/or system key), the owner of the hiperspace  * 00029800
*              may be any task within the caller's home address       * 00029900
*              space.  For non-zero PSW key callers, the hiperspace   * 00030000
*              storage access key must be the same as the caller's    * 00030100
*              PSW key or, if RELEASE=YES is not specified, the       * 00030200
*              hiperspace must have been created with fetch           * 00030300
*              protection off.  For non-zero PSW key callers, if      * 00030400
*              RELEASE=YES is specified, then the keys must match.    * 00030500
*                                                                     * 00030600
*                                                                     * 00030700
*                                                                     * 00030800
*                                                                     * 00030900
*          [NUMRANGE=xnumrange|1]                                   * 00031000
*              is the name (RS-type), or address in register          * 00031100
*              (2)-(12), of an optional fullword input that specifies * 00031200
*              the number of entries in the supplied range list.  The * 00031300
*              range list is used to specify one or more virtual      * 00031400
*              storage ranges which are to be read from the           * 00031500
*              hiperspace to the address space.  The value specified  * 00031600
*              must be a positive integer between 1 and 50.           * 00031700
*                                                                     * 00031800
*              DEFAULT: 1.                                            * 00031900
*              If NUMRANGE is omitted, then only one virtual range    * 00032000
*              will be read                                           * 00032100
*                                                                     * 00032200
*                                                                     * 00032300
*                                                                     * 00032400
*                                                                     * 00032500
*          RANGLIST=xranglist                                         * 00032600
*              is the name (RS-type), or address in register          * 00032700
*              (2)-(12), of a required 4 byte input that contains the * 00032800
*              address of a range list.  The range list consists of a * 00032900
*              number of entries (as specified by NUMRANGE) where     * 00033000
*              each entry specifies the address of the SREAD source   * 00033100
*              in the hiperspace, the SREAD target address in the     * 00033200
*              address space, and the number of blocks (4K bytes) to  * 00033300
*              be read.                                               * 00033400
*                                                                     * 00033500
*              More specifically, each entry consists of three words  * 00033600
*              as follows:                                            * 00033700
*                                                                     * 00033800
*                                                                     * 00033900
*  FIRST WORD    contains the starting virtual address in the address * 00034000
*                space into which the data is to be read.  The        * 00034100
*                specified address must be on a 4k boundary.  Unless  * 00034200
*                the caller is executing with a zero PSW key, the     * 00034300
*                access key of the address space storage must be the  * 00034400
*                same as the caller's PSW key.                        * 00034500
*                                                                     * 00034600
*                The specified virtual storage must be from a         * 00034700
*                non-DREF private area subpool.  At the time of the   * 00034800
*                request none of the area may be fixed, be part of a  * 00034900
*                VIO window, or map a DIV object.                     * 00035000
*                                                                     * 00035100
*  SECOND WORD   contains the starting virtual address in the         * 00035200
*                hiperspace from which the SREAD is to be initiated.  * 00035300
*                The specified virtual address must be on a 4K        * 00035400
*                boundary.                                            * 00035500
*                                                                     * 00035600
*  THIRD WORD    contains the number of blocks (4K bytes) to be read  * 00035700
*                from the hiperspace.                                 * 00035800
*                                                                     * 00035900
*                                                                     * 00036000
*                                                                     * 00036100
*  The range list must be addressable in the caller's primary address * 00036200
*  space.                                                             * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*                                                                     * 00036700
*          [RELEASE=NO|YES]                                         * 00036800
*              is an optional keyword input that indicates whether or * 00036900
*              not the specified hiperspace pages should or should    * 00037000
*              not be released.                                       * 00037100
*              DEFAULT: NO                                            * 00037200
*                                                                     * 00037300
*                                                                     * 00037400
*              [RELEASE=NO                                            * 00037500
*                  specifies that the hiperspace pages should not be  * 00037600
*                  discarded after the read.  The same data will be   * 00037700
*                  available again on a subsequent SREAD assuming     * 00037800
*                  that it was not changed by an intervening SWRITE.  * 00037900
*                                                                     * 00038000
*                                                                     * 00038100
*                  [HSPALET=xhspalet|0]]                            * 00038200
*                      is the name (RS-type), or address in register  * 00038300
*                      (2)-(12), of an optional fullword input        * 00038400
*                      variable that contains the ALET for the        * 00038500
*                      source hiperspace.  The ALET must be for a     * 00038600
*                      hiperspace on the caller's current DU or PASN  * 00038700
*                      access list.  HSPALET must be specified if the * 00038800
*                      caller is a non-authorized caller and is       * 00038900
*                      accessing a shared scroll type hiperspace.     * 00039000
*                      Otherwise it is optional.                      * 00039100
*                                                                     * 00039200
*                      DEFAULT: 0 (Only if HSPALET is omitted.  If    * 00039300
*                      HSPALET is specified then a value must be      * 00039400
*                      provided.)                                     * 00039500
*                                                                     * 00039600
*                                                                     * 00039700
*                                                                     * 00039800
*              [RELEASE=YES]                                          * 00039900
*                  specifies that the data in the hiperspace, after   * 00040000
*                  the read, may be discarded.  This enables the      * 00040100
*                  system to free the resources which were used to    * 00040200
*                  back the hiperspace page.                          * 00040300
*                                                                     * 00040400
*                                                                     * 00040500
*                                                                     * 00040600
*                                                                     * 00040700
*                                                                     * 00040800
*      SWRITE                                                         * 00040900
*          is a keyword used to request that data be written to a     * 00041000
*          SCROLL hiperspace.                                         * 00041100
*                                                                     * 00041200
*          The write may or may not be done synchronously with the    * 00041300
*          request.  That is, if physical I/O is required to satisfy  * 00041400
*          the request, it may not be complete when control is        * 00041500
*          returned the caller.  Upon return from the SWRITE, the     * 00041600
*          data in the specified address space is unpredictable.  The * 00041700
*          virtual area, however, is available for immediate reuse.   * 00041800
*                                                                     * 00041900
*                                                                     * 00042000
*          STOKEN=xstoken                                             * 00042100
*              is the name (RS-type), or address in register          * 00042200
*              (2)-(12), of a required 8 character input variable     * 00042300
*              that contains the STOKEN for the SCROLL hiperspace     * 00042400
*              into which the data is to be written.  For             * 00042500
*              non-authorized callers, the hiperspace must be owned   * 00042600
*              by the requesting task.  For authorized callers        * 00042700
*              (supervisor state and/or system key), the owner of the * 00042800
*              hiperspace may be any task within the caller's home    * 00042900
*              address space.  For non-zero PSW key callers, the      * 00043000
*              hiperspace storage access key must be the same as the  * 00043100
*              caller's PSW key.                                      * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*                                                                     * 00043600
*          [NUMRANGE=xnumrange|1]                                   * 00043700
*              is the name (RS-type), or address in register          * 00043800
*              (2)-(12), of an optional fullword input that specifies * 00043900
*              the number of entries in the supplied range list.  The * 00044000
*              range list is used to specify one or more virtual      * 00044100
*              storage ranges which are to be written to a hiperspace * 00044200
*              from an address space.  The value specified must be a  * 00044300
*              positive integer between 1 and 50.                     * 00044400
*                                                                     * 00044500
*              DEFAULT: 1.                                            * 00044600
*              If NUMRANGE is omitted, then only one virtual range    * 00044700
*              will be written.                                       * 00044800
*                                                                     * 00044900
*                                                                     * 00045000
*                                                                     * 00045100
*                                                                     * 00045200
*          RANGLIST=xranglist                                         * 00045300
*              is the name (RS-type), or address in register          * 00045400
*              (2)-(12), of a required 4 byte input that contains the * 00045500
*              address of a range list.  The range list consists of a * 00045600
*              number of entries (as specified by NUMRANGE) where     * 00045700
*              each entry specifies the address of the SWRITE source  * 00045800
*              in the address space, the SWRITE target address in the * 00045900
*              hiperspace, and the number of blocks (4K bytes) to be  * 00046000
*              written.                                               * 00046100
*                                                                     * 00046200
*              More specifically, each entry consists of three words  * 00046300
*              as follows:                                            * 00046400
*                                                                     * 00046500
*                                                                     * 00046600
*  FIRST WORD    contains the starting virtual address in the address * 00046700
*                space from which the write is to be initiated.  The  * 00046800
*                specified address must be on a 4K boundary.  If the  * 00046900
*                caller's PSW key is not zero, then The caller's PSW  * 00047000
*                key must match the access key of the virtual         * 00047100
*                storage.                                             * 00047200
*                                                                     * 00047300
*                The specified virtual storage must be from a         * 00047400
*                non-DREF private area subpool.  At the time of the   * 00047500
*                request none of the area may be fixed, be part of a  * 00047600
*                VIO window, or map a DIV object.                     * 00047700
*                                                                     * 00047800
*  SECOND WORD   contains the starting virtual address in the         * 00047900
*                hiperspace into which the data is to be written.     * 00048000
*                The specified address must be on a 4K boundary.      * 00048100
*                                                                     * 00048200
*  THIRD WORD    contains the number of blocks (4K bytes) to be       * 00048300
*                written to the hiperspace.                           * 00048400
*                                                                     * 00048500
*                                                                     * 00048600
*                                                                     * 00048700
*  The range list must be addressable in the caller's primary address * 00048800
*  space.                                                             * 00048900
*                                                                     * 00049000
*                                                                     * 00049100
*                                                                     * 00049200
*                                                                     * 00049300
*          [HSPALET=xhspalet|0]                                     * 00049400
*              is the name (RS-type), or address in register          * 00049500
*              (2)-(12), of an optional fullword input variable that  * 00049600
*              contains the ALET for the  target hiperspace.  The     * 00049700
*              ALET must be for a hiperspace on the caller's current  * 00049800
*              DU or PASN access list.  HSPALET must be specified if  * 00049900
*              the caller is a non-authorized caller and is accessing * 00050000
*              a shared scroll type hiperspace.  Otherwise it is      * 00050100
*              optional.                                              * 00050200
*                                                                     * 00050300
*              DEFAULT: 0 (Only if HSPALET is omitted.  If HSPALET is * 00050400
*              specified then a value must be provided.)              * 00050500
*                                                                     * 00050600
*                                                                     * 00050700
*                                                                     * 00050800
*      CREAD                                                          * 00050900
*          is a keyword used to request that data be read from a      * 00051000
*          CACHE hiperspace.                                          * 00051100
*                                                                     * 00051200
*          If all blocks requested to be read are available in the    * 00051300
*          hiperspace, then the read will be satisfied synchronously  * 00051400
*          with the request.  That is, immediately upon return from   * 00051500
*          the CREAD service, the data is available for reference in  * 00051600
*          the specified address space.  On the other hand, if one or * 00051700
*          more of the blocks to be read are no longer available in   * 00051800
*          the hiperspace, then a failing return code will be         * 00051900
*          returned (see return code 08 below).  What blocks are      * 00052000
*          successfully read, if any, is indeterminate.               * 00052100
*                                                                     * 00052200
*                                                                     * 00052300
*          STOKEN=xstoken                                             * 00052400
*              is the name (RS-type), or address in register          * 00052500
*              (2)-(12), of a required 8 character input variable     * 00052600
*              that contains the STOKEN for the CACHE hiperspace from * 00052700
*              which the data is to be read.  The owner of the        * 00052800
*              hiperspace may be any task in the system provided that * 00052900
*              that task is in the caller's home address space, in    * 00053000
*              the caller's primary address space, or in a            * 00053100
*              non-swappable address space.  For non-zero PSW key     * 00053200
*              caller's, the hiperspace storage access key must be    * 00053300
*              the same as the caller's PSW key or the hiperspace     * 00053400
*              must have been created with fetch protection off.      * 00053500
*                                                                     * 00053600
*                                                                     * 00053700
*                                                                     * 00053800
*                                                                     * 00053900
*          [ADDRSP=HOME|PRIMARY|COMMON]                             * 00054000
*              is an optional keyword input that specifies the        * 00054100
*              location of the virtual storage range into which the   * 00054200
*              data is to be read.                                    * 00054300
*                                                                     * 00054400
*              DEFAULT: HOME                                          * 00054500
*                                                                     * 00054600
*                                                                     * 00054700
*              HOME      specifies that the data is to be read from   * 00054800
*                        the hiperspace to the caller's home address  * 00054900
*                        space.                                       * 00055000
*                                                                     * 00055100
*              PRIMARY   specifies that the data is to be read from   * 00055200
*                        the hiperspace to the caller's primary       * 00055300
*                        address space.                               * 00055400
*                                                                     * 00055500
*              COMMON    specifies that the data is to be read from   * 00055600
*                        the hiperspace to the common area.           * 00055700
*                                                                     * 00055800
*                                                                     * 00055900
*                                                                     * 00056000
*                                                                     * 00056100
*                                                                     * 00056200
*                                                                     * 00056300
*          [NUMRANGE=xnumrange|1]                                   * 00056400
*              is the name (RS-type), or address in register          * 00056500
*              (2)-(12), of an optional fullword input that specifies * 00056600
*              the number of entries in the supplied range list.  The * 00056700
*              range list is used to specify one or more virtual      * 00056800
*              storage ranges which are to be read from the           * 00056900
*              hiperspace to the address space.  The value specified  * 00057000
*              must be a positive integer between 1 and 50.           * 00057100
*                                                                     * 00057200
*              DEFAULT: 1.                                            * 00057300
*              If NUMRANGE is omitted, then only one virtual range    * 00057400
*              will be read.                                          * 00057500
*                                                                     * 00057600
*                                                                     * 00057700
*                                                                     * 00057800
*                                                                     * 00057900
*          RANGLIST=xranglist                                         * 00058000
*              is the name (RS-type), or address in register          * 00058100
*              (2)-(12), of a required 4 byte input that contains the * 00058200
*              address of a range list.  The range list consists of a * 00058300
*              number of entries (as specified by NUMRANGE) where     * 00058400
*              each entry specifies the address of the CREAD source   * 00058500
*              in the hiperspace, the CREAD target address in the     * 00058600
*              address space, and the number of blocks (4K bytes) to  * 00058700
*              be read.                                               * 00058800
*                                                                     * 00058900
*              More specifically, each entry consists of three words  * 00059000
*              as follows:                                            * 00059100
*                                                                     * 00059200
*                                                                     * 00059300
*  FIRST WORD    contains the starting virtual address in the address * 00059400
*                space into which the data is to be read.  The        * 00059500
*                specified address must be on a 4k boundary.  Unless  * 00059600
*                the caller is executing with a zero PSW key, the     * 00059700
*                access key of the address space storage must be the  * 00059800
*                same as the caller's PSW key.                        * 00059900
*                                                                     * 00060000
*                The specified virtual storage vannot be part of a    * 00060100
*                VIO window nor map a DIV object.                     * 00060200
*                                                                     * 00060300
*  SECOND WORD   contains the starting virtual address in the         * 00060400
*                hiperspace from which the CREAD is to be initiated.  * 00060500
*                The specified virtual address must be on a 4K        * 00060600
*                boundary.                                            * 00060700
*                                                                     * 00060800
*  THIRD WORD    contains the number of blocks (4K bytes) to be read  * 00060900
*                from the hiperspace.                                 * 00061000
*                                                                     * 00061100
*                                                                     * 00061200
*                                                                     * 00061300
*  The range list must be addressable in the caller's primary address * 00061400
*  space.                                                             * 00061500
*                                                                     * 00061600
*                                                                     * 00061700
*                                                                     * 00061800
*                                                                     * 00061900
*          [HSPALET=xhspalet|0]                                     * 00062000
*              is the name (RS-type), or address in register          * 00062100
*              (2)-(12), of an optional fullword input variable that  * 00062200
*              contains the ALET for the  source hiperspace.  The     * 00062300
*              ALET must be for a hiperspace on the caller's current  * 00062400
*              DU or PASN access list.                                * 00062500
*                                                                     * 00062600
*              DEFAULT: 0 (Only if HSPALET is omitted.  If HSPALET is * 00062700
*              specified then a value must be provided.)              * 00062800
*                                                                     * 00062900
*                                                                     * 00063000
*                                                                     * 00063100
*      CWRITE                                                         * 00063200
*          is a keyword used to request that data be written to a     * 00063300
*          CACHE hiperspace.                                          * 00063400
*                                                                     * 00063500
*          All writes are done synchronously with the request.  Upon  * 00063600
*          return, the write will be complete and, if KEEP=YES is not * 00063700
*          specified, the data in the specified address space will be * 00063800
*          unaltered and available for reference.  If, for some       * 00063900
*          reason, all the blocks in the request cannot be written to * 00064000
*          the hiperspace, then none will be written and the request  * 00064100
*          will be rejected (see return code 08).  In this case, the  * 00064200
*          data in the hiperspace, for the specified range, is        * 00064300
*          inpredictable.  Therefore, after an unsuccessful write,    * 00064400
*          subsequent CREADs should not be issued against the failing * 00064500
*          hiperspace range of virtual storage until an intervening   * 00064600
*          CWRITE is successful.                                      * 00064700
*                                                                     * 00064800
*                                                                     * 00064900
*          STOKEN=xstoken                                             * 00065000
*              is the name (RS-type), or address in register          * 00065100
*              (2)-(12), of a required 8 character input variable     * 00065200
*              that contains the STOKEN for the CACHE hiperspace into * 00065300
*              which the data is to be written.  The owner of the     * 00065400
*              hiperspace may be any task in the system provided that * 00065500
*              that task is in the caller's home address space, in    * 00065600
*              the caller's primary address space, or in a            * 00065700
*              non-swappable address space.  For non-zero PSW key     * 00065800
*              caller's, the hiperspace storage access key must be    * 00065900
*              the same as the caller's PSW key.                      * 00066000
*                                                                     * 00066100
*                                                                     * 00066200
*                                                                     * 00066300
*                                                                     * 00066400
*          [ADDRSP=HOME|PRIMARY|COMMON]                             * 00066500
*              is an optional keyword input that specifies the        * 00066600
*              location of the virtual storage range from which the   * 00066700
*              data is to be written.                                 * 00066800
*                                                                     * 00066900
*              DEFAULT: HOME                                          * 00067000
*                                                                     * 00067100
*                                                                     * 00067200
*              HOME      specifies that the data is to be written     * 00067300
*                        from the caller's home address space to the  * 00067400
*                        hiperspace.                                  * 00067500
*                                                                     * 00067600
*              PRIMARY   specifies that the data is to be written     * 00067700
*                        from the caller's primary address space to   * 00067800
*                        the hiperspace.                              * 00067900
*                                                                     * 00068000
*              COMMON    specifies that the data is to be written     * 00068100
*                        from the common area to the hiperspace.      * 00068200
*                                                                     * 00068300
*                                                                     * 00068400
*                                                                     * 00068500
*                                                                     * 00068600
*                                                                     * 00068700
*                                                                     * 00068800
*          [NUMRANGE=xnumrange|1]                                   * 00068900
*              is the name (RS-type), or address in register          * 00069000
*              (2)-(12), of an optional fullword input that specifies * 00069100
*              the number of entries in the supplied range list.  The * 00069200
*              range list is used to specify one or more virtual      * 00069300
*              storage ranges which are to be written to a hiperspace * 00069400
*              from an address space.  The value specified must be a  * 00069500
*              positive integer between 1 and 50.                     * 00069600
*                                                                     * 00069700
*              DEFAULT: 1.                                            * 00069800
*              If NUMRANGE is omitted, then only one virtual range    * 00069900
*              will be written.                                       * 00070000
*                                                                     * 00070100
*                                                                     * 00070200
*                                                                     * 00070300
*                                                                     * 00070400
*          RANGLIST=xranglist                                         * 00070500
*              is the name (RS-type), or address in register          * 00070600
*              (2)-(12), of a required 4 byte input that contains the * 00070700
*              address of a range list.  The range list consists of a * 00070800
*              number of entries (as specified by NUMRANGE) where     * 00070900
*              each entry specifies the address of the CWRITE source  * 00071000
*              in the address space, the CWRITE target address in the * 00071100
*              hiperspace, and the number of blocks (4K bytes) to be  * 00071200
*              read.                                                  * 00071300
*                                                                     * 00071400
*              More specifically, each entry consists of three words  * 00071500
*              as follows:                                            * 00071600
*                                                                     * 00071700
*                                                                     * 00071800
*  FIRST WORD    contains the starting virtual address in the address * 00071900
*                space from which the write is to be initiated.  The  * 00072000
*                specified address must be on a 4K boundary.  If the  * 00072100
*                caller's PSW key is not zero and is not equal to the * 00072200
*                access key of the virtual storage then KEEP=NO       * 00072300
*                cannot be specified and the virtual storage cannot   * 00072400
*                be fetch protected.                                  * 00072500
*                                                                     * 00072600
*                The specified virtual storage vannot be part of a    * 00072700
*                VIO window nor map a DIV object.                     * 00072800
*                                                                     * 00072900
*  SECOND WORD   contains the starting virtual address in the         * 00073000
*                hiperspace into which the data is to be written.     * 00073100
*                The specified address must be on a 4K boundary.      * 00073200
*                                                                     * 00073300
*  THIRD WORD    contains the number of blocks (4K bytes) to be       * 00073400
*                written to the hiperspace.                           * 00073500
*                                                                     * 00073600
*                                                                     * 00073700
*                                                                     * 00073800
*  The range list must be addressable in the caller's primary address * 00073900
*  space.                                                             * 00074000
*                                                                     * 00074100
*                                                                     * 00074200
*                                                                     * 00074300
*                                                                     * 00074400
*          [KEEP=YES|NO]                                            * 00074500
*              is an optional keyword input that specifies whether or * 00074600
*              not the data should be kept in the virtual storage of  * 00074700
*              the address space after the CWRITE.                    * 00074800
*              DEFAULT: YES                                           * 00074900
*                                                                     * 00075000
*                                                                     * 00075100
*              YES       specifies that the the source data is to be  * 00075200
*                        kept in the virtual storage of the address   * 00075300
*                        space following the CWRITE.                  * 00075400
*                                                                     * 00075500
*              NO        specifies that the source data need not be   * 00075600
*                        kept in the virtual storage of the address   * 00075700
*                        space following the CWRITE. In certain       * 00075800
*                        cases, depending upon the environment, a     * 00075900
*                        KEEP=NO CWRITE will have better performance  * 00076000
*                        than a KEEP=YES CWRITE.  Consequently, it is * 00076100
*                        better to use KEEP=NO on CWRITE in those     * 00076200
*                        instances when it is intended to overlay the * 00076300
*                        address space virtual storage with new data  * 00076400
*                        following a CWRITE.                          * 00076500
*                                                                     * 00076600
*                                                                     * 00076700
*                                                                     * 00076800
*                                                                     * 00076900
*                                                                     * 00077000
*                                                                     * 00077100
*          [HSPALET=xhspalet|0]                                     * 00077200
*              is the name (RS-type), or address in register          * 00077300
*              (2)-(12), of an optional fullword input variable that  * 00077400
*              contains the ALET for the  target hiperspace.  The     * 00077500
*              ALET must be for a hiperspace on the caller's current  * 00077600
*              DU or PASN access list.                                * 00077700
*                                                                     * 00077800
*              DEFAULT: 0 (Only if HSPALET is omitted.  If HSPALET is * 00077900
*              specified then a value must be provided.)              * 00078000
*                                                                     * 00078100
*                                                                     * 00078200
*                                                                     * 00078300
*                                                                     * 00078400
*                                                                     * 00078500
*      End of a set of mutually exclusive required keys.              * 00078600
*                                                                     * 00078700
*                                                                     * 00078800
*                                                                     * 00078900
*      [RETCODE=xretcode]                                             * 00079000
*          is the name (RS-type) of an optional fullword output       * 00079100
*          variable, or register (2)-(12), into which the return code * 00079200
*          is to be copied from GPR 15.                               * 00079300
*                                                                     * 00079400
*                                                                     * 00079500
*                                                                     * 00079600
*                                                                     * 00079700
*      [RSNCODE=xrsncode]                                             * 00079800
*          is the name (RS-type) of an optional 4 character output    * 00079900
*          variable, or register (2)-(12), into which the reason code * 00080000
*          is to be copied from GPR 0.                                * 00080100
*                                                                     * 00080200
*                                                                     * 00080300
*                                                                     * 00080400
*                                                                     * 00080500
*      [MF=S|L|M|E]                                                 * 00080600
*          is an optional keyword input which specifies the macro     * 00080700
*          form.                                                      * 00080800
*          DEFAULT: S                                                 * 00080900
*                                                                     * 00081000
*                                                                     * 00081100
*          [MF=S]                                                     * 00081200
*              specifies the standard form of the macro.  The "S"     * 00081300
*              form generates code to put the parameters into an      * 00081400
*              in-line parameter list and invoke the desired service. * 00081500
*              Full checking for required macro keys is done along    * 00081600
*              with supplying defaults for omitted optional           * 00081700
*              parameters.                                            * 00081800
*                                                                     * 00081900
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00082000
*              specifies the list form of the macro.  The "L" form    * 00082100
*              defines an area to be used for the parameter list.     * 00082200
*              Only the PLISTVER key may be specified on the          * 00082300
*              invocation.  All other macro parameters are flagged as * 00082400
*              errors.  If PLISTVER is not specified, the original    * 00082500
*              parameter list definition is used.                     * 00082600
*                                                                     * 00082700
*            ,xmfctrl                                                 * 00082800
*              is a required input.  It is the name of a storage area * 00082900
*              for the parameter list.                                * 00083000
*                                                                     * 00083100
*            ,xmfattr|0D                                            * 00083200
*              is an optional 60 character input string that varies   * 00083300
*              from 1 to 60 characters. It can contain any value that * 00083400
*              is valid on an assembler DS pseudo-op. You can use     * 00083500
*              this parameter to force boundary alignment of the      * 00083600
*              parameter list.                                        * 00083700
*              DEFAULT: 0D which forces the parameter list to a       * 00083800
*              doubleword boundary.                                   * 00083900
*                                                                     * 00084000
*          [MF(M,xmfctrl,COMPLETE|NOCHECK)]                         * 00084100
*              specifies the modify form of the macro.  The "M" form  * 00084200
*              generates code to put the parameters into the          * 00084300
*              parameter list specified by xmfctrl.                   * 00084400
*                                                                     * 00084500
*            ,xmfctrl                                                 * 00084600
*              is a required input.  It is the name (RS-type), or     * 00084700
*              address in register (1)-(12), of a storage area for    * 00084800
*              the parameter list.                                    * 00084900
*                                                                     * 00085000
*            ,COMPLETE|NOCHECK]                                     * 00085100
*              is an optional keyword input which specifies the       * 00085200
*              degree of macro parameter syntax checking.             * 00085300
*              DEFAULT: COMPLETE                                      * 00085400
*                                                                     * 00085500
*                                                                     * 00085600
*              COMPLETE   Checking for required macro keys is done    * 00085700
*                        and defaults are supplied for omitted        * 00085800
*                        optional parameters.  (See Macro Usage Note  * 00085900
*                        2).                                          * 00086000
*                                                                     * 00086100
*              NOCHECK   Checking for required macro keys is not done * 00086200
*                        nor are defaults supplied for omitted        * 00086300
*                        optional parameters.                         * 00086400
*                                                                     * 00086500
*                                                                     * 00086600
*                                                                     * 00086700
*          [MF=(E,xmfctrl,COMPLETE|NOCHECK)]                        * 00086800
*              specifies the execute form of the macro.  The "E" form * 00086900
*              generates code to put the parameters into the          * 00087000
*              parameter list specified by xmfctrl and invoke the     * 00087100
*              desired service.                                       * 00087200
*                                                                     * 00087300
*            ,xmfctrl                                                 * 00087400
*              is a required input.  It is the name (RS-type), or     * 00087500
*              address in register (1)-(12), of a storage area for    * 00087600
*              the parameter list.                                    * 00087700
*                                                                     * 00087800
*            ,COMPLETE|NOCHECK                                      * 00087900
*              is an optional keyword input which specifies the       * 00088000
*              degree of macro parameter syntax checking.             * 00088100
*              DEFAULT: COMPLETE                                      * 00088200
*                                                                     * 00088300
*                                                                     * 00088400
*              COMPLETE   Checking for required macro keys is done    * 00088500
*                        and defaults are supplied for omitted        * 00088600
*                        optional parameters.  (See Macro Usage Note  * 00088700
*                        2).                                          * 00088800
*                                                                     * 00088900
*              NOCHECK   Checking for required macro keys is not done * 00089000
*                        nor are defaults supplied for omitted        * 00089100
*                        optional parameters.                         * 00089200
*                                                                     * 00089300
*                                                                     * 00089400
*                                                                     * 00089500
*                                                                     * 00089600
*                                                                     * 00089700
*                                                                     * 00089800
*                                                                     * 00089900
*01* RETURN CODES:                                                    * 00090000
*                                                                     * 00090100
*                                                                     * 00090200
*            00   Successful completion                               * 00090300
*                                                                     * 00090400
*            04   Successful completion with exceptional              * 00090500
*                 circumstances                                       * 00090600
*                                                                     * 00090700
*            08   Request rejected.  (details in the returned reason  * 00090800
*                 code).                                              * 00090900
*                                                                     * 00091000
*            0C   System failure due to environmental problems.       * 00091100
*                                                                     * 00091200
*                                                                     * 00091300
*                                                                     * 00091400
*01* REASON CODES:                                                    * 00091500
*                                                                     * 00091600
*       In the following HSPSERV reason codes, "zz" will be 07 if     * 00091700
*       CREAD, 08 if CWRITE, 09 if SREAD, and 0A if SWRITE.  If the   * 00091800
*       service requested cannot be determined, then The bytes        * 00091900
*       indicated by "zz" will be FE.  The bytes designated "xx" are  * 00092000
*       for diagnostic purposes and have no significance to the       * 00092100
*       external interface.                                           * 00092200
*                                                                     * 00092300
*       REASON    RETURN                                              * 00092400
*       CODE      CODE      DESCRIPTION                               * 00092500
*                                          * 00092600
*                                                                     * 00092700
*                                                                     * 00092800
*       xxzz01xx  08        The  requested  hiperspace  data  is  not * 00092900
*                           available (CREAD only)                    * 00093000
*                                                                     * 00093100
*       xxzz02xx  08        The  request  cannot  be  serviced at the * 00093200
*                           current  time  because  the address space * 00093300
*                           page  has  been  paged-out  and cannot be * 00093400
*                           synchronously  paged-in  or  the  page is * 00093500
*                           marked   freshly  getmained  and  is  not * 00093600
*                           backed   in  real  (CWRITE  only).    The * 00093700
*                           HSPSERV request can be repeated after the * 00093800
*                           page is referenced.  Referencing the page * 00093900
*                           will cause it to be paged-in.             * 00094000
*                                                                     * 00094100
*       xxzz03xx  08        The  request  cannot  be  serviced at the * 00094200
*                           current time because the necessary system * 00094300
*                           resources  to service the request are not * 00094400
*                           currently available (CWRITE only).        * 00094500
*                                                                     * 00094600
*       xxzz04xx  08        The  request  cannot  be  serviced at the * 00094700
*                           current    time   because   the   current * 00094800
*                           environment    precludes    synchronously * 00094900
*                           servicing   of  the  request  (CREAD  and * 00095000
*                           CWRITE only).                             * 00095100
*                                                                     * 00095200
*       xxzz05xx  08        A  necessary  hiperspace  page  cannot be * 00095300
*                           accessed due to a system error.           * 00095400
*                                                                     * 00095500
*       xxzz06xx  08        A  necessary address space page cannot be * 00095600
*                           accessed due to a system error.           * 00095700
*                                                                     * 00095800
*                                                                     * 00095900
*                                                                     * 00096000
*01* ABEND CODES:                                                     * 00096100
*                                                                     * 00096200
*                                                                     * 00096300
*       01D       Hiperspace  service  failed  for  non-environmental * 00096400
*                 error.                                              * 00096500
*                                                                     * 00096600
*                                                                     * 00096700
*                                                                     * 00096800
*01* ABEND REASON CODES:                                              * 00096900
*                                                                     * 00097000
*       REASON    ABEND                                               * 00097100
*       CODE      CODE      DESCRIPTION                               * 00097200
*                                          * 00097300
*                                                                     * 00097400
*                                                                     * 00097500
*       xxzz07xx  01D       CREAD   or   CWRITE   requested   by   an * 00097600
*                           unauthorized caller.                      * 00097700
*                                                                     * 00097800
*       xxzz08xx  01D       The  indicated  address  space  does  not * 00097900
*                           exist or cannot be accessed by the caller * 00098000
*                           for the requested service.                * 00098100
*                                                                     * 00098200
*       xxzz09xx  01D       The  indicated  hiperspace does not exist * 00098300
*                           or  cannot  be accessed by the caller for * 00098400
*                           the  requested  service  which  could  be * 00098500
*                           caused  by  the  owner  of the hiperspace * 00098600
*                           being swapped out.                        * 00098700
*                                                                     * 00098800
*       xxzz0Axx  01D       Request type unrecognized.                * 00098900
*                                                                     * 00099000
*       xxzz0Bxx  01D       Storage  protect  key  violation  on  the * 00099100
*                           specified hiperspace virtual storage.     * 00099200
*                                                                     * 00099300
*       xxzz0Cxx  01D       The  indicated  address  space virtual is * 00099400
*                           not GETMAINed.                            * 00099500
*                                                                     * 00099600
*       xxzz0Dxx  01D       Storage  protect  key  violation  on  the * 00099700
*                           specified address space virtual storage.  * 00099800
*                                                                     * 00099900
*       xxzz0Exx  01D       The  specified  address space virtual did * 00100000
*                           not  start  on  a  4K boundary or was not * 00100100
*                           within the bounds of the private area.    * 00100200
*                                                                     * 00100300
*       xxzz0Fxx  01D       The  specified hiperspace virtual did not * 00100400
*                           start  on a 4K boundary or was not within * 00100500
*                           the bounds of the hiperspace.             * 00100600
*                                                                     * 00100700
*       xxzz10xx  01D       SREAD  or  SWRITE  issued against address * 00100800
*                           space  virtual  storage  that  maps a DIV * 00100900
*                           object,  is  VIO storage, is fixed, or is * 00101000
*                           part of a DERF subpool.                   * 00101100
*                                                                     * 00101200
*       xxzz11xx  01D       The  value specified for NUMRANGE was not * 00101300
*                           in the acceptable range.                  * 00101400
*                                                                     * 00101500
*       xxzz12xx  01D       SREAD   or   SWRITE   invoked   while  in * 00101600
*                           cross-memory mode.                        * 00101700
*                                                                     * 00101800
*       xxzz13xx  01D       SREAD   or   SWRITE   issued   against  a * 00101900
*                           non-SCROLL type hiperspace.               * 00102000
*                                                                     * 00102100
*       xxzz14xx  01D       Caller not in 31 bit addressing mode.     * 00102200
*                                                                     * 00102300
*       xxzz15xx  01D       Specified  parameter  list  or range list * 00102400
*                           not accessable.                           * 00102500
*                                                                     * 00102600
*       xxzz16xx  01D       Invalid parameter list version specified. * 00102700
*                                                                     * 00102800
*       xxzz17xx  01D       Parameter   list   contains   invalid  or * 00102900
*                           inconsistent                              * 00103000
*                                                                     * 00103100
*       xxzz18xx  01D       SWRITE  issued for a hiperspace range for * 00103200
*                           which a DIV SAVE is current.              * 00103300
*                                                                     * 00103400
*       xxzz19xx  01D       Unauthorized  user issued HSPSERV against * 00103500
*                           a   shared   scroll   hiperspace  without * 00103600
*                           supplying an ALET.                        * 00103700
*                                                                     * 00103800
*       xxzz1Axx  01D       The   supplied   ALET   is  not  for  the * 00103900
*                           hiperspace  indicated  by  the  specified * 00104000
*                           STOKEN.                                   * 00104100
*                                                                     * 00104200
*       xxzz1Bxx  01D       The address space page is page protected. * 00104300
*                                                                     * 00104400
*                                                                     * 00104500
*                                                                     * 00104600
*01* MODULE TYPE:  ASSEM MACRO                                        * 00104700
*                                                                     * 00104800
*02*   PROCESSOR:  ASSEM                                              * 00104900
*                                                                     * 00105000
*01* COMPONENT:  SC1CR                                                * 00105100
*                                                                     * 00105200
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00105300
*                                                                     * 00105400
*01* MACRO USAGE NOTES:                                               * 00105500
*                                                                     * 00105600
*                                                                     * 00105700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00105800
*        global macro variable.  Any value other than 'NO' will       * 00105900
*        result in the macro expansion being printed.  The default is * 00106000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00106100
*        variable should be set.                                      * 00106200
*                                                                     * 00106300
*                    GBLC &ZPRINT                                     * 00106400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00106500
*                                                                     * 00106600
*                                                                     * 00106700
*    2.  When using the NOCHECK option in conjunction with the Modify * 00106800
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00106900
*        Modify   or  Execute  form  invocation  which  specifies  or * 00107000
*        defaults  to  the  COMPLETE  option.   This insures that the * 00107100
*        parameter  list  is  initialized completely.   The parameter * 00107200
*        list  field which identifies the version number of the macro * 00107300
*        is only set when the Standard form or the Complete option of * 00107400
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00107500
*        explicitly  specified.  Be sure that the resulting parameter * 00107600
*        list version number covers all the keys that you use.        * 00107700
*                                                                     * 00107800
*                                                                     * 00107900
*    3.  The  HSPSERV macro supports multiple versions. The macro key * 00108000
*        list  below  contains the version level in which the key was * 00108100
*        first  introduced.  Positionals  are  identified by the word * 00108200
*        'Positional'  followed by the numeric value of its position. * 00108300
*        Nested  positionals  are  preceded  by their outer key.  The * 00108400
*        lowest value represents the original version and the highest * 00108500
*        value  represents  the  most  recent  version of the HSPSERV * 00108600
*        macro.    When  specifying  PLISTVER,  be sure that it is as * 00108700
*        least  as high as the highest version number of all the keys * 00108800
*        being used.                                                  * 00108900
*                                                                     * 00109000
*        VERSION   KEY                                                * 00109100
*                                                                     * 00109200
*              0      ADDRSP                                          * 00109300
*                     CREAD                                           * 00109400
*                     CWRITE                                          * 00109500
*                     KEEP                                            * 00109600
*                     NUMRANGE                                        * 00109700
*                     PLISTVER                                        * 00109800
*                     RANGLIST                                        * 00109900
*                     RELEASE                                         * 00110000
*                     SREAD                                           * 00110100
*                     STOKEN                                          * 00110200
*                     SWRITE                                          * 00110300
*              1      HSPALET                                         * 00110400
*                                                                     * 00110500
*                                                                     * 00110600
*                                                                     * 00110700
*01* CHANGE ACTIVITY:                                                 * 00110800
*                                                                     * 00110900
*   Flag LineItem  FMID    Date   ID    Comment                       * 00111000
*                                                                     * 00111100
*    $L0=HIPER    JBB3311 880210 PDAC:  Hiperspaces.                  * 00111200
*    $D1=DCR0013  JBB3311 880427 PDAC:  Keep Option.                  * 00111300
*    $L1=MVPGM14  JBB3313 890721 PDK1:  HSPALET option                * 00111400
*    $01=OY40152  JBB3311 910314 PD00W3:  Ensure owning address space * 00111500
*                                         is not swapped out when     * 00111600
*                                         data space or hiperspace is * 00111700
*                                         referenced.                 * 00111800
*    $P1=PKB1005  HBB4430 920731 PD00NL:  Ensure HPSERV SREAD/WRITE   * 00111900
*                                         can not change PGSER        * 00112000
*                                         protected storage.          * 00112100
*    $P2=PIG2843  HBB5510 930902 PD00HM:  Removed Highlight tags due  * 00112200
*                                         to assembler error.         * 00112300
*    $P3=PIG3765  HBB5510 931118 PD00JV:  Use AMG ZNDX variable for   * 00112400
*                                         parameter list generation.  * 00112500
****** END OF SPECIFICATIONS *****************************************/ 00112600
*/********************************************************************* 00112700
         MACRO                                                          00112800
&XLABEL  HSPSERV &PLISTVER=,&STOKEN=,&NUMRANGE=,&RANGLIST=,&RELEASE=,  *00112900
               &HSPALET=,&ADDRSP=,&KEEP=,&RETCODE=,&RSNCODE=,&MF=       00113000
.*                                                                      00113100
*              MACDATE -92/07/31-<1>                                    00113200
.*                                                                      00113300
.*******************************************************************    00113400
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00113500
.*******************************************************************    00113600
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00113700
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00113800
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00113900
.*                                                                      00114000
              GBLC  &ZHSPSERV   YES=MACRO USED AT LEAST ONCE            00114100
.*******************************************************************    00114200
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00114300
.*******************************************************************    00114400
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00114500
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            00114600
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00114700
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00114800
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00114900
              LCLA  &ZAWRK      USED AS A WORK AREA                     00115000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00115100
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00115200
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00115300
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00115400
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00115500
              LCLA  &ZMACRET    MACRO RETURN CODE                       00115600
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00115700
.*                                                                      00115800
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00115900
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00116000
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00116100
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   00116200
.*******************************************************************    00116300
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00116400
.*******************************************************************    00116500
              LCLA  &ZI         INDEX FOR ARRAY                         00116600
              LCLA  &ZJ         INDEX FOR PARMS                         00116700
              LCLA  &ZK         INDEX FOR PARSE                         00116800
              LCLA  &ZLO        LOW RANGE VALUE                         00116900
              LCLA  &ZHI        HIGH RANGE VALUE                        00117000
              LCLC  &ZW         WORK AREA FOR PARM                      00117100
.********************************************************************   00117200
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00117300
.********************************************************************   00117400
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00117500
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00117600
.*                                                                      00117700
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00117800
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00117900
              SPLEVEL  TEST                                             00118000
.ZSYS2        ANOP  ,                                                   00118100
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00118200
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00118300
              SYSSTATE TEST                                             00118400
              AGO   .ZSYS4                                              00118500
.ZSYS3        ANOP  ,                                                   00118600
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00118700
.ZSYS4        ANOP  ,                                                   00118800
.*******************************************************************    00118900
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00119000
.*******************************************************************    00119100
              LCLA  &XPLISTVER  ++ VALUE                                00119200
              LCLC  &XSERVICE   ++ VALUE                                00119300
              LCLC  &XSREAD     ++ VALUE                                00119400
              LCLC  &XSTOKEN    ++ NAME                                 00119500
              LCLC  &XNUMRANGE  ++ NAME                                 00119600
              LCLC  &XRANGLIST  ++ NAME                                 00119700
              LCLC  &XRELEASE   ++ VALUE                                00119800
              LCLC  &XHSPALET   ++ NAME                                 00119900
              LCLC  &XSWRITE    ++ VALUE                                00120000
              LCLC  &XCREAD     ++ VALUE                                00120100
              LCLC  &XADDRSP    ++ VALUE                                00120200
              LCLC  &XCWRITE    ++ VALUE                                00120300
              LCLC  &XKEEP      ++ VALUE                                00120400
              LCLC  &XRETCODE   ++ NAME                                 00120500
              LCLC  &XRSNCODE   ++ NAME                                 00120600
              LCLC  &XMF        ++ VALUE                                00120700
              LCLC  &XMFCTRL    ++ NAME                                 00120800
              LCLC  &XMFATTR    ++ VALUE                                00120900
              LCLC  &XMFSCK     ++ VALUE                                00121000
.*******************************************************************    00121100
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00121200
.*******************************************************************    00121300
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          00121400
              LCLC  &ZXSERVICE  ++ INPUT VALUE                          00121500
              LCLC  &ZXSREAD    ++ INPUT VALUE                          00121600
              LCLC  &ZXSTOKEN   ++ INPUT NAME                           00121700
              LCLC  &ZXNUMRANGE                 ++ INPUT NAME           00121800
              LCLC  &ZXRANGLIST                 ++ INPUT NAME           00121900
              LCLC  &ZXRELEASE  ++ INPUT VALUE                          00122000
              LCLC  &ZXHSPALET  ++ INPUT NAME                           00122100
              LCLC  &ZXSWRITE   ++ INPUT VALUE                          00122200
              LCLC  &ZXCREAD    ++ INPUT VALUE                          00122300
              LCLC  &ZXADDRSP   ++ INPUT VALUE                          00122400
              LCLC  &ZXCWRITE   ++ INPUT VALUE                          00122500
              LCLC  &ZXKEEP     ++ INPUT VALUE                          00122600
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          00122700
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00122800
              LCLC  &ZXMF       ++ INPUT VALUE                          00122900
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00123000
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00123100
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00123200
.********************************************************************   00123300
.***AC.PLV01  PROCESS PLISTVER                                      *   00123400
.********************************************************************   00123500
&XPLISTVER      SETA  0                                                 00123600
.*                                                                      00123700
                AIF   ('&HSPALET' EQ '').ZPLV1E                         00123800
                AIF   (&XPLISTVER GE 1).ZPLV1E                          00123900
&XPLISTVER      SETA  1                                                 00124000
.ZPLV1E         ANOP  ,                                                 00124100
.*                                                                      00124200
                AIF   ('&HSPALET' EQ '').ZPLV2E                         00124300
                AIF   (&XPLISTVER GE 1).ZPLV2E                          00124400
&XPLISTVER      SETA  1                                                 00124500
.ZPLV2E         ANOP  ,                                                 00124600
.*                                                                      00124700
                AIF   ('&HSPALET' EQ '').ZPLV3E                         00124800
                AIF   (&XPLISTVER GE 1).ZPLV3E                          00124900
&XPLISTVER      SETA  1                                                 00125000
.ZPLV3E         ANOP  ,                                                 00125100
.*                                                                      00125200
                AIF   ('&HSPALET' EQ '').ZPLV4E                         00125300
                AIF   (&XPLISTVER GE 1).ZPLV4E                          00125400
&XPLISTVER      SETA  1                                                 00125500
.ZPLV4E         ANOP  ,                                                 00125600
.*                                                                      00125700
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00125800
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00125900
.*-------------------------------------------------------------------   00126000
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00126100
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00126200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00126300
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00126400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00126500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00126600
                AGO   .ZPVCK2                                           00126700
.ZPVCK3         ANOP  ,                                                 00126800
.*-------------------------------------------------------------------   00126900
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00127000
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00127100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00127200
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00127300
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00127400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00127500
                AGO   .ZPVCKE                                           00127600
.ZPVCK2         ANOP  ,                                                 00127700
.*-------------------------------------------------------------------   00127800
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00127900
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00128000
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00128100
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00128200
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00128300
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00128400
                MNOTE 8,' &ZMS IS REQUIRED.'                            00128500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00128600
                AGO   .ZPVCK5                                           00128700
.ZPVCK4         ANOP  ,                                                 00128800
&XPLISTVER      SETA  &PLISTVER(1)                                      00128900
.ZPVCK5         ANOP  ,                                                 00129000
.*-------------------------------------------------------------------   00129100
&ZCVAL          SETC  '&PLISTVER(1)'                                    00129200
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00129300
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00129400
                AIF   (&XPLISTVER LT 0).ZPVCK6  TOO LOW                 00129500
                AIF   (&XPLISTVER LE 1).ZPVCKE  NOT HIGH                00129600
.ZPVCK6         ANOP   ,                                                00129700
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00129800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00129900
&ZMS            SETC  '&ZMS THE RANGE IS "0-1"'                         00130000
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00130100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00130200
.ZPVCKE         ANOP   ,                                                00130300
.********************************************************************   00130400
.***AG.MF01 PROCESS MF MACRO FORMS                                      00130500
.********************************************************************   00130600
              ACTR  10000                                               00130700
.*------------------------------------------------------------------    00130800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00130900
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00131000
.*-------------------------------------------------------------------   00131100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00131200
.ZG88         ANOP  ,                                                   00131300
&ZTLC         SETC 'S'                                                  00131400
              AIF   ('&MF(1)' NE '&ZTLC').ZG89                          00131500
&XMF          SETC  'S'         SET KEYWORD                             00131600
&XMFSCK       SETC  'COMPLETE'  SET XMFSCK                              00131700
              AIF   (N'&MF LE 1).ZG88A          CK NUM                  00131800
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00131900
&ZMS          SETC  '&ZMS.&MF"'                                         00132000
&ZMS          SETC  '&ZMS "MF"'                                         00132100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00132200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00132300
.ZG88A        ANOP  ,                                                   00132400
.*-------------------------------------------------------------------   00132500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00132600
.ZG89         ANOP  ,                                                   00132700
&ZTLC         SETC 'L'                                                  00132800
              AIF   ('&MF(1)' NE '&ZTLC').ZG96                          00132900
&XMF          SETC  'L'         SET KEYWORD                             00133000
              AIF   (N'&MF LE 3).ZG89A          CK NUM                  00133100
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00133200
&ZMS          SETC  '&ZMS.&MF"'                                         00133300
&ZMS          SETC  '&ZMS "MF"'                                         00133400
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00133500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00133600
.ZG89A        ANOP  ,                                                   00133700
.*-------------------------------------------------------------------   00133800
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00133900
              AIF   (N'&SYSLIST NE 0).ZG89B     POSITIONALS?            00134000
              AIF   ('&STOKEN' NE '').ZG89B     KEYS?                   00134100
              AIF   ('&NUMRANGE' NE '').ZG89B   KEYS?                   00134200
              AIF   ('&RANGLIST' NE '').ZG89B   KEYS?                   00134300
              AIF   ('&RELEASE' NE '').ZG89B    KEYS?                   00134400
              AIF   ('&HSPALET' NE '').ZG89B    KEYS?                   00134500
              AIF   ('&ADDRSP' NE '').ZG89B     KEYS?                   00134600
              AIF   ('&KEEP' NE '').ZG89B       KEYS?                   00134700
              AIF   ('&RETCODE' NE '').ZG89B    KEYS?                   00134800
              AIF   ('&RSNCODE' NE '').ZG89B    KEYS?                   00134900
              AGO    .ZG89C     INVOCATION OKAY                         00135000
.ZG89B        ANOP  ,                                                   00135100
&ZMS          SETC  'THE "L" FORM OF "MF"'      *MFLA* MNOTE            00135200
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                00135300
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           00135400
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              00135500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00135600
.ZG89C        ANOP  ,                                                   00135700
.*-------------------------------------------------------------------   00135800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00135900
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00136000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00136100
              AIF   (N'&MF(2) GT 1).ZG91B       MULTI PARMS             00136200
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00136300
.ZG91B        AIF   (K'&MF(2) GT 0).ZG91C                               00136400
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00136500
&ZMS          SETC  ' '         *KRQDA*                                 00136600
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00136700
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00136800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00136900
.ZG91C        ANOP  ,                                                   00137000
.*-------------------------------------------------------------------   00137100
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00137200
              AIF   (K'&ZXMFCTRL LE 0).ZG91P    NOT I/O                 00137300
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG91P                      00137400
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00137500
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00137600
&ZMS          SETC  '&ZMS.&MF"'                                         00137700
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00137800
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00137900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00138000
.ZG91P        ANOP  ,                                                   00138100
.*-------------------------------------------------------------------   00138200
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00138300
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00138400
&XMFATTR      SETC  '0D'                                                00138500
              AIF   (K'&MF(3) LE 0).ZG94B       PARM                    00138600
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00138700
              AIF   (N'&MF(3) GT 1).ZG94B       MULTI PARMS             00138800
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00138900
.ZG94B        ANOP  ,                                                   00139000
.*-------------------------------------------------------------------   00139100
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00139200
              AIF   (K'&ZXMFATTR LE 0).ZG94P    NOT I/O                 00139300
              AIF   ('&XMFATTR'(1,1) NE '(').ZG94P                      00139400
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00139500
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00139600
&ZMS          SETC  '&ZMS.&MF"'                                         00139700
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00139800
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00139900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00140000
.ZG94P        ANOP  ,                                                   00140100
.*-------------------------------------------------------------------   00140200
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00140300
              AIF   (K'&ZXMFATTR LE 0).ZG94S    NOT I/O                 00140400
              AIF   (K'&XMFATTR LE 60).ZG94S    LNG OK                  00140500
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00140600
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           00140700
&ZMS          SETC  '&ZMS.&MF"'                                         00140800
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00140900
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00141000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00141100
.ZG94S        ANOP  ,                                                   00141200
.*-------------------------------------------------------------------   00141300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00141400
.ZG96         ANOP  ,                                                   00141500
&ZTLC         SETC 'M'                                                  00141600
              AIF   ('&MF(1)' NE '&ZTLC').ZG105                         00141700
&XMF          SETC  'M'         SET KEYWORD                             00141800
              AIF   (N'&MF LE 3).ZG96A          CK NUM                  00141900
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00142000
&ZMS          SETC  '&ZMS.&MF"'                                         00142100
&ZMS          SETC  '&ZMS "MF"'                                         00142200
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00142300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00142400
.ZG96A        ANOP  ,                                                   00142500
.*-------------------------------------------------------------------   00142600
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00142700
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00142800
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00142900
              AIF   (N'&MF(2) GT 1).ZG98B       MULTI PARMS             00143000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00143100
.ZG98B        AIF   (K'&MF(2) GT 0).ZG98C                               00143200
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00143300
&ZMS          SETC  ' '         *KRQDA*                                 00143400
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00143500
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00143600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00143700
.ZG98C        ANOP  ,                                                   00143800
.*-------------------------------------------------------------------   00143900
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00144000
              AIF   (K'&ZXMFCTRL LE 0).ZG98R    NOT I/O                 00144100
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG98R                      00144200
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00144300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG98P                        00144400
              AIF   (K'&ZCGPR GT 2).ZG98Q                               00144500
              AIF   ('&ZCGPR' EQ '0').ZG98Q                             00144600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00144700
              AIF   (T'&ZCGPR NE 'N').ZG98Q     INVALID REG NAME        00144800
.ZG98P        ANOP  ,                                                   00144900
              AIF   (T'&ZCGPR NE 'N').ZG98R     NON NUMERIC             00145000
              AIF   ('&ZCGPR' LT '1').ZG98Q                             00145100
              AIF   ('&ZCGPR' LE '12').ZG98R                            00145200
.ZG98Q        ANOP  ,                                                   00145300
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00145400
&ZMS          SETC  '&ZMS.&MF"'                                         00145500
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00145600
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00145700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00145800
.ZG98R        ANOP  ,                                                   00145900
.*-------------------------------------------------------------------   00146000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00146100
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00146200
.ZG102A   AIF   ('&MF(3)' NE 'COMPLETE').ZG103A                         00146300
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00146400
.*-------------------------------------------------------------------   00146500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00146600
.ZG103A   AIF   ('&MF(3)' NE 'NOCHECK').ZG104A                          00146700
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00146800
.*-------------------------------------------------------------------   00146900
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00147000
.ZG104A       AIF   (K'&XMFSCK GT 0).ZG104C     KEYWORD                 00147100
              AIF   (K'&MF(3) LE 0).ZG104B                              00147200
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00147300
&ZMS          SETC  '&ZMS.&MF"'                                         00147400
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00147500
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00147600
&ZMS          SETC  '&ZMS "COMPLETE"'           VALID KEYWORD           00147700
&ZMS          SETC  '&ZMS OR "NOCHECK".'        VALID KEYWORD           00147800
              MNOTE 8,' &ZMS '                                          00147900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00148000
.ZG104B       ANOP  ,                                                   00148100
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00148200
.ZG104C       ANOP  ,                                                   00148300
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00148400
.*-------------------------------------------------------------------   00148500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00148600
.ZG105        ANOP  ,                                                   00148700
&ZTLC         SETC 'E'                                                  00148800
              AIF   ('&MF(1)' NE '&ZTLC').ZG114                         00148900
&XMF          SETC  'E'         SET KEYWORD                             00149000
              AIF   (N'&MF LE 3).ZG105A         CK NUM                  00149100
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           00149200
&ZMS          SETC  '&ZMS.&MF"'                                         00149300
&ZMS          SETC  '&ZMS "MF"'                                         00149400
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00149500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00149600
.ZG105A       ANOP  ,                                                   00149700
.*-------------------------------------------------------------------   00149800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00149900
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00150000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00150100
              AIF   (N'&MF(2) GT 1).ZG107B      MULTI PARMS             00150200
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00150300
.ZG107B       AIF   (K'&MF(2) GT 0).ZG107C                              00150400
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00150500
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 00150600
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00150700
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00150800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00150900
.ZG107C       ANOP  ,                                                   00151000
.*-------------------------------------------------------------------   00151100
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00151200
              AIF   (K'&ZXMFCTRL LE 0).ZG107R   NOT I/O                 00151300
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG107R                     00151400
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00151500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG107P                       00151600
              AIF   (K'&ZCGPR GT 2).ZG107Q                              00151700
              AIF   ('&ZCGPR' EQ '0').ZG107Q                            00151800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00151900
              AIF   (T'&ZCGPR NE 'N').ZG107Q    INVALID REG NAME        00152000
.ZG107P       ANOP  ,                                                   00152100
              AIF   (T'&ZCGPR NE 'N').ZG107R    NON NUMERIC             00152200
              AIF   ('&ZCGPR' LT '1').ZG107Q                            00152300
              AIF   ('&ZCGPR' LE '12').ZG107R                           00152400
.ZG107Q       ANOP  ,                                                   00152500
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           00152600
&ZMS          SETC  '&ZMS.&MF"'                                         00152700
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00152800
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00152900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00153000
.ZG107R       ANOP  ,                                                   00153100
.*-------------------------------------------------------------------   00153200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00153300
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00153400
.ZG111A   AIF   ('&MF(3)' NE 'COMPLETE').ZG112A                         00153500
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00153600
.*-------------------------------------------------------------------   00153700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00153800
.ZG112A   AIF   ('&MF(3)' NE 'NOCHECK').ZG113A                          00153900
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00154000
.*-------------------------------------------------------------------   00154100
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00154200
.ZG113A       AIF   (K'&XMFSCK GT 0).ZG113C     KEYWORD                 00154300
              AIF   (K'&MF(3) LE 0).ZG113B                              00154400
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00154500
&ZMS          SETC  '&ZMS.&MF"'                                         00154600
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00154700
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00154800
&ZMS          SETC  '&ZMS "COMPLETE"'           VALID KEYWORD           00154900
&ZMS          SETC  '&ZMS OR "NOCHECK".'        VALID KEYWORD           00155000
              MNOTE 8,' &ZMS '                                          00155100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00155200
.ZG113B       ANOP  ,                                                   00155300
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00155400
.ZG113C       ANOP  ,                                                   00155500
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00155600
.*------------------------------------------------------------------    00155700
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00155800
.ZG114        ANOP  ,                                                   00155900
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00156000
              AIF   (K'&XMF GT 0).ZG114E        VALID ARG               00156100
              AIF   (T'&MF EQ 'O').ZG114D       OMITTED                 00156200
&ZASYSLNDX    SETA  0                                                   00156300
.ZG114A       ANOP  ,           POSITIONAL MACRO KEY                    00156400
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00156500
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG114C                   00156600
&ZTLC         SETC 'MF'                                                 00156700
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG114A          00156800
.ZG114B       ANOP  ,                                                   00156900
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00157000
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           00157100
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00157200
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00157300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00157400
              AGO   .ZG114E                                             00157500
.ZG114C       ANOP  ,                                                   00157600
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00157700
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           00157800
&ZMS          SETC  '&ZMS.&MF"'                                         00157900
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00158000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00158100
&ZMS          SETC  '&ZMS "S",'                 VALID KEYWORD           00158200
&ZMS          SETC  '&ZMS "L",'                 VALID KEYWORD           00158300
&ZMS          SETC  '&ZMS "M",'                 VALID KEYWORD           00158400
&ZMS          SETC  '&ZMS OR "E".'              VALID KEYWORD           00158500
              MNOTE 8,' &ZMS '                                          00158600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00158700
              AGO   .ZG114E                                             00158800
.ZG114D       ANOP  ,                                                   00158900
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00159000
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00159100
.ZG114E       ANOP  ,                                                   00159200
.********************************************************************   00159300
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00159400
.********************************************************************   00159500
              ACTR  10000                                               00159600
.*-------------------------------------------------------------------   00159700
.***AG.MF03 MF=(SLME)                                                   00159800
              AIF   ('&XMF' EQ 'L').ZGMFX                               00159900
              AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                     00160000
.*-------------------------------------------------------------------   00160100
.***AG.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00160200
&XSERVICE     SETC  ''          INITIALIZE XVARIABLE                    00160300
&ZASYSLNDX    SETA  0                                                   00160400
.ZG5A         ANOP  ,           POSITIONAL KEY SEARCH                   00160500
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00160600
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG5B  DONE                    00160700
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG5A             00160800
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'SREAD').ZG5A                 00160900
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00161000
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00161100
&XSERVICE     SETC  'SREAD'     SET XVARIABLE                           00161200
&ZXSREAD      SETC  'INPUT'     SET IN/OUTPUT                           00161300
&XSREAD       SETC  'SREAD'     SET XVARIABLE PARM                      00161400
.ZG5B         ANOP  ,                                                   00161500
.*-------------------------------------------------------------------   00161600
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00161700
&ZASYSLNDX    SETA  0                                                   00161800
.ZG23A        ANOP  ,           POSITIONAL KEY SEARCH                   00161900
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00162000
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG23C  DONE                   00162100
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG23A            00162200
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'SWRITE').ZG23A               00162300
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00162400
              AIF   (K'&XSERVICE LE 0).ZG23B    VALID                   00162500
&ZMS          SETC  '"SWRITE'   *KMEKA* MNOTE                           00162600
&ZMS          SETC  '&ZMS."'                                            00162700
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00162800
&ZMS          SETC  '&ZMS "&XSERVICE"'                                  00162900
              MNOTE 8,' &ZMS KEY.'                                      00163000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00163100
              AGO   .ZG23C                                              00163200
.*                                                                      00163300
.ZG23B        ANOP  ,                                                   00163400
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00163500
&XSERVICE     SETC  'SWRITE'    SET XVARIABLE                           00163600
&ZXSWRITE     SETC  'INPUT'     SET IN/OUTPUT                           00163700
&XSWRITE      SETC  'SWRITE'    SET XVARIABLE PARM                      00163800
.ZG23C        ANOP  ,                                                   00163900
.*-------------------------------------------------------------------   00164000
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00164100
&ZASYSLNDX    SETA  0                                                   00164200
.ZG36A        ANOP  ,           POSITIONAL KEY SEARCH                   00164300
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00164400
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG36C  DONE                   00164500
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG36A            00164600
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'CREAD').ZG36A                00164700
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00164800
              AIF   (K'&XSERVICE LE 0).ZG36B    VALID                   00164900
&ZMS          SETC  '"CREAD'    *KMEKA* MNOTE                           00165000
&ZMS          SETC  '&ZMS."'                                            00165100
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00165200
&ZMS          SETC  '&ZMS "&XSERVICE"'                                  00165300
              MNOTE 8,' &ZMS KEY.'                                      00165400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00165500
              AGO   .ZG36C                                              00165600
.*                                                                      00165700
.ZG36B        ANOP  ,                                                   00165800
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00165900
&XSERVICE     SETC  'CREAD'     SET XVARIABLE                           00166000
&ZXCREAD      SETC  'INPUT'     SET IN/OUTPUT                           00166100
&XCREAD       SETC  'CREAD'     SET XVARIABLE PARM                      00166200
.ZG36C        ANOP  ,                                                   00166300
.*-------------------------------------------------------------------   00166400
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00166500
&ZASYSLNDX    SETA  0                                                   00166600
.ZG55A        ANOP  ,           POSITIONAL KEY SEARCH                   00166700
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00166800
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG55C  DONE                   00166900
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG55A            00167000
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'CWRITE').ZG55A               00167100
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00167200
              AIF   (K'&XSERVICE LE 0).ZG55B    VALID                   00167300
&ZMS          SETC  '"CWRITE'   *KMEKA* MNOTE                           00167400
&ZMS          SETC  '&ZMS."'                                            00167500
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00167600
&ZMS          SETC  '&ZMS "&XSERVICE"'                                  00167700
              MNOTE 8,' &ZMS KEY.'                                      00167800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00167900
              AGO   .ZG55C                                              00168000
.*                                                                      00168100
.ZG55B        ANOP  ,                                                   00168200
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00168300
&XSERVICE     SETC  'CWRITE'    SET XVARIABLE                           00168400
&ZXCWRITE     SETC  'INPUT'     SET IN/OUTPUT                           00168500
&XCWRITE      SETC  'CWRITE'    SET XVARIABLE PARM                      00168600
.ZG55C        ANOP  ,                                                   00168700
.*------------------------------------------------------------------    00168800
.***AG.KMEKY09 VALUE, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED          00168900
              AIF   (K'&XSERVICE GT 0).ZG79B                            00169000
&ZXSERVICE    SETC  ''          RESET IN/OUTPUT                         00169100
&ZXSREAD      SETC  ''          RESET IN/OUTPUT                         00169200
&XSERVICE     SETC  ''          ENSURE NULL                             00169300
&XSREAD       SETC  ''          ENSURE NULL                             00169400
&ZMS          SETC  'ONE OF THE FOLLOWING'      *KMERA* MNOTE           00169500
&ZMS          SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'                 00169600
&ZMS          SETC  '&ZMS REQUIRED:'                                    00169700
&ZMS          SETC  '&ZMS "SREAD",'             VALID ME KEY            00169800
&ZMS          SETC  '&ZMS "SWRITE",'            VALID ME KEY            00169900
&ZMS          SETC  '&ZMS "CREAD",'             VALID ME KEY            00170000
&ZMS          SETC  '&ZMS OR "CWRITE".'         VALID ME KEY            00170100
              MNOTE 8,' &ZMS '                                          00170200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00170300
.ZG79B        ANOP  ,                                                   00170400
.*-------------------------------------------------------------------   00170500
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00170600
.ZG5          AIF   ('&XSERVICE' NE 'SREAD').ZG23                       00170700
.*-------------------------------------------------------------------   00170800
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00170900
&ZCVAL        SETC ''           ERROR KEY FIELD                         00171000
.ZG5I0        AIF   (K'&ADDRSP LE 0).ZG5I1                              00171100
&ZCVAL        SETC '&ZCVAL ADDRSP'              DISALLOWED KEY          00171200
.ZG5I1        AIF   (K'&KEEP LE 0).ZG5I2                                00171300
&ZCVAL        SETC '&ZCVAL KEEP'                DISALLOWED KEY          00171400
.ZG5I2        AIF   (K'&ZCVAL LE 0).ZG5J        KEY                     00171500
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00171600
&ZMS          SETC  '"SREAD'    *KMEIA* MNOTE                           00171700
&ZMS          SETC  '&ZMS."'                                            00171800
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00171900
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00172000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00172100
.ZG5J         ANOP  ,                                                   00172200
.*-------------------------------------------------------------------   00172300
.***AG.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00172400
              AIF   (K'&ZXSREAD LE 0).ZG5R      NOT I/O                 00172500
              AIF   ('&XSREAD'(1,1) NE '(').ZG5R                        00172600
&ZCGPR        SETC  '&XSREAD'(2,K'&XSREAD-2)                            00172700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                         00172800
              AIF   (K'&ZCGPR GT 2).ZG5Q                                00172900
              AIF   ('&ZCGPR' EQ '0').ZG5Q                              00173000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00173100
              AIF   (T'&ZCGPR NE 'N').ZG5Q      INVALID REG NAME        00173200
.ZG5P         ANOP  ,                                                   00173300
              AIF   (T'&ZCGPR NE 'N').ZG5R      NON NUMERIC             00173400
              AIF   ('&ZCGPR' LT '2').ZG5Q                              00173500
              AIF   ('&ZCGPR' LE '12').ZG5R                             00173600
.ZG5Q         ANOP  ,                                                   00173700
&ZMS          SETC  '"SREAD='   *KGPRA* MNOTE                           00173800
&ZMS          SETC  '&ZMS.&SREAD"'                                      00173900
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00174000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00174100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00174200
.ZG5R         ANOP  ,                                                   00174300
.*----------------------------------------------------------------***   00174400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00174500
              AIF   (N'&STOKEN LE 1).ZG7A       CK NUM                  00174600
&ZMS          SETC  '"STOKEN='  *KPOSA* MNOTE                           00174700
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00174800
&ZMS          SETC  '&ZMS "STOKEN"'                                     00174900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00175000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00175100
.ZG7A         ANOP  ,                                                   00175200
.*-------------------------------------------------------------------   00175300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00175400
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00175500
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00175600
              AIF   (N'&STOKEN GT 1).ZG7B       MULTI PARMS             00175700
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00175800
.ZG7B         AIF   (K'&STOKEN(1) GT 0).ZG7C                            00175900
&ZXSTOKEN     SETC  ''          RESET IN/OUTPUT                         00176000
&ZMS          SETC  ' '         *KRQDA*                                 00176100
&ZMS          SETC  '&ZMS "STOKEN" KEY AND ITS ARGUMENT'                00176200
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00176300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00176400
.ZG7C         ANOP  ,                                                   00176500
.*-------------------------------------------------------------------   00176600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00176700
              AIF   (K'&ZXSTOKEN LE 0).ZG7R     NOT I/O                 00176800
              AIF   ('&XSTOKEN'(1,1) NE '(').ZG7R                       00176900
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00177000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG7P                         00177100
              AIF   (K'&ZCGPR GT 2).ZG7Q                                00177200
              AIF   ('&ZCGPR' EQ '0').ZG7Q                              00177300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00177400
              AIF   (T'&ZCGPR NE 'N').ZG7Q      INVALID REG NAME        00177500
.ZG7P         ANOP  ,                                                   00177600
              AIF   (T'&ZCGPR NE 'N').ZG7R      NON NUMERIC             00177700
              AIF   ('&ZCGPR' LT '2').ZG7Q                              00177800
              AIF   ('&ZCGPR' LE '12').ZG7R                             00177900
.ZG7Q         ANOP  ,                                                   00178000
&ZMS          SETC  '"STOKEN='  *KGPRA* MNOTE                           00178100
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00178200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00178300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00178400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00178500
.ZG7R         ANOP  ,                                                   00178600
.*----------------------------------------------------------------***   00178700
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00178800
              AIF   (N'&NUMRANGE LE 1).ZG10A    CK NUM                  00178900
&ZMS          SETC  '"NUMRANGE='                *KPOSA* MNOTE           00179000
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00179100
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00179200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00179300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00179400
.ZG10A        ANOP  ,                                                   00179500
.*-------------------------------------------------------------------   00179600
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00179700
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00179800
&XNUMRANGE    SETC  '1'                                                 00179900
              AIF   (K'&NUMRANGE(1) LE 0).ZG10B  PARM                   00180000
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00180100
              AIF   (N'&NUMRANGE GT 1).ZG10B    MULTI PARMS             00180200
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00180300
.ZG10B        ANOP  ,                                                   00180400
.*-------------------------------------------------------------------   00180500
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00180600
              AIF   (K'&ZXNUMRANGE LE 0).ZG10R  NOT I/O                 00180700
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZG10R                    00180800
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00180900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                        00181000
              AIF   (K'&ZCGPR GT 2).ZG10Q                               00181100
              AIF   ('&ZCGPR' EQ '0').ZG10Q                             00181200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00181300
              AIF   (T'&ZCGPR NE 'N').ZG10Q     INVALID REG NAME        00181400
.ZG10P        ANOP  ,                                                   00181500
              AIF   (T'&ZCGPR NE 'N').ZG10R     NON NUMERIC             00181600
              AIF   ('&ZCGPR' LT '2').ZG10Q                             00181700
              AIF   ('&ZCGPR' LE '12').ZG10R                            00181800
.ZG10Q        ANOP  ,                                                   00181900
&ZMS          SETC  '"NUMRANGE='                *KGPRA* MNOTE           00182000
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00182100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00182200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00182300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00182400
.ZG10R        ANOP  ,                                                   00182500
.*----------------------------------------------------------------***   00182600
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00182700
              AIF   (N'&RANGLIST LE 1).ZG13A    CK NUM                  00182800
&ZMS          SETC  '"RANGLIST='                *KPOSA* MNOTE           00182900
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00183000
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00183100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00183200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00183300
.ZG13A        ANOP  ,                                                   00183400
.*-------------------------------------------------------------------   00183500
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00183600
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00183700
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00183800
              AIF   (N'&RANGLIST GT 1).ZG13B    MULTI PARMS             00183900
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00184000
.ZG13B        AIF   (K'&RANGLIST(1) GT 0).ZG13C                         00184100
&ZXRANGLIST   SETC  ''          RESET IN/OUTPUT                         00184200
&ZMS          SETC  ' '         *KRQDA*                                 00184300
&ZMS          SETC  '&ZMS "RANGLIST" KEY AND ITS ARGUMENT'              00184400
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00184500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00184600
.ZG13C        ANOP  ,                                                   00184700
.*-------------------------------------------------------------------   00184800
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00184900
              AIF   (K'&ZXRANGLIST LE 0).ZG13R  NOT I/O                 00185000
              AIF   ('&XRANGLIST'(1,1) NE '(').ZG13R                    00185100
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00185200
              AIF   ('&ZCGPR'(1,1) NE '0').ZG13P                        00185300
              AIF   (K'&ZCGPR GT 2).ZG13Q                               00185400
              AIF   ('&ZCGPR' EQ '0').ZG13Q                             00185500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00185600
              AIF   (T'&ZCGPR NE 'N').ZG13Q     INVALID REG NAME        00185700
.ZG13P        ANOP  ,                                                   00185800
              AIF   (T'&ZCGPR NE 'N').ZG13R     NON NUMERIC             00185900
              AIF   ('&ZCGPR' LT '2').ZG13Q                             00186000
              AIF   ('&ZCGPR' LE '12').ZG13R                            00186100
.ZG13Q        ANOP  ,                                                   00186200
&ZMS          SETC  '"RANGLIST='                *KGPRA* MNOTE           00186300
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00186400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00186500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00186600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00186700
.ZG13R        ANOP  ,                                                   00186800
.*------------------------------------------------------------------    00186900
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00187000
&XRELEASE     SETC  ''          INITIALIZE XVARIABLE                    00187100
.*-------------------------------------------------------------------   00187200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00187300
.ZG17         ANOP  ,                                                   00187400
              AIF   (K'&RELEASE(1) LE 0).ZG17A                          00187500
&ZTLC         SETC 'NO'                                                 00187600
              AIF   ('&RELEASE(1)' NE '&ZTLC').ZG21                     00187700
&XRELEASE     SETC  'NO'        SET KEYWORD                             00187800
              AIF   (N'&RELEASE LE 1).ZG17A     CK NUM                  00187900
&ZMS          SETC  '"RELEASE='                 *KPOSA* MNOTE           00188000
&ZMS          SETC  '&ZMS.&RELEASE"'                                    00188100
&ZMS          SETC  '&ZMS "RELEASE"'                                    00188200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00188300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00188400
.ZG17A        ANOP  ,                                                   00188500
.*----------------------------------------------------------------***   00188600
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00188700
              AIF   (N'&HSPALET LE 1).ZG19A     CK NUM                  00188800
&ZMS          SETC  '"HSPALET='                 *KPOSA* MNOTE           00188900
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00189000
&ZMS          SETC  '&ZMS "HSPALET"'                                    00189100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00189200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00189300
.ZG19A        ANOP  ,                                                   00189400
.*-------------------------------------------------------------------   00189500
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00189600
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00189700
&XHSPALET     SETC  '0'                                                 00189800
              AIF   (K'&HSPALET(1) LE 0).ZG19B  PARM                    00189900
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00190000
              AIF   (N'&HSPALET GT 1).ZG19B     MULTI PARMS             00190100
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00190200
.ZG19B        ANOP  ,                                                   00190300
.*-------------------------------------------------------------------   00190400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00190500
              AIF   (K'&ZXHSPALET LE 0).ZG19R   NOT I/O                 00190600
              AIF   ('&XHSPALET' EQ '0').ZG19R                          00190700
              AIF   ('&XHSPALET'(1,1) NE '(').ZG19R                     00190800
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00190900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                        00191000
              AIF   (K'&ZCGPR GT 2).ZG19Q                               00191100
              AIF   ('&ZCGPR' EQ '0').ZG19Q                             00191200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00191300
              AIF   (T'&ZCGPR NE 'N').ZG19Q     INVALID REG NAME        00191400
.ZG19P        ANOP  ,                                                   00191500
              AIF   (T'&ZCGPR NE 'N').ZG19R     NON NUMERIC             00191600
              AIF   ('&ZCGPR' LT '2').ZG19Q                             00191700
              AIF   ('&ZCGPR' LE '12').ZG19R                            00191800
.ZG19Q        ANOP  ,                                                   00191900
&ZMS          SETC  '"HSPALET='                 *KGPRA* MNOTE           00192000
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00192100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00192200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00192300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00192400
.ZG19R        ANOP  ,                                                   00192500
.*-------------------------------------------------------------------   00192600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00192700
.ZG21         ANOP  ,                                                   00192800
&ZTLC         SETC 'YES'                                                00192900
              AIF   ('&RELEASE(1)' NE '&ZTLC').ZG22                     00193000
&XRELEASE     SETC  'YES'       SET KEYWORD                             00193100
              AIF   (N'&RELEASE LE 1).ZG21A     CK NUM                  00193200
&ZMS          SETC  '"RELEASE='                 *KPOSA* MNOTE           00193300
&ZMS          SETC  '&ZMS.&RELEASE"'                                    00193400
&ZMS          SETC  '&ZMS "RELEASE"'                                    00193500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00193600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00193700
.ZG21A        ANOP  ,                                                   00193800
.*------------------------------------------------------------------    00193900
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00194000
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00194100
.ZG21A0       AIF   (K'&HSPALET LE 0).ZG21A1    OK                      00194200
&ZCVAL        SETC '&ZCVAL HSPALET'             INCORRECT KEY USED      00194300
.ZG21A1       AIF   (K'&ZCVAL LE 0).ZG21A2      OK                      00194400
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00194500
&ZMS          SETC  '"RELEASE'  *KMEIA* MNOTE                           00194600
&ZMS          SETC  '&ZMS.=&RELEASE"'                                   00194700
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00194800
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00194900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00195000
.ZG21A2       ANOP  ,                                                   00195100
.*------------------------------------------------------------------    00195200
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00195300
.ZG22         ANOP  ,                                                   00195400
&ZXRELEASE    SETC  'INPUT'     SET IN/OUTPUT                           00195500
              AIF   (K'&XRELEASE GT 0).ZG22E    VALID ARG               00195600
              AIF   (T'&RELEASE EQ 'O').ZG22D   OMITTED                 00195700
&ZASYSLNDX    SETA  0                                                   00195800
.ZG22A        ANOP  ,           POSITIONAL MACRO KEY                    00195900
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00196000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG22C                    00196100
&ZTLC         SETC 'RELEASE'                                            00196200
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG22A           00196300
.ZG22B        ANOP  ,                                                   00196400
&ZXRELEASE    SETC  ''          RESET IN/OUTPUT                         00196500
&ZMS          SETC  'THE "RELEASE" KEY'         *KOPTA* MNOTE           00196600
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00196700
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00196800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00196900
              AGO   .ZG22E                                              00197000
.ZG22C        ANOP  ,                                                   00197100
&ZXRELEASE    SETC  ''          RESET IN/OUTPUT                         00197200
&ZMS          SETC  '"RELEASE='                 *KUKWA* MNOTE           00197300
&ZMS          SETC  '&ZMS.&RELEASE"'                                    00197400
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00197500
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00197600
&ZMS          SETC  '&ZMS "NO"'                 VALID KEYWORD           00197700
&ZMS          SETC  '&ZMS OR "YES".'            VALID KEYWORD           00197800
              MNOTE 8,' &ZMS '                                          00197900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00198000
              AGO   .ZG22E                                              00198100
.ZG22D        ANOP  ,                                                   00198200
&XRELEASE     SETC  'NO'        SET DEFAULT KEYWORD                     00198300
.ZG22E        ANOP  ,                                                   00198400
.*-------------------------------------------------------------------   00198500
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00198600
.ZG23         AIF   ('&XSERVICE' NE 'SWRITE').ZG36                      00198700
.*-------------------------------------------------------------------   00198800
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00198900
&ZCVAL        SETC ''           ERROR KEY FIELD                         00199000
.ZG23I0       AIF   (K'&RELEASE LE 0).ZG23I1                            00199100
&ZCVAL        SETC '&ZCVAL RELEASE'             DISALLOWED KEY          00199200
.ZG23I1       AIF   (K'&ADDRSP LE 0).ZG23I2                             00199300
&ZCVAL        SETC '&ZCVAL ADDRSP'              DISALLOWED KEY          00199400
.ZG23I2       AIF   (K'&KEEP LE 0).ZG23I3                               00199500
&ZCVAL        SETC '&ZCVAL KEEP'                DISALLOWED KEY          00199600
.ZG23I3       AIF   (K'&ZCVAL LE 0).ZG23J       KEY                     00199700
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00199800
&ZMS          SETC  '"SWRITE'   *KMEIA* MNOTE                           00199900
&ZMS          SETC  '&ZMS."'                                            00200000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00200100
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00200200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00200300
.ZG23J        ANOP  ,                                                   00200400
.*-------------------------------------------------------------------   00200500
.***AG.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00200600
              AIF   (K'&ZXSWRITE LE 0).ZG23R    NOT I/O                 00200700
              AIF   ('&XSWRITE'(1,1) NE '(').ZG23R                      00200800
&ZCGPR        SETC  '&XSWRITE'(2,K'&XSWRITE-2)                          00200900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                        00201000
              AIF   (K'&ZCGPR GT 2).ZG23Q                               00201100
              AIF   ('&ZCGPR' EQ '0').ZG23Q                             00201200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00201300
              AIF   (T'&ZCGPR NE 'N').ZG23Q     INVALID REG NAME        00201400
.ZG23P        ANOP  ,                                                   00201500
              AIF   (T'&ZCGPR NE 'N').ZG23R     NON NUMERIC             00201600
              AIF   ('&ZCGPR' LT '2').ZG23Q                             00201700
              AIF   ('&ZCGPR' LE '12').ZG23R                            00201800
.ZG23Q        ANOP  ,                                                   00201900
&ZMS          SETC  '"SWRITE='  *KGPRA* MNOTE                           00202000
&ZMS          SETC  '&ZMS.&SWRITE"'                                     00202100
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00202200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00202300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00202400
.ZG23R        ANOP  ,                                                   00202500
.*----------------------------------------------------------------***   00202600
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00202700
              AIF   (N'&STOKEN LE 1).ZG25A      CK NUM                  00202800
&ZMS          SETC  '"STOKEN='  *KPOSA* MNOTE                           00202900
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00203000
&ZMS          SETC  '&ZMS "STOKEN"'                                     00203100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00203200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00203300
.ZG25A        ANOP  ,                                                   00203400
.*-------------------------------------------------------------------   00203500
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00203600
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00203700
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00203800
              AIF   (N'&STOKEN GT 1).ZG25B      MULTI PARMS             00203900
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00204000
.ZG25B        AIF   (K'&STOKEN(1) GT 0).ZG25C                           00204100
&ZXSTOKEN     SETC  ''          RESET IN/OUTPUT                         00204200
&ZMS          SETC  ' '         *KRQDA*                                 00204300
&ZMS          SETC  '&ZMS "STOKEN" KEY AND ITS ARGUMENT'                00204400
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00204500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00204600
.ZG25C        ANOP  ,                                                   00204700
.*-------------------------------------------------------------------   00204800
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00204900
              AIF   (K'&ZXSTOKEN LE 0).ZG25R    NOT I/O                 00205000
              AIF   ('&XSTOKEN'(1,1) NE '(').ZG25R                      00205100
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00205200
              AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                        00205300
              AIF   (K'&ZCGPR GT 2).ZG25Q                               00205400
              AIF   ('&ZCGPR' EQ '0').ZG25Q                             00205500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00205600
              AIF   (T'&ZCGPR NE 'N').ZG25Q     INVALID REG NAME        00205700
.ZG25P        ANOP  ,                                                   00205800
              AIF   (T'&ZCGPR NE 'N').ZG25R     NON NUMERIC             00205900
              AIF   ('&ZCGPR' LT '2').ZG25Q                             00206000
              AIF   ('&ZCGPR' LE '12').ZG25R                            00206100
.ZG25Q        ANOP  ,                                                   00206200
&ZMS          SETC  '"STOKEN='  *KGPRA* MNOTE                           00206300
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00206400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00206500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00206600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00206700
.ZG25R        ANOP  ,                                                   00206800
.*----------------------------------------------------------------***   00206900
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00207000
              AIF   (N'&NUMRANGE LE 1).ZG28A    CK NUM                  00207100
&ZMS          SETC  '"NUMRANGE='                *KPOSA* MNOTE           00207200
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00207300
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00207400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00207500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00207600
.ZG28A        ANOP  ,                                                   00207700
.*-------------------------------------------------------------------   00207800
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00207900
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00208000
&XNUMRANGE    SETC  '1'                                                 00208100
              AIF   (K'&NUMRANGE(1) LE 0).ZG28B  PARM                   00208200
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00208300
              AIF   (N'&NUMRANGE GT 1).ZG28B    MULTI PARMS             00208400
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00208500
.ZG28B        ANOP  ,                                                   00208600
.*-------------------------------------------------------------------   00208700
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00208800
              AIF   (K'&ZXNUMRANGE LE 0).ZG28R  NOT I/O                 00208900
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZG28R                    00209000
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00209100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                        00209200
              AIF   (K'&ZCGPR GT 2).ZG28Q                               00209300
              AIF   ('&ZCGPR' EQ '0').ZG28Q                             00209400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00209500
              AIF   (T'&ZCGPR NE 'N').ZG28Q     INVALID REG NAME        00209600
.ZG28P        ANOP  ,                                                   00209700
              AIF   (T'&ZCGPR NE 'N').ZG28R     NON NUMERIC             00209800
              AIF   ('&ZCGPR' LT '2').ZG28Q                             00209900
              AIF   ('&ZCGPR' LE '12').ZG28R                            00210000
.ZG28Q        ANOP  ,                                                   00210100
&ZMS          SETC  '"NUMRANGE='                *KGPRA* MNOTE           00210200
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00210300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00210400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00210500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00210600
.ZG28R        ANOP  ,                                                   00210700
.*----------------------------------------------------------------***   00210800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00210900
              AIF   (N'&RANGLIST LE 1).ZG31A    CK NUM                  00211000
&ZMS          SETC  '"RANGLIST='                *KPOSA* MNOTE           00211100
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00211200
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00211300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00211400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00211500
.ZG31A        ANOP  ,                                                   00211600
.*-------------------------------------------------------------------   00211700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00211800
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00211900
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00212000
              AIF   (N'&RANGLIST GT 1).ZG31B    MULTI PARMS             00212100
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00212200
.ZG31B        AIF   (K'&RANGLIST(1) GT 0).ZG31C                         00212300
&ZXRANGLIST   SETC  ''          RESET IN/OUTPUT                         00212400
&ZMS          SETC  ' '         *KRQDA*                                 00212500
&ZMS          SETC  '&ZMS "RANGLIST" KEY AND ITS ARGUMENT'              00212600
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00212700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00212800
.ZG31C        ANOP  ,                                                   00212900
.*-------------------------------------------------------------------   00213000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00213100
              AIF   (K'&ZXRANGLIST LE 0).ZG31R  NOT I/O                 00213200
              AIF   ('&XRANGLIST'(1,1) NE '(').ZG31R                    00213300
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00213400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                        00213500
              AIF   (K'&ZCGPR GT 2).ZG31Q                               00213600
              AIF   ('&ZCGPR' EQ '0').ZG31Q                             00213700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00213800
              AIF   (T'&ZCGPR NE 'N').ZG31Q     INVALID REG NAME        00213900
.ZG31P        ANOP  ,                                                   00214000
              AIF   (T'&ZCGPR NE 'N').ZG31R     NON NUMERIC             00214100
              AIF   ('&ZCGPR' LT '2').ZG31Q                             00214200
              AIF   ('&ZCGPR' LE '12').ZG31R                            00214300
.ZG31Q        ANOP  ,                                                   00214400
&ZMS          SETC  '"RANGLIST='                *KGPRA* MNOTE           00214500
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00214600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00214700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00214800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00214900
.ZG31R        ANOP  ,                                                   00215000
.*----------------------------------------------------------------***   00215100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00215200
              AIF   (N'&HSPALET LE 1).ZG34A     CK NUM                  00215300
&ZMS          SETC  '"HSPALET='                 *KPOSA* MNOTE           00215400
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00215500
&ZMS          SETC  '&ZMS "HSPALET"'                                    00215600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00215700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00215800
.ZG34A        ANOP  ,                                                   00215900
.*-------------------------------------------------------------------   00216000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00216100
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00216200
&XHSPALET     SETC  '0'                                                 00216300
              AIF   (K'&HSPALET(1) LE 0).ZG34B  PARM                    00216400
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00216500
              AIF   (N'&HSPALET GT 1).ZG34B     MULTI PARMS             00216600
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00216700
.ZG34B        ANOP  ,                                                   00216800
.*-------------------------------------------------------------------   00216900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00217000
              AIF   (K'&ZXHSPALET LE 0).ZG34R   NOT I/O                 00217100
              AIF   ('&XHSPALET' EQ '0').ZG34R                          00217200
              AIF   ('&XHSPALET'(1,1) NE '(').ZG34R                     00217300
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00217400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG34P                        00217500
              AIF   (K'&ZCGPR GT 2).ZG34Q                               00217600
              AIF   ('&ZCGPR' EQ '0').ZG34Q                             00217700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00217800
              AIF   (T'&ZCGPR NE 'N').ZG34Q     INVALID REG NAME        00217900
.ZG34P        ANOP  ,                                                   00218000
              AIF   (T'&ZCGPR NE 'N').ZG34R     NON NUMERIC             00218100
              AIF   ('&ZCGPR' LT '2').ZG34Q                             00218200
              AIF   ('&ZCGPR' LE '12').ZG34R                            00218300
.ZG34Q        ANOP  ,                                                   00218400
&ZMS          SETC  '"HSPALET='                 *KGPRA* MNOTE           00218500
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00218600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00218700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00218800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00218900
.ZG34R        ANOP  ,                                                   00219000
.*-------------------------------------------------------------------   00219100
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00219200
.ZG36         AIF   ('&XSERVICE' NE 'CREAD').ZG55                       00219300
.*-------------------------------------------------------------------   00219400
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00219500
&ZCVAL        SETC ''           ERROR KEY FIELD                         00219600
.ZG36I0       AIF   (K'&RELEASE LE 0).ZG36I1                            00219700
&ZCVAL        SETC '&ZCVAL RELEASE'             DISALLOWED KEY          00219800
.ZG36I1       AIF   (K'&KEEP LE 0).ZG36I2                               00219900
&ZCVAL        SETC '&ZCVAL KEEP'                DISALLOWED KEY          00220000
.ZG36I2       AIF   (K'&ZCVAL LE 0).ZG36J       KEY                     00220100
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00220200
&ZMS          SETC  '"CREAD'    *KMEIA* MNOTE                           00220300
&ZMS          SETC  '&ZMS."'                                            00220400
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00220500
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00220600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00220700
.ZG36J        ANOP  ,                                                   00220800
.*-------------------------------------------------------------------   00220900
.***AG.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00221000
              AIF   (K'&ZXCREAD LE 0).ZG36R     NOT I/O                 00221100
              AIF   ('&XCREAD'(1,1) NE '(').ZG36R                       00221200
&ZCGPR        SETC  '&XCREAD'(2,K'&XCREAD-2)                            00221300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG36P                        00221400
              AIF   (K'&ZCGPR GT 2).ZG36Q                               00221500
              AIF   ('&ZCGPR' EQ '0').ZG36Q                             00221600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00221700
              AIF   (T'&ZCGPR NE 'N').ZG36Q     INVALID REG NAME        00221800
.ZG36P        ANOP  ,                                                   00221900
              AIF   (T'&ZCGPR NE 'N').ZG36R     NON NUMERIC             00222000
              AIF   ('&ZCGPR' LT '2').ZG36Q                             00222100
              AIF   ('&ZCGPR' LE '12').ZG36R                            00222200
.ZG36Q        ANOP  ,                                                   00222300
&ZMS          SETC  '"CREAD='   *KGPRA* MNOTE                           00222400
&ZMS          SETC  '&ZMS.&CREAD"'                                      00222500
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00222600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00222700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00222800
.ZG36R        ANOP  ,                                                   00222900
.*----------------------------------------------------------------***   00223000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00223100
              AIF   (N'&STOKEN LE 1).ZG38A      CK NUM                  00223200
&ZMS          SETC  '"STOKEN='  *KPOSA* MNOTE                           00223300
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00223400
&ZMS          SETC  '&ZMS "STOKEN"'                                     00223500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00223600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00223700
.ZG38A        ANOP  ,                                                   00223800
.*-------------------------------------------------------------------   00223900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00224000
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00224100
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00224200
              AIF   (N'&STOKEN GT 1).ZG38B      MULTI PARMS             00224300
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00224400
.ZG38B        AIF   (K'&STOKEN(1) GT 0).ZG38C                           00224500
&ZXSTOKEN     SETC  ''          RESET IN/OUTPUT                         00224600
&ZMS          SETC  ' '         *KRQDA*                                 00224700
&ZMS          SETC  '&ZMS "STOKEN" KEY AND ITS ARGUMENT'                00224800
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00224900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00225000
.ZG38C        ANOP  ,                                                   00225100
.*-------------------------------------------------------------------   00225200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00225300
              AIF   (K'&ZXSTOKEN LE 0).ZG38R    NOT I/O                 00225400
              AIF   ('&XSTOKEN'(1,1) NE '(').ZG38R                      00225500
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00225600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG38P                        00225700
              AIF   (K'&ZCGPR GT 2).ZG38Q                               00225800
              AIF   ('&ZCGPR' EQ '0').ZG38Q                             00225900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00226000
              AIF   (T'&ZCGPR NE 'N').ZG38Q     INVALID REG NAME        00226100
.ZG38P        ANOP  ,                                                   00226200
              AIF   (T'&ZCGPR NE 'N').ZG38R     NON NUMERIC             00226300
              AIF   ('&ZCGPR' LT '2').ZG38Q                             00226400
              AIF   ('&ZCGPR' LE '12').ZG38R                            00226500
.ZG38Q        ANOP  ,                                                   00226600
&ZMS          SETC  '"STOKEN='  *KGPRA* MNOTE                           00226700
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00226800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00226900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00227000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00227100
.ZG38R        ANOP  ,                                                   00227200
.*----------------------------------------------------------------***   00227300
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00227400
              AIF   (N'&ADDRSP LE 1).ZG41A      CK NUM                  00227500
&ZMS          SETC  '"ADDRSP='  *KPOSA* MNOTE                           00227600
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00227700
&ZMS          SETC  '&ZMS "ADDRSP"'                                     00227800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00227900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00228000
.ZG41A        ANOP  ,                                                   00228100
.*-------------------------------------------------------------------   00228200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00228300
&XADDRSP      SETC  ''          INITIALIZE XVARIABLE                    00228400
.ZG42A   AIF   ('&ADDRSP(1)' NE 'HOME').ZG43A                           00228500
&XADDRSP      SETC  'HOME'      SET KEYWORD                             00228600
.*-------------------------------------------------------------------   00228700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00228800
.ZG43A   AIF   ('&ADDRSP(1)' NE 'PRIMARY').ZG44A                        00228900
&XADDRSP      SETC  'PRIMARY'   SET KEYWORD                             00229000
.*-------------------------------------------------------------------   00229100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00229200
.ZG44A   AIF   ('&ADDRSP(1)' NE 'COMMON').ZG45A                         00229300
&XADDRSP      SETC  'COMMON'    SET KEYWORD                             00229400
.*-------------------------------------------------------------------   00229500
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00229600
.ZG45A        AIF   (K'&XADDRSP GT 0).ZG45C     KEYWORD                 00229700
              AIF   (K'&ADDRSP(1) LE 0).ZG45B                           00229800
&ZMS          SETC  '"ADDRSP='  *KUKWA* MNOTE                           00229900
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00230000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00230100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00230200
&ZMS          SETC  '&ZMS "HOME",'              VALID KEYWORD           00230300
&ZMS          SETC  '&ZMS "PRIMARY",'           VALID KEYWORD           00230400
&ZMS          SETC  '&ZMS OR "COMMON".'         VALID KEYWORD           00230500
              MNOTE 8,' &ZMS '                                          00230600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00230700
.ZG45B        ANOP  ,                                                   00230800
&XADDRSP      SETC  'HOME'      SET DEFAULT KEYWORD                     00230900
.ZG45C        ANOP  ,                                                   00231000
&ZXADDRSP     SETC  'INPUT'     SET IN/OUTPUT                           00231100
.*----------------------------------------------------------------***   00231200
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00231300
              AIF   (N'&NUMRANGE LE 1).ZG47A    CK NUM                  00231400
&ZMS          SETC  '"NUMRANGE='                *KPOSA* MNOTE           00231500
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00231600
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00231700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00231800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00231900
.ZG47A        ANOP  ,                                                   00232000
.*-------------------------------------------------------------------   00232100
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00232200
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00232300
&XNUMRANGE    SETC  '1'                                                 00232400
              AIF   (K'&NUMRANGE(1) LE 0).ZG47B  PARM                   00232500
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00232600
              AIF   (N'&NUMRANGE GT 1).ZG47B    MULTI PARMS             00232700
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00232800
.ZG47B        ANOP  ,                                                   00232900
.*-------------------------------------------------------------------   00233000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00233100
              AIF   (K'&ZXNUMRANGE LE 0).ZG47R  NOT I/O                 00233200
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZG47R                    00233300
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00233400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG47P                        00233500
              AIF   (K'&ZCGPR GT 2).ZG47Q                               00233600
              AIF   ('&ZCGPR' EQ '0').ZG47Q                             00233700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00233800
              AIF   (T'&ZCGPR NE 'N').ZG47Q     INVALID REG NAME        00233900
.ZG47P        ANOP  ,                                                   00234000
              AIF   (T'&ZCGPR NE 'N').ZG47R     NON NUMERIC             00234100
              AIF   ('&ZCGPR' LT '2').ZG47Q                             00234200
              AIF   ('&ZCGPR' LE '12').ZG47R                            00234300
.ZG47Q        ANOP  ,                                                   00234400
&ZMS          SETC  '"NUMRANGE='                *KGPRA* MNOTE           00234500
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00234600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00234700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00234800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00234900
.ZG47R        ANOP  ,                                                   00235000
.*----------------------------------------------------------------***   00235100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00235200
              AIF   (N'&RANGLIST LE 1).ZG50A    CK NUM                  00235300
&ZMS          SETC  '"RANGLIST='                *KPOSA* MNOTE           00235400
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00235500
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00235600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00235700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00235800
.ZG50A        ANOP  ,                                                   00235900
.*-------------------------------------------------------------------   00236000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00236100
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00236200
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00236300
              AIF   (N'&RANGLIST GT 1).ZG50B    MULTI PARMS             00236400
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00236500
.ZG50B        AIF   (K'&RANGLIST(1) GT 0).ZG50C                         00236600
&ZXRANGLIST   SETC  ''          RESET IN/OUTPUT                         00236700
&ZMS          SETC  ' '         *KRQDA*                                 00236800
&ZMS          SETC  '&ZMS "RANGLIST" KEY AND ITS ARGUMENT'              00236900
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00237000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00237100
.ZG50C        ANOP  ,                                                   00237200
.*-------------------------------------------------------------------   00237300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00237400
              AIF   (K'&ZXRANGLIST LE 0).ZG50R  NOT I/O                 00237500
              AIF   ('&XRANGLIST'(1,1) NE '(').ZG50R                    00237600
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00237700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG50P                        00237800
              AIF   (K'&ZCGPR GT 2).ZG50Q                               00237900
              AIF   ('&ZCGPR' EQ '0').ZG50Q                             00238000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00238100
              AIF   (T'&ZCGPR NE 'N').ZG50Q     INVALID REG NAME        00238200
.ZG50P        ANOP  ,                                                   00238300
              AIF   (T'&ZCGPR NE 'N').ZG50R     NON NUMERIC             00238400
              AIF   ('&ZCGPR' LT '2').ZG50Q                             00238500
              AIF   ('&ZCGPR' LE '12').ZG50R                            00238600
.ZG50Q        ANOP  ,                                                   00238700
&ZMS          SETC  '"RANGLIST='                *KGPRA* MNOTE           00238800
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00238900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00239000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00239100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00239200
.ZG50R        ANOP  ,                                                   00239300
.*----------------------------------------------------------------***   00239400
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00239500
              AIF   (N'&HSPALET LE 1).ZG53A     CK NUM                  00239600
&ZMS          SETC  '"HSPALET='                 *KPOSA* MNOTE           00239700
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00239800
&ZMS          SETC  '&ZMS "HSPALET"'                                    00239900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00240000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00240100
.ZG53A        ANOP  ,                                                   00240200
.*-------------------------------------------------------------------   00240300
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00240400
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00240500
&XHSPALET     SETC  '0'                                                 00240600
              AIF   (K'&HSPALET(1) LE 0).ZG53B  PARM                    00240700
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00240800
              AIF   (N'&HSPALET GT 1).ZG53B     MULTI PARMS             00240900
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00241000
.ZG53B        ANOP  ,                                                   00241100
.*-------------------------------------------------------------------   00241200
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00241300
              AIF   (K'&ZXHSPALET LE 0).ZG53R   NOT I/O                 00241400
              AIF   ('&XHSPALET' EQ '0').ZG53R                          00241500
              AIF   ('&XHSPALET'(1,1) NE '(').ZG53R                     00241600
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00241700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG53P                        00241800
              AIF   (K'&ZCGPR GT 2).ZG53Q                               00241900
              AIF   ('&ZCGPR' EQ '0').ZG53Q                             00242000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00242100
              AIF   (T'&ZCGPR NE 'N').ZG53Q     INVALID REG NAME        00242200
.ZG53P        ANOP  ,                                                   00242300
              AIF   (T'&ZCGPR NE 'N').ZG53R     NON NUMERIC             00242400
              AIF   ('&ZCGPR' LT '2').ZG53Q                             00242500
              AIF   ('&ZCGPR' LE '12').ZG53R                            00242600
.ZG53Q        ANOP  ,                                                   00242700
&ZMS          SETC  '"HSPALET='                 *KGPRA* MNOTE           00242800
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00242900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00243000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00243100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00243200
.ZG53R        ANOP  ,                                                   00243300
.*-------------------------------------------------------------------   00243400
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00243500
.ZG55         AIF   ('&XSERVICE' NE 'CWRITE').ZG79                      00243600
.*-------------------------------------------------------------------   00243700
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00243800
&ZCVAL        SETC ''           ERROR KEY FIELD                         00243900
.ZG55I0       AIF   (K'&RELEASE LE 0).ZG55I1                            00244000
&ZCVAL        SETC '&ZCVAL RELEASE'             DISALLOWED KEY          00244100
.ZG55I1       AIF   (K'&ZCVAL LE 0).ZG55J       KEY                     00244200
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00244300
&ZMS          SETC  '"CWRITE'   *KMEIA* MNOTE                           00244400
&ZMS          SETC  '&ZMS."'                                            00244500
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00244600
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00244700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00244800
.ZG55J        ANOP  ,                                                   00244900
.*-------------------------------------------------------------------   00245000
.***AG.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00245100
              AIF   (K'&ZXCWRITE LE 0).ZG55R    NOT I/O                 00245200
              AIF   ('&XCWRITE'(1,1) NE '(').ZG55R                      00245300
&ZCGPR        SETC  '&XCWRITE'(2,K'&XCWRITE-2)                          00245400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG55P                        00245500
              AIF   (K'&ZCGPR GT 2).ZG55Q                               00245600
              AIF   ('&ZCGPR' EQ '0').ZG55Q                             00245700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00245800
              AIF   (T'&ZCGPR NE 'N').ZG55Q     INVALID REG NAME        00245900
.ZG55P        ANOP  ,                                                   00246000
              AIF   (T'&ZCGPR NE 'N').ZG55R     NON NUMERIC             00246100
              AIF   ('&ZCGPR' LT '2').ZG55Q                             00246200
              AIF   ('&ZCGPR' LE '12').ZG55R                            00246300
.ZG55Q        ANOP  ,                                                   00246400
&ZMS          SETC  '"CWRITE='  *KGPRA* MNOTE                           00246500
&ZMS          SETC  '&ZMS.&CWRITE"'                                     00246600
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00246700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00246800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00246900
.ZG55R        ANOP  ,                                                   00247000
.*----------------------------------------------------------------***   00247100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00247200
              AIF   (N'&STOKEN LE 1).ZG57A      CK NUM                  00247300
&ZMS          SETC  '"STOKEN='  *KPOSA* MNOTE                           00247400
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00247500
&ZMS          SETC  '&ZMS "STOKEN"'                                     00247600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00247700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00247800
.ZG57A        ANOP  ,                                                   00247900
.*-------------------------------------------------------------------   00248000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00248100
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00248200
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00248300
              AIF   (N'&STOKEN GT 1).ZG57B      MULTI PARMS             00248400
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00248500
.ZG57B        AIF   (K'&STOKEN(1) GT 0).ZG57C                           00248600
&ZXSTOKEN     SETC  ''          RESET IN/OUTPUT                         00248700
&ZMS          SETC  ' '         *KRQDA*                                 00248800
&ZMS          SETC  '&ZMS "STOKEN" KEY AND ITS ARGUMENT'                00248900
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00249000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00249100
.ZG57C        ANOP  ,                                                   00249200
.*-------------------------------------------------------------------   00249300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00249400
              AIF   (K'&ZXSTOKEN LE 0).ZG57R    NOT I/O                 00249500
              AIF   ('&XSTOKEN'(1,1) NE '(').ZG57R                      00249600
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00249700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG57P                        00249800
              AIF   (K'&ZCGPR GT 2).ZG57Q                               00249900
              AIF   ('&ZCGPR' EQ '0').ZG57Q                             00250000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00250100
              AIF   (T'&ZCGPR NE 'N').ZG57Q     INVALID REG NAME        00250200
.ZG57P        ANOP  ,                                                   00250300
              AIF   (T'&ZCGPR NE 'N').ZG57R     NON NUMERIC             00250400
              AIF   ('&ZCGPR' LT '2').ZG57Q                             00250500
              AIF   ('&ZCGPR' LE '12').ZG57R                            00250600
.ZG57Q        ANOP  ,                                                   00250700
&ZMS          SETC  '"STOKEN='  *KGPRA* MNOTE                           00250800
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00250900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00251000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00251100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00251200
.ZG57R        ANOP  ,                                                   00251300
.*----------------------------------------------------------------***   00251400
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00251500
              AIF   (N'&ADDRSP LE 1).ZG60A      CK NUM                  00251600
&ZMS          SETC  '"ADDRSP='  *KPOSA* MNOTE                           00251700
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00251800
&ZMS          SETC  '&ZMS "ADDRSP"'                                     00251900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00252000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00252100
.ZG60A        ANOP  ,                                                   00252200
.*-------------------------------------------------------------------   00252300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00252400
&XADDRSP      SETC  ''          INITIALIZE XVARIABLE                    00252500
.ZG61A   AIF   ('&ADDRSP(1)' NE 'HOME').ZG62A                           00252600
&XADDRSP      SETC  'HOME'      SET KEYWORD                             00252700
.*-------------------------------------------------------------------   00252800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00252900
.ZG62A   AIF   ('&ADDRSP(1)' NE 'PRIMARY').ZG63A                        00253000
&XADDRSP      SETC  'PRIMARY'   SET KEYWORD                             00253100
.*-------------------------------------------------------------------   00253200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00253300
.ZG63A   AIF   ('&ADDRSP(1)' NE 'COMMON').ZG64A                         00253400
&XADDRSP      SETC  'COMMON'    SET KEYWORD                             00253500
.*-------------------------------------------------------------------   00253600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00253700
.ZG64A        AIF   (K'&XADDRSP GT 0).ZG64C     KEYWORD                 00253800
              AIF   (K'&ADDRSP(1) LE 0).ZG64B                           00253900
&ZMS          SETC  '"ADDRSP='  *KUKWA* MNOTE                           00254000
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00254100
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00254200
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00254300
&ZMS          SETC  '&ZMS "HOME",'              VALID KEYWORD           00254400
&ZMS          SETC  '&ZMS "PRIMARY",'           VALID KEYWORD           00254500
&ZMS          SETC  '&ZMS OR "COMMON".'         VALID KEYWORD           00254600
              MNOTE 8,' &ZMS '                                          00254700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00254800
.ZG64B        ANOP  ,                                                   00254900
&XADDRSP      SETC  'HOME'      SET DEFAULT KEYWORD                     00255000
.ZG64C        ANOP  ,                                                   00255100
&ZXADDRSP     SETC  'INPUT'     SET IN/OUTPUT                           00255200
.*----------------------------------------------------------------***   00255300
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00255400
              AIF   (N'&NUMRANGE LE 1).ZG66A    CK NUM                  00255500
&ZMS          SETC  '"NUMRANGE='                *KPOSA* MNOTE           00255600
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00255700
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00255800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00255900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00256000
.ZG66A        ANOP  ,                                                   00256100
.*-------------------------------------------------------------------   00256200
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00256300
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00256400
&XNUMRANGE    SETC  '1'                                                 00256500
              AIF   (K'&NUMRANGE(1) LE 0).ZG66B  PARM                   00256600
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00256700
              AIF   (N'&NUMRANGE GT 1).ZG66B    MULTI PARMS             00256800
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00256900
.ZG66B        ANOP  ,                                                   00257000
.*-------------------------------------------------------------------   00257100
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00257200
              AIF   (K'&ZXNUMRANGE LE 0).ZG66R  NOT I/O                 00257300
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZG66R                    00257400
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00257500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG66P                        00257600
              AIF   (K'&ZCGPR GT 2).ZG66Q                               00257700
              AIF   ('&ZCGPR' EQ '0').ZG66Q                             00257800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00257900
              AIF   (T'&ZCGPR NE 'N').ZG66Q     INVALID REG NAME        00258000
.ZG66P        ANOP  ,                                                   00258100
              AIF   (T'&ZCGPR NE 'N').ZG66R     NON NUMERIC             00258200
              AIF   ('&ZCGPR' LT '2').ZG66Q                             00258300
              AIF   ('&ZCGPR' LE '12').ZG66R                            00258400
.ZG66Q        ANOP  ,                                                   00258500
&ZMS          SETC  '"NUMRANGE='                *KGPRA* MNOTE           00258600
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00258700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00258800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00258900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00259000
.ZG66R        ANOP  ,                                                   00259100
.*----------------------------------------------------------------***   00259200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00259300
              AIF   (N'&RANGLIST LE 1).ZG69A    CK NUM                  00259400
&ZMS          SETC  '"RANGLIST='                *KPOSA* MNOTE           00259500
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00259600
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00259700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00259800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00259900
.ZG69A        ANOP  ,                                                   00260000
.*-------------------------------------------------------------------   00260100
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00260200
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00260300
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00260400
              AIF   (N'&RANGLIST GT 1).ZG69B    MULTI PARMS             00260500
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00260600
.ZG69B        AIF   (K'&RANGLIST(1) GT 0).ZG69C                         00260700
&ZXRANGLIST   SETC  ''          RESET IN/OUTPUT                         00260800
&ZMS          SETC  ' '         *KRQDA*                                 00260900
&ZMS          SETC  '&ZMS "RANGLIST" KEY AND ITS ARGUMENT'              00261000
              MNOTE 8,' &ZMS ARE REQUIRED.'                             00261100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00261200
.ZG69C        ANOP  ,                                                   00261300
.*-------------------------------------------------------------------   00261400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00261500
              AIF   (K'&ZXRANGLIST LE 0).ZG69R  NOT I/O                 00261600
              AIF   ('&XRANGLIST'(1,1) NE '(').ZG69R                    00261700
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00261800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG69P                        00261900
              AIF   (K'&ZCGPR GT 2).ZG69Q                               00262000
              AIF   ('&ZCGPR' EQ '0').ZG69Q                             00262100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00262200
              AIF   (T'&ZCGPR NE 'N').ZG69Q     INVALID REG NAME        00262300
.ZG69P        ANOP  ,                                                   00262400
              AIF   (T'&ZCGPR NE 'N').ZG69R     NON NUMERIC             00262500
              AIF   ('&ZCGPR' LT '2').ZG69Q                             00262600
              AIF   ('&ZCGPR' LE '12').ZG69R                            00262700
.ZG69Q        ANOP  ,                                                   00262800
&ZMS          SETC  '"RANGLIST='                *KGPRA* MNOTE           00262900
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00263000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00263100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00263200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00263300
.ZG69R        ANOP  ,                                                   00263400
.*----------------------------------------------------------------***   00263500
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00263600
              AIF   (N'&KEEP LE 1).ZG72A        CK NUM                  00263700
&ZMS          SETC  '"KEEP='    *KPOSA* MNOTE                           00263800
&ZMS          SETC  '&ZMS.&KEEP"'                                       00263900
&ZMS          SETC  '&ZMS "KEEP"'                                       00264000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00264100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00264200
.ZG72A        ANOP  ,                                                   00264300
.*-------------------------------------------------------------------   00264400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00264500
&XKEEP        SETC  ''          INITIALIZE XVARIABLE                    00264600
.ZG73A   AIF   ('&KEEP(1)' NE 'YES').ZG74A                              00264700
&XKEEP        SETC  'YES'       SET KEYWORD                             00264800
.*-------------------------------------------------------------------   00264900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00265000
.ZG74A   AIF   ('&KEEP(1)' NE 'NO').ZG75A                               00265100
&XKEEP        SETC  'NO'        SET KEYWORD                             00265200
.*-------------------------------------------------------------------   00265300
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00265400
.ZG75A        AIF   (K'&XKEEP GT 0).ZG75C       KEYWORD                 00265500
              AIF   (K'&KEEP(1) LE 0).ZG75B                             00265600
&ZMS          SETC  '"KEEP='    *KUKWA* MNOTE                           00265700
&ZMS          SETC  '&ZMS.&KEEP"'                                       00265800
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00265900
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00266000
&ZMS          SETC  '&ZMS "YES"'                VALID KEYWORD           00266100
&ZMS          SETC  '&ZMS OR "NO".'             VALID KEYWORD           00266200
              MNOTE 8,' &ZMS '                                          00266300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00266400
.ZG75B        ANOP  ,                                                   00266500
&XKEEP        SETC  'YES'       SET DEFAULT KEYWORD                     00266600
.ZG75C        ANOP  ,                                                   00266700
&ZXKEEP       SETC  'INPUT'     SET IN/OUTPUT                           00266800
.*----------------------------------------------------------------***   00266900
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00267000
              AIF   (N'&HSPALET LE 1).ZG77A     CK NUM                  00267100
&ZMS          SETC  '"HSPALET='                 *KPOSA* MNOTE           00267200
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00267300
&ZMS          SETC  '&ZMS "HSPALET"'                                    00267400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00267500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00267600
.ZG77A        ANOP  ,                                                   00267700
.*-------------------------------------------------------------------   00267800
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00267900
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00268000
&XHSPALET     SETC  '0'                                                 00268100
              AIF   (K'&HSPALET(1) LE 0).ZG77B  PARM                    00268200
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00268300
              AIF   (N'&HSPALET GT 1).ZG77B     MULTI PARMS             00268400
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00268500
.ZG77B        ANOP  ,                                                   00268600
.*-------------------------------------------------------------------   00268700
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00268800
              AIF   (K'&ZXHSPALET LE 0).ZG77R   NOT I/O                 00268900
              AIF   ('&XHSPALET' EQ '0').ZG77R                          00269000
              AIF   ('&XHSPALET'(1,1) NE '(').ZG77R                     00269100
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00269200
              AIF   ('&ZCGPR'(1,1) NE '0').ZG77P                        00269300
              AIF   (K'&ZCGPR GT 2).ZG77Q                               00269400
              AIF   ('&ZCGPR' EQ '0').ZG77Q                             00269500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00269600
              AIF   (T'&ZCGPR NE 'N').ZG77Q     INVALID REG NAME        00269700
.ZG77P        ANOP  ,                                                   00269800
              AIF   (T'&ZCGPR NE 'N').ZG77R     NON NUMERIC             00269900
              AIF   ('&ZCGPR' LT '2').ZG77Q                             00270000
              AIF   ('&ZCGPR' LE '12').ZG77R                            00270100
.ZG77Q        ANOP  ,                                                   00270200
&ZMS          SETC  '"HSPALET='                 *KGPRA* MNOTE           00270300
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00270400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00270500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00270600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00270700
.ZG77R        ANOP  ,                                                   00270800
.*-------------------------------------------------------------------   00270900
.***AG.KMEKY15 VALUE, RQD INPUT, ME KEYS -END                           00271000
.ZG79         ANOP  ,           END MUTUALLY EXCLUSIVE KEYS             00271100
.*----------------------------------------------------------------***   00271200
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00271300
              AIF   (N'&RETCODE LE 1).ZG81A     CK NUM                  00271400
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           00271500
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00271600
&ZMS          SETC  '&ZMS "RETCODE"'                                    00271700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00271800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00271900
.ZG81A        ANOP  ,                                                   00272000
.*-------------------------------------------------------------------   00272100
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00272200
              AIF   (K'&RETCODE(1) LE 0).ZG81C  NO PARM                 00272300
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              00272400
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00272500
              AIF   (N'&RETCODE GT 1).ZG81C                             00272600
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00272700
.ZG81C        ANOP  ,                                                   00272800
.*-------------------------------------------------------------------   00272900
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00273000
              AIF   (K'&ZXRETCODE LE 0).ZG81R   NOT I/O                 00273100
              AIF   ('&XRETCODE'(1,1) NE '(').ZG81R                     00273200
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00273300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG81P                        00273400
              AIF   (K'&ZCGPR GT 2).ZG81Q                               00273500
              AIF   ('&ZCGPR' EQ '0').ZG81Q                             00273600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00273700
              AIF   (T'&ZCGPR NE 'N').ZG81Q     INVALID REG NAME        00273800
.ZG81P        ANOP  ,                                                   00273900
              AIF   (T'&ZCGPR NE 'N').ZG81R     NON NUMERIC             00274000
              AIF   ('&ZCGPR' LT '2').ZG81Q                             00274100
              AIF   ('&ZCGPR' LE '12').ZG81R                            00274200
.ZG81Q        ANOP  ,                                                   00274300
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           00274400
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00274500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00274600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00274700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00274800
.ZG81R        ANOP  ,                                                   00274900
.*----------------------------------------------------------------***   00275000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00275100
              AIF   (N'&RSNCODE LE 1).ZG84A     CK NUM                  00275200
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           00275300
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00275400
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00275500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00275600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00275700
.ZG84A        ANOP  ,                                                   00275800
.*-------------------------------------------------------------------   00275900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00276000
              AIF   (K'&RSNCODE(1) LE 0).ZG84C  NO PARM                 00276100
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00276200
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00276300
              AIF   (N'&RSNCODE GT 1).ZG84C                             00276400
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00276500
.ZG84C        ANOP  ,                                                   00276600
.*-------------------------------------------------------------------   00276700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00276800
              AIF   (K'&ZXRSNCODE LE 0).ZG84R   NOT I/O                 00276900
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG84R                     00277000
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00277100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG84P                        00277200
              AIF   (K'&ZCGPR GT 2).ZG84Q                               00277300
              AIF   ('&ZCGPR' EQ '0').ZG84Q                             00277400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00277500
              AIF   (T'&ZCGPR NE 'N').ZG84Q     INVALID REG NAME        00277600
.ZG84P        ANOP  ,                                                   00277700
              AIF   (T'&ZCGPR NE 'N').ZG84R     NON NUMERIC             00277800
              AIF   ('&ZCGPR' LT '2').ZG84Q                             00277900
              AIF   ('&ZCGPR' LE '12').ZG84R                            00278000
.ZG84Q        ANOP  ,                                                   00278100
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           00278200
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00278300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00278400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00278500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00278600
.ZG84R        ANOP  ,                                                   00278700
.******************************************************************     00278800
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00278900
.******************************************************************     00279000
              ACTR  10000                                               00279100
.*-------------------------------------------------------------------   00279200
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00279300
&ZCVAL        SETC  ''          ERROR FIELD                             00279400
&ZAWRK        SETA  0           POSITIONAL COUNTER                      00279500
&ZASYSLNDX    SETA  0           NON-X KEY COUNTER                       00279600
.ZGLIST2      ANOP  ,                                                   00279700
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT NON-X KEY          00279800
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 00279900
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          00280000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00280100
              AIF   (&ZAWRK LE 0).ZGLIST2                               00280200
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA                 00280300
              AGO   .ZGLIST2                                            00280400
.*                                                                      00280500
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  00280600
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00280700
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00280800
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00280900
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00281000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00281100
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00281200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00281300
.ZGLISTX      ANOP  ,                                                   00281400
&ZASYSLNDX    SETA  0                                                   00281500
.*-------------------------------------------------------------------   00281600
.***AG.MF04 MF=(SLME)                                                   00281700
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00281800
.********************************************************************   00281900
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00282000
.********************************************************************   00282100
              ACTR  10000                                               00282200
.*-------------------------------------------------------------------   00282300
.***AE.MF01 MF=(SLME)                                                   00282400
              AIF   ('&XMF' EQ 'L').ZEMFX                               00282500
              AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                      00282600
.********************************************************************   00282700
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00282800
.********************************************************************   00282900
&XRELEASE     SETC  ''          INITIALIZE XVARIABLE                    00283000
&XADDRSP      SETC  ''          INITIALIZE XVARIABLE                    00283100
&XKEEP        SETC  ''          INITIALIZE XVARIABLE                    00283200
.*-------------------------------------------------------------------   00283300
.***AE.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00283400
&XSERVICE     SETC  ''          INITIALIZE XVARIABLE                    00283500
&ZASYSLNDX    SETA  0                                                   00283600
.ZE5A         ANOP  ,           POSITIONAL KEY SEARCH                   00283700
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00283800
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZE5B  DONE                    00283900
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZE5A             00284000
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'SREAD').ZE5A                 00284100
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00284200
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00284300
&XSERVICE     SETC  'SREAD'     SET XVARIABLE                           00284400
&ZXSREAD      SETC  'INPUT'     SET IN/OUTPUT                           00284500
&XSREAD       SETC  'SREAD'     SET XVARIABLE                           00284600
.ZE5B         ANOP  ,                                                   00284700
.*-------------------------------------------------------------------   00284800
.***AE.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00284900
&ZASYSLNDX    SETA  0                                                   00285000
.ZE23A        ANOP  ,           POSITIONAL KEY SEARCH                   00285100
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00285200
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZE23C  DONE                   00285300
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZE23A            00285400
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'SWRITE').ZE23A               00285500
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00285600
              AIF   (K'&XSERVICE LE 0).ZE23B    VALID                   00285700
&ZMS          SETC  '"SWRITE'   *KMEKA* MNOTE                           00285800
&ZMS          SETC  '&ZMS."'                                            00285900
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00286000
&ZMS          SETC  '&ZMS "&XSERVICE"'                                  00286100
              MNOTE 8,' &ZMS KEY.'                                      00286200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00286300
              AGO   .ZE23C                                              00286400
.*                                                                      00286500
.ZE23B        ANOP  ,                                                   00286600
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00286700
&XSERVICE     SETC  'SWRITE'    SET XVARIABLE                           00286800
&ZXSWRITE     SETC  'INPUT'     SET IN/OUTPUT                           00286900
&XSWRITE      SETC  'SWRITE'    SET XVARIABLE                           00287000
.ZE23C        ANOP  ,                                                   00287100
.*-------------------------------------------------------------------   00287200
.***AE.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00287300
&ZASYSLNDX    SETA  0                                                   00287400
.ZE36A        ANOP  ,           POSITIONAL KEY SEARCH                   00287500
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00287600
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZE36C  DONE                   00287700
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZE36A            00287800
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'CREAD').ZE36A                00287900
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00288000
              AIF   (K'&XSERVICE LE 0).ZE36B    VALID                   00288100
&ZMS          SETC  '"CREAD'    *KMEKA* MNOTE                           00288200
&ZMS          SETC  '&ZMS."'                                            00288300
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00288400
&ZMS          SETC  '&ZMS "&XSERVICE"'                                  00288500
              MNOTE 8,' &ZMS KEY.'                                      00288600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00288700
              AGO   .ZE36C                                              00288800
.*                                                                      00288900
.ZE36B        ANOP  ,                                                   00289000
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00289100
&XSERVICE     SETC  'CREAD'     SET XVARIABLE                           00289200
&ZXCREAD      SETC  'INPUT'     SET IN/OUTPUT                           00289300
&XCREAD       SETC  'CREAD'     SET XVARIABLE                           00289400
.ZE36C        ANOP  ,                                                   00289500
.*-------------------------------------------------------------------   00289600
.***AE.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00289700
&ZASYSLNDX    SETA  0                                                   00289800
.ZE55A        ANOP  ,           POSITIONAL KEY SEARCH                   00289900
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00290000
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZE55C  DONE                   00290100
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZE55A            00290200
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'CWRITE').ZE55A               00290300
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00290400
              AIF   (K'&XSERVICE LE 0).ZE55B    VALID                   00290500
&ZMS          SETC  '"CWRITE'   *KMEKA* MNOTE                           00290600
&ZMS          SETC  '&ZMS."'                                            00290700
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00290800
&ZMS          SETC  '&ZMS "&XSERVICE"'                                  00290900
              MNOTE 8,' &ZMS KEY.'                                      00291000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00291100
              AGO   .ZE55C                                              00291200
.*                                                                      00291300
.ZE55B        ANOP  ,                                                   00291400
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00291500
&XSERVICE     SETC  'CWRITE'    SET XVARIABLE                           00291600
&ZXCWRITE     SETC  'INPUT'     SET IN/OUTPUT                           00291700
&XCWRITE      SETC  'CWRITE'    SET XVARIABLE                           00291800
.ZE55C        ANOP  ,                                                   00291900
.*------------------------------------------------------------------    00292000
.***AE.KMEKY07 VALUE, RQD INPUT, ME KEYS -CHECK IF ENTERED              00292100
              AIF   (K'&XSERVICE GT 0).ZE79B                            00292200
&ZXSERVICE    SETC  ''          RESET IN/OUTPUT                         00292300
&XSERVICE     SETC  ''          SET NULL                                00292400
&ZXSREAD      SETC  ''          RESET OUTPUT                            00292500
&XSREAD       SETC  ''          SET NULL PARM                           00292600
.ZE79B        ANOP  ,                                                   00292700
.*-------------------------------------------------------------------   00292800
.***AE.KMEKY08 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00292900
.ZE5     AIF   ('&XSERVICE' NE 'SREAD').ZE23                            00293000
.*-------------------------------------------------------------------   00293100
.***AE.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00293200
              AIF   (K'&ZXSREAD LE 0).ZE5R      NOT I/O                 00293300
              AIF   ('&XSREAD'(1,1) NE '(').ZE5R                        00293400
&ZCGPR        SETC  '&XSREAD'(2,K'&XSREAD-2)                            00293500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE5P                         00293600
              AIF   (K'&ZCGPR GT 2).ZE5Q                                00293700
              AIF   ('&ZCGPR' EQ '0').ZE5Q                              00293800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00293900
              AIF   (T'&ZCGPR NE 'N').ZE5Q      INVALID REG NAME        00294000
.ZE5P         ANOP  ,                                                   00294100
              AIF   (T'&ZCGPR NE 'N').ZE5R      NON NUMERIC             00294200
              AIF   ('&ZCGPR' LT '2').ZE5Q                              00294300
              AIF   ('&ZCGPR' LE '12').ZE5R                             00294400
.ZE5Q         ANOP  ,                                                   00294500
&ZMS          SETC  '"SREAD='   *KGPRA* MNOTE                           00294600
&ZMS          SETC  '&ZMS.&SREAD"'                                      00294700
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00294800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00294900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00295000
.ZE5R         ANOP  ,                                                   00295100
.*----------------------------------------------------------------***   00295200
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00295300
              AIF   (N'&STOKEN LE 1).ZE7A       CK NUM                  00295400
&ZMS          SETC  '"STOKEN='  *KPOSA* MNOTE                           00295500
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00295600
&ZMS          SETC  '&ZMS "STOKEN"'                                     00295700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00295800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00295900
.ZE7A         ANOP  ,                                                   00296000
.*-------------------------------------------------------------------   00296100
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00296200
              AIF   (K'&STOKEN(1) LE 0).ZE7B    NO PRM                  00296300
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00296400
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00296500
              AIF   (N'&STOKEN GT 1).ZE7B                               00296600
.*            ANOP              MULTIPLE PARMS                          00296700
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00296800
.ZE7B         ANOP  ,                                                   00296900
.*-------------------------------------------------------------------   00297000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00297100
              AIF   (K'&ZXSTOKEN LE 0).ZE7R     NOT I/O                 00297200
              AIF   ('&XSTOKEN'(1,1) NE '(').ZE7R                       00297300
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00297400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE7P                         00297500
              AIF   (K'&ZCGPR GT 2).ZE7Q                                00297600
              AIF   ('&ZCGPR' EQ '0').ZE7Q                              00297700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00297800
              AIF   (T'&ZCGPR NE 'N').ZE7Q      INVALID REG NAME        00297900
.ZE7P         ANOP  ,                                                   00298000
              AIF   (T'&ZCGPR NE 'N').ZE7R      NON NUMERIC             00298100
              AIF   ('&ZCGPR' LT '2').ZE7Q                              00298200
              AIF   ('&ZCGPR' LE '12').ZE7R                             00298300
.ZE7Q         ANOP  ,                                                   00298400
&ZMS          SETC  '"STOKEN='  *KGPRA* MNOTE                           00298500
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00298600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00298700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00298800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00298900
.ZE7R         ANOP  ,                                                   00299000
.*----------------------------------------------------------------***   00299100
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00299200
              AIF   (N'&NUMRANGE LE 1).ZE10A    CK NUM                  00299300
&ZMS          SETC  '"NUMRANGE='                *KPOSA* MNOTE           00299400
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00299500
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00299600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00299700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00299800
.ZE10A        ANOP  ,                                                   00299900
.*-------------------------------------------------------------------   00300000
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00300100
              AIF   (K'&NUMRANGE(1) LE 0).ZE10B NO PRM                  00300200
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00300300
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00300400
              AIF   (N'&NUMRANGE GT 1).ZE10B                            00300500
.*            ANOP              MULTIPLE PARMS                          00300600
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00300700
.ZE10B        ANOP  ,                                                   00300800
.*-------------------------------------------------------------------   00300900
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00301000
              AIF   (K'&ZXNUMRANGE LE 0).ZE10R  NOT I/O                 00301100
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZE10R                    00301200
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00301300
              AIF   ('&ZCGPR'(1,1) NE '0').ZE10P                        00301400
              AIF   (K'&ZCGPR GT 2).ZE10Q                               00301500
              AIF   ('&ZCGPR' EQ '0').ZE10Q                             00301600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00301700
              AIF   (T'&ZCGPR NE 'N').ZE10Q     INVALID REG NAME        00301800
.ZE10P        ANOP  ,                                                   00301900
              AIF   (T'&ZCGPR NE 'N').ZE10R     NON NUMERIC             00302000
              AIF   ('&ZCGPR' LT '2').ZE10Q                             00302100
              AIF   ('&ZCGPR' LE '12').ZE10R                            00302200
.ZE10Q        ANOP  ,                                                   00302300
&ZMS          SETC  '"NUMRANGE='                *KGPRA* MNOTE           00302400
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00302500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00302600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00302700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00302800
.ZE10R        ANOP  ,                                                   00302900
.*----------------------------------------------------------------***   00303000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00303100
              AIF   (N'&RANGLIST LE 1).ZE13A    CK NUM                  00303200
&ZMS          SETC  '"RANGLIST='                *KPOSA* MNOTE           00303300
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00303400
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00303500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00303600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00303700
.ZE13A        ANOP  ,                                                   00303800
.*-------------------------------------------------------------------   00303900
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00304000
              AIF   (K'&RANGLIST(1) LE 0).ZE13B NO PRM                  00304100
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00304200
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00304300
              AIF   (N'&RANGLIST GT 1).ZE13B                            00304400
.*            ANOP              MULTIPLE PARMS                          00304500
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00304600
.ZE13B        ANOP  ,                                                   00304700
.*-------------------------------------------------------------------   00304800
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00304900
              AIF   (K'&ZXRANGLIST LE 0).ZE13R  NOT I/O                 00305000
              AIF   ('&XRANGLIST'(1,1) NE '(').ZE13R                    00305100
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00305200
              AIF   ('&ZCGPR'(1,1) NE '0').ZE13P                        00305300
              AIF   (K'&ZCGPR GT 2).ZE13Q                               00305400
              AIF   ('&ZCGPR' EQ '0').ZE13Q                             00305500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00305600
              AIF   (T'&ZCGPR NE 'N').ZE13Q     INVALID REG NAME        00305700
.ZE13P        ANOP  ,                                                   00305800
              AIF   (T'&ZCGPR NE 'N').ZE13R     NON NUMERIC             00305900
              AIF   ('&ZCGPR' LT '2').ZE13Q                             00306000
              AIF   ('&ZCGPR' LE '12').ZE13R                            00306100
.ZE13Q        ANOP  ,                                                   00306200
&ZMS          SETC  '"RANGLIST='                *KGPRA* MNOTE           00306300
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00306400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00306500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00306600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00306700
.ZE13R        ANOP  ,                                                   00306800
.*-------------------------------------------------------------------   00306900
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00307000
&ZTLC         SETC 'NO'                                                 00307100
              AIF   ('&RELEASE(1)' NE '&ZTLC').ZE17A                    00307200
&XRELEASE     SETC  'NO'        SET KEYWORD                             00307300
              AIF   (N'&RELEASE LE 1).ZE17A     CK NUM                  00307400
&ZMS          SETC  '"RELEASE='                 *KPOSA* MNOTE           00307500
&ZMS          SETC  '&ZMS.&RELEASE"'                                    00307600
&ZMS          SETC  '&ZMS "RELEASE"'                                    00307700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00307800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00307900
.ZE17A        ANOP  ,                                                   00308000
.*----------------------------------------------------------------***   00308100
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00308200
              AIF   (N'&HSPALET LE 1).ZE19A     CK NUM                  00308300
&ZMS          SETC  '"HSPALET='                 *KPOSA* MNOTE           00308400
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00308500
&ZMS          SETC  '&ZMS "HSPALET"'                                    00308600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00308700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00308800
.ZE19A        ANOP  ,                                                   00308900
.*-------------------------------------------------------------------   00309000
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00309100
              AIF   (K'&HSPALET(1) LE 0).ZE19B  NO PRM                  00309200
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00309300
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00309400
              AIF   (N'&HSPALET GT 1).ZE19B                             00309500
.*            ANOP              MULTIPLE PARMS                          00309600
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00309700
.ZE19B        ANOP  ,                                                   00309800
.*-------------------------------------------------------------------   00309900
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00310000
              AIF   (K'&ZXHSPALET LE 0).ZE19R   NOT I/O                 00310100
              AIF   ('&XHSPALET'(1,1) NE '(').ZE19R                     00310200
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00310300
              AIF   ('&ZCGPR'(1,1) NE '0').ZE19P                        00310400
              AIF   (K'&ZCGPR GT 2).ZE19Q                               00310500
              AIF   ('&ZCGPR' EQ '0').ZE19Q                             00310600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00310700
              AIF   (T'&ZCGPR NE 'N').ZE19Q     INVALID REG NAME        00310800
.ZE19P        ANOP  ,                                                   00310900
              AIF   (T'&ZCGPR NE 'N').ZE19R     NON NUMERIC             00311000
              AIF   ('&ZCGPR' LT '2').ZE19Q                             00311100
              AIF   ('&ZCGPR' LE '12').ZE19R                            00311200
.ZE19Q        ANOP  ,                                                   00311300
&ZMS          SETC  '"HSPALET='                 *KGPRA* MNOTE           00311400
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00311500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00311600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00311700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00311800
.ZE19R        ANOP  ,                                                   00311900
.*-------------------------------------------------------------------   00312000
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00312100
&ZTLC         SETC 'YES'                                                00312200
              AIF   ('&RELEASE(1)' NE '&ZTLC').ZE21A                    00312300
&XRELEASE     SETC  'YES'       SET KEYWORD                             00312400
              AIF   (N'&RELEASE LE 1).ZE21A     CK NUM                  00312500
&ZMS          SETC  '"RELEASE='                 *KPOSA* MNOTE           00312600
&ZMS          SETC  '&ZMS.&RELEASE"'                                    00312700
&ZMS          SETC  '&ZMS "RELEASE"'                                    00312800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00312900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00313000
.ZE21A        ANOP  ,                                                   00313100
.*------------------------------------------------------------------    00313200
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00313300
.ZE22         AIF   (K'&XRELEASE GT 0).ZE22A    VALID                   00313400
              AIF   (K'&RELEASE(1) LE 0).ZE22B                          00313500
&ZMS          SETC  '"RELEASE='                 *KUKWA* MNOTE           00313600
&ZMS          SETC  '&ZMS.&RELEASE"'                                    00313700
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00313800
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00313900
&ZMS          SETC  '&ZMS "NO"'                 VALID KEYWORD           00314000
&ZMS          SETC  '&ZMS OR "YES".'            VALID KEYWORD           00314100
              MNOTE 8,' &ZMS '                                          00314200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00314300
              AGO   .ZE22B                                              00314400
.*                                                                      00314500
.ZE22A        ANOP  ,                                                   00314600
&ZXRELEASE    SETC  'INPUT'     SET IN/OUTPUT                           00314700
.ZE22B        ANOP  ,                                                   00314800
.*-------------------------------------------------------------------   00314900
.***AE.KMEKY08 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00315000
.ZE23     AIF   ('&XSERVICE' NE 'SWRITE').ZE36                          00315100
.*-------------------------------------------------------------------   00315200
.***AE.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00315300
              AIF   (K'&ZXSWRITE LE 0).ZE23R    NOT I/O                 00315400
              AIF   ('&XSWRITE'(1,1) NE '(').ZE23R                      00315500
&ZCGPR        SETC  '&XSWRITE'(2,K'&XSWRITE-2)                          00315600
              AIF   ('&ZCGPR'(1,1) NE '0').ZE23P                        00315700
              AIF   (K'&ZCGPR GT 2).ZE23Q                               00315800
              AIF   ('&ZCGPR' EQ '0').ZE23Q                             00315900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00316000
              AIF   (T'&ZCGPR NE 'N').ZE23Q     INVALID REG NAME        00316100
.ZE23P        ANOP  ,                                                   00316200
              AIF   (T'&ZCGPR NE 'N').ZE23R     NON NUMERIC             00316300
              AIF   ('&ZCGPR' LT '2').ZE23Q                             00316400
              AIF   ('&ZCGPR' LE '12').ZE23R                            00316500
.ZE23Q        ANOP  ,                                                   00316600
&ZMS          SETC  '"SWRITE='  *KGPRA* MNOTE                           00316700
&ZMS          SETC  '&ZMS.&SWRITE"'                                     00316800
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00316900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00317000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00317100
.ZE23R        ANOP  ,                                                   00317200
.*----------------------------------------------------------------***   00317300
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00317400
              AIF   (N'&STOKEN LE 1).ZE25A      CK NUM                  00317500
&ZMS          SETC  '"STOKEN='  *KPOSA* MNOTE                           00317600
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00317700
&ZMS          SETC  '&ZMS "STOKEN"'                                     00317800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00317900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00318000
.ZE25A        ANOP  ,                                                   00318100
.*-------------------------------------------------------------------   00318200
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00318300
              AIF   (K'&STOKEN(1) LE 0).ZE25B   NO PRM                  00318400
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00318500
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00318600
              AIF   (N'&STOKEN GT 1).ZE25B                              00318700
.*            ANOP              MULTIPLE PARMS                          00318800
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00318900
.ZE25B        ANOP  ,                                                   00319000
.*-------------------------------------------------------------------   00319100
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00319200
              AIF   (K'&ZXSTOKEN LE 0).ZE25R    NOT I/O                 00319300
              AIF   ('&XSTOKEN'(1,1) NE '(').ZE25R                      00319400
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00319500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE25P                        00319600
              AIF   (K'&ZCGPR GT 2).ZE25Q                               00319700
              AIF   ('&ZCGPR' EQ '0').ZE25Q                             00319800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00319900
              AIF   (T'&ZCGPR NE 'N').ZE25Q     INVALID REG NAME        00320000
.ZE25P        ANOP  ,                                                   00320100
              AIF   (T'&ZCGPR NE 'N').ZE25R     NON NUMERIC             00320200
              AIF   ('&ZCGPR' LT '2').ZE25Q                             00320300
              AIF   ('&ZCGPR' LE '12').ZE25R                            00320400
.ZE25Q        ANOP  ,                                                   00320500
&ZMS          SETC  '"STOKEN='  *KGPRA* MNOTE                           00320600
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00320700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00320800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00320900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00321000
.ZE25R        ANOP  ,                                                   00321100
.*----------------------------------------------------------------***   00321200
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00321300
              AIF   (N'&NUMRANGE LE 1).ZE28A    CK NUM                  00321400
&ZMS          SETC  '"NUMRANGE='                *KPOSA* MNOTE           00321500
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00321600
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00321700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00321800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00321900
.ZE28A        ANOP  ,                                                   00322000
.*-------------------------------------------------------------------   00322100
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00322200
              AIF   (K'&NUMRANGE(1) LE 0).ZE28B NO PRM                  00322300
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00322400
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00322500
              AIF   (N'&NUMRANGE GT 1).ZE28B                            00322600
.*            ANOP              MULTIPLE PARMS                          00322700
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00322800
.ZE28B        ANOP  ,                                                   00322900
.*-------------------------------------------------------------------   00323000
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00323100
              AIF   (K'&ZXNUMRANGE LE 0).ZE28R  NOT I/O                 00323200
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZE28R                    00323300
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00323400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE28P                        00323500
              AIF   (K'&ZCGPR GT 2).ZE28Q                               00323600
              AIF   ('&ZCGPR' EQ '0').ZE28Q                             00323700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00323800
              AIF   (T'&ZCGPR NE 'N').ZE28Q     INVALID REG NAME        00323900
.ZE28P        ANOP  ,                                                   00324000
              AIF   (T'&ZCGPR NE 'N').ZE28R     NON NUMERIC             00324100
              AIF   ('&ZCGPR' LT '2').ZE28Q                             00324200
              AIF   ('&ZCGPR' LE '12').ZE28R                            00324300
.ZE28Q        ANOP  ,                                                   00324400
&ZMS          SETC  '"NUMRANGE='                *KGPRA* MNOTE           00324500
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00324600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00324700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00324800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00324900
.ZE28R        ANOP  ,                                                   00325000
.*----------------------------------------------------------------***   00325100
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00325200
              AIF   (N'&RANGLIST LE 1).ZE31A    CK NUM                  00325300
&ZMS          SETC  '"RANGLIST='                *KPOSA* MNOTE           00325400
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00325500
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00325600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00325700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00325800
.ZE31A        ANOP  ,                                                   00325900
.*-------------------------------------------------------------------   00326000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00326100
              AIF   (K'&RANGLIST(1) LE 0).ZE31B NO PRM                  00326200
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00326300
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00326400
              AIF   (N'&RANGLIST GT 1).ZE31B                            00326500
.*            ANOP              MULTIPLE PARMS                          00326600
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00326700
.ZE31B        ANOP  ,                                                   00326800
.*-------------------------------------------------------------------   00326900
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00327000
              AIF   (K'&ZXRANGLIST LE 0).ZE31R  NOT I/O                 00327100
              AIF   ('&XRANGLIST'(1,1) NE '(').ZE31R                    00327200
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00327300
              AIF   ('&ZCGPR'(1,1) NE '0').ZE31P                        00327400
              AIF   (K'&ZCGPR GT 2).ZE31Q                               00327500
              AIF   ('&ZCGPR' EQ '0').ZE31Q                             00327600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00327700
              AIF   (T'&ZCGPR NE 'N').ZE31Q     INVALID REG NAME        00327800
.ZE31P        ANOP  ,                                                   00327900
              AIF   (T'&ZCGPR NE 'N').ZE31R     NON NUMERIC             00328000
              AIF   ('&ZCGPR' LT '2').ZE31Q                             00328100
              AIF   ('&ZCGPR' LE '12').ZE31R                            00328200
.ZE31Q        ANOP  ,                                                   00328300
&ZMS          SETC  '"RANGLIST='                *KGPRA* MNOTE           00328400
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00328500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00328600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00328700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00328800
.ZE31R        ANOP  ,                                                   00328900
.*----------------------------------------------------------------***   00329000
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00329100
              AIF   (N'&HSPALET LE 1).ZE34A     CK NUM                  00329200
&ZMS          SETC  '"HSPALET='                 *KPOSA* MNOTE           00329300
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00329400
&ZMS          SETC  '&ZMS "HSPALET"'                                    00329500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00329600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00329700
.ZE34A        ANOP  ,                                                   00329800
.*-------------------------------------------------------------------   00329900
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00330000
              AIF   (K'&HSPALET(1) LE 0).ZE34B  NO PRM                  00330100
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00330200
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00330300
              AIF   (N'&HSPALET GT 1).ZE34B                             00330400
.*            ANOP              MULTIPLE PARMS                          00330500
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00330600
.ZE34B        ANOP  ,                                                   00330700
.*-------------------------------------------------------------------   00330800
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00330900
              AIF   (K'&ZXHSPALET LE 0).ZE34R   NOT I/O                 00331000
              AIF   ('&XHSPALET'(1,1) NE '(').ZE34R                     00331100
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00331200
              AIF   ('&ZCGPR'(1,1) NE '0').ZE34P                        00331300
              AIF   (K'&ZCGPR GT 2).ZE34Q                               00331400
              AIF   ('&ZCGPR' EQ '0').ZE34Q                             00331500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00331600
              AIF   (T'&ZCGPR NE 'N').ZE34Q     INVALID REG NAME        00331700
.ZE34P        ANOP  ,                                                   00331800
              AIF   (T'&ZCGPR NE 'N').ZE34R     NON NUMERIC             00331900
              AIF   ('&ZCGPR' LT '2').ZE34Q                             00332000
              AIF   ('&ZCGPR' LE '12').ZE34R                            00332100
.ZE34Q        ANOP  ,                                                   00332200
&ZMS          SETC  '"HSPALET='                 *KGPRA* MNOTE           00332300
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00332400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00332500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00332600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00332700
.ZE34R        ANOP  ,                                                   00332800
.*-------------------------------------------------------------------   00332900
.***AE.KMEKY08 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00333000
.ZE36     AIF   ('&XSERVICE' NE 'CREAD').ZE55                           00333100
.*-------------------------------------------------------------------   00333200
.***AE.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00333300
              AIF   (K'&ZXCREAD LE 0).ZE36R     NOT I/O                 00333400
              AIF   ('&XCREAD'(1,1) NE '(').ZE36R                       00333500
&ZCGPR        SETC  '&XCREAD'(2,K'&XCREAD-2)                            00333600
              AIF   ('&ZCGPR'(1,1) NE '0').ZE36P                        00333700
              AIF   (K'&ZCGPR GT 2).ZE36Q                               00333800
              AIF   ('&ZCGPR' EQ '0').ZE36Q                             00333900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00334000
              AIF   (T'&ZCGPR NE 'N').ZE36Q     INVALID REG NAME        00334100
.ZE36P        ANOP  ,                                                   00334200
              AIF   (T'&ZCGPR NE 'N').ZE36R     NON NUMERIC             00334300
              AIF   ('&ZCGPR' LT '2').ZE36Q                             00334400
              AIF   ('&ZCGPR' LE '12').ZE36R                            00334500
.ZE36Q        ANOP  ,                                                   00334600
&ZMS          SETC  '"CREAD='   *KGPRA* MNOTE                           00334700
&ZMS          SETC  '&ZMS.&CREAD"'                                      00334800
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00334900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00335000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00335100
.ZE36R        ANOP  ,                                                   00335200
.*----------------------------------------------------------------***   00335300
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00335400
              AIF   (N'&STOKEN LE 1).ZE38A      CK NUM                  00335500
&ZMS          SETC  '"STOKEN='  *KPOSA* MNOTE                           00335600
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00335700
&ZMS          SETC  '&ZMS "STOKEN"'                                     00335800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00335900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00336000
.ZE38A        ANOP  ,                                                   00336100
.*-------------------------------------------------------------------   00336200
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00336300
              AIF   (K'&STOKEN(1) LE 0).ZE38B   NO PRM                  00336400
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00336500
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00336600
              AIF   (N'&STOKEN GT 1).ZE38B                              00336700
.*            ANOP              MULTIPLE PARMS                          00336800
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00336900
.ZE38B        ANOP  ,                                                   00337000
.*-------------------------------------------------------------------   00337100
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00337200
              AIF   (K'&ZXSTOKEN LE 0).ZE38R    NOT I/O                 00337300
              AIF   ('&XSTOKEN'(1,1) NE '(').ZE38R                      00337400
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00337500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE38P                        00337600
              AIF   (K'&ZCGPR GT 2).ZE38Q                               00337700
              AIF   ('&ZCGPR' EQ '0').ZE38Q                             00337800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00337900
              AIF   (T'&ZCGPR NE 'N').ZE38Q     INVALID REG NAME        00338000
.ZE38P        ANOP  ,                                                   00338100
              AIF   (T'&ZCGPR NE 'N').ZE38R     NON NUMERIC             00338200
              AIF   ('&ZCGPR' LT '2').ZE38Q                             00338300
              AIF   ('&ZCGPR' LE '12').ZE38R                            00338400
.ZE38Q        ANOP  ,                                                   00338500
&ZMS          SETC  '"STOKEN='  *KGPRA* MNOTE                           00338600
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00338700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00338800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00338900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00339000
.ZE38R        ANOP  ,                                                   00339100
.*----------------------------------------------------------------***   00339200
.***AE.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00339300
              AIF   (N'&ADDRSP LE 1).ZE41A      CK NUM                  00339400
&ZMS          SETC  '"ADDRSP='  *KPOSA* MNOTE                           00339500
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00339600
&ZMS          SETC  '&ZMS "ADDRSP"'                                     00339700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00339800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00339900
.ZE41A        ANOP  ,                                                   00340000
.*-------------------------------------------------------------------   00340100
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00340200
.ZE42A   AIF   ('&ADDRSP(1)' NE 'HOME').ZE43A                           00340300
&XADDRSP      SETC  'HOME'      SET KEYWORD                             00340400
.*-------------------------------------------------------------------   00340500
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00340600
.ZE43A   AIF   ('&ADDRSP(1)' NE 'PRIMARY').ZE44A                        00340700
&XADDRSP      SETC  'PRIMARY'   SET KEYWORD                             00340800
.*-------------------------------------------------------------------   00340900
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00341000
.ZE44A   AIF   ('&ADDRSP(1)' NE 'COMMON').ZE45A                         00341100
&XADDRSP      SETC  'COMMON'    SET KEYWORD                             00341200
.*-------------------------------------------------------------------   00341300
.***AE.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00341400
.ZE45A        AIF   (K'&XADDRSP GT 0).ZE45B     KEYWORD                 00341500
              AIF   (K'&ADDRSP(1) LE 0).ZE45C                           00341600
&ZMS          SETC  '"ADDRSP='  *KUKWA* MNOTE                           00341700
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00341800
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00341900
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00342000
&ZMS          SETC  '&ZMS "HOME",'              VALID KEYWORD           00342100
&ZMS          SETC  '&ZMS "PRIMARY",'           VALID KEYWORD           00342200
&ZMS          SETC  '&ZMS OR "COMMON".'         VALID KEYWORD           00342300
              MNOTE 8,' &ZMS '                                          00342400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00342500
              AGO   .ZE45C                                              00342600
.*                                                                      00342700
.ZE45B        ANOP  ,                                                   00342800
&ZXADDRSP     SETC  'INPUT'     SET IN/OUTPUT                           00342900
.ZE45C        ANOP  ,                                                   00343000
.*----------------------------------------------------------------***   00343100
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00343200
              AIF   (N'&NUMRANGE LE 1).ZE47A    CK NUM                  00343300
&ZMS          SETC  '"NUMRANGE='                *KPOSA* MNOTE           00343400
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00343500
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00343600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00343700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00343800
.ZE47A        ANOP  ,                                                   00343900
.*-------------------------------------------------------------------   00344000
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00344100
              AIF   (K'&NUMRANGE(1) LE 0).ZE47B NO PRM                  00344200
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00344300
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00344400
              AIF   (N'&NUMRANGE GT 1).ZE47B                            00344500
.*            ANOP              MULTIPLE PARMS                          00344600
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00344700
.ZE47B        ANOP  ,                                                   00344800
.*-------------------------------------------------------------------   00344900
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00345000
              AIF   (K'&ZXNUMRANGE LE 0).ZE47R  NOT I/O                 00345100
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZE47R                    00345200
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00345300
              AIF   ('&ZCGPR'(1,1) NE '0').ZE47P                        00345400
              AIF   (K'&ZCGPR GT 2).ZE47Q                               00345500
              AIF   ('&ZCGPR' EQ '0').ZE47Q                             00345600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00345700
              AIF   (T'&ZCGPR NE 'N').ZE47Q     INVALID REG NAME        00345800
.ZE47P        ANOP  ,                                                   00345900
              AIF   (T'&ZCGPR NE 'N').ZE47R     NON NUMERIC             00346000
              AIF   ('&ZCGPR' LT '2').ZE47Q                             00346100
              AIF   ('&ZCGPR' LE '12').ZE47R                            00346200
.ZE47Q        ANOP  ,                                                   00346300
&ZMS          SETC  '"NUMRANGE='                *KGPRA* MNOTE           00346400
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00346500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00346600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00346700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00346800
.ZE47R        ANOP  ,                                                   00346900
.*----------------------------------------------------------------***   00347000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00347100
              AIF   (N'&RANGLIST LE 1).ZE50A    CK NUM                  00347200
&ZMS          SETC  '"RANGLIST='                *KPOSA* MNOTE           00347300
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00347400
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00347500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00347600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00347700
.ZE50A        ANOP  ,                                                   00347800
.*-------------------------------------------------------------------   00347900
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00348000
              AIF   (K'&RANGLIST(1) LE 0).ZE50B NO PRM                  00348100
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00348200
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00348300
              AIF   (N'&RANGLIST GT 1).ZE50B                            00348400
.*            ANOP              MULTIPLE PARMS                          00348500
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00348600
.ZE50B        ANOP  ,                                                   00348700
.*-------------------------------------------------------------------   00348800
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00348900
              AIF   (K'&ZXRANGLIST LE 0).ZE50R  NOT I/O                 00349000
              AIF   ('&XRANGLIST'(1,1) NE '(').ZE50R                    00349100
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00349200
              AIF   ('&ZCGPR'(1,1) NE '0').ZE50P                        00349300
              AIF   (K'&ZCGPR GT 2).ZE50Q                               00349400
              AIF   ('&ZCGPR' EQ '0').ZE50Q                             00349500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00349600
              AIF   (T'&ZCGPR NE 'N').ZE50Q     INVALID REG NAME        00349700
.ZE50P        ANOP  ,                                                   00349800
              AIF   (T'&ZCGPR NE 'N').ZE50R     NON NUMERIC             00349900
              AIF   ('&ZCGPR' LT '2').ZE50Q                             00350000
              AIF   ('&ZCGPR' LE '12').ZE50R                            00350100
.ZE50Q        ANOP  ,                                                   00350200
&ZMS          SETC  '"RANGLIST='                *KGPRA* MNOTE           00350300
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00350400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00350500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00350600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00350700
.ZE50R        ANOP  ,                                                   00350800
.*----------------------------------------------------------------***   00350900
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00351000
              AIF   (N'&HSPALET LE 1).ZE53A     CK NUM                  00351100
&ZMS          SETC  '"HSPALET='                 *KPOSA* MNOTE           00351200
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00351300
&ZMS          SETC  '&ZMS "HSPALET"'                                    00351400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00351500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00351600
.ZE53A        ANOP  ,                                                   00351700
.*-------------------------------------------------------------------   00351800
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00351900
              AIF   (K'&HSPALET(1) LE 0).ZE53B  NO PRM                  00352000
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00352100
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00352200
              AIF   (N'&HSPALET GT 1).ZE53B                             00352300
.*            ANOP              MULTIPLE PARMS                          00352400
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00352500
.ZE53B        ANOP  ,                                                   00352600
.*-------------------------------------------------------------------   00352700
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00352800
              AIF   (K'&ZXHSPALET LE 0).ZE53R   NOT I/O                 00352900
              AIF   ('&XHSPALET'(1,1) NE '(').ZE53R                     00353000
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00353100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE53P                        00353200
              AIF   (K'&ZCGPR GT 2).ZE53Q                               00353300
              AIF   ('&ZCGPR' EQ '0').ZE53Q                             00353400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00353500
              AIF   (T'&ZCGPR NE 'N').ZE53Q     INVALID REG NAME        00353600
.ZE53P        ANOP  ,                                                   00353700
              AIF   (T'&ZCGPR NE 'N').ZE53R     NON NUMERIC             00353800
              AIF   ('&ZCGPR' LT '2').ZE53Q                             00353900
              AIF   ('&ZCGPR' LE '12').ZE53R                            00354000
.ZE53Q        ANOP  ,                                                   00354100
&ZMS          SETC  '"HSPALET='                 *KGPRA* MNOTE           00354200
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00354300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00354400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00354500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00354600
.ZE53R        ANOP  ,                                                   00354700
.*-------------------------------------------------------------------   00354800
.***AE.KMEKY08 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00354900
.ZE55     AIF   ('&XSERVICE' NE 'CWRITE').ZE79                          00355000
.*-------------------------------------------------------------------   00355100
.***AE.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00355200
              AIF   (K'&ZXCWRITE LE 0).ZE55R    NOT I/O                 00355300
              AIF   ('&XCWRITE'(1,1) NE '(').ZE55R                      00355400
&ZCGPR        SETC  '&XCWRITE'(2,K'&XCWRITE-2)                          00355500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE55P                        00355600
              AIF   (K'&ZCGPR GT 2).ZE55Q                               00355700
              AIF   ('&ZCGPR' EQ '0').ZE55Q                             00355800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00355900
              AIF   (T'&ZCGPR NE 'N').ZE55Q     INVALID REG NAME        00356000
.ZE55P        ANOP  ,                                                   00356100
              AIF   (T'&ZCGPR NE 'N').ZE55R     NON NUMERIC             00356200
              AIF   ('&ZCGPR' LT '2').ZE55Q                             00356300
              AIF   ('&ZCGPR' LE '12').ZE55R                            00356400
.ZE55Q        ANOP  ,                                                   00356500
&ZMS          SETC  '"CWRITE='  *KGPRA* MNOTE                           00356600
&ZMS          SETC  '&ZMS.&CWRITE"'                                     00356700
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00356800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00356900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00357000
.ZE55R        ANOP  ,                                                   00357100
.*----------------------------------------------------------------***   00357200
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00357300
              AIF   (N'&STOKEN LE 1).ZE57A      CK NUM                  00357400
&ZMS          SETC  '"STOKEN='  *KPOSA* MNOTE                           00357500
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00357600
&ZMS          SETC  '&ZMS "STOKEN"'                                     00357700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00357800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00357900
.ZE57A        ANOP  ,                                                   00358000
.*-------------------------------------------------------------------   00358100
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00358200
              AIF   (K'&STOKEN(1) LE 0).ZE57B   NO PRM                  00358300
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00358400
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00358500
              AIF   (N'&STOKEN GT 1).ZE57B                              00358600
.*            ANOP              MULTIPLE PARMS                          00358700
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00358800
.ZE57B        ANOP  ,                                                   00358900
.*-------------------------------------------------------------------   00359000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00359100
              AIF   (K'&ZXSTOKEN LE 0).ZE57R    NOT I/O                 00359200
              AIF   ('&XSTOKEN'(1,1) NE '(').ZE57R                      00359300
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00359400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE57P                        00359500
              AIF   (K'&ZCGPR GT 2).ZE57Q                               00359600
              AIF   ('&ZCGPR' EQ '0').ZE57Q                             00359700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00359800
              AIF   (T'&ZCGPR NE 'N').ZE57Q     INVALID REG NAME        00359900
.ZE57P        ANOP  ,                                                   00360000
              AIF   (T'&ZCGPR NE 'N').ZE57R     NON NUMERIC             00360100
              AIF   ('&ZCGPR' LT '2').ZE57Q                             00360200
              AIF   ('&ZCGPR' LE '12').ZE57R                            00360300
.ZE57Q        ANOP  ,                                                   00360400
&ZMS          SETC  '"STOKEN='  *KGPRA* MNOTE                           00360500
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00360600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00360700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00360800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00360900
.ZE57R        ANOP  ,                                                   00361000
.*----------------------------------------------------------------***   00361100
.***AE.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00361200
              AIF   (N'&ADDRSP LE 1).ZE60A      CK NUM                  00361300
&ZMS          SETC  '"ADDRSP='  *KPOSA* MNOTE                           00361400
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00361500
&ZMS          SETC  '&ZMS "ADDRSP"'                                     00361600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00361700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00361800
.ZE60A        ANOP  ,                                                   00361900
.*-------------------------------------------------------------------   00362000
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00362100
.ZE61A   AIF   ('&ADDRSP(1)' NE 'HOME').ZE62A                           00362200
&XADDRSP      SETC  'HOME'      SET KEYWORD                             00362300
.*-------------------------------------------------------------------   00362400
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00362500
.ZE62A   AIF   ('&ADDRSP(1)' NE 'PRIMARY').ZE63A                        00362600
&XADDRSP      SETC  'PRIMARY'   SET KEYWORD                             00362700
.*-------------------------------------------------------------------   00362800
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00362900
.ZE63A   AIF   ('&ADDRSP(1)' NE 'COMMON').ZE64A                         00363000
&XADDRSP      SETC  'COMMON'    SET KEYWORD                             00363100
.*-------------------------------------------------------------------   00363200
.***AE.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00363300
.ZE64A        AIF   (K'&XADDRSP GT 0).ZE64B     KEYWORD                 00363400
              AIF   (K'&ADDRSP(1) LE 0).ZE64C                           00363500
&ZMS          SETC  '"ADDRSP='  *KUKWA* MNOTE                           00363600
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00363700
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00363800
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00363900
&ZMS          SETC  '&ZMS "HOME",'              VALID KEYWORD           00364000
&ZMS          SETC  '&ZMS "PRIMARY",'           VALID KEYWORD           00364100
&ZMS          SETC  '&ZMS OR "COMMON".'         VALID KEYWORD           00364200
              MNOTE 8,' &ZMS '                                          00364300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00364400
              AGO   .ZE64C                                              00364500
.*                                                                      00364600
.ZE64B        ANOP  ,                                                   00364700
&ZXADDRSP     SETC  'INPUT'     SET IN/OUTPUT                           00364800
.ZE64C        ANOP  ,                                                   00364900
.*----------------------------------------------------------------***   00365000
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00365100
              AIF   (N'&NUMRANGE LE 1).ZE66A    CK NUM                  00365200
&ZMS          SETC  '"NUMRANGE='                *KPOSA* MNOTE           00365300
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00365400
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00365500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00365600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00365700
.ZE66A        ANOP  ,                                                   00365800
.*-------------------------------------------------------------------   00365900
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00366000
              AIF   (K'&NUMRANGE(1) LE 0).ZE66B NO PRM                  00366100
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00366200
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00366300
              AIF   (N'&NUMRANGE GT 1).ZE66B                            00366400
.*            ANOP              MULTIPLE PARMS                          00366500
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00366600
.ZE66B        ANOP  ,                                                   00366700
.*-------------------------------------------------------------------   00366800
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00366900
              AIF   (K'&ZXNUMRANGE LE 0).ZE66R  NOT I/O                 00367000
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZE66R                    00367100
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00367200
              AIF   ('&ZCGPR'(1,1) NE '0').ZE66P                        00367300
              AIF   (K'&ZCGPR GT 2).ZE66Q                               00367400
              AIF   ('&ZCGPR' EQ '0').ZE66Q                             00367500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00367600
              AIF   (T'&ZCGPR NE 'N').ZE66Q     INVALID REG NAME        00367700
.ZE66P        ANOP  ,                                                   00367800
              AIF   (T'&ZCGPR NE 'N').ZE66R     NON NUMERIC             00367900
              AIF   ('&ZCGPR' LT '2').ZE66Q                             00368000
              AIF   ('&ZCGPR' LE '12').ZE66R                            00368100
.ZE66Q        ANOP  ,                                                   00368200
&ZMS          SETC  '"NUMRANGE='                *KGPRA* MNOTE           00368300
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00368400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00368500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00368600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00368700
.ZE66R        ANOP  ,                                                   00368800
.*----------------------------------------------------------------***   00368900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00369000
              AIF   (N'&RANGLIST LE 1).ZE69A    CK NUM                  00369100
&ZMS          SETC  '"RANGLIST='                *KPOSA* MNOTE           00369200
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00369300
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00369400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00369500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00369600
.ZE69A        ANOP  ,                                                   00369700
.*-------------------------------------------------------------------   00369800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00369900
              AIF   (K'&RANGLIST(1) LE 0).ZE69B NO PRM                  00370000
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00370100
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00370200
              AIF   (N'&RANGLIST GT 1).ZE69B                            00370300
.*            ANOP              MULTIPLE PARMS                          00370400
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00370500
.ZE69B        ANOP  ,                                                   00370600
.*-------------------------------------------------------------------   00370700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00370800
              AIF   (K'&ZXRANGLIST LE 0).ZE69R  NOT I/O                 00370900
              AIF   ('&XRANGLIST'(1,1) NE '(').ZE69R                    00371000
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00371100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE69P                        00371200
              AIF   (K'&ZCGPR GT 2).ZE69Q                               00371300
              AIF   ('&ZCGPR' EQ '0').ZE69Q                             00371400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00371500
              AIF   (T'&ZCGPR NE 'N').ZE69Q     INVALID REG NAME        00371600
.ZE69P        ANOP  ,                                                   00371700
              AIF   (T'&ZCGPR NE 'N').ZE69R     NON NUMERIC             00371800
              AIF   ('&ZCGPR' LT '2').ZE69Q                             00371900
              AIF   ('&ZCGPR' LE '12').ZE69R                            00372000
.ZE69Q        ANOP  ,                                                   00372100
&ZMS          SETC  '"RANGLIST='                *KGPRA* MNOTE           00372200
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00372300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00372400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00372500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00372600
.ZE69R        ANOP  ,                                                   00372700
.*----------------------------------------------------------------***   00372800
.***AE.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00372900
              AIF   (N'&KEEP LE 1).ZE72A        CK NUM                  00373000
&ZMS          SETC  '"KEEP='    *KPOSA* MNOTE                           00373100
&ZMS          SETC  '&ZMS.&KEEP"'                                       00373200
&ZMS          SETC  '&ZMS "KEEP"'                                       00373300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00373400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00373500
.ZE72A        ANOP  ,                                                   00373600
.*-------------------------------------------------------------------   00373700
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00373800
.ZE73A   AIF   ('&KEEP(1)' NE 'YES').ZE74A                              00373900
&XKEEP        SETC  'YES'       SET KEYWORD                             00374000
.*-------------------------------------------------------------------   00374100
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00374200
.ZE74A   AIF   ('&KEEP(1)' NE 'NO').ZE75A                               00374300
&XKEEP        SETC  'NO'        SET KEYWORD                             00374400
.*-------------------------------------------------------------------   00374500
.***AE.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00374600
.ZE75A        AIF   (K'&XKEEP GT 0).ZE75B       KEYWORD                 00374700
              AIF   (K'&KEEP(1) LE 0).ZE75C                             00374800
&ZMS          SETC  '"KEEP='    *KUKWA* MNOTE                           00374900
&ZMS          SETC  '&ZMS.&KEEP"'                                       00375000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00375100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00375200
&ZMS          SETC  '&ZMS "YES"'                VALID KEYWORD           00375300
&ZMS          SETC  '&ZMS OR "NO".'             VALID KEYWORD           00375400
              MNOTE 8,' &ZMS '                                          00375500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00375600
              AGO   .ZE75C                                              00375700
.*                                                                      00375800
.ZE75B        ANOP  ,                                                   00375900
&ZXKEEP       SETC  'INPUT'     SET IN/OUTPUT                           00376000
.ZE75C        ANOP  ,                                                   00376100
.*----------------------------------------------------------------***   00376200
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00376300
              AIF   (N'&HSPALET LE 1).ZE77A     CK NUM                  00376400
&ZMS          SETC  '"HSPALET='                 *KPOSA* MNOTE           00376500
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00376600
&ZMS          SETC  '&ZMS "HSPALET"'                                    00376700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00376800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00376900
.ZE77A        ANOP  ,                                                   00377000
.*-------------------------------------------------------------------   00377100
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00377200
              AIF   (K'&HSPALET(1) LE 0).ZE77B  NO PRM                  00377300
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00377400
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00377500
              AIF   (N'&HSPALET GT 1).ZE77B                             00377600
.*            ANOP              MULTIPLE PARMS                          00377700
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00377800
.ZE77B        ANOP  ,                                                   00377900
.*-------------------------------------------------------------------   00378000
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00378100
              AIF   (K'&ZXHSPALET LE 0).ZE77R   NOT I/O                 00378200
              AIF   ('&XHSPALET'(1,1) NE '(').ZE77R                     00378300
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00378400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE77P                        00378500
              AIF   (K'&ZCGPR GT 2).ZE77Q                               00378600
              AIF   ('&ZCGPR' EQ '0').ZE77Q                             00378700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00378800
              AIF   (T'&ZCGPR NE 'N').ZE77Q     INVALID REG NAME        00378900
.ZE77P        ANOP  ,                                                   00379000
              AIF   (T'&ZCGPR NE 'N').ZE77R     NON NUMERIC             00379100
              AIF   ('&ZCGPR' LT '2').ZE77Q                             00379200
              AIF   ('&ZCGPR' LE '12').ZE77R                            00379300
.ZE77Q        ANOP  ,                                                   00379400
&ZMS          SETC  '"HSPALET='                 *KGPRA* MNOTE           00379500
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00379600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00379700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00379800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00379900
.ZE77R        ANOP  ,                                                   00380000
.*-------------------------------------------------------------------   00380100
.***AE.KMEKY09 VALUE, RQD INPUT, ME KEYS -END                           00380200
.ZE79         ANOP  ,           END MUTUALLY EXCLUSIVE KEYS             00380300
.*----------------------------------------------------------------***   00380400
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00380500
              AIF   (N'&RETCODE LE 1).ZE81A     CK NUM                  00380600
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           00380700
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00380800
&ZMS          SETC  '&ZMS "RETCODE"'                                    00380900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00381000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00381100
.ZE81A        ANOP  ,                                                   00381200
.*-------------------------------------------------------------------   00381300
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00381400
              AIF   (K'&RETCODE(1) LE 0).ZE81B  NO PRM                  00381500
&ZXRETCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00381600
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00381700
              AIF   (N'&RETCODE GT 1).ZE81B                             00381800
.*            ANOP              MULTIPLE PARMS                          00381900
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00382000
.ZE81B        ANOP  ,                                                   00382100
.*-------------------------------------------------------------------   00382200
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00382300
              AIF   (K'&ZXRETCODE LE 0).ZE81R   NOT I/O                 00382400
              AIF   ('&XRETCODE'(1,1) NE '(').ZE81R                     00382500
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00382600
              AIF   ('&ZCGPR'(1,1) NE '0').ZE81P                        00382700
              AIF   (K'&ZCGPR GT 2).ZE81Q                               00382800
              AIF   ('&ZCGPR' EQ '0').ZE81Q                             00382900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00383000
              AIF   (T'&ZCGPR NE 'N').ZE81Q     INVALID REG NAME        00383100
.ZE81P        ANOP  ,                                                   00383200
              AIF   (T'&ZCGPR NE 'N').ZE81R     NON NUMERIC             00383300
              AIF   ('&ZCGPR' LT '2').ZE81Q                             00383400
              AIF   ('&ZCGPR' LE '12').ZE81R                            00383500
.ZE81Q        ANOP  ,                                                   00383600
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           00383700
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00383800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00383900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00384000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00384100
.ZE81R        ANOP  ,                                                   00384200
.*----------------------------------------------------------------***   00384300
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00384400
              AIF   (N'&RSNCODE LE 1).ZE84A     CK NUM                  00384500
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           00384600
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00384700
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00384800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00384900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00385000
.ZE84A        ANOP  ,                                                   00385100
.*-------------------------------------------------------------------   00385200
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00385300
              AIF   (K'&RSNCODE(1) LE 0).ZE84B  NO PRM                  00385400
&ZXRSNCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00385500
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00385600
              AIF   (N'&RSNCODE GT 1).ZE84B                             00385700
.*            ANOP              MULTIPLE PARMS                          00385800
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00385900
.ZE84B        ANOP  ,                                                   00386000
.*-------------------------------------------------------------------   00386100
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00386200
              AIF   (K'&ZXRSNCODE LE 0).ZE84R   NOT I/O                 00386300
              AIF   ('&XRSNCODE'(1,1) NE '(').ZE84R                     00386400
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00386500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE84P                        00386600
              AIF   (K'&ZCGPR GT 2).ZE84Q                               00386700
              AIF   ('&ZCGPR' EQ '0').ZE84Q                             00386800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00386900
              AIF   (T'&ZCGPR NE 'N').ZE84Q     INVALID REG NAME        00387000
.ZE84P        ANOP  ,                                                   00387100
              AIF   (T'&ZCGPR NE 'N').ZE84R     NON NUMERIC             00387200
              AIF   ('&ZCGPR' LT '2').ZE84Q                             00387300
              AIF   ('&ZCGPR' LE '12').ZE84R                            00387400
.ZE84Q        ANOP  ,                                                   00387500
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           00387600
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00387700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00387800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00387900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00388000
.ZE84R        ANOP  ,                                                   00388100
.******************************************************************     00388200
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00388300
.******************************************************************     00388400
              ACTR  10000                                               00388500
.*-------------------------------------------------------------------   00388600
.***AF.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00388700
&ZCVAL        SETC  ''          ERROR FIELD                             00388800
&ZAWRK        SETA  0           POSITIONAL COUNTER                      00388900
&ZASYSLNDX    SETA  0           NON-X KEY COUNTER                       00389000
.ZELIST2      ANOP  ,                                                   00389100
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT NON-X KEY          00389200
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZELIST3  DONE                 00389300
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZELIST2          00389400
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00389500
              AIF   (&ZAWRK LE 0).ZELIST2                               00389600
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA                 00389700
              AGO   .ZELIST2                                            00389800
.*                                                                      00389900
.ZELIST3  AIF  (K'&ZCVAL LE 0).ZELISTX                                  00390000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00390100
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           00390200
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00390300
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00390400
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00390500
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00390600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00390700
.ZELISTX      ANOP  ,                                                   00390800
&ZASYSLNDX    SETA  0                                                   00390900
.*-------------------------------------------------------------------   00391000
.***AE.MF02 MF=(SLME)                                                   00391100
.ZEMFX        ANOP  ,           END OF PARTIAL SYNTAX CHECK             00391200
.*******************************************************************    00391300
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00391400
.*******************************************************************    00391500
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00391600
.*******************************************************************    00391700
.***AE.01  START OF HSPSERV MACRO CODE                                  00391800
.*******************************************************************    00391900
              LCLC  &M0M0001                 NAME                       00392000
&M0M0001      SETC  '&XLABEL'                SET NAME                   00392100
              AIF   (K'&XLABEL NE 0).XLAB2                              00392200
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00392300
.*                                                                      00392400
.XLAB2        ANOP  ,                                                   00392500
&M0M0001 DS    0H                             HSPSERV-1                 00392600
.*******************************************************************    00392700
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00392800
.*******************************************************************    00392900
              PUSH  PRINT                                               00393000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00393100
              PRINT OFF         ++ PR01                                 00393200
              AGO   .ZPRNTXX                                            00393300
.ZPRINTX      PRINT ON                                                  00393400
.ZPRNTXX      ANOP  ,                                                   00393500
.********************************************************************   00393600
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00393700
.********************************************************************   00393800
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00393900
                      LCLA  &ZOPN1         INVOCATION INDEX             00394000
                      LCLC  &ZOPL(4095)    LABEL                        00394100
                      LCLC  &ZOPO(4095)    OPERATION                    00394200
                      LCLC  &ZOPV(4095)    VALUE                        00394300
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00394400
.*                                                                      00394500
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00394600
.******************************************************************     00394700
.***AL.L10 HSPSERV FMT=LIST MF=S|L PARAMETERS                           00394800
.******************************************************************     00394900
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00395000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00395100
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00395200
&XMFATTR              SETC  '0D'                                        00395300
.*                                                                      00395400
&ZOPN                 SETA  &ZOPN+1                                     00395500
&ZOPL(&ZOPN)          SETC  ' '                                         00395600
&ZOPO(&ZOPN)          SETC  'B'                                         00395700
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00395800
&ZOPD(&ZOPN)          SETC  '++ HSPSERV ARG PARMS'                      00395900
.*                                                                      00396000
&ZOPN                 SETA  &ZOPN+1                                     00396100
&ZOPL(&ZOPN)          SETC  ' '                                         00396200
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00396300
&ZOPV(&ZOPN)          SETC  '1'                                         00396400
&ZOPD(&ZOPN)          SETC  ' '                                         00396500
.*                                                                      00396600
.ZLMFSL2              ANOP  ,                                           00396700
.*-------------------------------------------------------------------   00396800
.***AM.L01  HSPSERV FMT=LIST PARAMETERS                                 00396900
&ZOPN                 SETA &ZOPN+1                                      00397000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00397100
&ZOPO(&ZOPN)          SETC 'DS'                                         00397200
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00397300
&ZOPD(&ZOPN)          SETC '++ HSPSERV PARM LIST'                       00397400
.*-------------------------------------------------------------------   00397500
.***AM.L02 XVERSION XL1                                                 00397600
&ZOPN                 SETA &ZOPN+1                                      00397700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00397800
&ZOPO(&ZOPN)          SETC 'DS'                                         00397900
&ZOPV(&ZOPN)          SETC 'XL1'                                        00398000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00398100
.*-------------------------------------------------------------------   00398200
.***AM.L05 XSERVICE XL1                                                 00398300
&ZOPN                 SETA &ZOPN+1                                      00398400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSERVICE'                         00398500
&ZOPO(&ZOPN)          SETC 'DS'                                         00398600
&ZOPV(&ZOPN)          SETC 'XL1'                                        00398700
&ZOPD(&ZOPN)          SETC '++ &ZXSERVICE XSERVICE'                     00398800
.*                                                                      00398900
&ZOPN                 SETA  &ZOPN+1                                     00399000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._SREAD'                           00399100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00399200
&ZOPV(&ZOPN)          SETC  '1'                                         00399300
&ZOPD(&ZOPN)          SETC  '++ XSERVICE.'                              00399400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SREAD'                        00399500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00399600
.*                                                                      00399700
&ZOPN                 SETA  &ZOPN+1                                     00399800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._SWRITE'                          00399900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00400000
&ZOPV(&ZOPN)          SETC  '2'                                         00400100
&ZOPD(&ZOPN)          SETC  '++ XSERVICE.'                              00400200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SWRITE'                       00400300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00400400
.*                                                                      00400500
&ZOPN                 SETA  &ZOPN+1                                     00400600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._CREAD'                           00400700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00400800
&ZOPV(&ZOPN)          SETC  '3'                                         00400900
&ZOPD(&ZOPN)          SETC  '++ XSERVICE.'                              00401000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CREAD'                        00401100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00401200
.*                                                                      00401300
&ZOPN                 SETA  &ZOPN+1                                     00401400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._CWRITE'                          00401500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00401600
&ZOPV(&ZOPN)          SETC  '4'                                         00401700
&ZOPD(&ZOPN)          SETC  '++ XSERVICE.'                              00401800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CWRITE'                       00401900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00402000
.*-------------------------------------------------------------------   00402100
.***AM.L09  XRVS00001 BL.16                                             00402200
&ZOPN                 SETA &ZOPN+1                                      00402300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRVS00001'                        00402400
&ZOPO(&ZOPN)          SETC 'DS'                                         00402500
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00402600
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRVS00001'                  00402700
.*-------------------------------------------------------------------   00402800
.***AM.L03 XFLAGS1 BL.8                                                 00402900
&ZOPN                 SETA &ZOPN+1                                      00403000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS1'                          00403100
&ZOPO(&ZOPN)          SETC 'DS'                                         00403200
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00403300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00403400
.*                                                                      00403500
&ZOPN                 SETA  &ZOPN+1                                     00403600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XRELEASE_YES'                    00403700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00403800
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00403900
&ZOPD(&ZOPN)          SETC  '++ XRELEASE.'                              00404000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00404100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00404200
.*                                                                      00404300
&ZOPN                 SETA  &ZOPN+1                                     00404400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XADDRSP_HOME'                    00404500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00404600
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00404700
&ZOPD(&ZOPN)          SETC  '++ XADDRSP.'                               00404800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).HOME'                         00404900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00405000
.*                                                                      00405100
&ZOPN                 SETA  &ZOPN+1                                     00405200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XADDRSP_PRIMARY'                 00405300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00405400
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00405500
&ZOPD(&ZOPN)          SETC  '++ XADDRSP.'                               00405600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).PRIMARY'                      00405700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00405800
.*                                                                      00405900
&ZOPN                 SETA  &ZOPN+1                                     00406000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XADDRSP_COMMON'                  00406100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00406200
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00406300
&ZOPD(&ZOPN)          SETC  '++ XADDRSP.'                               00406400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).COMMON'                       00406500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00406600
.*                                                                      00406700
&ZOPN                 SETA  &ZOPN+1                                     00406800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XKEEP_YES'                       00406900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00407000
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00407100
&ZOPD(&ZOPN)          SETC  '++ XKEEP.'                                 00407200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00407300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00407400
.*-------------------------------------------------------------------   00407500
.***AM.L09  XRVS00002 BL.8                                              00407600
&ZOPN                 SETA &ZOPN+1                                      00407700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRVS00002'                        00407800
&ZOPO(&ZOPN)          SETC 'DS'                                         00407900
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00408000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRVS00002'                  00408100
.*-------------------------------------------------------------------   00408200
.***AM.L09  XRVS00003 BL.16                                             00408300
&ZOPN                 SETA &ZOPN+1                                      00408400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRVS00003'                        00408500
&ZOPO(&ZOPN)          SETC 'DS'                                         00408600
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00408700
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRVS00003'                  00408800
.*-------------------------------------------------------------------   00408900
.***AM.L09  XSTOKEN CL8                                                 00409000
&ZOPN                 SETA &ZOPN+1                                      00409100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTOKEN'                          00409200
&ZOPO(&ZOPN)          SETC 'DS'                                         00409300
&ZOPV(&ZOPN)          SETC 'CL8'                                        00409400
&ZOPD(&ZOPN)          SETC '++ &ZXSTOKEN  XSTOKEN'                      00409500
.*-------------------------------------------------------------------   00409600
.***AM.L09  XNUMRANGE F                                                 00409700
&ZOPN                 SETA &ZOPN+1                                      00409800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XNUMRANGE'                        00409900
&ZOPO(&ZOPN)          SETC 'DS'                                         00410000
&ZOPV(&ZOPN)          SETC 'F'                                          00410100
&ZOPD(&ZOPN)          SETC '++ &ZXNUMRANGE  XNUMRANGE'                  00410200
.*-------------------------------------------------------------------   00410300
.***AM.L09  XRANGLIST A                                                 00410400
&ZOPN                 SETA &ZOPN+1                                      00410500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRANGLIST'                        00410600
&ZOPO(&ZOPN)          SETC 'DS'                                         00410700
&ZOPV(&ZOPN)          SETC 'A'                                          00410800
&ZOPD(&ZOPN)          SETC '++ &ZXRANGLIST  XRANGLIST'                  00410900
.*-------------------------------------------------------------------   00411000
.***AM.LVER1                                                            00411100
                      AIF  (&XPLISTVER LT 1).ZL18L                      00411200
.*-------------------------------------------------------------------   00411300
.*-------------------------------------------------------------------   00411400
.***AM.L09  XHSPALET F                                                  00411500
&ZOPN                 SETA &ZOPN+1                                      00411600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XHSPALET'                         00411700
&ZOPO(&ZOPN)          SETC 'DS'                                         00411800
&ZOPV(&ZOPN)          SETC 'F'                                          00411900
&ZOPD(&ZOPN)          SETC '++ &ZXHSPALET  XHSPALET'                    00412000
.*-------------------------------------------------------------------   00412100
.***AM.LVER2                                                            00412200
.ZL18L                ANOP  ,                                           00412300
.*-------------------------------------------------------------------   00412400
.*-------------------------------------------------------------------   00412500
.***AM.L10 END OF HSPSERV LIST PARAMETERS                               00412600
&ZOPN                 SETA &ZOPN+1                                      00412700
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00412800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00412900
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00413000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00413100
.*                                                                      00413200
&ZOPN                 SETA &ZOPN+1                                      00413300
&ZOPL(&ZOPN)          SETC ' '                                          00413400
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00413500
&ZOPV(&ZOPN)          SETC '1'                                          00413600
&ZOPD(&ZOPN)          SETC ' '                                          00413700
.*-------------------------------------------------------------------   00413800
.***AL.L12 HSPSERV FMT=LIST MF=S|L PARAMETERS                           00413900
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00414000
.*                                                                      00414100
&ZOPN                 SETA  &ZOPN+1                                     00414200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00414300
&ZOPO(&ZOPN)          SETC  'DC'                                        00414400
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00414500
&ZOPD(&ZOPN)          SETC  '++ HSPSERV ARG PARMS'                      00414600
.*                                                                      00414700
.ZLMFSLX              ANOP  ,                                           00414800
.*-------------------------------------------------------------------   00414900
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00415000
&ZPLLEN               SETA 24                                           00415100
.*                                                                      00415200
                      AIF  (&XPLISTVER LT 1).ZLLEN2Z                    00415300
&ZPLLEN               SETA 28                                           00415400
.ZLLEN2Z              ANOP  ,                                           00415500
.*                                                                      00415600
.******************************************************************     00415700
.***AI.L01 HSPSERV FMT=LIST FILL IN PARAMETER AREA                      00415800
.******************************************************************     00415900
                      ACTR  10000                                       00416000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00416100
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00416200
&ZCVAL                SETC  'LAE'          XAX MODE                     00416300
.ZIMFXA               ANOP ,                                            00416400
.*                                                                      00416500
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00416600
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00416700
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00416800
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00416900
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00417000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00417100
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00417200
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00417300
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00417400
&ZOPN                 SETA  &ZOPN+1                                     00417500
&ZOPL(&ZOPN)          SETC  ' '                                         00417600
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00417700
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00417800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00417900
                      AGO   .ZIMFNX                                     00418000
.*                                                                      00418100
.ZIMFN2               ANOP ,                                            00418200
&ZOPN                 SETA  &ZOPN+1                                     00418300
&ZOPL(&ZOPN)          SETC  ' '                                         00418400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00418500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00418600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00418700
.ZIMFNX               ANOP ,                                            00418800
.********************************************************************   00418900
.***AI.L02 HSPSERV FMT=LIST INITIALIZE PARAMETER AREA                   00419000
.********************************************************************   00419100
.***AI.L03 MF=(SLME)                                                    00419200
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00419300
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00419400
.*                                                                      00419500
&ZOPN                 SETA  &ZOPN+1                                     00419600
&ZOPL(&ZOPN)          SETC  ' '                                         00419700
&ZOPO(&ZOPN)          SETC  'XC'                                        00419800
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00419900
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00420000
.ZIMFLX               ANOP  ,                                           00420100
.*-------------------------------------------------------------------   00420200
.***AI.L04A XVERSION XL1                                                00420300
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00420400
                      AIF   ('&PLISTVER' NE '').ZIMFVV                  00420500
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFVW            00420600
.ZIMFVV               ANOP  ,                                           00420700
&ZOPN                 SETA  &ZOPN+1                                     00420800
&ZOPL(&ZOPN)          SETC  ' '                                         00420900
&ZOPO(&ZOPN)          SETC  'MVI'                                       00421000
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00421100
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00421200
.ZIMFVW               ANOP  ,                                           00421300
.*-------------------------------------------------------------------   00421400
.***AI.L07 XSERVICE AL1                                                 00421500
&ZW                   SETC  ''                                          00421600
.*-------------------------------------------------------------------   00421700
.***AI.L15 XSERVICE "SREAD" AL1                                         00421800
         AIF   ('&XSERVICE' NE 'SREAD').ZI3A                            00421900
&ZW                   SETC  '1'                                         00422000
.ZI3A                 ANOP  ,                                           00422100
.*-------------------------------------------------------------------   00422200
.***AI.L15 XSERVICE "SWRITE" AL1                                        00422300
         AIF   ('&XSERVICE' NE 'SWRITE').ZI4A                           00422400
&ZW                   SETC  '2'                                         00422500
.ZI4A                 ANOP  ,                                           00422600
.*-------------------------------------------------------------------   00422700
.***AI.L15 XSERVICE "CREAD" AL1                                         00422800
         AIF   ('&XSERVICE' NE 'CREAD').ZI5A                            00422900
&ZW                   SETC  '3'                                         00423000
.ZI5A                 ANOP  ,                                           00423100
.*-------------------------------------------------------------------   00423200
.***AI.L15 XSERVICE "CWRITE" AL1                                        00423300
         AIF   ('&XSERVICE' NE 'CWRITE').ZI6A                           00423400
&ZW                   SETC  '4'                                         00423500
.ZI6A                 ANOP  ,                                           00423600
.*-------------------------------------------------------------------   00423700
.***AI.L17 XSERVICE AL1                                                 00423800
                      AIF   ('&ZW' NE '0').ZI6C                         00423900
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI6B              00424000
.ZI6C                 ANOP  ,                                           00424100
                      AIF   ('&ZW' EQ '').ZI6B                          00424200
.*                                                                      00424300
&ZOPN                 SETA  &ZOPN+1                                     00424400
&ZOPL(&ZOPN)          SETC  ' '                                         00424500
&ZOPO(&ZOPN)          SETC  'MVI'                                       00424600
&ZOPV(&ZOPN)          SETC  '1(1),&ZW'                                  00424700
&ZOPD(&ZOPN)          SETC  '++ &ZXSERVICE XSERVICE AL1'                00424800
.ZI6B                 ANOP  ,                                           00424900
.*-------------------------------------------------------------------   00425000
.***AI.L05 XFLAGS1 BL1                                                  00425100
&ZW                   SETC  ''                                          00425200
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00425300
&ZMS                  SETC  ''                                          00425400
&ZC                   SETC  ''                                          00425500
.*-------------------------------------------------------------------   00425600
.***AI.L08 XFLAGS1 "YES"                                                00425700
.***      BL1'1XXXXXXX'                                                 00425800
         AIF   ('&XRELEASE' NE 'YES').ZI9A                              00425900
&ZW                   SETC  '&ZW.1'                                     00426000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00426100
&ZMS                  SETC  '&ZMS.1'                                    00426200
                      AGO   .ZI9C                                       00426300
.*                                                                      00426400
.ZI9A                 ANOP  ,                                           00426500
&ZW                   SETC  '&ZW.0'                                     00426600
         AIF   ('&ZXRELEASE' EQ '').ZI9B                                00426700
&ZMS                  SETC  '&ZMS.0'                                    00426800
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00426900
                      AGO   .ZI9C                                       00427000
.*                                                                      00427100
.ZI9B                 ANOP  ,                                           00427200
&ZMS                  SETC  '&ZMS.1'                                    00427300
.ZI9C                 ANOP  ,                                           00427400
.*-------------------------------------------------------------------   00427500
.***AI.L08 XFLAGS1 "HOME"                                               00427600
.***      BL1'XX1XXXXX'                                                 00427700
         AIF   ('&XADDRSP' NE 'HOME').ZI10A                             00427800
&ZW                   SETC  '&ZW.01'                                    00427900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00428000
&ZMS                  SETC  '&ZMS.11'                                   00428100
                      AGO   .ZI10C                                      00428200
.*                                                                      00428300
.ZI10A                ANOP  ,                                           00428400
&ZW                   SETC  '&ZW.00'                                    00428500
         AIF   ('&ZXADDRSP' EQ '').ZI10B                                00428600
&ZMS                  SETC  '&ZMS.10'                                   00428700
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00428800
                      AGO   .ZI10C                                      00428900
.*                                                                      00429000
.ZI10B                ANOP  ,                                           00429100
&ZMS                  SETC  '&ZMS.11'                                   00429200
.ZI10C                ANOP  ,                                           00429300
.*-------------------------------------------------------------------   00429400
.***AI.L08 XFLAGS1 "PRIMARY"                                            00429500
.***      BL1'XXX1XXXX'                                                 00429600
         AIF   ('&XADDRSP' NE 'PRIMARY').ZI11A                          00429700
&ZW                   SETC  '&ZW.1'                                     00429800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00429900
&ZMS                  SETC  '&ZMS.1'                                    00430000
                      AGO   .ZI11C                                      00430100
.*                                                                      00430200
.ZI11A                ANOP  ,                                           00430300
&ZW                   SETC  '&ZW.0'                                     00430400
         AIF   ('&ZXADDRSP' EQ '').ZI11B                                00430500
&ZMS                  SETC  '&ZMS.0'                                    00430600
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00430700
                      AGO   .ZI11C                                      00430800
.*                                                                      00430900
.ZI11B                ANOP  ,                                           00431000
&ZMS                  SETC  '&ZMS.1'                                    00431100
.ZI11C                ANOP  ,                                           00431200
.*-------------------------------------------------------------------   00431300
.***AI.L08 XFLAGS1 "COMMON"                                             00431400
.***      BL1'XXXX1XXX'                                                 00431500
         AIF   ('&XADDRSP' NE 'COMMON').ZI12A                           00431600
&ZW                   SETC  '&ZW.1'                                     00431700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00431800
&ZMS                  SETC  '&ZMS.1'                                    00431900
                      AGO   .ZI12C                                      00432000
.*                                                                      00432100
.ZI12A                ANOP  ,                                           00432200
&ZW                   SETC  '&ZW.0'                                     00432300
         AIF   ('&ZXADDRSP' EQ '').ZI12B                                00432400
&ZMS                  SETC  '&ZMS.0'                                    00432500
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00432600
                      AGO   .ZI12C                                      00432700
.*                                                                      00432800
.ZI12B                ANOP  ,                                           00432900
&ZMS                  SETC  '&ZMS.1'                                    00433000
.ZI12C                ANOP  ,                                           00433100
.*-------------------------------------------------------------------   00433200
.***AI.L08 XFLAGS1 "YES"                                                00433300
.***      BL1'XXXXX1XX'                                                 00433400
         AIF   ('&XKEEP' NE 'YES').ZI13A                                00433500
&ZW                   SETC  '&ZW.100'                                   00433600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00433700
&ZMS                  SETC  '&ZMS.111'                                  00433800
                      AGO   .ZI13C                                      00433900
.*                                                                      00434000
.ZI13A                ANOP  ,                                           00434100
&ZW                   SETC  '&ZW.000'                                   00434200
         AIF   ('&ZXKEEP' EQ '').ZI13B                                  00434300
&ZMS                  SETC  '&ZMS.011'                                  00434400
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00434500
                      AGO   .ZI13C                                      00434600
.*                                                                      00434700
.ZI13B                ANOP  ,                                           00434800
&ZMS                  SETC  '&ZMS.111'                                  00434900
.ZI13C                ANOP  ,                                           00435000
.*-------------------------------------------------------------------   00435100
.***AI.L11 XFLAGS1 BL1                                                  00435200
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI13D              00435300
                      AIF   ('&ZC' NE 'YES').ZI13D                      00435400
&ZOPN                 SETA  &ZOPN+1                                     00435500
&ZOPL(&ZOPN)          SETC  ' '                                         00435600
&ZOPO(&ZOPN)          SETC  'NI'                                        00435700
&ZOPV(&ZOPN)          SETC  '4(1),B''&ZMS'''                            00435800
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00435900
.ZI13D                ANOP  ,                                           00436000
                      AIF   ('&ZCLNG' NE 'YES').ZI13E  ALL ZERO BITS    00436100
&ZOPN                 SETA  &ZOPN+1                                     00436200
&ZOPL(&ZOPN)          SETC  ' '                                         00436300
&ZOPO(&ZOPN)          SETC  'OI'                                        00436400
&ZOPV(&ZOPN)          SETC  '4(1),B''&ZW'''                             00436500
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00436600
.ZI13E                ANOP  ,                                           00436700
.*-------------------------------------------------------------------   00436800
.***AI.L25  XSTOKEN CL8                                                 00436900
                      AIF   ('&ZXSTOKEN' EQ '').ZI16E  NOT USED         00437000
                      AIF   ('&ZXSTOKEN' EQ 'OUTPUT').ZI16E             00437100
&ZCGPR                SETC  '&XSTOKEN'                                  00437200
.*                                                                      00437300
                      AIF   ('&XSTOKEN'(1,1) NE '(').ZI16B              00437400
&ZCGPR   SETC  '0('.'&XSTOKEN'(2,K'&XSTOKEN-2).')'                      00437500
.ZI16B                ANOP  ,                                           00437600
.*                                                                      00437700
&ZOPN                 SETA  &ZOPN+1                                     00437800
&ZOPL(&ZOPN)          SETC  ' '                                         00437900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00438000
&ZOPV(&ZOPN)          SETC  '8(8,1),&ZCGPR'                             00438100
&ZOPD(&ZOPN)          SETC  '++ &ZXSTOKEN XSTOKEN CL8'                  00438200
.*                                                                      00438300
.ZI16E                ANOP  ,                                           00438400
.*-------------------------------------------------------------------   00438500
.***AI.L25  XNUMRANGE F                                                 00438600
                      AIF   ('&ZXNUMRANGE' EQ '').ZI17E  NOT USED       00438700
                      AIF   ('&ZXNUMRANGE' EQ 'OUTPUT').ZI17E           00438800
&ZCGPR                SETC  '&XNUMRANGE'                                00438900
.*                                                                      00439000
                      AIF   ('&XNUMRANGE'(1,1) NE '(').ZI17B            00439100
&ZCGPR   SETC  '0('.'&XNUMRANGE'(2,K'&XNUMRANGE-2).')'                  00439200
                      AGO   .ZI17D                                      00439300
.ZI17B                ANOP  ,                                           00439400
.*                                                                      00439500
&ZC                   SETC  '&XNUMRANGE'(1,1)                           00439600
                      AIF   (T'&ZC NE 'N').ZI17D                        00439700
&ZC                   SETC  '&XNUMRANGE'                                00439800
                      AIF   ('&ZC'(K'&ZC,K'&ZC) EQ ')').ZI17D           00439900
&ZCGPR                SETC  '=FL4''&XNUMRANGE'''                        00440000
.*                                                                      00440100
.ZI17D                ANOP  ,                                           00440200
.*                                                                      00440300
&ZOPN                 SETA  &ZOPN+1                                     00440400
&ZOPL(&ZOPN)          SETC  ' '                                         00440500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00440600
&ZOPV(&ZOPN)          SETC  '16(4,1),&ZCGPR'                            00440700
&ZOPD(&ZOPN)          SETC  '++ &ZXNUMRANGE XNUMRANGE F'                00440800
.*                                                                      00440900
.ZI17E                ANOP  ,                                           00441000
.*-------------------------------------------------------------------   00441100
.***AI.L25  XRANGLIST AL4                                               00441200
                      AIF   ('&ZXRANGLIST' EQ '').ZI18E  NOT USED       00441300
                      AIF   ('&ZXRANGLIST' EQ 'OUTPUT').ZI18E           00441400
&ZCGPR                SETC  '&XRANGLIST'                                00441500
.*                                                                      00441600
                      AIF   ('&XRANGLIST'(1,1) NE '(').ZI18B            00441700
&ZCGPR   SETC  '0('.'&XRANGLIST'(2,K'&XRANGLIST-2).')'                  00441800
                      AGO   .ZI18D                                      00441900
.ZI18B                ANOP  ,                                           00442000
.*                                                                      00442100
&ZC                   SETC  '&XRANGLIST'(1,1)                           00442200
                      AIF   (T'&ZC NE 'N').ZI18D                        00442300
&ZC                   SETC  '&XRANGLIST'                                00442400
                      AIF   ('&ZC'(K'&ZC,K'&ZC) EQ ')').ZI18D           00442500
&ZCGPR                SETC  '=AL4(&XRANGLIST)'                          00442600
.*                                                                      00442700
.ZI18D                ANOP  ,                                           00442800
.*                                                                      00442900
&ZOPN                 SETA  &ZOPN+1                                     00443000
&ZOPL(&ZOPN)          SETC  ' '                                         00443100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00443200
&ZOPV(&ZOPN)          SETC  '20(4,1),&ZCGPR'                            00443300
&ZOPD(&ZOPN)          SETC  '++ &ZXRANGLIST XRANGLIST AL4'              00443400
.*                                                                      00443500
.ZI18E                ANOP  ,                                           00443600
.*-------------------------------------------------------------------   00443700
.***AI.LVER01                                                           00443800
                      AIF  (&XPLISTVER LT 1).ZI19Z                      00443900
.*-------------------------------------------------------------------   00444000
.***AI.L18  XHSPALET F                                                  00444100
                      AIF   ('&XHSPALET' NE '0').ZI19                   00444200
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI19  CK *        00444300
&ZXHSPALET            SETC  ''             RESET INPUT/OUTPUT           00444400
.ZI19                 ANOP  ,                                           00444500
.*-------------------------------------------------------------------   00444600
.***AI.L25  XHSPALET F                                                  00444700
                      AIF   ('&ZXHSPALET' EQ '').ZI19E  NOT USED        00444800
                      AIF   ('&ZXHSPALET' EQ 'OUTPUT').ZI19E            00444900
&ZCGPR                SETC  '&XHSPALET'                                 00445000
                      AIF   ('&XHSPALET' NE '0').ZI19A                  00445100
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI19E             00445200
.*                                                                      00445300
&ZCGPR                SETC  '=XL4''00'''                                00445400
.ZI19A                ANOP  ,                                           00445500
.*                                                                      00445600
                      AIF   ('&XHSPALET'(1,1) NE '(').ZI19B             00445700
&ZCGPR   SETC  '0('.'&XHSPALET'(2,K'&XHSPALET-2).')'                    00445800
                      AGO   .ZI19D                                      00445900
.ZI19B                ANOP  ,                                           00446000
.*                                                                      00446100
&ZC                   SETC  '&XHSPALET'(1,1)                            00446200
                      AIF   (T'&ZC NE 'N').ZI19D                        00446300
&ZC                   SETC  '&XHSPALET'                                 00446400
                      AIF   ('&ZC'(K'&ZC,K'&ZC) EQ ')').ZI19D           00446500
&ZCGPR                SETC  '=FL4''&XHSPALET'''                         00446600
.*                                                                      00446700
.ZI19D                ANOP  ,                                           00446800
.*                                                                      00446900
&ZOPN                 SETA  &ZOPN+1                                     00447000
&ZOPL(&ZOPN)          SETC  ' '                                         00447100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00447200
&ZOPV(&ZOPN)          SETC  '24(4,1),&ZCGPR'                            00447300
&ZOPD(&ZOPN)          SETC  '++ &ZXHSPALET XHSPALET F'                  00447400
.*                                                                      00447500
.ZI19E                ANOP  ,                                           00447600
.*-------------------------------------------------------------------   00447700
.***AI.LVER02                                                           00447800
.ZI19Z                ANOP  ,                                           00447900
.*-------------------------------------------------------------------   00448000
&ZOPN1                SETA &ZOPN                                        00448100
.*-------------------------------------------------------------------   00448200
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00448300
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00448400
.*******************************************************************    00448500
.***  PROCESS HSPSERV OUTPUT PARAMETERS                                 00448600
.*******************************************************************    00448700
                      ACTR  10000                                       00448800
.*******************************************************************    00448900
.***AO.X02  RETURN CODE PROCESSING                                      00449000
.*******************************************************************    00449100
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00449200
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00449300
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00449400
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00449500
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00449600
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00449700
&ZOPN                 SETA  &ZOPN+1                                     00449800
&ZOPL(&ZOPN)          SETC  ' '                                         00449900
&ZOPO(&ZOPN)          SETC  'ST'                                        00450000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00450100
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00450200
                      AGO   .ZMRETX                                     00450300
.*                                                                      00450400
.ZMRET2               ANOP  ,                                           00450500
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00450600
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00450700
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00450800
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00450900
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00451000
&ZOPN                 SETA  &ZOPN+1                                     00451100
&ZOPL(&ZOPN)          SETC  ' '                                         00451200
&ZOPO(&ZOPN)          SETC  'LR'                                        00451300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00451400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00451500
.ZMRETX               ANOP  ,                                           00451600
.*******************************************************************    00451700
.***AO.X03  REASON CODE PROCESSING                                      00451800
.*******************************************************************    00451900
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00452000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00452100
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00452200
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00452300
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00452400
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00452500
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00452600
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00452700
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00452800
&ZOPN                 SETA  &ZOPN+1                                     00452900
&ZOPL(&ZOPN)          SETC  ' '                                         00453000
&ZOPO(&ZOPN)          SETC  'ST'                                        00453100
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00453200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00453300
                      AGO   .ZMRSNX                                     00453400
.*                                                                      00453500
.ZMRSN2               ANOP  ,                                           00453600
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00453700
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00453800
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00453900
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00454000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00454100
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00454200
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00454300
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00454400
&ZOPN                 SETA  &ZOPN+1                                     00454500
&ZOPL(&ZOPN)          SETC  ' '                                         00454600
&ZOPO(&ZOPN)          SETC  'LR'                                        00454700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00454800
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00454900
.ZMRSNX               ANOP  ,                                           00455000
.*******************************************************************    00455100
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00455200
.*******************************************************************    00455300
.ZMFLX                ANOP  ,              MF=L PROCESSING              00455400
.*******************************************************************    00455500
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00455600
.*******************************************************************    00455700
                      ACTR  10000                                       00455800
.*                                                                      00455900
                      LCLA  &ZLC           COLUMN POSITION              00456000
                      LCLA  &ZOPX          LIST TABLE INDEX             00456100
                      LCLC  &ZLL           LABEL                        00456200
                      LCLC  &ZLOP          OPERATION                    00456300
                      LCLC  &ZLV           VALUE                        00456400
                      LCLC  &ZLD           DESCRIPTION                  00456500
.*                                                                      00456600
&ZOPX                 SETA  1                                           00456700
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00456800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00456900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00457000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00457100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00457200
                      AIF   (K'&ZLD LE 0).ZL5                           00457300
&ZLC                  SETA  35             COMMENT COLUMN               00457400
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00457500
&ZLC                  SETA  33             COMMMENT COLUMN              00457600
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00457700
&ZLV                  SETC  '&ZLV'.' '                                  00457800
                      AGO   .ZL3                                        00457900
.*                                                                      00458000
.ZL4                  ANOP  ,                                           00458100
&ZLV                  SETC  '&ZLV'.' '                                  00458200
.ZL5                  ANOP  ,                                           00458300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00458400
.*                                                                      00458500
&ZLL     &ZLOP &ZLV                                                     00458600
.*                                                                      00458700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00458800
                      AGO   .ZL2           CONTINUE LOOPING             00458900
.*                                                                      00459000
.ZLX                  ANOP  ,                                           00459100
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00459200
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00459300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00459400
         LCLC  &ASYSE            LOCAL ASC ENVIRONMENT VAR         @L1A 00459500
         LCLC  &HLABO            LABEL FOR PC TO HSP SERVICES      @L1A 00459600
         LCLC  &HLABE            LABEL FOR END OF MACRO EXPANSION  @L1A 00459700
&HLABO   SETC  'HSP'.'&SYSNDX'.'O'     ESTABLISH HSPXXXXO LABEL    @L1A 00459800
&HLABE   SETC  'HSP'.'&SYSNDX'.'E'     ESTABLISH HSPXXXXE LABEL    @L1A 00459900
&ASYSE   SETC  '&SYSASCE'        RECORD CURRENT SYSSTATE VALUE     @L1A 00460000
.********************************************************************** 00460100
.*                                                                      00460200
.*  If an ALET was specified, or if this is the execute form of the     00460300
.*  macro, generate code to exploit the ALET.  For the case where the   00460400
.*  ALET is not specified but this is the execute form of the macro,    00460500
.*  a test must be generated to determine if the HSPSERV parameter list 00460600
.*  contains an ALET (only version 1 of parm list has an ALET).         00460700
.*                                                                      00460800
.********************************************************************** 00460900
         AIF   ('&HSPALET' EQ '' AND '&MF(1)' NE 'E').HSPPC        @L1A 00461000
         AIF   ('&HSPALET' NE '').HSPNCK     ALET SPECIFIED?       @L1A 00461100
         CLI   0(1),1            CHECK HSPSERV PARM LIST VERSION   @L1A 00461200
         BNE   &HLABO            IF NOT VERSION 1, PC TO HSP SERV  @L1A 00461300
.HSPNCK  AIF   ('&ASYSE' EQ 'AR' OR                                    C00461400
               '&ASYSE' EQ 'P').HSPAE1     IN AR OR PRIM MODE?     @L1A 00461500
         IAC   14                CAPTURE CURRENT PSW ASC MODE      @L1A 00461600
         ST    14,0(0,13)        RECORD CURRENT PSW ASC MODE       @L1A 00461700
.HSPAE1  AIF   ('&ASYSE' EQ 'AR').HSPAE2     ALREADY IN AR MODE?   @L1A 00461800
         SAC   512               SAC TO AR MODE                    @L1A 00461900
         SYSSTATE ASCENV=AR      INFORM ASSEMBLER OF AR MODE       @L1A 00462000
.HSPAE2  L     15,16(0,0)        GET CVT ADDRESS                   @L1A 00462100
         L     15,356(15,0)      GET PVT ADDRESS                   @L1A 00462200
         L     15,208(15,0)      GET BALR ADDRESS TO EXPLOIT ALET  @L1A 00462300
         BALR  14,15             CALL SERVICE TO EXPLOIT ALET      @L1A 00462400
         AIF   ('&ASYSE' EQ 'AR').HSPAE6  ORIGINAL MODE WAS AR?    @L1A 00462500
         AIF   ('&ASYSE' EQ 'P').HSPAE3   ORIGINAL MODE WAS PRIM?  @L1A 00462600
         L     14,0(0,13)        RETRIEVE ORIGINAL PSW ASC MODE    @L1A 00462700
         SAC   0(14)             RESTORE ORIGINAL PSW ASC MODE     @L1A 00462800
         AGO   .HSPAE4                                             @L1A 00462900
.HSPAE3  SAC   0                 RESTORE PRIMARY ASC MODE          @L1A 00463000
.HSPAE4  AIF   ('&ASYSE' NE 'P' AND                                    C00463100
               '&ASYSE' NE 'ANY').HSPAE5   ORIG MODE NOT PRIM/ANY? @L1A 00463200
         SYSSTATE ASCENV=&ASYSE                                    @L1A 00463300
         AGO   .HSPAE6                                             @L1A 00463400
.HSPAE5  SYSSTATE TEST                                             @L1A 00463500
.HSPAE6  AIF   ('&HSPALET' NE '').HSPPC    PC LNKG TO BR AROUND?   @L1A 00463600
         B     &HLABE            SKIP PC LINKAGE                   @L1A 00463700
.********************************************************************** 00463800
.*                                                                      00463900
.*  Generate code to PC to hiperspace services only when HSPALET was    00464000
.*  not specified.                                                      00464100
.*                                                                      00464200
.********************************************************************** 00464300
.HSPPC   AIF   ('&HSPALET' NE '').HSPEND                           @L1A 00464400
&HLABO   L     14,16(0,0)        GET CVT ADDRESS                   @L1C 00464500
         L     14,772(14,0)      GET SYSTEM FUNCTION TABLE ADDRESS      00464600
         L     14,208(14,0)      GET LX FOR SERVICE ROUTINE             00464700
         AIF   ('&XSERVICE' EQ 'CREAD').HSP001                          00464800
         AIF   ('&XSERVICE' EQ 'CWRITE').HSP001                         00464900
         AGO   .HSP002                                                  00465000
.HSP001  LA    15,6              EX OFFSET FOR CACHE SERVICES           00465100
         AGO   .HSP003                                                  00465200
.HSP002  LA    15,7              EX OFFSET FOR SCROLL SERVICES          00465300
.HSP003  OR    14,15             GENERATE LX/EX COMBINATION             00465400
         PC    0(14)             PC TO HSPSERV SERVICE                  00465500
.HSPEND  ANOP  ,                                                   @L1A 00465600
&HLABE   DS    0H                                                  @L1A 00465700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00465800
.ZLINKX               ANOP  ,                                           00465900
.*******************************************************************    00466000
.***AP.X01  FORMAT GENERATED CODE                                       00466100
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00466200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00466300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00466400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00466500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00466600
                      AIF   (K'&ZLD LE 0).ZL51                          00466700
&ZLC                  SETA  35             COMMENT COLUMN               00466800
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00466900
&ZLC                  SETA  33             COMMENT COLUMN               00467000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00467100
&ZLV                  SETC  '&ZLV'.' '                                  00467200
                      AGO   .ZL31                                       00467300
.*                                                                      00467400
.ZL41                 ANOP  ,                                           00467500
&ZLV                  SETC  '&ZLV'.' '                                  00467600
.ZL51                 ANOP  ,                                           00467700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00467800
.*                                                                      00467900
&ZLL     &ZLOP &ZLV                                                     00468000
.*                                                                      00468100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00468200
                      AGO   .ZL21          CONTINUE LOOPING             00468300
.*                                                                      00468400
.ZLX1                 ANOP  ,                                           00468500
.*******************************************************************    00468600
.***AP.X02  END OF HSPSERV MACRO                                        00468700
&ZHSPSERV             SETC  'YES'          SET HSPSERV USED             00468800
         POP   PRINT                                                    00468900
*                                            HSPSERV-1                  00469000
         SPACE 1                                                        00469100
.ZLX2                 ANOP  ,                                           00469200
         MEND                                                           00469300
**********************************************************************/ 00469400
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00469500
*%HSPSERV: MACRO KEYS(PLISTVER,SREAD,STOKEN,NUMRANGE,RANGLIST,RELEASE,  00469600
*                 HSPALET,SWRITE,CREAD,ADDRSP,CWRITE,KEEP,RETCODE,      00469700
*                 RSNCODE,MF);                                          00469800
*  ANS('?'||MACLABEL||' '||'HSPSERVP '||MACLIST||                       00469900
*         ' '||MACKEYS||';') COL(MACLMAR);                              00470000
*%END HSPSERV;                                                          00470100
