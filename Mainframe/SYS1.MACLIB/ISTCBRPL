         MACRO                                                          00050000
         ISTCBRPL &AM=,&MF=,&CALLER=,                          @ZA34940C00100000
               &ACB=,&AREA=,&AREALEN=,&ARG=,&ECB=, *** RPL KEYWORDS ***C00150000
               &FDBK=,&MSGAREA=,&MSGLEN=,&NXTRPL=,&OPTCD=,&KEYLEN=,    C00200000
               &RBA=,&RECLEN=,&IO=,&RPLLEN=,&AAREA=,&AAREALN=,   X03004C00250000
               &ARECLEN=,&EXIT=,&NIB=,                          X04SVHSC00300000
               &BRANCH=,&USER=,&RTNCD=,&FDBK2=,&SENSE=,          X03004C00350000
               &REQ=,&DATAFLG=,                                  X03004C00400000
               &TRANSID=,&AIXPC=,&FTNCD=,&AIXFLAG=,             X04SVHSC00450000
               &CHNGDIR=,&STYPE=,&RTYPE=,&CHAIN=,&POST=,        X3004BSC00500000
               &RESPOND=,&CONTROL=,&OBSQAC=,&IBSQAC=,           X3004BSC00550000
               &OBSQVAL=,&IBSQVAL=,&SEQNO=,&SSENSEO=,           X3004BSC00600000
               &SSENSEI=,&USENSEO=,&USENSEI=,                      @01C*00650000
               &BRACKET=,&SSENSMO=,&SSENSMI=,                          C00700000
               &SIGDATA=,&CODESEL=,                                @01C*00750000
               &CRYPT=,&THRDPTY=                               @G69AKJP 00800000
.*                                                                      00805500
.*      COPYRIGHT = LICENSED MATERIALS - PROPERTY OF IBM                00811000
.*                                                                      00816500
.*                  "RESTRICTED MATERIALS OF IBM"                       00822000
.*                                                                      00827500
.*                  5695-117                                            00833000
.*                                                                      00838500
.*                  (C) COPYRIGHT IBM CORP. 1979                        00844000
.*                                                                      00850000
.*       CHANGE LEVEL = 01                                     @G69AKJP 00900000
.*       DATE OF LAST CHANGE = 12   OCT   78 ( 78*285 )        @G69AKJP 00950000
.*                             01/29/81                        @D5P4790 01000000
.*                             11/03/81                        @ZA53800 01050000
.*                                                             @ZA34940 01100000
.*  FUNCTION   THIS MACRO ACTS AS A CONTROLLER FOR GENCB, MODCB, AND    01150000
.*             TESTCB FOR PROCESSING AN RPL.                            01200000
.*             IT IS CALLED BY IDACB2 TO BUILD VARIOUS ARRAYS TO BE     01250000
.*             USED BY THAT MACRO TO BUILD A PARAMETER LIST OF ARGUMENT 01300000
.*             CONTROL ENTRIES THAT WILL BE PASSED TO THE CONTROL       01350000
.*             BLOCK MANIPULATION MODULE AT EXECUTE TIME.               01400000
.*             FOR NON-BIT KEYWORDS, THIS MACRO CALLS ISTCB3   @ZA34940 01450000
.*             WHICH SETS VALUES INTO ALL THE ARRAYS THAT      @ZA34940 01500000
.*             ARE REQUIRED.                                   @ZA34940 01550000
.*                                                                      01600000
.*             FOR BIT KEYWORDS, ISTCB3 IS CALLED, BUT THIS    @ZA34940 01650000
.*             MACRO SETS THE VALUE IN THE &IDAVALC ARRAY.     @ZA34940 01700000
.*             IT ALSO VALIDITY CHECKS BIT OPTIONS AND IF MUTUALLY      01750000
.*             EXCLUSIVE OPTIONS ARE SPECIFIED, AN ERROR MESSAGE IS     01800000
.*             ISSUED. THE ONE EXCEPTION IS OPTCD.                      01850000
.*             ISTCBOPT IS ISSUED TO PROCESS OPTCD.            @ZA34940 01900000
.*                                                                      01950000
.*             IT IS ALSO CALLED BY THE RPL DECLARATIVE MACRO TO        02000000
.*             PROCESS THE BIT KEYWORDS OPTCD, BRANCH, POST, RESPOND,   02050000
.*             CHAIN, CONTROL, CHNGDIR, BRACKET, SSENSEO, RTYPE,        02100000
.*             STYPE, IBSQAC, OBSQAC AND THRDPTY.              @G69AKJP 02150000
.*             WHEN CALLED BY RPL, DIFFERENT GLOBALS ARE SET THAN       02200000
.*             THOSE USED BY THE CBMM. THESE GLOBALS ARE SET IN SUCH    02250000
.*             A MANNER TO ALLOW THE DECLARATIVE MACRO TO GENERATE      02300000
.*             A 'DC' USING THE GLOBALS DIRECTLY.                       02350000
.*             THEREFORE THE BITS SET IN THESE GLOBALS MUST BE          02400000
.*             IDENTICAL TO THE WAY THEY WILL APPEAR WHEN THE           02450000
.*             CONTROL BLOCK IS GENERATED.                              02500000
.*                                                             @ZA34940 02550000
.* CHANGE ACTIVITY                                             @ZA34940 02600000
.*      CBMM SPLIT SUPPORT                                     @ZA34940 02650000
.*      SNA4 SUPPORT                                           @G69AKJP 02700000
.*      DCR  4790.0Z                                           @D5P4790 02750000
.*      APAR OZ53800 ECB=INTERNAL                              @ZA53800 02800000
.*                                                             @ZA34940 02850000
.*  $MAC(ISTCBRPL),COMP(API),PROD(VTAM): RPL CONTROLLER                 02855500
.*                                                                      02861000
.*  FLAG REASON   RELEASE DATE   ORIGIN  FLAG DESCRIPTORS               02866500
.*  ---- -------- ------- ------ ------  ----------------------------   02872000
.*  $01= OY24134  HVT3303 890824 460025: DUPLICATE CHARACTERS IN COL 71 02877500
.*                                       AND 72 CAUSES ASSEMBLER H      02883000
.*                                       MESSAGE WITH DBCS OPTION       02888500
.*  $KG= P105521  HATAPPN 921103 460208: CHNGDIR=REQ/NREQ REMOVAL       02890300
.*  $T1= P105823  HATAPPN 921113 879315: CORRECTIONS TO P105521         02892100
.*  $02= OY62380  SNAIP   930330 358168: Allow CHNGDIR=NREQ to be       02892500
.*                                       specified though ignored       02892900
.*                                       (still issued by CICS)         02893300
.*                                                                      02894000
.* GLOBALS                                                              02900000
         GBLB  &IDACB01                ERROR INDICATOR                  02950000
         GBLA  &IDAENO                 NUMBER OF ELEMENTS               03000000
         GBLC  &IDAVALC(50)            ELEMENT CHARACTER VALUE ARRAY    03050000
.*             THE FOLLOWING GLOBALS ARE SET WHEN CALLED BY THE RPL     03100000
.*             DECLARATIVE MACRO TO SET BIT STRING KEYWORDS             03150000
         GBLC  &IDABRCH                 BRANCH CODE             X04SVHS 03200000
         GBLC  &IDASNSO                 SSENSEO CODES           X04SVHS 03250000
         GBLC  &IDARH3                  CHNGDIR/BRACKET CODES   X04SVHS 03300000
         GBLC  &IDASRTY                 STYPE/RTYPE CODES       X04SVHS 03350000
         GBLC  &IDACHN                  CHAIN CODES             X04SVHS 03400000
         GBLC  &IDAPORE                 POST/RESPOND CODES      X04SVHS 03450000
         GBLC  &IDACRYP                 ENCRIPTION FEATURE     @G40AKSL 03500000
         GBLC  &IDACON1,&IDACON2,&IDACON3 CONTROL CODES         X04SVHS 03550000
         GBLC  &IDAOBQC                 OBSQAC CODES            X04SVHS 03600000
         GBLC  &IDAIBQC                 IBSQAC CODES            X04SVHS 03650000
.* LOCALS                                                               03700000
         LCLA  &I,&A                             WORK VARIABLES X04SVHS 03750000
         LCLB  &VSAM,&VTAM                       AM CODES               03800000
         LCLB  &PRIME,&AIXRBA                    AIXFLAG CODES  X04SVHS 03850000
         LCLB  &NCMD,&CMD,&NREQ,&CREQ            CHNGDIR CODES  X3004BS 03900000
         LCLB  &SREQ,&SRESP                      STYPE CODES    X3004BS 03950000
         LCLB  &NRESP,&RRESP,&RDFSYN,&NDFSYN     RTYPE CODES    X3004BS 04000000
         LCLB  &NDFASY,&RDFASY                   RTYPE CODES   @Z40BHUC 04050000
         LCLB  &ONLY,&FIRST,&MIDDLE,&LAST        CHAIN CODES    X3004BS 04100000
         LCLB  &PRESP,&SCHED                     POST CODES     X3004BS 04150000
         LCLB  &NEX,&EX,&FME,&NFME,&NRRN,&RRN    RESPOND CODES  X3004BS 04200000
         LCLB  &QRESP,&NQRESP                    RESPOND CODES @G40AKSL 04250000
         LCLB  &DATA,&CANCEL,&QC,&QEC,&CHASE     CONTROL CODES  X3004BS 04300000
         LCLB  &RELQ,&CSDT,&CLEAR,&STSN          CONTROL CODES X03004HS 04350000
         LCLB  &SHUTD,&RQR,&SHUTC                CONTROL CODES @ZA07554 04400000
         LCLB  &BID,&LUS,&SIGNAL,&RTR,&RSHUTD    CONTROL CODES X03004HS 04450000
         LCLB  &SBI,&BIS,&BIND,&UNBIND           CONTROL CODES @G40AKCM 04500000
         LCLB  &STDRD,&ALT                       CODESEL CODE  @Z40BHUC 04550000
         LCLB  &SET,&TESTSET,&RESET,&IGNORE      OBSQAC CODES   X3004BS 04600000
         LCLB  &TESTPOS,&TESTNEG,&INVALID        OBSQAC CODES   X3004BS 04650000
         LCLB  &ISET,&ITESTSE,&IRESET,&IIGNORE   IBSQAC CODES   X3004BS 04700000
         LCLB  &ITESTPO,&ITESTNE,&IINVALI        IBSQAC CODES   X3004BS 04750000
         LCLB  &OCPM,&OSTATE,&OFI,&ORR           SSENSEO CODES X03004HS 04800000
         LCLB  &IPATH,&ICPM,&ISTATE,&IFI,&IRR    SSENSEI CODES X03004HS 04850000
         LCLB  &BB,&NBB,&EB,&NEB,&CEB,&NCEB      BRACKET CODES @D5P4790 04900000
         LCLB  &NO,&YES                          SWITCHC CODES  X3004BS 04950000
         LCLB  &UNSOL,&EOB,&EOM,&EOT,&LOGOFF     DATAFLG CODES   X03004 05000000
         LCLB  &LG,&SOH                          DATAFLG CODES   X03004 05050000
         LCLB  &BRYES,&BRNO             BRANCH CODES            X04SVHS 05100000
         LCLB  &COMPLET                 IO CODE                 X04SVHS 05150000
         LCLB  &CRYES,&CRNO             ENCRIPTION CODES       @G40AKSL 05200000
         LCLC  &Z16,&Z8                 UNUSED PORTION OF BITSTRING     05250000
.*                                                                      05300000
&Z16     SETC  '0000000000000000'       INITIALIZE CONSTANT     X04SVHS 05350000
&Z8      SETC  '00000000'               INITIALIZE CONSTANT    @Z40BHUC 05400000
.* SCAN RPL KEYWORDS ************************************************** 05450000
.*                                      ACB                             05500000
         ISTCB3 ARG=&ACB,ARGNAME=ACB,KWTC=X'2B',MF=&MF         @ZA34940 05550000
.********************************************************************** 05600000
.*                                      AREA                            05650000
         ISTCB3 ARG=&AREA,ARGNAME=AREA,KWTC=X'2C',MF=&MF       @ZA34940 05700000
.********************************************************************** 05750000
.*                                      AREALEN                         05800000
         ISTCB3 ARG=&AREALEN,ARGNAME=AREALEN,KWTC=X'2D',MF=&MF @ZA34940 05850000
.********************************************************************** 05900000
.*                                      ARG                             05950000
         ISTCB3 ARG=&ARG,ARGNAME=ARG,KWTC=X'2E',MF=&MF         @ZA34940 06000000
.********************************************************************** 06050000
.*                                      ECB                             06100000
         ISTCB3 ARG=&ECB,ARGNAME=ECB,KWTC=X'2F',MF=&MF         @ZA34940 06150000
.********************************************************************** 06200000
.*                                      KEYLEN                          06250000
         ISTCB3 ARG=&KEYLEN,ARGNAME=KEYLEN,KWTC=X'30',MF=&MF   @ZA34940 06300000
.********************************************************************** 06350000
.*                                      MSGAREA                         06400000
         ISTCB3 ARG=&MSGAREA,ARGNAME=MSGAREA,KWTC=X'31',MF=&MF @ZA34940 06450000
.********************************************************************** 06500000
.*                                      MSGLEN                          06550000
         ISTCB3 ARG=&MSGLEN,ARGNAME=MSGLEN,KWTC=X'32',MF=&MF   @ZA34940 06600000
.********************************************************************** 06650000
.*                                      NXTRPL                          06700000
         ISTCB3 ARG=&NXTRPL,ARGNAME=NXTRPL,KWTC=X'33',MF=&MF   @ZA34940 06750000
.********************************************************************** 06800000
.*                                      OPTCD                           06850000
         ISTCBOPT OPTCD=&OPTCD,AM=&AM,MF=&MF,CALLER=&CALLER,   @G69AKJP*06900000
               THRDPTY=&THRDPTY                                @G69AKJP 06950000
.* OPTCD AND THRDPTY ARE PROCESSED BY INNER MACRO ISTCBOPT     @G69AKJP 07000000
.********************************************************************** 07050000
.*                                      CHNGDIR                         07100000
.R000100 AIF   ('&CHNGDIR' EQ '').R000600 *** CHNGDIR ***       X3004BS 07150000
         ISTCB3 ARG=&CHNGDIR,KWTC=X'65',BIT=YES,CHKAM=VTAM,    @ZA34940*07200000
               AM=&AM                                          @ZA34940 07250000
.*                                                              X04SVHS 07300000
&I       SETA  0                        CLEAR INDEX VARIABLE    X3004BS 07350000
&A       SETA  0                        ZERO ERROR COUNTER      X04SVHS 07400000
.R000200 ANOP                                                   X3004BS 07450000
&I       SETA  &I+1                     BUMP INDEX INTO LIST    X04SVHS 07500000
         AIF   (&I GT N'&CHNGDIR).R000300 CHECK FOR END OF LIST X04SVHS 07550000
&NCMD    SETB  ('&CHNGDIR(&I)' EQ 'NCMD' OR &NCMD)              X3004BS 07600000
&CMD     SETB  ('&CHNGDIR(&I)' EQ 'CMD' OR &CMD)                X3004BS 07650000
&NREQ    SETB  ('&CHNGDIR(&I)' EQ 'NREQ' OR &NREQ)              X3004BS 07700000
&CREQ    SETB  ('&CHNGDIR(&I)' EQ 'REQ' OR &CREQ)               X3004BS 07750000
         AIF   (&NCMD+&CMD+&NREQ+&CREQ+&A EQ &I).R000200        X04SVHS 07800000
.*             CHK FOR NEW BIT SET                                      07850000
         ISTERMAC 5,CHNGDIR,&CHNGDIR(&I)                       @ZA34940 07900000
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 07950000
&A       SETA  &A+1                     BUMP ERROR COUNTER      X04SVHS 08000000
         AGO   .R000200                 CHECK NEXT OPTION       X04SVHS 08050000
.*             CHECK FOR MUTUALLY EXCLUSIVE OPTIONS                     08100000
.R000300 AIF   (NOT(&NCMD AND &CMD)).R000400                    X3004BS 08150000
         ISTERMAC 8,CHNGDIR,NCMD,CMD                           @ZA34940 08200000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 08250000
.R000400 AIF   (NOT(&CREQ)).R000500                           @KGC @02C 08300000
         MNOTE 8,'CHNGDIR = REQ/NREQ NO LONGER SUPPORTED, IGNORED' @T1C 08350000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 08400000
.R000500 ANOP                                                   X3004BS 08450000
         AIF   ('&CALLER' EQ 'RPL').R000600                     X04SVHS 08500000
.*             IF CALLED BY RPL, VALUE SET IN RPLRH3 UNDER CODESEL CODE 08550000
&IDAVALC(&IDAENO) SETC '&NCMD&CMD.00000000000000&Z16'            @KGC   08600000
.********************************************************************** 08650000
.R000600 ANOP                                                  X03004HS 08700000
.*                                      BRACKET                         08750000
         AIF   ('&BRACKET' EQ '').R001010                      X03004HS 08800000
         ISTCB3 ARG=&BRACKET,KWTC=X'85',CHKAM=VTAM,AM=&AM,     @ZA34940*08850000
               BIT=YES                                         @ZA34940 08900000
&I       SETA  0                        INITIALIZE INDEX VALUE X03004HS 08950000
&A       SETA  0                        ZERO ERROR COUNTER      X04SVHS 09000000
.R000700 ANOP                                                  X03004HS 09050000
&I       SETA  &I+1                     BUMP INDEX INTO LIST    X04SVHS 09100000
         AIF   (&I GT N'&BRACKET).R000800                      X03004HS 09150000
.*             DETERMINE IF ALL SUBPARMS HAVE BEEN CHECKED     X03004HS 09200000
&BB      SETB  ('&BRACKET(&I)' EQ 'BB' OR &BB)                 X03004HS 09250000
&NBB     SETB  ('&BRACKET(&I)' EQ 'NBB' OR &NBB)               X03004HS 09300000
&EB      SETB  ('&BRACKET(&I)' EQ 'EB' OR &EB)                 X03004HS 09350000
&NEB     SETB  ('&BRACKET(&I)' EQ 'NEB' OR &NEB)               X03004HS 09400000
&CEB     SETB  ('&BRACKET(&I)' EQ 'CEB' OR &CEB)               @D5P4790 09450000
&NCEB    SETB  ('&BRACKET(&I)' EQ 'NCEB' OR &NCEB)             @D5P4790 09500000
         AIF   (&BB+&NBB+&EB+&NEB+&CEB+&NCEB+&A EQ &I).R000700 @D5P4790 09550000
.*                                      CHK FOR NEW BIT SET             09600000
         ISTERMAC 5,BRACKET,&BRACKET(&I)                       @ZA34940 09650000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 09700000
&A       SETA  &A+1                     BUMP ERROR COUNTER      X04SVHS 09750000
         AGO   .R000700                 CHK NEXT SUBPARM       X03004HS 09800000
.R000800 ANOP                                                  X03004HS 09850000
         AIF   (NOT(&BB AND &NBB)).R000900 CHK MUTUALLY        X03004HS 09900000
.*                                      EXCLUSIVE KEYWORDS     X03004HS 09950000
         ISTERMAC 8,BRACKET,BB,NBB                             @ZA34940 10000000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 10050000
.R000900 ANOP                                                  X03004HS 10100000
         AIF   (NOT(&EB AND &NEB)).R000905 CHK MUTUALLY        @D5P4790 10150000
.*                                      EXCLUSIVE KEYWORDS     X03004HS 10200000
         ISTERMAC 8,BRACKET,EB,NEB                             @ZA34940 10250000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 10300000
.R000905 ANOP                                                  @D5P4790 10350000
         AIF   (NOT(&CEB AND &NCEB)).R001000 CHK MUTUALLY      @D5P4790 10400000
.*                                      EXCLUSIVE KEYWORDS     @D5P4790 10450000
         ISTERMAC 8,BRACKET,CEB,NCEB                           @D5P4790 10500000
&IDACB01 SETB  1                        SET ERROR SWITCH       @D5P4790 10550000
.R001000 ANOP                                                  X03004HS 10600000
         AIF   ('&CALLER' EQ 'RPL').R001010                     X04SVHS 10650000
.*             IF CALLED BY RPL, VALUE SET IN RPLRH3 UNDER CODESEL CODE 10700000
&IDAVALC(&IDAENO) SETC '&BB&NBB&EB&NEB.000000000000&Z16'       X03004HS 10750000
.*                                                              X04SVHS 10800000
.********************************************************************** 10850000
.*                                      CODESEL                @Z40BHUC 10900000
.R001010 AIF   ('&CODESEL' EQ '').R001070 *** CODESEL ***      @Z40BHUC 10950000
         ISTCB3 ARG=&CODESEL,KWTC=X'91',CHKAM=VTAM,AM=&AM,     @ZA34940*11000000
               BIT=YES                                         @ZA34940 11050000
&STDRD SETB ('&CODESEL' EQ 'STANDARD' OR '&CODESEL' EQ '(STANDARD)')    11100000
&ALT   SETB ('&CODESEL' EQ 'ALT' OR '&CODESEL' EQ '(ALT)')     @Z40BHUC 11150000
         AIF   (&STDRD+&ALT EQ 1).R001020 CHECK VALID OPTION   @Z40BHUC 11200000
         ISTERMAC  5,CODESEL,&CODESEL                          @ZA34940 11250000
&IDACB01 SETB  1                                               @Z40BHUC 11300000
.R001020 AIF   (N'&CODESEL EQ 1).R001050   ONE OPTION ALLOWED  @Z40BHUC 11350000
         ISTERMAC 22,CODESEL                                   @ZA34940 11400000
&IDACB01 SETB  1                                               @Z40BHUC 11450000
.R001050 AIF   ('&CALLER' EQ 'RPL').R001070                    @Z40BHUC 11500000
.*             IF CALLED BY RPL, BYPASS SETTING CBM GLOBAL     @Z40BHUC 11550000
&IDAVALC(&IDAENO) SETC '&STDRD&ALT.000000&Z8&Z16'              @Z40BHUC 11600000
         AGO   .R001100                                        @Z40BHUC 11650000
.R001070 ANOP                                                  @Z40BHUC 11700000
.*    ISTCBRPL HAS BEEN CALLED BY THE RPL DECLARATIVE MACRO    @ZA34940 11750000
.*    OR CODESEL IS NULL                                       @Z40BHUC 11800000
&IDARH3  SETC  '&BB&EB&CMD.0&ALT.00&CEB'    SET BRACKET/CHNGDIR/        11850000
.*                                                CODESEL        @KGC   11900000
.********************************************************************** 11950000
.*                                      STYPE                           12000000
.R001100 AIF   ('&STYPE' EQ '').R001500 *** STYPE ***           X3004BS 12050000
         ISTCB3 ARG=&STYPE,KWTC=X'66',CHKAM=VTAM,AM=&AM,       @ZA34940*12100000
               BIT=YES                                         @ZA34940 12150000
&I       SETA  0                                                X3004BS 12200000
&A       SETA  0                        ZERO ERROR COUNTER      X04SVHS 12250000
.R001200 ANOP                                                   X3004BS 12300000
&I       SETA  &I+1                     BUMP INDEX INTO LIST    X04SVHS 12350000
         AIF   (&I GT N'&STYPE).R001300 CHECK FOR END OF LIST   X04SVHS 12400000
&SREQ    SETB  ('&STYPE(&I)' EQ 'REQ' OR &SREQ)                 X3004BS 12450000
&SRESP   SETB  ('&STYPE(&I)' EQ 'RESP' OR &SRESP)               X3004BS 12500000
         AIF   (&SREQ+&SRESP+&A EQ &I).R001200                  X04SVHS 12550000
.*                                      CHK FOR NEW BIT SET             12600000
         ISTERMAC 5,STYPE,&STYPE(&I)                           @ZA34940 12650000
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 12700000
&A       SETA  &A+1                     BUMP ERROR COUNTER      X04SVHS 12750000
         AGO   .R001200                                         X3004BS 12800000
.*             CHECK FOR MUTUALLY EXCLUSIVE OPTIONS                     12850000
.R001300 AIF   (NOT(&SREQ AND &SRESP)).R001400                  X3004BS 12900000
         ISTERMAC 8,STYPE,REQ,RESP                             @ZA34940 12950000
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 13000000
.R001400 ANOP                                                   X3004BS 13050000
         AIF   ('&CALLER' EQ 'RPL').R001500                     X04SVHS 13100000
.*             IF CALLED BY RPL, BYPASS SETTING CBM GLOBAL              13150000
&IDAVALC(&IDAENO) SETC '&SREQ&SRESP.00000000000000&Z16'         X3004BS 13200000
.********************************************************************** 13250000
.*                                      RTYPE                           13300000
.R001500 AIF   ('&RTYPE' EQ '').R002150 *** RTYPE ***           X3004BS 13350000
         ISTCB3 ARG=&RTYPE,KWTC=X'67',CHKAM=VTAM,AM=&AM,       @ZA34940*13400000
               BIT=YES                                         @ZA34940 13450000
&I       SETA  0                        ZERO INDEX              X3004BS 13500000
&A       SETA  0                        ZERO ERROR COUNTER      X04SVHS 13550000
.R001600 ANOP                                                   X3004BS 13600000
&I       SETA  &I+1                     BUMP INDEX INTO LIST    X04SVHS 13650000
         AIF   (&I GT N'&RTYPE).R001700 CHECK FOR END OF LIST   X04SVHS 13700000
&NRESP   SETB  ('&RTYPE(&I)' EQ 'NRESP' OR &NRESP)              X3004BS 13750000
&RRESP   SETB  ('&RTYPE(&I)' EQ 'RESP' OR &RRESP)               X3004BS 13800000
&RDFSYN  SETB  ('&RTYPE(&I)' EQ 'DFSYN' OR &RDFSYN)             X3004BS 13850000
&NDFSYN  SETB  ('&RTYPE(&I)' EQ 'NDFSYN' OR &NDFSYN)            X3004BS 13900000
&NDFASY  SETB  ('&RTYPE(&I)' EQ 'NDFASY' OR &NDFASY)            X3004BS 13950000
&RDFASY  SETB  ('&RTYPE(&I)' EQ 'DFASY' OR &RDFASY)             X3004BS 14000000
         AIF   (&NRESP+&RRESP+&RDFSYN+&NDFSYN+&NDFASY+&RDFASY+&A EQ &I)*14050000
               .R001600                                        @Z40BHUC 14100000
.*                                      CHK FOR NEW BIT SET             14150000
         ISTERMAC 5,RTYPE,&RTYPE(&I)                           @ZA34940 14200000
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 14250000
&A       SETA  &A+1                     BUMP ERROR COUNTER      X04SVHS 14300000
         AGO   .R001600                                         X3004BS 14350000
.*             CHECK FOR MUTUALLY EXCLUSIVE OPTIONS                     14400000
.R001700 AIF   (NOT(&NRESP AND &RRESP)).R001800                 X3004BS 14450000
         ISTERMAC 8,RTYPE,NRESP,RESP                           @ZA34940 14500000
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 14550000
.R001800 AIF   (NOT(&NDFSYN AND &RDFSYN)).R001900               X3004BS 14600000
         ISTERMAC 8,RTYPE,NDFSYN,DFSYN                         @ZA34940 14650000
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 14700000
.R001900 AIF   (NOT(&NDFASY AND &RDFASY)).R002100              @Z40BHUC 14750000
         ISTERMAC 8,RTYPE,NDFASY,DFASY                         @ZA34940 14800000
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 14850000
.R002100 ANOP                                                   X3004BS 14900000
         AIF   ('&CALLER' EQ 'RPL').R002150                     X04SVHS 14950000
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               15000000
&IDAVALC(&IDAENO) SETC '&NRESP&RRESP&RDFSYN&NDFSYN&NDFASY&RDFASY.000000*15050000
               0000&Z16'                                                15100000
         AGO   .R002200                                         X04SVHS 15150000
.R002150 ANOP                                                   X04SVHS 15200000
&IDASRTY SETC  '&SRESP.000&RRESP&NDFSYN&RDFASY.0'              @Z40BHUC 15250000
.*             SET STYPE/RTYPE CODES FOR RPL                    X04SVHS 15300000
.********************************************************************** 15350000
.*                                      CHAIN                           15400000
.R002200 AIF   ('&CHAIN' EQ '').R002450 *** CHAIN ***           X3004BS 15450000
         ISTCB3 ARG=&CHAIN,KWTC=X'68',CHKAM=VTAM,AM=&AM,       @ZA34940*15500000
               BIT=YES                                         @ZA34940 15550000
&ONLY    SETB  ('&CHAIN' EQ 'ONLY' OR '&CHAIN' EQ '(ONLY)')     X04SVHS 15600000
&FIRST   SETB  ('&CHAIN' EQ 'FIRST' OR '&CHAIN' EQ '(FIRST)')   X04SVHS 15650000
&MIDDLE  SETB  ('&CHAIN' EQ 'MIDDLE' OR '&CHAIN' EQ '(MIDDLE)') X04SVHS 15700000
&LAST    SETB  ('&CHAIN' EQ 'LAST' OR '&CHAIN' EQ '(LAST)')     X04SVHS 15750000
         AIF   (&ONLY+&FIRST+&MIDDLE+&LAST EQ 1).R002300        X04SVHS 15800000
.*                                      CHK FOR NEW BIT SET             15850000
         ISTERMAC 5,CHAIN,&CHAIN                               @ZA34940 15900000
&IDACB01 SETB  1                                                X3004BS 15950000
.R002300 ANOP                                                   X04SVHS 16000000
         AIF   (N'&CHAIN EQ 1).R002400 ONLY ONE OPTION MAY BE SPECIFIED 16050000
         ISTERMAC 22,CHAIN                                     @ZA34940 16100000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 16150000
.R002400 ANOP                                                   X3004BS 16200000
         AIF   ('&CALLER' EQ 'RPL').R002450                     X04SVHS 16250000
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               16300000
&IDAVALC(&IDAENO) SETC '&FIRST&MIDDLE&LAST&ONLY.000000000000&Z16'       16350000
.*                                                              X04SVHS 16400000
         AGO   .R002500                                         X04SVHS 16450000
.R002450 ANOP                                                   X04SVHS 16500000
.*       AT THIS POINT CHAIN IS EITHER UNSPECIFIED, OR         @ZA34940 16550000
.*       ISTCBRPL WAS CALLED BY THE RPL DECLARATIVE MACRO      @ZA34940 16600000
         AIF   ('&CHAIN' NE '').R002475 IF CHAIN IS SPEC,       X04SVHS 16650000
.*             THEN CALLER IS RPL AND DECLARATIVE GLOBAL MUST BE SET    16700000
         AIF   ('&CALLER' NE 'RPL').R002500 ICALLER IS RPL,     X04SVHS 16750000
.*             THEN DEFAULT VALUE MUST BE SET                           16800000
&ONLY    SETB  1                        SET DEFAULT VALUE       X04SVHS 16850000
.R002475 ANOP                                                   X04SVHS 16900000
&IDACHN  SETC  '&FIRST&MIDDLE&LAST&ONLY.0000'                   X04SVHS 16950000
.*                                      SET CHAIN CODES         X04SVHS 17000000
.********************************************************************** 17050000
.*                                      POST                            17100000
.R002500 AIF   ('&POST' EQ '').R002900 *** POST ***             X3004BS 17150000
         ISTCB3 ARG=&POST,KWTC=X'69',CHKAM=VTAM,AM=&AM,BIT=YES @ZA34940 17200000
&I       SETA  0                                                X3004BS 17250000
&A       SETA  0                        ZERO ERROR COUNTER      X04SVHS 17300000
.R002600 ANOP                                                   X3004BS 17350000
&I       SETA  &I+1                     BUMP INDEX INTO LIST    X04SVHS 17400000
         AIF   (&I GT N'&POST).R002700  CHECK FOR END OF LIST   X04SVHS 17450000
&PRESP   SETB  ('&POST(&I)' EQ 'RESP' OR &PRESP)                X3004BS 17500000
&SCHED   SETB  ('&POST(&I)' EQ 'SCHED' OR &SCHED)               X3004BS 17550000
         AIF   (&PRESP+&SCHED+&A EQ &I).R002600                 X04SVHS 17600000
.*                                      CHK FOR NEW BIT SET             17650000
         ISTERMAC 5,POST,&POST(&I)                             @ZA34940 17700000
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 17750000
&A       SETA  &A+1                     BUMP ERROR COUNTER      X04SVHS 17800000
         AGO   .R002600                                         X3004BS 17850000
.*             CHECK FOR MUTUALLY EXCLUSIVE KEYWORDS                    17900000
.R002700 AIF   (NOT(&PRESP AND &SCHED)).R002800                 X3004BS 17950000
         ISTERMAC 8,POST,RESP,SCHED                            @ZA34940 18000000
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 18050000
.R002800 ANOP                                                   X3004BS 18100000
         AIF   ('&CALLER' EQ 'RPL').R002900                     X04SVHS 18150000
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               18200000
&IDAVALC(&IDAENO) SETC '&PRESP&SCHED.00000000000000&Z16'        X3004BS 18250000
.********************************************************************** 18300000
.*                                      RESPOND                         18350000
.R002900 AIF   ('&RESPOND' EQ '').R003450 *** RESPOND ***       X3004BS 18400000
         ISTCB3 ARG=&RESPOND,KWTC=X'6A',CHKAM=VTAM,AM=&AM,     @ZA34940*18450000
               BIT=YES                                         @ZA34940 18500000
.*                                                              X04SVHS 18550000
&I       SETA  0                                                X3004BS 18600000
&A       SETA  0                        ZERO ERROR COUNTER      X04SVHS 18650000
.R003000 ANOP                                                   X3004BS 18700000
&I       SETA  &I+1                     BUMP INDEX INTO ARRAYS  X04SVHS 18750000
         AIF   (&I GT N'&RESPOND).R003100 CHECK FOR END OF LIST X04SVHS 18800000
&NEX     SETB  ('&RESPOND(&I)' EQ 'NEX' OR &NEX)                X3004BS 18850000
&EX      SETB  ('&RESPOND(&I)' EQ 'EX' OR &EX)                  X3004BS 18900000
&FME     SETB  ('&RESPOND(&I)' EQ 'FME' OR &FME)                X3004BS 18950000
&NFME    SETB  ('&RESPOND(&I)' EQ 'NFME' OR &NFME)              X3004BS 19000000
&NRRN    SETB  ('&RESPOND(&I)' EQ 'NRRN' OR &NRRN)              X3004BS 19050000
&RRN     SETB  ('&RESPOND(&I)' EQ 'RRN' OR &RRN)                X3004BS 19100000
&QRESP   SETB  ('&RESPOND(&I)' EQ 'QRESP' OR &QRESP)           @G40AKSL 19150000
&NQRESP  SETB  ('&RESPOND(&I)' EQ 'NQRESP' OR &NQRESP)         @G40AKSL 19200000
         AIF   (&NEX+&EX+&FME+&NFME+&NRRN+&RRN+&A+&QRESP+&NQRESP EQ &I)*19250000
               .R003000                                        @G40AKSL 19300000
.*             CHECK FOR VALID OPTION                                   19350000
         ISTERMAC 5,RESPOND,&RESPOND(&I)                       @ZA34940 19400000
&IDACB01 SETB  1                          SET ERROR SWITCH      X3004BS 19450000
&A       SETA  &A+1                     BUMP ERROR COUNTER      X04SVHS 19500000
         AGO   .R003000                                         X3004BS 19550000
.*             CHECK FOR MUTUALLY EXCLUSIVE KEYWORDS                    19600000
.R003100 AIF   (NOT(&NEX AND &EX)).R003200                      X3004BS 19650000
         ISTERMAC 8,RESPOND,NEX,EX                             @ZA34940 19700000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 19750000
.R003200 AIF   (NOT(&FME AND &NFME)).R003300                    X3004BS 19800000
         ISTERMAC 8,RESPOND,FME,NFME                           @ZA34940 19850000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 19900000
.R003300 AIF   (NOT(&NRRN AND &RRN)).R003400                    X3004BS 19950000
         ISTERMAC 8,RESPOND,NRRN,RRN                           @ZA34940 20000000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 20050000
.R003400 ANOP                                                   X3004BS 20100000
         AIF   ('&CALLER' EQ 'RPL').R003450                     X04SVHS 20150000
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               20200000
&IDAVALC(&IDAENO) SETC '&NEX&EX&FME&NFME&NRRN&RRN&QRESP&NQRESP.00000000*20250000
               &Z16'                                           @G40AKSL 20300000
         AGO   .R003500                                         X04SVHS 20350000
.R003450 ANOP                                                   X04SVHS 20400000
&IDAPORE SETC  '&SCHED.000&QRESP&EX&NFME&RRN' SET POST/RESPOND @G40AKCM 20450000
.********************************************************************** 20500000
.*                                      CONTROL                         20550000
.R003500 AIF   ('&CONTROL' EQ '').R003750                       X04SVHS 20600000
         AIF   ('&AM' NE 'VTAM').AMERR                                  20650000
         ISTCB3 ARG=&CONTROL,KWTC=X'6B',BIT=YES                @ZA34940 20700000
.*                                                              X04SVHS 20750000
&DATA    SETB  ('&CONTROL' EQ 'DATA' OR '&CONTROL' EQ '(DATA)') X04SVHS 20800000
&CANCEL  SETB  ('&CONTROL' EQ 'CANCEL' OR '&CONTROL' EQ '(CANCEL)')     20850000
.*                                                              X04SVHS 20900000
&QC      SETB  ('&CONTROL' EQ 'QC' OR '&CONTROL' EQ '(QC)')     X04SVHS 20950000
&QEC     SETB  ('&CONTROL' EQ 'QEC' OR '&CONTROL' EQ '(QEC)')   X04SVHS 21000000
&CHASE   SETB  ('&CONTROL' EQ 'CHASE' OR '&CONTROL' EQ '(CHASE)')       21050000
.*                                                              X04SVHS 21100000
&RELQ    SETB  ('&CONTROL' EQ 'RELQ' OR '&CONTROL' EQ '(RELQ)') X04SVHS 21150000
&CSDT    SETB  ('&CONTROL' EQ 'SDT' OR '&CONTROL' EQ '(SDT)')   X04SVHS 21200000
&CLEAR   SETB  ('&CONTROL' EQ 'CLEAR' OR '&CONTROL' EQ '(CLEAR)')       21250000
.*                                                              X04SVHS 21300000
&STSN    SETB  ('&CONTROL' EQ 'STSN' OR '&CONTROL' EQ '(STSN)') X04SVHS 21350000
&SHUTD   SETB  ('&CONTROL' EQ 'SHUTD' OR '&CONTROL' EQ '(SHUTD)')       21400000
.*                                                              X04SVHS 21450000
&RQR     SETB  ('&CONTROL' EQ 'RQR' OR '&CONTROL' EQ '(RQR)')   X04SVHS 21500000
&BID     SETB  ('&CONTROL' EQ 'BID' OR '&CONTROL' EQ '(BID)')   X04SVHS 21550000
&LUS     SETB  ('&CONTROL' EQ 'LUS' OR '&CONTROL' EQ '(LUS)')   X04SVHS 21600000
&RTR     SETB  ('&CONTROL' EQ 'RTR' OR '&CONTROL' EQ '(RTR)')   X04SVHS 21650000
&SIGNAL  SETB  ('&CONTROL' EQ 'SIGNAL' OR '&CONTROL' EQ '(SIGNAL)')     21700000
.*                                                              X04SVHS 21750000
&RSHUTD  SETB  ('&CONTROL' EQ 'RSHUTD' OR '&CONTROL' EQ '(RSHUTD)')     21800000
.*                                                              X04SVHS 21850000
&SHUTC   SETB  ('&CONTROL' EQ 'SHUTC' OR '&CONTROL' EQ '(SHUTC)')       21900000
.*             CHECK IF VALID OPTION WAS SPECIFIED             @ZA07554 21950000
&BIND    SETB  ('&CONTROL' EQ 'BIND'   OR '&CONTROL' EQ '(BIND)')       22000000
.*                                                             @G40AKCM 22050000
&UNBIND  SETB  ('&CONTROL' EQ 'UNBIND' OR '&CONTROL' EQ '(UNBIND)')     22100000
.*             CHECK IF VALID OPTION WAS SPECIFIED             @G40AKCM 22150000
&SBI     SETB  ('&CONTROL' EQ 'SBI'    OR '&CONTROL' EQ '(SBI)')        22200000
.*                                                             @G40AKCM 22250000
&BIS     SETB  ('&CONTROL' EQ 'BIS'   OR '&CONTROL' EQ '(BIS)')         22300000
.*             CHECK IF VALID OPTION WAS SPECIFIED             @G40AKCM 22350000
         AIF   (&DATA+&CANCEL+&QC+&QEC+&CHASE+&RELQ+&CSDT+&CLEAR+&STSN+*22400000
               &SHUTD+&RQR+&BID+&LUS+&RTR+&SIGNAL+&RSHUTD+&SHUTC+&BIND+*22450000
               &UNBIND+&SBI+&BIS EQ 1).R003600                 @G40AKCM 22500000
         ISTERMAC 5,CONTROL,&CONTROL                           @ZA34940 22550000
&IDACB01 SETB  1                         SET ERROR SWITCH       X3004BS 22600000
.R003600 ANOP                                                           22650000
         AIF (N'&CONTROL EQ 1).R003700   ONLY ONE OPTION IS ALLOWED     22700000
         ISTERMAC 22,CONTROL                                   @ZA34940 22750000
&IDACB01 SETB  1                         SET ERROR SWITCH       X04SVHS 22800000
.R003700 ANOP                                                   X3004BS 22850000
         AIF   ('&CALLER' EQ 'RPL').R003750                     X04SVHS 22900000
.*   IF CALLED BY RPL BYPASS SETTING CBM GLOBAL                         22950000
&IDAVALC(&IDAENO) SETC '&DATA&CANCEL&QC&QEC&CHASE&RELQ&BID&RTR&LUS&SIGN*23000000
               AL&CSDT&CLEAR&STSN&SHUTD&RQR&RSHUTD&SHUTC&BIND&UNBIND&SB*23050000
               I&BIS.000&Z8'                                   @G40AKCM 23100000
         AGO   .R003900                                                 23150000
.R003750 ANOP                                                           23200000
.*       AT THIS POINT EITHER CONTROL IS NOT SPECIFIED, OR     @ZA34940 23250000
.*       ISTCBRPL HAS BEEN CALLED BY THE RPL DECLARATIVE MACRO @ZA34940 23300000
         AIF   ('&CONTROL' NE '').R003775 IF CONTROL IS SPEC,   X04SVHS 23350000
.*             THEN CALLER IS RPL, AND DECLARATIVE GLOBALS MUST BE SET  23400000
         AIF   ('&CALLER' NE 'RPL').R003900 IF CONTROL IS NULL  X04SVHS 23450000
.*             AND CALLER IS RPL, THEN VTAM DEFAULT VALUE MUST BE SET   23500000
&DATA    SETB  1                        SET VTAM DEFAULT        X04SVHS 23550000
.R003775 ANOP                                                           23600000
&IDACON1 SETC  '&DATA&CANCEL&QC&QEC&CHASE&RELQ.00'              X04SVHS 23650000
&IDACON2 SETC  '&BID&RTR&LUS&SIGNAL&BIND&UNBIND&SBI&BIS'       @G40AKCM 23700000
&IDACON3 SETC  '&CSDT&CLEAR&STSN&SHUTD&SHUTC&RQR.00'           @G40AKCM 23750000
         AGO   .R003900                                                 23800000
.AMERR   MNOTE 8,'CONTROL IS INVALID UNLESS AM IS SPECIFIED'            23850000
&IDACB01 SETB  1                                                        23900000
.********************************************************************** 23950000
.*                                      OBSQAC                          24000000
.R003900 AIF   ('&OBSQAC' EQ '').R004050 *** OBSQAC ***                 24050000
         ISTCB3 ARG=&OBSQAC,KWTC=X'6C',CHKAM=VTAM,AM=&AM,      @ZA34940*24100000
               BIT=YES                                         @ZA34940 24150000
.*                                                              X04SVHS 24200000
&SET     SETB  ('&OBSQAC' EQ 'SET' OR '&OBSQAC' EQ '(SET)')     X04SVHS 24250000
&TESTSET SETB  ('&OBSQAC' EQ 'TESTSET' OR '&OBSQAC' EQ '(TESTSET)')     24300000
.*                                                              X04SVHS 24350000
&RESET   SETB  ('&OBSQAC' EQ 'RESET' OR '&OBSQAC' EQ '(RESET)') X04SVHS 24400000
&IGNORE  SETB  ('&OBSQAC' EQ 'IGNORE' OR '&OBSQAC' EQ '(IGNORE)')       24450000
.*                                                              X04SVHS 24500000
&TESTPOS SETB  ('&OBSQAC' EQ 'TESTPOS' OR '&OBSQAC' EQ '(TESTPOS)')     24550000
.*                                                              X04SVHS 24600000
&TESTNEG SETB  ('&OBSQAC' EQ 'TESTNEG' OR '&OBSQAC' EQ '(TESTNEG)')     24650000
.*                                                              X04SVHS 24700000
&INVALID SETB  ('&OBSQAC' EQ 'INVALID' OR '&OBSQAC' EQ '(INVALID)')     24750000
.*                                                              X04SVHS 24800000
         AIF   (&SET+&TESTSET+&RESET+&IGNORE+&TESTPOS+&TESTNEG+&INVALID*24850000
                EQ 1).R003950                                           24900000
.*             CHECK FOR VALID OPTION                                   24950000
         ISTERMAC 5,OBSQAC,&OBSQAC(&I)                         @ZA34940 25000000
&IDACB01 SETB  1                    SET ERROR SWITCH            X3004BS 25050000
.R003950 AIF   (N'&OBSQAC EQ 1).R004000  ONE OPTION IS ALLOWED          25100000
         ISTERMAC 22,OBSQAC                                    @ZA34940 25150000
&IDACB01 SETB  1                    SET ERROR SWITCH            X04SVHS 25200000
.R004000 ANOP                                                   X3004BS 25250000
         AIF   ('&CALLER' EQ 'RPL').R004050                     X04SVHS 25300000
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               25350000
&IDAVALC(&IDAENO) SETC '&SET&TESTSET&RESET&IGNORE&TESTPOS&TESTNEG&INVAL*25400000
               ID.000000000&Z16'                                        25450000
         AGO   .R004100                                         X04SVHS 25500000
.R004050 ANOP                                                   X04SVHS 25550000
.*       AT THIS POINT, EITHER OBSQAC IS NOT SPECIFIED, OR     @ZA34940 25600000
.*       ISTCBRPL HAS BEEN CALLED BY THE RPL DECLARATIVE MACRO @ZA34940 25650000
         AIF   ('&OBSQAC' NE '').R004075 I FOBSQAC IS SPEC,     X04SVHS 25700000
.*             THEN CALLER I SRPL, AND DECLARATIVE GLOBALS MUST BE SET  25750000
         AIF   ('&CALLER' NE 'RPL').R004100                     X04SVHS 25800000
.*             IF OBSQAC IS NULL, AND CALLER IS RPL, THEN DEFAULT       25850000
.*             VALUE MUST BE SET                                        25900000
&SET     SETB  1                        SET DEFAULT VALUE       X04SVHS 25950000
.R004075 ANOP                                                   X04SVHS 26000000
&IDAOBQC SETC  '&SET&TESTSET&RESET&IGNORE&TESTPOS&TESTNEG&INVALID.0'    26050000
.*                                      SET OBSQAC CODES        X04SVHS 26100000
.********************************************************************** 26150000
.*                                      IBSQAC                          26200000
.R004100 AIF   ('&IBSQAC' EQ '').R004350 *** IBSQAC ***         X3004BS 26250000
         ISTCB3 ARG=&IBSQAC,KWTC=X'6D',CHKAM=VTAM,AM=&AM,      @ZA34940*26300000
               BIT=YES                                         @ZA34940 26350000
.*                                                              X04SVHS 26400000
&ISET    SETB  ('&IBSQAC' EQ 'SET' OR '&IBSQAC' EQ '(SET)')     X04SVHS 26450000
&ITESTSE SETB  ('&IBSQAC' EQ 'TESTSET' OR '&IBSQAC' EQ '(TESTSET)')     26500000
.*                                                              X04SVHS 26550000
&IRESET  SETB  ('&IBSQAC' EQ 'RESET' OR '&IBSQAC' EQ '(RESET)') X04SVHS 26600000
&IIGNORE SETB  ('&IBSQAC' EQ 'IGNORE' OR '&IBSQAC' EQ '(IGNORE)')       26650000
.*                                                              X04SVHS 26700000
&ITESTPO SETB  ('&IBSQAC' EQ 'TESTPOS' OR '&IBSQAC' EQ '(TESTPOS)')     26750000
.*                                                              X04SVHS 26800000
&ITESTNE SETB  ('&IBSQAC' EQ 'TESTNEG' OR '&IBSQAC' EQ '(TESTNEG)')     26850000
.*                                                              X04SVHS 26900000
&IINVALI SETB  ('&IBSQAC' EQ 'INVALID' OR '&IBSQAC' EQ '(INVALID)')     26950000
.*                                                              X04SVHS 27000000
         AIF   (&ISET+&ITESTSE+&IRESET+&IIGNORE+&ITESTPO+&ITESTNE+&IINV*27050000
               ALI EQ 1).R004200                                X04SVHS 27100000
.*             CHECK FOR VALID OPTION                                   27150000
         ISTERMAC 5,IBSQAC,&IBSQAC                             @ZA34940 27200000
&IDACB01 SETB  1                         SET ERROR SWITCH       X3004BS 27250000
.R004200 AIF   (N'&IBSQAC EQ 1).R004300  ONLY ONE OPTION IS ALLOWED     27300000
         ISTERMAC 22,IBSQAC                                    @ZA34940 27350000
&IDACB01 SETB  1                         SET ERROR SWITCH       X3004BS 27400000
.R004300 ANOP                                                   X3004BS 27450000
         AIF   ('&CALLER' EQ 'RPL').R004350                     X04SVHS 27500000
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               27550000
&IDAVALC(&IDAENO) SETC '&ISET&ITESTSE&IRESET&IIGNORE&ITESTPO&ITESTNE&II*27600000
               NVALI.000000000&Z16'                             X04SVHS 27650000
         AGO   .R004400                                         X04SVHS 27700000
.R004350 ANOP                                                   X04SVHS 27750000
.*       AT THIS POINT EITHER IBSQAC IS NOT SPECIFIED, OR      @ZA34940 27800000
.*       ISTCBRPL HAS BEEN CALLED BY THE RPL DECLARATIVE MACRO @ZA34940 27850000
         AIF   ('&IBSQAC' NE '').R004375 IF IBSQAC IS SPEC,     X04SVHS 27900000
.*             THEN CALLER IS RPL AND DECLARATIVE GLOBALS MUST BE SET   27950000
         AIF   ('&CALLER' NE 'RPL').R004400 IF CALLER IS RPL,   X04SVHS 28000000
.*             THEN DEFAULT VALUE MUST BE SET                   X04SVHS 28050000
&ISET    SETB  1                        SET DEFAULT VALUE       X04SVHS 28100000
.R004375 ANOP                                                   X04SVHS 28150000
&IDAIBQC SETC  '&ISET&ITESTSE&IRESET&IIGNORE&ITESTPO&ITESTNE&IINVALI.0' 28200000
.*                                      SET IBSQAC CODES        X04SVHS 28250000
.********************************************************************** 28300000
.*                                      SSENSEO                         28350000
.R004400 AIF   ('&SSENSEO' EQ '').R004700 *** SSENSEO ***       X3004BS 28400000
         AIF   ('&SSENSEO' EQ '0' OR '&SSENSEO' EQ '(0)').R004700       28450000
.*                                                             @ZA41707 28500000
         ISTCB3 ARG=&SSENSEO,KWTC=X'71',CHKAM=VTAM,AM=&AM,     @ZA34940*28550000
               BIT=YES                                         @ZA34940 28600000
.*                                                              X04SVHS 28650000
&OCPM    SETB  ('&SSENSEO' EQ 'CPM' OR '&SSENSEO' EQ '(CPM)')   X04SVHS 28700000
&OSTATE  SETB  ('&SSENSEO' EQ 'STATE' OR '&SSENSEO' EQ '(STATE)')       28750000
.*                                                              X04SVHS 28800000
&OFI     SETB  ('&SSENSEO' EQ 'FI' OR '&SSENSEO' EQ '(FI)')     X04SVHS 28850000
&ORR     SETB  ('&SSENSEO' EQ 'RR' OR '&SSENSEO' EQ '(RR)')     X04SVHS 28900000
         AIF   (&OCPM+&OSTATE+&OFI+&ORR EQ 1).R004500           X04SVHS 28950000
.*                                      TEST FOR VALID OPTION SPEC      29000000
         ISTERMAC 5,SSENSEO,&SSENSEO                           @ZA34940 29050000
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 29100000
.R004500 ANOP                                                  X03004HS 29150000
         AIF   (N'&SSENSEO EQ 1).R004600                        X04SVHS 29200000
         ISTERMAC 22,SSENSEO           ONLY ONE OPTION ALLOWED @ZA34940 29250000
&IDACB01 SETB  1                        SET ERROR SWITCH       X03004HS 29300000
.R004600 ANOP                                                  X03004HS 29350000
         AIF   ('&CALLER' EQ 'RPL').R004650                     X04SVHS 29400000
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               29450000
&IDAVALC(&IDAENO) SETC '&OCPM&OSTATE&OFI&ORR.000000000000&Z16' X03004HS 29500000
         AGO   .R004700                                         X04SVHS 29550000
.R004650 ANOP                                                   X04SVHS 29600000
&IDASNSO SETC  '0&OCPM&OSTATE&OFI&ORR.000'                      X04SVHS 29650000
.*                                      SET SSENSEO CODES       X04SVHS 29700000
         AGO   .R005250                 WHEN CALLED BY RPL, PROCESS     29750000
.*                                      BRANCH KEYWORD          X04SVHS 29800000
.********************************************************************** 29850000
.*                                      SSENSEI                         29900000
.R004700 AIF   ('&SSENSEI' EQ '').R005000 *** SSENSEI ***       X3004BS 29950000
         ISTCB3 ARG=&SSENSEI,KWTC=X'72',CHKAM=VTAM,AM=&AM,     @ZA34940*30000000
               BIT=YES                                         @ZA34940 30050000
.*                                                              X04SVHS 30100000
&IPATH   SETB  ('&SSENSEI' EQ 'PATH' OR '&SSENSEI' EQ '(PATH)') X04SVHS 30150000
&ICPM    SETB  ('&SSENSEI' EQ 'CPM' OR '&SSENSEI' EQ '(CPM)')   X04SVHS 30200000
&ISTATE  SETB  ('&SSENSEI' EQ 'STATE' OR '&SSENSEI' EQ '(STATE)')       30250000
.*                                                              X04SVHS 30300000
&IFI     SETB  ('&SSENSEI' EQ 'FI' OR '&SSENSEI' EQ '(FI)')     X04SVHS 30350000
&IRR     SETB  ('&SSENSEI' EQ 'RR' OR '&SSENSEI' EQ '(RR)')     X04SVHS 30400000
         AIF   (&IPATH+&ICPM+&ISTATE+&IFI+&IRR EQ 1).R004800            30450000
.*                                      TEST FOR VALID OPTION SPEC      30500000
         ISTERMAC 5,SSENSEI,&SSENSEI                           @ZA34940 30550000
&IDACB01 SETB  1                        SET ERROR SWITCH        X3004BS 30600000
.R004800 ANOP                                                  X03004HS 30650000
         AIF   (N'&SSENSEI EQ 1).R004900 ONLY ONE OPTION IS ALLOWED     30700000
         ISTERMAC 22,SSENSEI                                   @ZA34940 30750000
&IDACB01 SETB  1                        SET ERROR SWITCH       X03004HS 30800000
.R004900 ANOP                                                   X04SVHS 30850000
&IDAVALC(&IDAENO) SETC '&IPATH&ICPM&ISTATE&IFI&IRR.00000000000&Z16'     30900000
.R005000 ANOP                                                  @Z40BHUC 30950000
.********************************************************************** 31000000
.*                                      SSENSMO                         31050000
         ISTCB3 ARG=&SSENSMO,ARGNAME=SSENSMO,KWTC=X'86',       @ZA34940*31100000
               MF=&MF,CHKAM=VTAM,AM=&AM                        @ZA34940 31150000
.********************************************************************** 31200000
.*                                      SSENSMI                         31250000
         ISTCB3 ARG=&SSENSMI,ARGNAME=SSENSMI,KWTC=X'87',       @ZA34940*31300000
               MF=&MF,CHKAM=VTAM,AM=&AM                        @ZA34940 31350000
.********************************************************************** 31400000
.*                                      SIGDATA                         31450000
         ISTCB3 ARG=&SIGDATA,ARGNAME=SIGDATA,KWTC=X'88',       @ZA34940*31500000
               MF=&MF,CHKAM=VTAM,AM=&AM                        @ZA34940 31550000
.********************************************************************** 31600000
.*                                      OBSQVAL                         31650000
         ISTCB3 ARG=&OBSQVAL,ARGNAME=OBSQVAL,KWTC=X'6E',       @ZA34940*31700000
               MF=&MF,CHKAM=VTAM,AM=&AM                        @ZA34940 31750000
.********************************************************************** 31800000
.*                                      IBSQVAL                         31850000
         ISTCB3 ARG=&IBSQVAL,ARGNAME=IBSQVAL,KWTC=X'6F',       @ZA34940*31900000
               MF=&MF,CHKAM=VTAM,AM=&AM                        @ZA34940 31950000
.********************************************************************** 32000000
.*                                      SEQNO                           32050000
         ISTCB3 ARG=&SEQNO,ARGNAME=SEQNO,KWTC=X'70',MF=&MF,    @ZA34940*32100000
               CHKAM=VTAM,AM=&AM                                X04SVHS 32150000
.********************************************************************** 32200000
.*                                      USENSEO                         32250000
         ISTCB3 ARG=&USENSEO,ARGNAME=USENSEO,KWTC=X'73',       @ZA34940*32300000
               MF=&MF,CHKAM=VTAM,AM=&AM                        @ZA34940 32350000
.********************************************************************** 32400000
.*                                      USENSEI                         32450000
         ISTCB3 ARG=&USENSEI,ARGNAME=USENSEI,KWTC=X'74',       @ZA34940*32500000
               MF=&MF,CHKAM=VTAM,AM=&AM                        @ZA34940 32550000
.********************************************************************** 32600000
.*                                      RECLEN                          32650000
         ISTCB3 ARG=&RECLEN,ARGNAME=RECLEN,KWTC=X'35',MF=&MF   @ZA34940 32700000
.********************************************************************** 32750000
.*                                      AAREA                           32800000
         ISTCB3 ARG=&AAREA,ARGNAME=AAREA,KWTC=X'57',MF=&MF,    @ZA34940*32850000
               CHKAM=VTAM,AM=&AM                                X04SVHS 32900000
.********************************************************************** 32950000
.*                                      AAREALN                         33000000
         ISTCB3 ARG=&AAREALN,ARGNAME=AAREALN,KWTC=X'49',       @ZA34940*33050000
               MF=&MF,CHKAM=VTAM,AM=&AM                        @ZA34940 33100000
.********************************************************************** 33150000
.*                                      ARECLEN                         33200000
         ISTCB3 ARG=&ARECLEN,ARGNAME=ARECLEN,KWTC=X'4A',       @ZA34940*33250000
               MF=&MF,CHKAM=VTAM,AM=&AM                        @ZA34940 33300000
.********************************************************************** 33350000
.*                                      EXIT                            33400000
         ISTCB3 ARG=&EXIT,ARGNAME=EXIT,KWTC=X'4B',MF=&MF,      @ZA34940*33450000
               CHKAM=VTAM,AM=&AM                               @ZA34940 33500000
.********************************************************************** 33550000
.*                                      NIB                             33600000
         ISTCB3 ARG=&NIB,ARGNAME=NIB,KWTC=X'4F',MF=&MF,        @ZA34940*33650000
               CHKAM=VTAM,AM=&AM                               @ZA34940 33700000
.********************************************************************** 33750000
.*                                      BRANCH                          33800000
.R005250 ANOP                                                   X04SVHS 33850000
         AIF   ('&BRANCH' EQ '').R005400 *** BRANCH ***          X03004 33900000
         ISTCB3 ARG=&BRANCH,KWTC=X'58',CHKAM=VTAM,AM=&AM,      @ZA34940*33950000
               BIT=YES                                         @ZA34940 34000000
.*                                                              X04SVHS 34050000
&BRYES   SETB  ('&BRANCH' EQ 'YES')                                     34100000
&BRNO    SETB  ('&BRANCH' EQ 'NO')                                      34150000
         AIF   (&BRYES OR &BRNO).R005300 TEST FOR VALID OPTION  X04SVHS 34200000
         ISTERMAC 3,BRANCH,&BRANCH                             @ZA34940 34250000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 34300000
.R005300 ANOP                                                           34350000
         AIF   ('&CALLER' EQ 'RPL').R005350                     X04SVHS 34400000
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL               34450000
&IDAVALC(&IDAENO) SETC '&BRYES&BRNO.00000000000000&Z16'          X03004 34500000
         AGO   .R005400                                        @G40AKSL 34550000
.R005350 ANOP                                                   X04SVHS 34600000
&IDABRCH SETC  '&BRYES'                 SET BRANCH CODE         X04SVHS 34650000
.********************************************************************** 34700000
.*                                      CRYPT                  @G40AKSL 34750000
.R005400 ANOP                                                  @G40AKSL 34800000
         AIF   ('&CRYPT' EQ '').R005440      ***CRYPT***       @G40AKSL 34850000
         ISTCB3 ARG=&CRYPT,KWTC=X'95',AM=&AM,CHKAM=VTAM,       @ZA34940*34900000
               BIT=YES                                         @ZA34940 34950000
&CRYES   SETB  ('&CRYPT' EQ 'YES')                             @G40AKSL 35000000
&CRNO    SETB  ('&CRYPT' EQ 'NO')                              @G40AKSL 35050000
         AIF   (&CRYES OR &CRNO).R005425    TEST FOR VALID OPTION       35100000
         ISTERMAC 3,CRYPT,&CRYPT                               @ZA34940 35150000
&IDACB01 SETB  1                                               @G40AKSL 35200000
.R005425 ANOP                                                  @G40AKSL 35250000
         AIF   ('&CALLER' EQ 'RPL').R005430                    @G40AKSL 35300000
.*             IF CALLED BY RPL BYPASS SETTING CBM GLOBAL      @G40AKSL 35350000
&IDAVALC(&IDAENO) SETC '&CRYES&CRNO.00000000000000&Z16'        @G40AKSL 35400000
         AGO   .R005440                                        @G40AKSL 35450000
.R005430 ANOP                                                  @G40AKSL 35500000
&IDACRYP SETC  '&CRYES'   SET CRYPT CODE                       @G40AKSL 35550000
.********************************************************************** 35600000
.R005440 AIF   ('&CALLER' NE 'RPL').R005450                     X04SVHS 35650000
.*             IF CALLER IS RPL, ALL KEYWORDS HAVE BEEN PROCESSED       35700000
         MEXIT                                                  X04SVHS 35750000
.*                                                                      35800000
.* TEST FOR INCOMPATIBLE VTAM KEYWORDS                           X03004 35850000
.R005450 AIF ('&ARG' EQ '' OR '&NIB' EQ '').R005500              X03004 35900000
         ISTERMAC 19,ARG,NIB                                   @ZA34940 35950000
&IDACB01 SETB  1                                                 X03004 36000000
.R005500 AIF ('&ECB' EQ 'INTERNAL').R006100                    @ZA53800 36050000
         AIF ('&ECB' EQ '' OR '&EXIT' EQ '').R006100             X03004 36100000
         ISTERMAC 19,ECB,EXIT                                  @ZA34940 36150000
&IDACB01 SETB  1                                                 X03004 36200000
.R006100 AIF ('&RBA' EQ '' OR '&SEQNO' EQ '').R006200           X3004BS 36250000
         ISTERMAC 19,RBA,SEQNO                                 @ZA34940 36300000
&IDACB01 SETB  1                                                X3004BS 36350000
.R006200 AIF ('&KEYLEN' EQ '' OR '&CHNGDIR' EQ '').R006300      X3004BS 36400000
         ISTERMAC 19,KEYLEN,CHNGDIR                            @ZA34940 36450000
&IDACB01 SETB  1                                                X3004BS 36500000
.R006300 AIF ('&KEYLEN' EQ '' OR '&STYPE' EQ '').R006400        X3004BS 36550000
         ISTERMAC 19,KEYLEN,STYPE                              @ZA34940 36600000
&IDACB01 SETB  1                                                X3004BS 36650000
.R006400 AIF ('&KEYLEN' EQ '' OR '&RTYPE' EQ '').R006450        X04SVHS 36700000
         ISTERMAC 19,KEYLEN,RTYPE                              @ZA34940 36750000
&IDACB01 SETB  1                                                X3004BS 36800000
.R006450 AIF   ('&KEYLEN' EQ '' OR '&BRACKET' EQ '').R006500    X04SVHS 36850000
         ISTERMAC 19,KEYLEN,BRACKET                            @ZA34940 36900000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 36950000
.R006500 ANOP                                                   X04SVHS 37000000
.********************************************************************** 37050000
.*                                      TRANSID                         37100000
         ISTCB3 ARG=&TRANSID,ARGNAME=TRANSID,KWTC=X'5F',MF=&MF @ZA34940 37150000
.********************************************************************** 37200000
.*                                      AM                              37250000
         AIF   ('&AM' EQ '' OR '&CALLER' NE 'GEN').R006700      X04SVHS 37300000
.*             ARGUMENT CONTROL ENTRY IS ONLY BUILT FOR GENCB FOR AM    37350000
&VSAM    SETB  ('&AM' EQ 'VSAM')        CHK FOR AM=VSAM         X04SVHS 37400000
&VTAM    SETB  ('&AM' EQ 'VTAM')        CHK FOR AM=VTAM         X04SVHS 37450000
         AIF   (&VSAM OR &VTAM).R006600                                 37500000
.*             IF NOT VSAM OR VTAM, ERROR                               37550000
         ISTERMAC 5,AM,&AM                                     @ZA34940 37600000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 37650000
.R006600 ANOP                                                   X04SVHS 37700000
         ISTCB3 ARG=&AM,KWTC=X'40',BIT=YES                     @ZA34940 37750000
&IDAVALC(&IDAENO) SETC '&VSAM&VTAM.00000000000000&Z16'                  37800000
.********************************************************************** 37850000
.R006700 ANOP                                                   X04SVHS 37900000
         AIF   ('&CALLER' EQ 'GEN' OR '&CALLER' EQ 'MOD').R007500       37950000
.*                                                              X04SVHS 38000000
.*             THE FOLLOWING KEYWORDS ARE VALID ONLY FOR TESTCB         38050000
.*                                                                      38100000
.********************************************************************** 38150000
.*                                      IO                              38200000
         AIF   ('&IO' EQ '').R006900   *** IO ***                       38250000
         ISTCB3 ARG=&IO,ARGNAME=IO,KWTC=X'36',MF=&MF,          @ZA34940*38300000
               INDRECT=YES,BIT=YES                             @ZA34940 38350000
         AIF   ('&IO(1)' EQ '*').R006900                                38400000
.*       IF INDIRECT ADDRESS WAS SPECIFIED, THE VALUE ARRAY(&IDAVALC)   38450000
.*       WAS SET IN ISTCB3                                     @ZA34940 38500000
&COMPLET SETB  ('&IO' EQ 'COMPLETE')                            X04SVHS 38550000
         AIF   (&COMPLET).R006800       CHK FOR CORRECT OPTION  X04SVHS 38600000
         ISTERMAC 3,IO,&IO                                     @ZA34940 38650000
&IDACB01 SETB  1                        SET ERROR SWITCH                38700000
.R006800 ANOP                                                           38750000
&IDAVALC(&IDAENO) SETC '&COMPLET.000000000000000&Z16'           X04SVHS 38800000
.********************************************************************** 38850000
.R006900 ANOP                                                           38900000
.*                                      FDBK                            38950000
         ISTCB3 ARG=&FDBK,ARGNAME=FDBK,KWTC=X'38',MF=&MF       @ZA34940 39000000
.********************************************************************** 39050000
.*                                      RBA                             39100000
         ISTCB3 ARG=&RBA,ARGNAME=RBA,KWTC=X'39',MF=&MF         @ZA34940 39150000
.********************************************************************** 39200000
.*                                      AIXPC                           39250000
         ISTCB3 ARG=&AIXPC,ARGNAME=AIXPC,KWTC=X'3A',MF=&MF     @ZA34940 39300000
.********************************************************************** 39350000
         AIF   ('&AIXFLAG' EQ '').R007100 ** AIXFLAG ***        X04SVHS 39400000
&PRIME   SETB  ('&AIXFLAG' EQ 'AIXPKP')                        @XM07772 39450000
         AIF   (&PRIME).R007000                                @XM07772 39500000
.*                                      CHK FOR VALID OPTION SPEC       39550000
         ISTERMAC 5,AIXFLAG,&AIXFLAG                           @ZA34940 39600000
&IDACB01 SETB  1                        SET ERROR SWITCH        X04SVHS 39650000
.R007000 ANOP                                                   X04SVHS 39700000
         ISTCB3 ARG=&AIXFLAG,KWTC=X'3B',BIT=YES                @ZA34940 39750000
&IDAVALC(&IDAENO) SETC '&PRIME.000000000000000&Z16'            @XM07772 39800000
.********************************************************************** 39850000
.R007100 ANOP                                                   X04SVHS 39900000
.*                                      USER                            39950000
         ISTCB3 ARG=&USER,ARGNAME=USER,KWTC=X'4E',MF=&MF,      @ZA34940*40000000
               CHKAM=VTAM,AM=&AM                                X04SVHS 40050000
.********************************************************************** 40100000
.*                                      RTNCD                           40150000
         ISTCB3 ARG=&RTNCD,ARGNAME=RTNCD,KWTC=X'5E',MF=&MF     @ZA34940 40200000
.********************************************************************** 40250000
.*                                      FDBK2                           40300000
         ISTCB3 ARG=&FDBK2,ARGNAME=FDBK2,KWTC=X'60',MF=&MF     @ZA34940 40350000
.********************************************************************** 40400000
.*                                      SENSE                           40450000
         ISTCB3 ARG=&SENSE,ARGNAME=SENSE,KWTC=X'61',MF=&MF,    @ZA34940*40500000
               CHKAM=VTAM,AM=&AM                                X04SVHS 40550000
.********************************************************************** 40600000
.*                                      REQ                             40650000
         ISTCB3 ARG=&REQ,ARGNAME=REQ,KWTC=X'62',MF=&MF         @ZA34940 40700000
.********************************************************************** 40750000
.*                                      DATAFLG                         40800000
         AIF   ('&DATAFLG' EQ '').R007400 *** DATAFLG ***       X04SVHS 40850000
         ISTCB3 ARG=&DATAFLG,KWTC=X'5D',CHKAM=VTAM,AM=&AM,     @ZA34940*40900000
               BIT=YES                                         @ZA34940 40950000
.*                                                              X04SVHS 41000000
&I       SETA  0                                                 X03004 41050000
&A       SETA  0                        ZERO ERROR COUNTER      X04SVHS 41100000
.R007200 ANOP                                                    X03004 41150000
&I       SETA  &I+1                     BUMP INDEX INTO LIST     X03004 41200000
         AIF   (&I GT N'&DATAFLG).R007300 CHECK FOR END OF LIST  X03004 41250000
&UNSOL   SETB  ('&DATAFLG(&I)' EQ 'UNSOL' OR &UNSOL)             X03004 41300000
&EOB     SETB  ('&DATAFLG(&I)' EQ 'EOB' OR &EOB)                 X03004 41350000
&EOM     SETB  ('&DATAFLG(&I)' EQ 'EOM' OR &EOM)                 X03004 41400000
&EOT     SETB  ('&DATAFLG(&I)' EQ 'EOT' OR &EOT)                 X03004 41450000
&LOGOFF  SETB  ('&DATAFLG(&I)' EQ 'LOGOFF' OR &LOGOFF)           X03004 41500000
&LG      SETB  ('&DATAFLG(&I)' EQ 'LG' OR &LG)                   X03004 41550000
&SOH     SETB  ('&DATAFLG(&I)' EQ 'SOH' OR &SOH)                 X03004 41600000
         AIF   (&UNSOL+&EOB+&EOM+&EOT+&LOGOFF+&LG+&SOH+&A EQ &I).R00720*41650000
               0                                                X04SVHS 41700000
                                        TEST FOR VALID OPTION SPEC      41750000
         ISTERMAC 5,DATAFLG,&DATAFLG(&I)                       @ZA34940 41800000
&IDACB01 SETB  1                        SET ERROR SWITCH         X03004 41850000
&A       SETA  &A+1                     BUMP ERROR COUNTER      X04SVHS 41900000
         AGO   .R007200                                          X03004 41950000
.R007300 ANOP                                                    X03004 42000000
&IDAVALC(&IDAENO) SETC '&UNSOL&EOB&EOM&EOT&LOGOFF&LG&SOH.000000000&Z16' 42050000
.*                                                              X04SVHS 42100000
.********************************************************************** 42150000
.R007400 ANOP                                                   X04SVHS 42200000
.*                                      FTNCD                           42250000
         ISTCB3 ARG=&FTNCD,ARGNAME=FTNCD,KWTC=X'63',MF=&MF     @ZA34940 42300000
.********************************************************************** 42350000
.R007500 ANOP                                                           42400000
         MEND                                                           42450000
