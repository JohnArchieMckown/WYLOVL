*/*                                                                     00050000
         MACRO                                                          00100000
&LABEL   CBRXLCS &ACCESS=,                                             *00157990
               &BULKEJCT=,                                             *00165980
               &CANCEL=,                                               *00175000
               &COPYMODE=,                                             *00180000
               &COPYOPER=,                                             *00185000
               &DATATYPE=,                                             *00190000
               &DEFVALUE=,                                             *00195000
               &DEVTYPE=,                                              *00200000
               &EJECTOPT=,                                             *00250000
               &EXITINFO=,                                             *00300000
               &EXPDATE=,                                              *00350000
               &FUNC=,                                                 *00400000
               &GRPNAME=,                                              *00450000
               &IOLIB=,                                                *00470000
               &LIBNAME=,                                              *00500000
               &LOC=,                                                  *00510000
               &SUBPOOL=,                                              *00525000
               &TCDBCHK=,                                              *00537500
               &TYPE=,                                                 *00550000
               &UCBPTR=,                                               *00575000
               &USE=,                                                  *00600000
               &USERID=,                                               *00625000
               &VOLUME=,                                               *00650000
               &VOLINFO=,                                              *00675000
               &VOLLIST=,                                              *00700000
               &WRTDATE=,                                              *00750000
               &WRTPROT=,                                              *00800000
               &MF=                                                @L5C 00869990
.*** START OF SPECIFICATIONS *****************************************  00900000
.*                                                                   *  00950000
.*   $MAC(CBRXLCS) COMP(BL) PROD(OAM):                               *  01000000
.*                                                                   *  01050000
.*  MACRO NAME:       CBRXLCS                                        *  01100000
.*                                                                   *  01150000
.*  DESCRIPTION:      PROVIDE THE INTERFACE BY WHICH CALLERS MAY     *  01200000
.*                    ACCESS AND MANIPULATE THE LIBRARY              *  01250000
.*                    CONFIGURATION DATA MAINTAINED BY THE LIBRARY   *  01300000
.*                    CONTROL SYSTEM (LCS).                          *  01350000
.*                                                                   *  01400000
.*PROPRIETARY V3 STATEMENT                                           *  01450000
.*LICENSED MATERIALS - PROPERTY OF IBM                               *  01500000
.*"RESTRICTED MATERIALS OF IBM"                                      *  01550000
.*5694-A01                                                           *  01600000
.*(C) COPYRIGHT 1993,2001  IBM CORP.                                 *  01669990
.*END PROPRIETARY V3 STATEMENT                                       *  01700000
.*                                                                   *  01800000
.*                                                                   *  01850000
.*  FUNCTION:  CBRXLCS SUPPORTS THE FOLLOWING SERVICE REQUESTS:      *  01900000
.*                                                                   *  01950000
.*    1. FUNC=CUA  (CHANGE USE ATTRIBUTE)                            *  02000000
.*       CHANGE THE USE ATTRIBUTE OF THE VOLUME SPECIFIED            *  02050000
.*       FROM SCRATCH TO PRIVATE OR PRIVATE TO SCRATCH.              *  02100000
.*                                                                   *  02150000
.*                                                                   *  02200000
.*    2. FUNC=MCE  (MANUAL CARTRIDGE ENTRY)                          *  02250000
.*       ENTER THE SPECIFIED VOLUME(S) INTO THE SPECIFIED            *  02300000
.*       MANUAL TAPE LIBRARY.                                        *  02350000
.*                                                                   *  02400000
.*    3. FUNC=EJECT (EJECT TAPE LIBRARY CARTRIDGE)                   *  02450000
.*       EJECT THE SPECIFIED VOLUME FROM THE LIBRARY.  IF            *  02500000
.*       SPECIFIED IN THE MACRO INVOCATION, PUT THE CARTRIDGE        *  02550000
.*       IN THE BULK OUTPUT STATION OTHERWISE, PLACE IT IN THE       *  02600000
.*       CONVENIENCE OUTPUT STATION.  IF SPECIFIED (AND THE          *  02650000
.*       INSTALLATION EXIT AGREES) KEEP OR PURGE THE VOLUME'S        *  02700000
.*       RECORD IN THE TAPE CONFIGURATION DATA BASE.               @D3A 02750000
.*                                                                   *  02800000
.*    4. FUNC=QVR  (QUERY VOLUME RESIDENCE)                        @D1A 02850000
.*       RETURN THE NAME AND TYPE OF LIBRARY IN WHICH THE            *  02900000
.*       SPECIFIED VOLUME RESIDES.  RETURN THE CONSOLE NAME          *  02950000
.*       ASSOCIATED WITH THE LIBRARY, IF ANY.  IF THE VOLINFO        *  02970000
.*       KEYWORD IS SPECIFIED, RETURN AVAILABLE VOLUME RECORD        *  02990000
.*       INFORMATION FROM BOTH THE TCDB AND THE LIBRARY MANAGER      *  03010000
.*       INVENTORY.                                                @D5A 03030000
.*                                                                   *  03050000
.*    5. FUNC=TVE  (TEST VOLUME ELIGIBILITY)                       @D4A 03062500
.*       VERIFY THAT THE VOLUME SERIAL SPECIFIED CAN BE MOUNTED ON   *  03075000
.*       THE DEVICE SPECIFIED.                                       *  03087500
.*                                                                   *  03089200
.*    6. FUNC=IMPORT                                               @L3A 03090900
.*       INITIATE OR CANCEL AN IMPORT OPERATION.                     *  03092600
.*                                                                   *  03094300
.*    7. FUNC=EXPORT                                               @L3A 03096000
.*       INITIATE OR CANCEL AN EXPORT OPERATION.                     *  03097700
.*                                                                   *  03098000
.*    8. FUNC=PTPMC                                                @L5A 03098300
.*       SET THE OPERATING MODE OF A PEER-TO-PEER VTS LIBRARY.       *  03098600
.*                                                                   *  03098900
.*    9. FUNC=PTPDATA                                              @L5A 03099200
.*       RETURN DEVICE OR MODE DATA FOR A PEER-TO-PEER VTS.          *  03099500
.*                                                                   *  03100000
.*  OPERATION:                                                       *  03150000
.*                                                                   *  03200000
.*    1. MF=(L,LISTNAME)                                             *  03250000
.*       THE LCSPL IS DEFINED WITH ALL BINARY FIELDS SET TO ZERO     *  03300000
.*       AND CHARACTER FIELDS SET TO BLANKS.  IF OTHER KEYWORDS      *  03350000
.*       ARE SUPPLIED, THEY ARE IGNORED.                             *  03400000
.*    2. MF=(M,LISTNAME)                                             *  03450000
.*       THE SET OF SPECIFIED KEYWORDS IS VALIDATED AS A PARTIAL     *  03500000
.*       SET.  MISSING KEYWORDS ARE IGNORED.                         *  03550000
.*    3. MF=(M,LISTNAME,COMPLETE)                                    *  03600000
.*       THE SET OF SPECIFIED KEYWORDS IS VALIDATED AS A COMPLETE    *  03650000
.*       SET.  A MISSING KEYWORD IS CONSIDERED TO BE AN ERROR.       *  03700000
.*       LCS EXTERNAL SERVICES IS NOT INVOKED.                       *  03750000
.*    4. MF=(E,LISTNAME)                                             *  03800000
.*       THE SET OF SPECIFIED KEYWORDS IS VALIDATED AS A PARTIAL     *  03850000
.*       SET.  MISSING KEYWORDS ARE IGNORED.  THE VALUES SUPPLIED    *  03900000
.*       WITH THE KEYWORDS ARE STORED IN THE LCSPL, AND LCS          *  03950000
.*       EXTERNAL SERVICES IS INVOKED.                               *  04000000
.*    5. MF=(E,LISTNAME,COMPLETE)                                    *  04050000
.*       THE SET OF SPECIFIED KEYWORDS IS VALIDATED AS A COMPLETE    *  04100000
.*       SET.  A MISSING KEYWORD IS CONSIDERED TO BE AN ERROR.       *  04150000
.*       THE VALUES SUPPLIED WITH THE KEYWORDS ARE STORED            *  04200000
.*       IN THE LCSPL, AND LCS EXTERNAL SERVICES IS INVOKED.         *  04250000
.*                                                                   *  04300000
.*  INVOCATION:                                                      *  04350000
.*                                                                   *  04400000
.*    REQUIRED KEYWORDS:                                             *  04450000
.*                                                                   *  04500000
.*        KEYWORD 'TYPE' MUST BE SPECIFIED AS TYPE=TAPE BEFORE       *  04550000
.*        LCS EXTERNAL SERVICES IS INVOKED.                          *  04600000
.*                                                                   *  04650000
.*        KEYWORD FUNC MUST BE SPECIFIED BY ONE OF THE FUNCTIONS     *  04700000
.*        LISTED BELOW BEFORE LCS EXTERNAL SERVICES IS INVOKED:      *  04750000
.*                                                                   *  04800000
.*        THE KEYWORD PARAMETERS BY FUNCTION:                        *  04850000
.*                                                                   *  04900000
.*        1. FUNC=CUA                                                *  04950000
.*                                                                   *  05000000
.*           USE=PRIVATE|SCRATCH (REQUIRED)                          *  05050000
.*             - PRIVATE SPECIFIES THAT THE VOLUME USE ATTRIBUTE     *  05100000
.*               IS TO BE SET TO PRIVATE.                            *  05150000
.*             - SCRATCH SPECIFIES THAT THE VOLUME USE ATTRIBUTE     *  05200000
.*               IS TO BE SET TO SCRATCH.                            *  05250000
.*                                                                   *  05300000
.*           VOLUME=VOLUME-SERIAL-NUMBER (REQUIRED)                  *  05350000
.*             NAME OF A CHARACTER VARIABLE OF LENGTH 6 WHICH        *  05400000
.*             CONTAINS THE VOLUME SERIAL NUMBER WHOSE USE           *  05450000
.*             ATTRIBUTE IS TO BE CHANGED.  THE VOLUME SERIAL        *  05500000
.*             MUST BE LEFT JUSTIFIED IN THE FIELD AND PADDED ON     *  05550000
.*             THE RIGHT WITH BLANKS IF NEEDED.                      *  05600000
.*                                                                   *  05650000
.*           DEVTYPE=DEVICE-TYPE (OPTIONAL IF USE=PRIVATE            *  05700000
.*                                IGNORED IF USE=SCRATCH)            *  05750000
.*             NAME OF A VARIALBE WHICH CONTAINS THE ADDRESS OF      *  05800000
.*             TAPE DEVICE SELECTION INFORMATIN (TDSI) TO BE         *  05850000
.*             ASSOCIATED WITH THE INPUT VOLUME.  TAPE DEVICE        *  05900000
.*             SELECTION INFORMATION IS MAPPED BY THE STRUCTURE      *  05950000
.*             CBRTDSI AND CONSISTS OF FOUR ONE-BYTE FIELDS WHICH    *  06000000
.*             SPECIFY RECORDING TECHNIQUE, MEDIA TYPE, COMPACTION   *  06050000
.*             TYPE, AND SPECIAL ATTRIBUTE TO BE ASSOCIATED WITH     *  06100000
.*             THE TAPE VOLUME.  ON A CHANGE TO PRIVATE, RECORDING   *  06150000
.*             TECHNIQUE, MEDIA TYPE, AND COMPACTION TYPE MAY BE     *  06200000
.*             SPECIFIED IN THE TDSI.                              @L1A 06250000
.*                                                                   *  06300000
.*           EXPDATE=VOLUME-EXPIRATION-DATE(OPTIONAL IF USE=PRIVATE  *  06350000
.*                                          IGNORED IF USE=SCRATCH)  *  06400000
.*             NAME OF A 4 BYTE VARIABLE WHICH CONTAINS THE          *  06450000
.*             EXPIRATION DATE, IN 'TIME DEC' MACRO FORMAT, OF       *  06500000
.*             THE DATASET WHICH IS BEING WRITTEN ON THE VOLUME.     *  06550000
.*                                                                   *  06600000
.*           GRPNAME=STORAGE-GROUP-NAME (OPTIONAL IF USE=PRIVATE     *  06650000
.*                                       IGNORED IF USE=SCRATCH)     *  06700000
.*             NAME OF A CHARACTER VARIABLE OF LENGTH 8 WHICH        *  06750000
.*             CONTAINS THE NAME OF THE SMS STORAGE GROUP TO WHICH   *  06800000
.*             THE VOLUME IS TO BE ASSIGNED.  IF NO STORAGE GROUP    *  06850000
.*             NAME IS SPECIFIED ON A CHANGE TO PRIVATE, THE FIELD   *  06900000
.*             DEFAULTS TO BLANKS.  THE STORAGE GROUP NAME MUST BE   *  06950000
.*             LEFT-JUSTIFIED IN THE FIELD AND PADDED ON THE RIGHT   *  07000000
.*             WITH BLANKS, OR IT MAY BE BLANKS.                     *  07050000
.*                                                                   *  07100000
.*           WRTPROT=WRITE-PROTECTION-STATUS(OPTIONAL IF USE=PRIVATE *  07150000
.*                                           IGNORED IF USE=SCRATCH) *  07200000
.*             THE NAME OF A ONE-BYTE CHARACTER FIELD WHICH          *  07250000
.*             CONTAINS 'Y' IF THE WRITE-PROTECT TAB ON THE 3480     *  07300000
.*             CARTRIDGE IS SET, 'N' IF THE TAB IS NOT SET, AND      *  07350000
.*             ' '(BLANK) IF THE TAB SETTING IS UNKNOWN.             *  07400000
.*                                                                   *  07450000
.*           WRTDATE=YES       (OPTIONAL IF USE=PRIVATE              *  07500000
.*                              IGNORED IF USE=SCRATCH )             *  07550000
.*             REQUESTS THAT THE DATE LAST WRITTEN AND DATE LAST     *  07600000
.*             MOUNTED BE SET TO TODAY'S DATE (AS RETURNED BY        *  07650000
.*             THE MVS 'TIME DEC' MACRO)                             *  07700000
.*                                                                   *  07750000
.*           EXITINFO=INSTALLATION-EXIT-INFORMATION   (OPTIONAL)     *  07800000
.*             THE NAME OF A 16-BYTE CHARACTER FIELD WHICH CONTAINS  *  07850000
.*             FREE-FORM INFORMATION TO BE PASSED TO THE CHANGE USE  *  07900000
.*             ATTRIBUTE INSTALLATION EXIT                         @D2A 07950000
.*                                                                   *  08000000
.*        2. FUNC=MCE                                                *  08050000
.*                                                                   *  08100000
.*           VOLLIST=VOLUME-LIST-POINTER          (REQUIRED)         *  08150000
.*             A VARIABLE CONTAINING THE ADDRESS OF THE LIST         *  08200000
.*             OF VOLUMES TO BE ENTERED INTO THE MANUAL TAPE         *  08250000
.*             LIBRARY, MAPPED BY LCSMLIST.  EACH ENTRY IN THE       *  08300000
.*             LIST MUST CONTAIN A 6-CHARACTER VOLUME SERIAL,        *  08350000
.*             LEFT JUSTIFIED AND PADDED ON THE RIGHT WITH BLANKS,   *  08400000
.*             2 BYTES PAD, AND A FULLWORD EACH FOR RETURN AND       *  08450000
.*             REASON CODES.                                         *  08500000
.*                                                                   *  08550000
.*           LIBNAME=LIBRARY-NAME                 (REQUIRED)         *  08600000
.*             NAME OF A CHARACTER FIELD OF LENGTH 8 WHICH CONTAINS  *  08650000
.*             THE LIBRARY NAME, LEFT JUSTIFIED IN THE FIELD AND     *  08700000
.*             PADDED ON THE RIGHT WITH BLANKS.                      *  08750000
.*                                                                   *  08800000
.*           EXITINFO=INSTALLATION-EXIT-INFORMATION   (OPTIONAL)     *  08850000
.*             THE NAME OF A 16-BYTE CHARACTER FIELD WHICH CONTAINS  *  08900000
.*             FREE-FORM INFORMATION TO BE PASSED TO THE CARTRIDGE   *  08950000
.*             ENTRY INSTALLATION EXIT                             @D2A 09000000
.*                                                                   *  09050000
.*        3. FUNC=EJECT                                            @D3A 09100000
.*                                                                   *  09150000
.*           VOLUME=VOLUME-SERIAL-NUMBER (REQUIRED)                  *  09200000
.*             NAME OF A CHARACTER VARIABLE OF LENGTH 6 WHICH        *  09250000
.*             CONTAINS THE VOLUME SERIAL NUMBER OF THE VOLUME       *  09300000
.*             TO BE EJECTED.  THE VOLUME SERIAL NUMBER MUST         *  09350000
.*             BE LEFT JUSTIFIED IN THE FIELD AND PADDED ON          *  09400000
.*             THE RIGHT WITH BLANKS IF NEEDED.                    @D3A 09450000
.*                                                                   *  09500000
.*           EJECTOPT=KEEP|PURGE   (OPTIONAL)                        *  09550000
.*             - KEEP SPECIFIES THAT THE VOLUME RECORD IN THE        *  09600000
.*               TCDB IS TO KEPT FOLLOWING A SUCCESSFUL              *  09650000
.*               EJECT.                                              *  09700000
.*             - PURGE SPECIFIES THAT THE VOLUME RECORD IN THE       *  09750000
.*               TCDB IS TO BE PURGED FOLLOWING A SUCCESSFUL         *  09800000
.*               EJECT.                                              *  09850000
.*             IF THIS PARAMETER IS NOT SPECIFIED, THE DEFAULT       *  09900000
.*             DEFINED FOR THE LIBRARY WILL BE USED.                 *  09950000
.*             THIS PARAMETER VALUE (OR THE DEFAULT) MAY BE          *  10000000
.*             OVERRIDDEN BY THE EJECT INSTALLATION EXIT.          @D3A 10050000
.*                                                                   *  10100000
.*           BULKEJCT=YES|NO (OPTIONAL)                              *  10150000
.*             - YES SPECIFIES THAT THE CARTRIDGE                    *  10200000
.*               IS PLACED IN THE BULK OUTPUT STATION OF THE         *  10250000
.*               AUTOMATED TAPE LIBRARY.                             *  10300000
.*             - NO SPECIFIES THAT THE CARTRIDGE IS PLACED           *  10350000
.*               IN THE CONVENIENCE OUTPUT STATION OF THE            *  10400000
.*               AUTOMATED TAPE LIBRARY.                             *  10450000
.*               THIS PARAMETER VALUE DEFAULTS TO NO.              @D3A 10500000
.*                                                                   *  10507100
.*           USERID=TSO-USERID                        (OPTIONAL)     *  10514200
.*             THE NAME OF AN 8-BYTE CHARACTER FIELD WHICH           *  10521300
.*             CONTAINS THE TSO USERID TO RECEIVE EJECT MESSAGES.    *  10528400
.*             USERID SHOULD BE LEFT-JUSTIFIED AND PADDED WITH       *  10535500
.*             BLANKS.                                             @L2A 10542600
.*                                                                   *  10550000
.*           EXITINFO=INSTALLATION-EXIT-INFORMATION   (OPTIONAL)     *  10600000
.*             THE NAME OF A 16-BYTE CHARACTER FIELD WHICH           *  10650000
.*             CONTAINS FREE-FORM INFORMATION PASSED TO THE          *  10700000
.*             CARTRIDGE EJECT INSTALLATION EXIT.                  @D3A 10750000
.*                                                                   *  10800000
.*        4. FUNC=QVR                                              @D1A 10850000
.*                                                                   *  10900000
.*           VOLUME=VOLUME-SERIAL-NUMBER          (REQUIRED)         *  10950000
.*             NAME OF A CHARACTER VARIABLE OF LENGTH 6 WHICH        *  11000000
.*             CONTAINS THE VOLUME SERIAL NUMBER WHOSE LIBRARY       *  11050000
.*             RESIDENCE IS TO BE DETERMINED.  THE VOLUME SERIAL     *  11100000
.*             MUST BE LEFT JUSTIFIED IN THE FIELD AND PADDED ON     *  11150000
.*             THE RIGHT WITH BLANKS IF NEEDED.                      *  11200000
.*                                                                   *  11250000
.*           LIBNAME=LIBRARY-NAME                 (OPTIONAL)       @L3A 11251100
.*             NAME OF A CHARACTER FIELD OF LENGTH 8 WHICH CONTAINS  *  11252200
.*             THE LIBRARY NAME, LEFT JUSTIFIED IN THE FIELD AND     *  11253300
.*             PADDED ON THE RIGHT WITH BLANKS.                      *  11254400
.*                                                                   *  11255500
.*           VOLINFO=(YES|NO)                     (OPTIONAL)       @D5A 11257100
.*             WHEN VOLINFO=YES, QVR RETURNS THE AVAILABLE INFORMA-  *  11264200
.*             TION ABOUT THE VOLUME SPECIFIED FROM BOTH THE VOLUME  *  11271300
.*             RECORD IN THE TCDB AND THE LIBRARY MANAGER INVENTORY. *  11278400
.*             THE TAPE VOLUME INFORMATION RETURNED IS MAPPED BY     *  11285500
.*             MACRO CBRTVI.  THE DEFAULT FOR VOLINFO IS NO.         *  11292600
.*                                                                   *  11293400
.*           TCDBCHK=(YES|NO)                     (OPTIONAL)       @L4A 11294200
.*                             IGNORED IF LIBNAME NOT SPECIFIED    @L4A 11295000
.*             WHEN TCDBCHK=YES OR THIS OPTION IS OMITTED, QVR       *  11295800
.*             ATTEMPTS TO RETRIEVE THE VOLUME RECORD FROM THE TCDB. *  11296600
.*             TCDBCHK=YES IS THE DEFAULT.                           *  11297400
.*             WHEN TCDBCHK=NO, QVR DOES NOT RETRIEVE THE VOLUME     *  11298200
.*             RECORD FROM THE TCDB.                                 *  11299000
.*                                                                   *  11300000
.*           SUBPOOL=SPNO                        (OPTIONAL)       @D5A  11302990
.*             WHEN VOLINFO=YES, SPNO SPECIFIES THE NAME OF AN 8-BIT *  11304000
.*             VARIABLE THAT CONTAINS THE NUMBER OF THE SUBPOOL FROM *  11306000
.*             WHICH STORAGE FOR THE TAPE VOLUME INFORMATION (TVI)   *  11308000
.*             IS TO BE OBTAINED.  IF NO SUBPOOL IS SPECIFIED,       *  11310000
.*             STORAGE IS OBTAINED FROM SUBPOOL 0 IN THE KEY OF THE  *  11312000
.*             CALLER.                                               *  11314000
.*                                                                   *  11316000
.*        5. FUNC=TVE                                              @D4A 11320000
.*                                                                   *  11322000
.*           VOLUME=VOLUME-SERIAL-NUMBER          (REQUIRED)         *  11324000
.*             NAME OF A CHARACTER VARIABLE OF LENGTH 6 WHICH        *  11326000
.*             CONTAINS THE VOLUME SERIAL NUMBER FOR WHICH MOUNT     *  11328000
.*             ELIGIBILITY ISTO BE DETERMINED.  THE VOLUME SERIAL    *  11330000
.*             MUST BE LEFT JUSTIFIED IN THE FIELD AND PADDED ON     *  11332000
.*             THE RIGHT WITH BLANKS IF NEEDED.                      *  11334000
.*                                                                   *  11336000
.*           UCBPTR=UCB-ADDRESS                   (REQUIRED)       @D4A 11338000
.*             NAME OF A POINTER VARIABLE WHICH CONTAINS THE ADDRESS *  11340000
.*             OF THE UCB FOR THE DEVICE WHICH IS TO BE TESTED       *  11342000
.*             FOR MOUNT CAPABILITY.                                 *  11344000
.*                                                                   *  11344200
.*        6. FUNC=IMPORT                                           @L3A 11344400
.*                                                                   *  11344600
.*           VOLUME=VOLUME-SERIAL-NUMBER          (REQUIRED)         *  11344800
.*             NAME OF A CHARACTER VARIABLE OF LENGTH 6 WHICH        *  11345000
.*             CONTAINS THE VOLUME SERIAL NUMBER TO BE USED AS THE   *  11345200
.*             IMPORT LIST VOLUME.  THE VOLUME SERIAL NUMBER         *  11345400
.*             MUST BE LEFT JUSTIFIED IN THE FIELD AND PADDED ON     *  11345600
.*             THE RIGHT WITH BLANKS IF NEEDED.                      *  11345800
.*                                                                   *  11346000
.*           CANCEL=YES|NO                        (OPTIONAL)       @L3A 11346200
.*             IF CANCEL IS OMITTED, CANCEL=NO IS THE DEFAULT.       *  11346400
.*             WHEN CANCEL=YES IS SPECIFIED, THE REQUEST IS TO       *  11346600
.*             CANCEL AN IMPORT OPERATION.                           *  11346800
.*                                                                   *  11347000
.*        7. FUNC=EXPORT                                           @L3A 11347200
.*                                                                   *  11347400
.*           VOLUME=VOLUME-SERIAL-NUMBER          (REQUIRED)         *  11347600
.*             NAME OF A CHARACTER VARIABLE OF LENGTH 6 WHICH        *  11347800
.*             CONTAINS THE VOLUME SERIAL NUMBER TO BE USED AS THE   *  11348000
.*             IMPORT LIST VOLUME.  THE VOLUME SERIAL NUMBER         *  11348200
.*             MUST BE LEFT JUSTIFIED IN THE FIELD AND PADDED ON     *  11348400
.*             THE RIGHT WITH BLANKS IF NEEDED.                      *  11348600
.*                                                                   *  11348800
.*           CANCEL=YES|NO                        (OPTIONAL)       @L3A 11349000
.*             IF CANCEL IS OMITTED, CANCEL=NO IS THE DEFAULT.       *  11349200
.*             WHEN CANCEL=YES IS SPECIFIED, THE REQUEST IS TO       *  11349400
.*             CANCEL AN EXPORT OPERATION.                           *  11349600
.*                                                                   *  11349800
.*        8. FUNC=PTPMC                                            @L5A 11349802
.*                                                                   *  11349804
.*           LIBNAME=LIBRARY-NAME                 (REQUIRED)         *  11349806
.*             NAME OF A CHARACTER VARIABLE OF LENGTH 8 WHICH        *  11349808
.*             CONTAINS THE PEER-TO-PEER VTS LIBRARY NAME.  THE      *  11349810
.*             LIBRARY NAME MUST BE LEFT JUSTIFIED IN THE FIELD      *  11349812
.*             AND PADDED ON THE RIGHT WITH BLANKS IF NEEDED.        *  11349814
.*                                                                   *  11349816
.*           AT LEAST ONE OF THE FOLLOWING OPTIONAL KEYWORDS       @L5A 11349818
.*           (IOLIB, COPYMODE, COPYOPER OR ACCESS) MUST BE SPECIFIED.*  11349820
.*                                                                   *  11349822
.*           IOLIB=PRIMARY|PREFERRED|BALANCED|DEFAULT   (OPTIONAL) @L5A 11349824
.*             SETS THE I/O SELECTION CRITERIA MODE IN A             *  11349826
.*             PEER-TO-PEER VTS LIBRARY.                             *  11349828
.*             PRIMARY INDICATES THAT HOST I/O IS TO GO TO THE       *  11349830
.*               DISTRIBUTED LIBRARY SPECIFIED WITH THE LIBNAME      *  11349832
.*               KEYWORD.                                            *  11349834
.*             PREFERRED INDICATES THAT THE DISTRIBUTED LIBRARY      *  11349836
.*               SPECIFIED WITH THE LIBNAME KEYWORD IS TO BE         *  11349838
.*               PREFERENCED FOR HOST I/O.                           *  11349840
.*             BALANCED INDICATES THAT HOST I/O SHOULD BE BALANCED   *  11349842
.*               ACROSS THE DISTRIBUTED LIBRARIES.                   *  11349844
.*             DEFAULT INDICATES THAT THE CE'S DEFAULT SETTING       *  11349846
.*               SHOULD BE USED.                                     *  11349848
.*                                                                   *  11349850
.*           COPYMODE=IMMEDIATE|DEFERRED|DEFAULT        (OPTIONAL) @L5A 11349852
.*             SETS THE COPY MODE IN THE PEER-TO-PEER VTS LIBRARY.   *  11349854
.*             IMMEDIATE INDICATES THAT COPIES ARE TO BE MADE        *  11349856
.*               UPON RECEIVING THE HOST REWIND/UNLOAD COMMAND.      *  11349858
.*             DEFERRED INDICATES THAT COPIES ARE TO BE QUEUED       *  11349860
.*               UPON RECEIVING THE HOST REWIND/UNLOAD COMMAND       *  11349862
.*               AND MADE AS WORKLOAD PERMITS.                       *  11349864
.*             DEFAULT INDICATES THAT THE CE'S DEFAULT SETTING       *  11349866
.*               FOR COPYMODE AND DEFERRED THRESHOLD SHOULD BE USED. *  11349868
.*                                                                   *  11349870
.*           DEFVALUE=DEFNO   (APPLICABLE WITH COPYMODE=DEFERRED)  @L5A 11349872
.*             DEFNO SPECIFIES THE NAME OF AN 8-BIT VARIABLE THAT    *  11349874
.*             CONTAINS THE NUMBER OF HOURS FOR THE DEFERRED MODE    *  11349876
.*             PRIORITY THRESHOLD VALUE IN A PEER-TO-PEER VTS        *  11349878
.*             LIBRARY.                                              *  11349880
.*             THIS SPECIFICATION IS IGNORED WITH ALL FUNC=PTPMC     *  11349882
.*             SPECFICATIONS EXCEPT COPYMODE=DEFERRED.               *  11349884
.*                                                                   *  11349886
.*           COPYOPER=ENABLE|DISABLE                  (OPTIONAL)   @L5A 11349888
.*             SETS THE COPY OPERATIONS MODE IN A PEER-TO-PEER VTS.  *  11349890
.*             ENABLE INDICATES THAT COPY OPERATIONS ARE TO BE       *  11349892
.*               PERFORMED.                                          *  11349894
.*             DISABLE INDICATES THAT NEW COPY OPERATIONS ARE TO     *  11349896
.*               BE QUEUED.                                          *  11349898
.*                                                                   *  11349900
.*           ACCESS=RWDISCON                          (OPTIONAL)   @L5A 11349902
.*             SETS THE SPECIAL ACCESS MODE IN A PEER-TO-PEER VTS.   *  11349904
.*             READ/WRITE DISCONNECTED MODE IS A SPECIAL MODE THAT   *  11349906
.*               CAN BE SET WHEN THE DISTRIBUTED LIBRARY SPECIFIED   *  11349908
.*               WITH THE LIBNAME KEYWORD IS THE ONLY FUNCTIONAL OR  *  11349910
.*               AVAILABLE VTS.  THIS MODE FORCES THE SPECIFIED VTS  *  11349912
.*               TO BECOME THE MASTER.  THIS MODE ALLOWS ACCESS TO   *  11349914
.*               CUSTOMER DATA EVEN IF THE VOLUME TOKENS CANNOT BE   *  11349916
.*               VALIDATED.                                          *  11349918
.*                                                                   *  11349920
.*        9. FUNC=PTPDATA                                          @L5A 11349922
.*                                                                   *  11349924
.*           LIBNAME=LIBRARY-NAME                 (REQUIRED)         *  11349926
.*             NAME OF A CHARACTER VARIABLE OF LENGTH 8 WHICH        *  11349928
.*             CONTAINS THE PEER-TO-PEER VTS COMPOSITE LIBRARY NAME. *  11349930
.*             THE LIBRARY NAME MUST BE LEFT JUSTIFIED IN THE FIELD  *  11349932
.*             AND PADDED ON THE RIGHT WITH BLANKS IF NEEDED.        *  11349934
.*                                                                   *  11349936
.*           DATATYPE=MODE|DEVICE                 (REQUIRED)       @L5A 11349938
.*             MODE SPECIFIES REQUEST TO RETURN PTP MODE SETTINGS    *  11349940
.*             DEVICE SPECIFIES REQUEST TO RETURN CURRENT USAGE OF   *  11349942
.*             EACH DEVICE IN THE PTP VTS.                           *  11349944
.*                                                                   *  11349946
.*           SUBPOOL=SPNO                         (OPTIONAL)       @L5A 11349948
.*             SPNO SPECIFIES THE NAME OF AN 8-BIT VARIABLE THAT     *  11349950
.*             CONTAINS THE NUMBER OF THE SUBPOOL FROM WHICH         *  11349952
.*             STORAGE FOR THE MODE OR DEVICE (TDI) INFORMATION      *  11349954
.*             IS TO BE OBTAINED.  IF NO SUBPOOL IS SPECIFIED,       *  11349956
.*             STORAGE IS OBTAINED FROM SUBPOOL 0 IN THE KEY OF THE  *  11349958
.*             CALLER.                                               *  11349960
.*                                                                   *  11349962
.*           LOC=BELOW|ANY                        (OPTIONAL)       @L5A 11349964
.*             BELOW SPECIFIES STORAGE IS TO BE OBTAINED BELOW THE   *  11349966
.*               16 MEGABYTE LINE.                                   *  11349968
.*             ANY SPECIFIES STORAGE MAY BE OBTAINED ABOVE THE       *  11349970
.*               16 MEGABYTE LINE.  IF LOC IS NOT SPECIFIED, ANY     *  11349972
.*               IS THE DEFAULT.                                     *  11349974
.*                                                                   *  11349976
.*  RETURN AND REASON CODES:                                         *  11350000
.*    FOLLOWING EXECUTION OF LCS EXTERNAL SERVICES, THE RETURN       *  11400000
.*    CODE IS STORED IN REGISTER 15 AND IN THE LCSPL IN FIELD        *  11450000
.*    LCSRCODE. THE REASON CODE IS STORED IN REGISTER 0 AND IN       *  11500000
.*    THE FIELD LCSREAS IN THE LCSPL.                                *  11550000
.*                                                                   *  11600000
.*    THE FOLLOWING RETURN CODES ARE DEFINED:                        *  11650000
.*                                                                   *  11700000
.*    CODE    CONDITION                                              *  11750000
.*     0      SUCCESSFUL COMPLETION OF THE REQUESTED FUNCTION.       *  11800000
.*            THE REASON CODE IS ALWAYS 0.                           *  11850000
.*     4      REQUEST COMPLETED WITH WARNING CONDITION.  THE         *  11900000
.*            REASON CODE IDENTIFIES THE WARNING.                    *  11950000
.*     8      PARAMETER ERROR.  THE REASON CODE IDENTIFIES THE       *  12000000
.*            INVALID PARAMETER.                                     *  12050000
.*    12      REQUEST FAILED.  THE REASON CODE IDENTIFIES THE        *  12100000
.*            SPECIFIC CAUSE OF FAILURE.                             *  12150000
.*    16      INVALID ENVIRONMENT. THE REASON CODE IDENTIFIES THE    *  12200000
.*            THE SPECIFIC ENVIRONMENTAL CONDITION.                  *  12250000
.*                                                                   *  12300000
.*    THE REASON CODES ARE DEFINED IN MAPPING MACRO CBRLCSPL.        *  12350000
.*                                                                   *  12400000
.*                                                                   *  12450000
.*  CONTROL BLOCKS:                                                  *  12500000
.*    CBRLCSPL - LCS EXTERNAL SERVICES PARAMETER LIST - LCSPL- R/W   *  12550000
.*                                                                   *  12600000
.*  CHANGE ACTIVITY:                                                 *  12650000
.*                                                                   *  12700000
.*    $L0=ATL,410,910830,TUCHLO: ATL SUPPORT                         *  12750000
.*    $D1=ATL,410,920120,TUCHLO: ADDED QUERY VOLUME RESIDENCE (QVR)  *  12800000
.*                               FUNCTION                          @D1A 12850000
.*    $D2=ATL,410,920224,TUCHLO: KBL0235:  ADDED EXITINFO KEYWORD TO *  12900000
.*                               ALLOW THE PROGRAM WHICH ISSUES THE  *  12950000
.*                               CBRXLCS MACRO TO PASS INFORMATION   *  13000000
.*                               TO THE CUA OR MCE INSTALLATION EXIT *  13050000
.*    $D3=ATL,410,920324,TUCMKB: KBP0002:  ADDED EJECT FUNCTION      *  13100000
.*                               TO ALLOW CARTRIDGE EJECT FROM       *  13150000
.*                               ANY TAPE LIBRARY.                 @D3A 13200000
.*    $L1=ATL2,410,920429,TUCHO: MIXED MEDIA/MIXED DEVICE SUPPORT    *  13250000
.*    $P1=ATL2,410,920618,TUCHLO: ATL2 IUT SUPPORT -- KBL0287        *  13300000
.*    $P2=ATL2,410,920928,TUCMKB: ATL2 SVT SUPPORT -- KAC0036        *  13350000
.*    $D4=ATL2,410,921204,TUCHLO: KBQ0024 -- ADD TVE FUNCTION        *  13358300
.*    $D5=ATL2,410,921204,TUCHLO: KBQ0025 -- ADD VOLINFO AND SUBPOOL *  13366600
.*                               KEYWORDS TO QVR FUNCTION            *  13374900
.*    $01=OY62822 140 930323 TUCLJT: AGO STATEMENT SPECIFIES     @01A*  13383200
.*                                   INCORRECT LABEL (500/5000)  @01A*  13391500
.*    $L2=BLYTHE  130 950929 TUCLJS: ADDED USERID KEYWORD FOR    @L2A*  13411000
.*                                   EJECT FUNCTION.             @L2A*  13430500
.*    $L3=VTSIXB  150 980730 TUCLJS: VTS IMPORT/EXPORT SUPPORT   @L3A*  13440200
.*    $L4=K160178 160 990601 TUCLJS: ADDED TCDBCHK KEYWORD FOR   @L4A*  13443400
.*                                   QVR FUNCTION.               @L4A*  13446600
.*    $L5=OW49900 1F0 001201 TUCLJS: ADDED PTPMC/PTPDATA SUPPORT @L5A*  13447600
.** END OF SPECIFICATIONS ********************************************  13450000
         LCLB  &TERM                        TERMINAL ERROR DETECTED     13500000
         LCLB  &LIST                        MF=L SPECIFIED              13550000
         LCLB  &MODIFY                      MF=M SPECIFIED              13600000
         LCLB  &EXECUTE                     MF=E SPECIFIED              13650000
         LCLB  &REGLIST                     PARMLIST NAME IN REG FORM   13700000
         LCLB  &FUNCVAL                     VALID FUNCTION SPECIFIED    13750000
         LCLB  &COMPLET                     MF=COMPLETE SPECIFIED       13800000
         LCLC  &PLNAME                      PARMLIST NAME FROM MF       13850000
         LCLC  &REG                         REGISTER NAME W/O PARENS    13900000
.*--------------------------------------------------------------------* 13950000
.*                                                                    * 14000000
.*       CHECK FOR POSITIONAL PARAMETERS                           @L1A 14050000
.*                                                                    * 14100000
.*--------------------------------------------------------------------* 14150000
         AIF   (N'&SYSLIST EQ 0).PP1000    NO POSITIONAL PARMS     @L1A 14200000
         MNOTE 12,'POSITIONAL PARAMETERS NOT ALLOWED'              @L1A 14250000
&TERM    SETB  1                                                   @L1A 14300000
.PP1000  ANOP                                                      @L1A 14350000
.*--------------------------------------------------------------------* 14400000
.*                                                                    * 14450000
.*       VALIDATE THE MF= KEYWORD                                     * 14500000
.*                                                                    * 14550000
.*--------------------------------------------------------------------* 14600000
         AIF   ('&MF' NE '').MF1000         GO IF MF SPECIFIED          14650000
         MNOTE 12,'MF KEYWORD REQUIRED'                                 14700000
&TERM    SETB  1                            SET TERMINATE FLAG          14750000
         AGO   .TYPE                        GO CHECK TYPE               14800000
.MF1000  ANOP  ,                                                        14850000
         AIF   ('&MF(1)' EQ 'L' OR                                     +14900000
               '&MF(1)' EQ 'M' OR                                      +14950000
               '&MF(1)' EQ 'E').MF2000      GO IF 1ST MF VALUE VALID    15000000
         MNOTE 12,'MF=&MF(1) INVALID'                                   15050000
&TERM    SETB  1                            SET TERMINATE FLAG          15100000
.MF2000  ANOP  ,                                                        15150000
         AIF   (N'&MF GT 1).MF3000          GO IF NO 2ND MF VALUE       15200000
         MNOTE 12,'MF PARAMETER LIST NAME OMITTED'                      15250000
&TERM    SETB  1                            SET TERMINATE FLAG          15300000
.MF3000  ANOP  ,                                                        15350000
         AIF   (N'&MF LT 3).MF4000         GO IF NO THIRD MF VALUE      15400000
         AIF   ('&MF(3)' EQ '' OR                                      +15450000
               '&MF(3)' EQ 'COMPLETE').MF4000  GO IF 3RD MF VALUE VALID 15500000
         MNOTE 12,'MF=&MF(3) INVALID'                                   15550000
&TERM    SETB  1                            SET TERMINATE FLAG          15600000
.MF4000  ANOP  ,                                                        15650000
         AIF   ('&MF(1)' NE 'L').MF6000     GO IF MF=L NOT SPECIFIED    15700000
         AIF   (N'&MF LE 2).MF5000          GO IF NO 3RD MF VALUE       15750000
         MNOTE 12,'TOO MANY VALUES SUPPLIED WITH MF=L'                  15800000
&TERM    SETB  1                            SET TERMINATE FLAG          15850000
.MF5000  ANOP  ,                                                        15900000
         AIF   (N'&MF LT 2).MF6000                                      15950000
         AIF   ('&MF(2)'(1,1) NE '(').MF7000  GO IF NOT REGISTER        16000000
         MNOTE 12,'REGISTER NOTATION INVALID WITH MF=L'                 16050000
&TERM    SETB  1                            SET TERMINATE FLAG          16100000
         AGO   .MF7000                      GO SET MF FLAGS             16150000
.MF6000  ANOP  ,                                                        16200000
         AIF   (N'&MF LE 3).MF7000          GO IF 3 OR FEWER MF VALUES  16250000
         MNOTE 12,'TOO MANY MF VALUES SUPPLIED'                         16300000
&TERM    SETB  1                            SET TERMINATE FLAG          16350000
.MF7000  ANOP  ,                                                        16400000
&LIST    SETB  ('&MF(1)' EQ 'L')            MF=L                        16450000
&MODIFY  SETB  ('&MF(1)' EQ 'M')            MF=M                        16500000
&EXECUTE SETB  ('&MF(1)' EQ 'E')            MF=E                        16550000
         AIF   (N'&MF LT 2).MF7500                                      16600000
&REGLIST SETB  ('&MF(2)'(1,1) EQ '(')       MF=(,(REG),)                16650000
&PLNAME  SETC  '&MF(2)'                     PARAMETER LIST NAME         16700000
.MF7500  ANOP                                                           16750000
         AIF   (N'&MF LT 3).LIST                                        16800000
&COMPLET SETB  ('&MF(3)' EQ 'COMPLETE')     MF=(,,COMPLETE)             16850000
.*--------------------------------------------------------------------* 16900000
.*                                                                    * 16950000
.*       GENERATE THE LIST FORM, IF REQUESTED                         * 17000000
.*                                                                    * 17050000
.*--------------------------------------------------------------------* 17100000
.LIST    ANOP  ,                                                        17150000
         AIF   (NOT &LIST).TYPE             GO IF MF=L NOT SPECIFIED    17200000
         AIF   ('&LABEL' EQ '').LIS1000     GO IF STMT LABEL NOT SPECD  17250000
         MNOTE 4,'STATEMENT LABEL &LABEL IGNORED ON LIST FORM'          17300000
.LIS1000 ANOP  ,                                                        17350000
         AIF   ('&FUNC' EQ '' AND                                      +17400000
               '&TYPE' EQ '' AND                                       +17450000
               '&ACCESS' EQ '' AND                                     +17457000
               '&COPYMODE' EQ '' AND                                   +17464000
               '&COPYOPER' EQ '' AND                                   +17471000
               '&DATATYPE' EQ '' AND                                   +17478000
               '&DEFVALUE' EQ '' AND                                   +17485000
               '&IOLIB' EQ '' AND                                      +17492000
               '&DEVTYPE' EQ '' AND                                    +17500000
               '&EXPDATE' EQ '' AND                                    +17550000
               '&VOLUME' EQ '' AND                                     +17600000
               '&USE' EQ '' AND                                        +17650000
               '&USERID' EQ '' AND                                     +17675000
               '&GRPNAME' EQ '' AND                                    +17700000
               '&LIBNAME' EQ '' AND                                    +17750000
               '&EXITINFO' EQ '' AND                                   +17800000
               '&VOLLIST' EQ '' AND                                    +17850000
               '&TCDBCHK' EQ '' AND                                    +17856200
               '&VOLINFO' EQ '' AND                                    +17862500
               '&UCBPTR' EQ '' AND                                     +17875000
               '&SUBPOOL' EQ '' AND                                    +17887500
               '&LOC' EQ '' AND                                        +17893500
               '&WRTDATE' EQ '' AND                                    +17900000
               '&EJECTOPT' EQ '' AND                                   +17950000
               '&BULKEJCT' EQ '' AND                                   +18000000
               '&CANCEL' EQ '' AND                                     +18033300
               '&WRTPROT' EQ '').LIS2000    GO IF NO OTHER KEYWORD @L5C 18076590
         MNOTE 4,'ALL KEYWORDS EXCEPT MF IGNORED ON LIST FORM'          18100000
.LIS2000 ANOP  ,                                                        18150000
         AIF   (NOT &TERM).LIS3000          GO IF NO TERMINAL ERROR     18200000
         MEXIT ,                                                        18250000
.LIS3000 ANOP  ,                                                        18300000
&PLNAME  DS    0F                      LCS EXTERNAL SERVICES PARM LIST  18350000
         DC    XL(LCSPOLEN)'00'        CLEAR STORAGE FOR OUTPUT AREA    18400000
         DC    XL(LCSPILEN)'00'        CLEAR STORAGE FOR INPUT AREA     18450000
         DC    XL(LCSPDLEN)'00'        CLEAR STORAGE FOR DIAGNOSTICS    18500000
         DC    XL(LCSPELEN)'00'        CLEAR STORAGE FOR EXPANSION AREA 18550000
         MEXIT ,                                                        18600000
.*--------------------------------------------------------------------* 18650000
.*                                                                    * 18700000
.*       VALIDATE THE TYPE= KEYWORD (REQUIRED FOR ALL FUNCTIONS)   @D1C 18750000
.*                                                                    * 18800000
.*--------------------------------------------------------------------* 18850000
.TYPE    ANOP  ,                                                        18900000
         AIF   ('&TYPE' NE '').TYPE100      GO IF TYPE SPECIFIED        18950000
         AIF   (NOT &COMPLET).FUNC                                      19000000
         MNOTE 12,'TYPE KEYWORD REQUIRED'                               19050000
&TERM    SETB  1                            SET TERMINATE FLAG          19100000
         AGO   .FUNC                                                    19150000
.TYPE100 ANOP                                                           19200000
         AIF   ('&TYPE' EQ 'TAPE').FUNC     GO IF TYPE IS CORRECT       19250000
         MNOTE 12,'TYPE=&TYPE INVALID'                                  19300000
&TERM    SETB  1                            SET TERMINATE FLAG          19350000
.*--------------------------------------------------------------------* 19400000
.*                                                                    * 19450000
.*       VALIDATE THE FUNC= KEYWORD (REQUIRED FOR ALL FUNCTIONS)   @D1C 19500000
.*                                                                    * 19550000
.*--------------------------------------------------------------------* 19600000
.FUNC    ANOP  ,                                                        19650000
         AIF   ('&FUNC' NE '').FUN1000      GO IF FUNC SPECIFIED        19700000
         AIF   (NOT &COMPLET).USE           GO IF NOT MF=COMPLETE       19750000
         MNOTE 12,'FUNC KEYWORD REQUIRED'                               19800000
&TERM    SETB  1                            SET TERMINATE FLAG          19850000
         AGO   .USE                         GO CHECK USE ATTRIBUTE      19900000
.FUN1000 ANOP  ,                                                        19950000
         AIF   ('&FUNC' EQ 'CUA' OR '&FUNC' EQ 'QVR' OR                +20000000
               '&FUNC' EQ 'EJECT' OR  '&FUNC' EQ 'TVE' OR              +20050000
               '&FUNC' EQ 'IMPORT' OR  '&FUNC' EQ 'EXPORT' OR          +20083300
               '&FUNC' EQ 'PTPMC' OR  '&FUNC' EQ 'PTPDATA' OR          +20126590
               '&FUNC' EQ 'MCE').FUN2000    GO IF FUNC IS VALID    @L5C 20136580
         MNOTE 12,'FUNC=&FUNC INVALID'                                  20150000
&TERM    SETB  1                            SET TERMINATE FLAG          20200000
         AGO   .USE                                                     20250000
.FUN2000 ANOP                                                           20300000
&FUNCVAL SETB  1                                                        20350000
.*--------------------------------------------------------------------* 20400000
.*                                                                    * 20450000
.*       VALIDATE THE USE= KEYWORD   (REQUIRED FOR FUNC=CUA)       @D3C 20529990
.*                                                                    * 20559980
.*--------------------------------------------------------------------* 20600000
.USE     ANOP  ,                                                        20650000
         AIF   ('&USE' NE '').USE1000      GO IF USE SPECIFIED          20700000
         AIF   ('&FUNC' NE 'CUA').VOLUME   GO IF FUNC NOT CUA           20750000
         AIF   (NOT &COMPLET).VOLUME       GO IF NO VALIDATION REQUIRED 20800000
         MNOTE 12,'USE KEYWORD REQUIRED WITH FUNC=&FUNC'                20850000
&TERM    SETB  1                           SET TERMINATE FLAG           20900000
         AGO   .VOLUME                     GO CHECK WRTDATE             20950000
.USE1000 ANOP  ,                                                        21000000
         AIF   ('&FUNC' EQ 'CUA').USE2000  GO IF FUNC=CUA          @D3C 21050000
         AIF   (NOT &FUNCVAL).USE2000                              @D3A 21100000
         MNOTE 12,'USE KEYWORD INVALID WITH FUNC=&FUNC'                 21150000
&TERM    SETB  1                           SET TERMINATE FLAG           21200000
         AGO  .VOLUME                                                   21250000
.USE2000 AIF   ('&USE' EQ 'PRIVATE' OR                                 +21300000
               '&USE' EQ 'SCRATCH').VOLUME   GO IF USE VALID            21350000
         MNOTE 12,'USE=&USE INVALID'                                    21400000
&TERM    SETB  1                            SET TERMINATE FLAG          21450000
.*--------------------------------------------------------------------* 21500000
.*                                                                    * 21550000
.*       VALIDATE VOLUME= KEYWORD  (REQUIRED FOR CUA, QVR          @D1C 21600000
.*                                  TVE AND EJECT)                 @D4C 21650000
.*                          (ALSO REQUIRED FOR IMPORT AND EXPORT)  @L3A 21700000
.*--------------------------------------------------------------------* 21750000
.VOLUME  ANOP  ,                                                        21800000
         AIF   ('&VOLUME' NE '').VOL100     GO IF VOLUME SPECIFIED      21850000
         AIF   ('&FUNC' NE 'CUA' AND                                   +21900000
               '&FUNC' NE 'QVR' AND                                    +21950000
               '&FUNC' NE 'TVE' AND                                    +21983300
               '&FUNC' NE 'IMPORT' AND                                 +21999900
               '&FUNC' NE 'EXPORT' AND                                 +22016500
               '&FUNC' NE 'EJECT').LIBNAME  GO IF VOLUME NOT REQRD @L3C 22033100
         AIF   (NOT &COMPLET).LIBNAME       GO IF COMPLETE NOT SPECFD   22050000
         MNOTE 12,'VOLUME KEYWORD REQUIRED WITH FUNC=&FUNC'             22100000
&TERM    SETB  1                            SET TERMINATE FLAG          22150000
         AGO   .LIBNAME                                                 22200000
.VOL100  ANOP                                                           22250000
         AIF   ('&FUNC' EQ 'CUA' OR                                    +22300000
               '&FUNC' EQ 'QVR' OR                                     +22350000
               '&FUNC' EQ 'TVE' OR                                     +22383300
               '&FUNC' EQ 'IMPORT' OR                                  +22399900
               '&FUNC' EQ 'EXPORT' OR                                  +22416500
               '&FUNC' EQ 'EJECT').LIBNAME  GO IF VOLUME NOT REQRD @L3C 22433100
         AIF   (NOT &FUNCVAL).LIBNAME                                   22450000
         MNOTE 12,'VOLUME KEYWORD INVALID WITH FUNC=&FUNC'              22500000
&TERM    SETB  1                            SET TERMINATE FLAG          22550000
.*--------------------------------------------------------------------* 22600000
.*                                                                    * 22650000
.*       VALIDATE LIBNAME= KEYWORD (REQUIRED FOR MCE, PTPMC AND       * 22709990
.*                                  PTPDATA FUNCTIONS)            @L5C* 22719980
.*                                 (OPTIONAL FOR QVR FUNCTION)    @L3A* 22750000
.*--------------------------------------------------------------------* 22800000
.LIBNAME ANOP  ,                                                        22850000
         AIF   ('&LIBNAME' NE '').LIBN100                               22900000
         AIF   ('&FUNC' NE 'MCE' AND                                   +22959990
                '&FUNC' NE 'PTPMC' AND                                 +22969980
                '&FUNC' NE 'PTPDATA').VOLLIST                      @L5C 22979970
         AIF   (NOT &COMPLET).VOLLIST       GO IF COMPLETE NOT SPECFD   23000000
         MNOTE 12,'LIBNAME KEYWORD REQUIRED WITH FUNC=&FUNC'            23050000
&TERM    SETB  1                            SET TERMINATE FLAG          23100000
         AGO   .VOLLIST                                                 23150000
.LIBN100 ANOP                                                           23200000
         AIF   ('&FUNC' EQ 'MCE' OR                                    +23233300
                '&FUNC' EQ 'PTPMC' OR                                  +23274590
                '&FUNC' EQ 'PTPDATA' OR                                +23282580
                '&FUNC' EQ 'QVR').VOLLIST   GO IF FUNC=QVR         @L5C 23290570
         AIF   (NOT &FUNCVAL).VOLLIST       GO IF NO VALID FUNC         23300000
         MNOTE 12,'LIBNAME KEYWORD INVALID WITH FUNC=&FUNC'             23350000
&TERM    SETB  1                            SET TERMINATE FLAG          23400000
.*--------------------------------------------------------------------* 23450000
.*                                                                    * 23500000
.*       VALIDATE VOLLIST= KEYWORD (REQUIRED FOR MCE FUNCTION)        * 23550000
.*                                                                    * 23600000
.*--------------------------------------------------------------------* 23650000
.VOLLIST ANOP  ,                                                        23700000
         AIF   ('&VOLLIST' NE '').VOLL100   GO IF VOLLIST SPECIFIED     23750000
         AIF   ('&FUNC' NE 'MCE').UCBPTR    GO IF FUNC NOT MCE     @D4C 23800000
         AIF   (NOT &COMPLET).UCBPTR        GO IF COMPLETE NOT SPECFD   23850000
         MNOTE 12,'VOLLIST KEYWORD REQUIRED WITH FUNC=&FUNC'            23900000
&TERM    SETB  1                            SET TERMINATE FLAG          23950000
         AGO   .UCBPTR                                             @D4C 24000000
.VOLL100 ANOP                                                           24050000
         AIF   ('&FUNC' EQ 'MCE').UCBPTR    GO IF FUNC=MCE         @D4C 24100000
         AIF   (NOT &FUNCVAL).UCBPTR        GO IF NO VALID FUNC SPECFD  24150000
         MNOTE 12,'VOLLIST KEYWORD INVALID WITH FUNC=&FUNC'             24200000
&TERM    SETB  1                            SET TERMINATE FLAG          24250000
.*--------------------------------------------------------------------* 24252700
.*                                                                    * 24255400
.*       VALIDATE UCBPTR= KEYWORD (REQUIRED FOR TVE FUNCTION)      @D4A 24258100
.*                                                                    * 24260800
.*--------------------------------------------------------------------* 24263500
.UCBPTR  ANOP  ,                                                   @D4A 24266200
         AIF   ('&UCBPTR' NE '').UCBP100    GO IF UCBPTR SPECIFIED @D4A 24268900
         AIF   ('&FUNC' NE 'TVE').DATATP0   GO IF FUNC NOT TVE     @L5C 24272590
         AIF   (NOT &COMPLET).DATATP0       GO IF COMPLETE NOT SPECFD   24273580
         MNOTE 12,'UCBPTR KEYWORD REQUIRED WITH FUNC=&FUNC'        @D4A 24277000
&TERM    SETB  1                            SET TERMINATE FLAG     @D4A 24279700
         AGO   .DATATP0                                            @L5C 24283390
.UCBP100 ANOP                                                      @D4A 24285100
         AIF   ('&FUNC' EQ 'TVE').DATATP0   GO IF FUNC=TVE         @L5C 24288790
         AIF   (NOT &FUNCVAL).DATATP0       GO IF NO VALID FUNC    @L5C 24289780
         MNOTE 12,'UCBPTR KEYWORD INVALID WITH FUNC=&FUNC'         @D4A 24293200
&TERM    SETB  1                            SET TERMINATE FLAG     @D4A 24295900
.*--------------------------------------------------------------------* 24296000
.*                                                                    * 24296100
.*       VALIDATE THE DATATYPE= KEYWORD                               * 24296200
.*                  (REQUIRED KEYWORD WITH FUNC=PTPDATA)           @L5A 24296300
.*                                                                    * 24296400
.*--------------------------------------------------------------------* 24296500
.DATATP0 ANOP  ,                                                        24296600
         AIF   ('&DATATYPE' NE '').DATAT10       GO IF DATATYPE    @L5A 24296700
         AIF   ('&FUNC' NE 'PTPDATA').WRTDATE    GO IF NOT PTPDATA @L5A 24296800
         AIF   (NOT &COMPLET).WRTDATE        GO IF COMPLETE NOT SPECFD  24296900
         MNOTE 12,'DATATYPE KEYWORD REQUIRED WITH FUNC=&FUNC'      @L5A 24297000
&TERM    SETB  1                            SET TERMINATE FLAG     @L5A 24297100
         AGO   .WRTDATE                                            @L5A 24297200
.DATAT10 ANOP                                                      @L5A 24297300
         AIF   ('&FUNC' EQ 'PTPDATA').DATAT20   GO IF FUNC PTPDATA @L5A 24297400
         AIF   (NOT &FUNCVAL).DATAT20           GO IF NOT VALID    @L5A 24297500
         MNOTE 12,'DATATYPE KEYWORD INVALID WITH FUNC=&FUNC'       @L5A 24297600
&TERM    SETB  1                            SET TERMINATE FLAG     @L5A 24297700
         AGO   .WRTDATE                                            @L5A 24297800
.DATAT20 AIF   ('&DATATYPE' EQ 'MODE' OR                               +24297900
                '&DATATYPE' EQ 'DEVICE').WRTDATE  GO IF VALID      @L5A 24298000
         MNOTE 12,'DATATYPE=&DATATYPE INVALID'                     @L5A 24298100
&TERM    SETB  1                            SET TERMINATE FLAG     @L5A 24298200
.*--------------------------------------------------------------------* 24300000
.*                                                                    * 24350000
.*       VALIDATE THE WRTDATE= KEYWORD     (OPTIONAL KEYWORD WITH     * 24400000
.*                                          FUNC=CUA,USE=PRIVATE)     * 24450000
.*--------------------------------------------------------------------* 24500000
.WRTDATE ANOP  ,                                                        24550000
         AIF   ('&WRTDATE' EQ '').DEVTYPE    GO IF WRTDATE OMITTED      24600000
         AIF   ('&FUNC' EQ 'CUA').WRTD100    GO TO CHECK DEVTYPE        24650000
         AIF   (NOT &FUNCVAL).WRTD100        SKIP ERROR IF INVALID FUNC 24700000
         MNOTE 12,'WRTDATE KEYWORD INVALID WITH FUNC=&FUNC'             24750000
&TERM    SETB  1                            SET TERMINATE FLAG          24800000
         AGO   .DEVTYPE                                                 24850000
.WRTD100 ANOP                                                           24900000
         AIF   ('&WRTDATE' EQ 'YES').DEVTYPE GO IF WRTDATE VALID        24950000
         MNOTE 12,'WRTDATE=&WRTDATE INVALID'                            25000000
&TERM    SETB  1                            SET TERMINATE FLAG          25050000
.*--------------------------------------------------------------------* 25100000
.*                                                                    * 25150000
.*       VALIDATE THE DEVTYPE= KEYWORD     (OPTIONAL KEYWORD WITH     * 25200000
.*                                          FUNC=CUA,USE=PRIVATE)     * 25250000
.*--------------------------------------------------------------------* 25300000
.DEVTYPE ANOP  ,                                                        25350000
         AIF   ('&DEVTYPE' EQ '').EXPDATE    GO IF DEVTYPE OMITTED      25400000
         AIF   ('&FUNC' EQ 'CUA').EXPDATE    GO TO CHECK WRTDATE        25450000
         AIF   (NOT &FUNCVAL).EXPDATE                                   25500000
         MNOTE 12,'DEVTYPE KEYWORD INVALID WITH FUNC=&FUNC'             25550000
&TERM    SETB  1                            SET TERMINATE FLAG          25600000
.*--------------------------------------------------------------------* 25650000
.*                                                                    * 25700000
.*       VALIDATE THE EXPDATE= KEYWORD     (OPTIONAL KEYWORD WITH     * 25750000
.*                                          FUNC=CUA,USE=PRIVATE)     * 25800000
.*--------------------------------------------------------------------* 25850000
.EXPDATE ANOP  ,                                                        25900000
         AIF   ('&EXPDATE' EQ '').GRPNAME    GO IF EXPDATE OMITTED      25950000
         AIF   ('&FUNC' EQ 'CUA').GRPNAME    GO TO CHECK EXPDATE        26000000
         AIF   (NOT &FUNCVAL).GRPNAME                                   26050000
         MNOTE 12,'EXPDATE KEYWORD INVALID WITH FUNC=&FUNC'             26100000
&TERM    SETB  1                            SET TERMINATE FLAG          26150000
.*--------------------------------------------------------------------* 26200000
.*                                                                    * 26250000
.*       VALIDATE THE GRPNAME= KEYWORD     (OPTIONAL KEYWORD WITH     * 26300000
.*                                          FUNC=CUA,USE=PRIVATE)     * 26350000
.*--------------------------------------------------------------------* 26400000
.GRPNAME ANOP  ,                                                        26450000
         AIF   ('&GRPNAME' EQ '').WRTPROT    GO IF GRPNAME OMITTED      26500000
         AIF   ('&FUNC' EQ 'CUA').WRTPROT    GO TO CHECK WRTPROT        26550000
         AIF   (NOT &FUNCVAL).WRTPROT                                   26600000
         MNOTE 12,'GRPNAME KEYWORD INVALID WITH FUNC=&FUNC'             26650000
&TERM    SETB  1                            SET TERMINATE FLAG          26700000
.*--------------------------------------------------------------------* 26750000
.*                                                                    * 26800000
.*       VALIDATE THE WRTPROT= KEYWORD     (OPTIONAL KEYWORD WITH     * 26850000
.*                                          FUNC=CUA,USE=PRIVATE)     * 26900000
.*--------------------------------------------------------------------* 26950000
.WRTPROT ANOP  ,                                                        27000000
         AIF   ('&WRTPROT' EQ '').EXITINF    GO IF WRTPROT OMITTED      27050000
         AIF   ('&FUNC' EQ 'CUA').EXITINF    GO IF FUNC=CUA             27100000
         AIF   (NOT &FUNCVAL).EXITINF                                   27150000
         MNOTE 12,'WRTPROT KEYWORD INVALID WITH FUNC=&FUNC'             27200000
&TERM    SETB  1                            SET TERMINATE FLAG          27250000
.*--------------------------------------------------------------------* 27300000
.*                                                                    * 27350000
.*       VALIDATE THE EXITINFO= KEYWORD    (OPTIONAL KEYWORD WITH     * 27400000
.*                                          FUNC=CUA OR FUNC=MCE   @D3C 27450000
.*                                          OR FUNC=EJECT)         @D3A 27500000
.*--------------------------------------------------------------------* 27550000
.EXITINF ANOP  ,                                                        27600000
         AIF   ('&EXITINFO' EQ '').USRID     GO IF NO EXITINFO     @L2C 27650000
         AIF   ('&FUNC' EQ 'CUA' OR                                    +27700000
               '&FUNC' EQ 'MCE' OR                                     +27750000
               '&FUNC' EQ 'EJECT').USRID     GO IF CUA-MCE-EJECT   @L2C 27800000
         AIF   (NOT &FUNCVAL).USRID                                @L2C 27850000
         MNOTE 12,'EXITINFO KEYWORD INVALID WITH FUNC=&FUNC'       @D2A 27900000
&TERM    SETB  1                            SET TERMINATE FLAG          27904100
.*--------------------------------------------------------------------* 27908200
.*                                                                    * 27912300
.*       VALIDATE THE USERID= KEYWORD    (OPTIONAL KEYWORD WITH       * 27916400
.*                                             FUNC=EJECT)         @L2A 27920500
.*--------------------------------------------------------------------* 27924600
.USRID   ANOP  ,                                                        27928700
         AIF   ('&USERID' EQ '').EJCTOPT     GO IF NO USERID       @L2A 27932800
         AIF   ('&FUNC' EQ 'EJECT').EJCTOPT  GO IF EJECT           @L2A 27936900
         AIF   (NOT &FUNCVAL).EJCTOPT                              @L2A 27941000
         MNOTE 12,'USERID KEYWORD INVALID WITH FUNC=&FUNC'         @L2A 27945100
&TERM    SETB  1                            SET TERMINATE FLAG          27950000
.*--------------------------------------------------------------------* 28000000
.*                                                                 @D3A 28050000
.*       VALIDATE THE EJECTOPT= KEYWORD    (OPTIONAL KEYWORD WITH     * 28100000
.*                                          FUNC=EJECT)               * 28150000
.*--------------------------------------------------------------------* 28200000
.EJCTOPT ANOP  ,                                                        28250000
         AIF   ('&EJECTOPT' EQ '').BULKEJT   GO IF NO EJECTOPT     @D3A 28300000
         AIF   ('&FUNC' EQ 'EJECT').EJOP100  GO TO CHECK EJOP100   @D3A 28350000
         AIF   (NOT &FUNCVAL).EJOP100                              @D3A 28400000
         MNOTE 12,'EJECTOPT KEYWORD INVALID WITH FUNC=&FUNC'       @D3A 28450000
&TERM    SETB  1                            SET TERMINATE FLAG     @D3A 28500000
         AGO   .BULKEJT                                            @D3A 28550000
.EJOP100 ANOP                                                      @D3A 28600000
         AIF   ('&EJECTOPT' EQ 'KEEP').BULKEJT  GO IF VALID        @D3A 28650000
         AIF   ('&EJECTOPT' EQ 'PURGE').BULKEJT GO IF VALID        @D3A 28700000
         MNOTE 12,'EJECTOPT=&EJECTOPT INVALID'                     @D3A 28750000
&TERM    SETB  1                            SET TERMINATE FLAG     @D3A 28800000
.*--------------------------------------------------------------------* 28850000
.*                                                                    * 28900000
.*       VALIDATE THE BULKEJECT= KEYWORD   (OPTIONAL KEYWORD WITH  @D3A 28950000
.*                                          FUNC=EJECT)               * 29000000
.*--------------------------------------------------------------------* 29050000
.BULKEJT ANOP  ,                                                        29100000
         AIF   ('&BULKEJCT' EQ '').VOLINFO   GO IF NO BULKEJCT     @D3A 29150000
         AIF   ('&FUNC' EQ 'EJECT').BULK100  GO IF FUNC=EJECT      @D3A 29200000
         AIF   (NOT &FUNCVAL).BULK100                              @D3A 29250000
         MNOTE 12,'BULKEJCT KEYWORD INVALID WITH FUNC=&FUNC'       @D3A 29300000
&TERM    SETB  1                            SET TERMINATE FLAG     @D3A 29350000
         AGO   .VOLINFO                                            @D3A 29400000
.BULK100 ANOP                                                      @D3A 29450000
         AIF   ('&BULKEJCT' EQ 'YES').VOLINFO GO IF VALID          @D3A 29500000
         AIF   ('&BULKEJCT' EQ 'NO').VOLINFO  GO IF VALID          @D3A 29550000
         MNOTE 12,'BULKEJCT=&BULKEJCT INVALID'                     @D3A 29600000
&TERM    SETB  1                            SET TERMINATE FLAG     @D3A 29650000
.*--------------------------------------------------------------------* 29651700
.*                                                                    * 29653400
.*       VALIDATE THE VOLINFO= KEYWORD     (OPTIONAL KEYWORD WITH  @D5A 29655100
.*                                          FUNC=QVR)                 * 29656800
.*--------------------------------------------------------------------* 29658500
.VOLINFO ANOP  ,                                                        29660200
         AIF   ('&VOLINFO' EQ '').TCDBCHK    GO IF VOLINFO OMITTED @L4C 29661900
         AIF   ('&FUNC' EQ 'QVR').VINF100    GO TO CHECK VOLINFO   @D5A 29663600
         AIF   (NOT &FUNCVAL).VINF100        SKIP ERROR IF INVALID FUNC 29665300
         MNOTE 12,'VOLINFO KEYWORD INVALID WITH FUNC=&FUNC'        @D5A 29667000
&TERM    SETB  1                            SET TERMINATE FLAG     @D5A 29668700
         AGO   .TCDBCHK                                            @L4C 29670400
.VINF100 ANOP                                                      @D5A 29672100
         AIF   ('&VOLINFO' EQ 'YES' OR '&VOLINFO' EQ 'NO').TCDBCHK @L4C 29673800
         MNOTE 12,'VOLINFO=&VOLINFO INVALID'                       @D5A 29675500
&TERM    SETB  1                            SET TERMINATE FLAG     @D5A 29677200
.*--------------------------------------------------------------------* 29677300
.*                                                                    * 29677400
.*       VALIDATE THE TCDBCHK= KEYWORD     (OPTIONAL KEYWORD WITH  @L4A 29677500
.*                                          FUNC=QVR)                 * 29677600
.*--------------------------------------------------------------------* 29677700
.TCDBCHK ANOP  ,                                                        29677800
         AIF   ('&TCDBCHK' EQ '').SUBPOOL    GO IF TCDBCHK OMITTED @L4A 29677900
         AIF   ('&FUNC' EQ 'QVR').VREC100    GO TO CHECK TCDBCHK   @L4A 29678000
         AIF   (NOT &FUNCVAL).VREC100        SKIP ERROR IF INVALID FUNC 29678100
         MNOTE 12,'TCDBCHK KEYWORD INVALID WITH FUNC=&FUNC'        @L4A 29678200
&TERM    SETB  1                            SET TERMINATE FLAG     @L4A 29678300
         AGO   .SUBPOOL                                            @L4A 29678400
.VREC100 ANOP                                                      @L4A 29678500
         AIF   ('&TCDBCHK' EQ 'YES' OR '&TCDBCHK' EQ 'NO').SUBPOOL      29678600
         MNOTE 12,'TCDBCHK=&TCDBCHK INVALID'                       @L4A 29678700
&TERM    SETB  1                            SET TERMINATE FLAG     @L4A 29678800
.*--------------------------------------------------------------------* 29678900
.*                                                                    * 29680600
.*       VALIDATE THE SUBPOOL= KEYWORD     (OPTIONAL KEYWORD WITH  @D5A 29682300
.*                                          FUNC=QVR)                 * 29684000
.*                  (OPTIONAL KEYWORD WITH FUNC=PTPDATA)           @L5A 29684800
.*--------------------------------------------------------------------* 29685700
.SUBPOOL ANOP  ,                                                        29687400
         AIF   ('&SUBPOOL' EQ '').SPLOC      GO IF SUBPOOL OMITTED @L5C 29690090
         AIF   ('&FUNC' EQ 'QVR' OR                                    +29691080
                '&FUNC' EQ 'PTPDATA').SPLOC                        @L5C 29692070
         AIF   (NOT &FUNCVAL).SPLOC          SKIP IF INVALID FUNC  @L5C 29693060
         MNOTE 12,'SUBPOOL KEYWORD INVALID WITH FUNC=&FUNC'        @D5A 29694200
&TERM    SETB  1                            SET TERMINATE FLAG     @D5A 29695900
.*--------------------------------------------------------------------* 29695901
.*                                                                    * 29695902
.*       VALIDATE THE LOC=     KEYWORD                             @L5A 29695903
.*                  (OPTIONAL KEYWORD WITH FUNC=PTPDATA)           @L5A 29695904
.*--------------------------------------------------------------------* 29695905
.SPLOC   ANOP  ,                                                   @L5A 29695906
         AIF   ('&LOC' EQ '').IOLIB0             GO IF LOC OMITTED @L5A 29695907
         AIF   ('&FUNC' EQ 'PTPDATA').SPLOC0                       @L5A 29695908
         AIF   (NOT &FUNCVAL).SPLOC0         SKIP IF INVALID FUNC  @L5A 29695909
         MNOTE 12,'LOC KEYWORD INVALID WITH FUNC=&FUNC'            @L5A 29695910
         AGO   .IOLIB0                                             @L5A 29695911
.SPLOC0  ANOP                                                      @L5A 29695912
         AIF   ('&LOC' EQ 'BELOW').IOLIB0    GO IF VALID           @L5A 29695913
         AIF   ('&LOC' EQ 'ANY').IOLIB0      GO IF VALID           @L5A 29695914
         MNOTE 12,'LOC=&LOC INVALID'                               @L5A 29695915
&TERM    SETB  1                            SET TERMINATE FLAG     @L5A 29695916
.*--------------------------------------------------------------------* 29695917
.*                                                                    * 29695918
.*       VALIDATE THE IOLIB= KEYWORD                                  * 29695919
.*                  (OPTIONAL KEYWORD WITH FUNC=PTPMC)             @L5A 29695920
.*                                                                    * 29695921
.*--------------------------------------------------------------------* 29695922
.IOLIB0  ANOP  ,                                                        29695923
         AIF   ('&IOLIB' EQ '').CPYMODE        GO IF IOLIB OMITTED @L5A 29695924
         AIF   ('&FUNC' EQ 'PTPMC').IOLIB10                        @L5A 29695925
         AIF   (NOT &FUNCVAL).IOLIB10        SKIP IF INVALID FUNC  @L5A 29695926
         MNOTE 12,'IOLIB KEYWORD INVALID WITH FUNC=&FUNC'          @L5A 29695927
&TERM    SETB  1                            SET TERMINATE FLAG     @L5A 29695928
         AGO   .CPYMODE                                            @L5A 29695929
.IOLIB10 ANOP                                                      @L5A 29695930
         AIF   ('&IOLIB' EQ 'PRIMARY').CPYMODE   GO IF VALID       @L5A 29695931
         AIF   ('&IOLIB' EQ 'PREFERRED').CPYMODE GO IF VALID       @L5A 29695932
         AIF   ('&IOLIB' EQ 'BALANCED').CPYMODE  GO IF VALID       @L5A 29695933
         AIF   ('&IOLIB' EQ 'DEFAULT').CPYMODE   GO IF VALID       @L5A 29695934
         MNOTE 12,'IOLIB=&IOLIB INVALID'                           @L5A 29695935
&TERM    SETB  1                            SET TERMINATE FLAG     @L5A 29695936
.*--------------------------------------------------------------------* 29695937
.*                                                                    * 29695938
.*       VALIDATE THE COPYMODE= KEYWORD                               * 29695939
.*                  (OPTIONAL KEYWORD WITH FUNC=PTPMC)             @L5A 29695940
.*                                                                    * 29695941
.*--------------------------------------------------------------------* 29695942
.CPYMODE ANOP  ,                                                        29695943
         AIF   ('&COPYMODE' EQ '').DEFVALU       GO IF NO COPYMODE @L5A 29695944
         AIF   ('&FUNC' EQ 'PTPMC').CPYMD10                        @L5A 29695945
         AIF   (NOT &FUNCVAL).CPYMD10        SKIP IF INVALID FUNC  @L5A 29695946
         MNOTE 12,'COPYMODE KEYWORD INVALID WITH FUNC=&FUNC'       @L5A 29695947
&TERM    SETB  1                            SET TERMINATE FLAG     @L5A 29695948
         AGO   .DEFVALU                                            @L5A 29695949
.CPYMD10 ANOP                                                      @L5A 29695950
         AIF   ('&COPYMODE' EQ 'IMMEDIATE').DEFVALU   GO IF VALID  @L5A 29695951
         AIF   ('&COPYMODE' EQ 'DEFERRED').DEFVALU    GO IF VALID  @L5A 29695952
         AIF   ('&COPYMODE' EQ 'DEFAULT').DEFVALU     GO IF VALID  @L5A 29695953
         MNOTE 12,'COPYMODE=&COPYMODE INVALID'                     @L5A 29695954
&TERM    SETB  1                            SET TERMINATE FLAG     @L5A 29695955
.*--------------------------------------------------------------------* 29695956
.*                                                                    * 29695957
.*       VALIDATE THE DEFVALUE= KEYWORD                               * 29695958
.*         (OPTIONAL KEYWORD WITH FUNC=PTPMC)                      @L5A 29695959
.*         (APPLICABLE WITH COPYMODE=DEFERRED, OTHERWISE IGNORED)  @L5A 29695960
.*                                                                    * 29695961
.*--------------------------------------------------------------------* 29695962
.DEFVALU ANOP  ,                                                        29695963
         AIF   ('&DEFVALUE' EQ '').CPYOPER   GO IF NO DEFVALUE     @L5A 29695964
         AIF   ('&FUNC' EQ 'PTPMC').CPYOPER                        @L5A 29695965
         AIF   (NOT &FUNCVAL).CPYOPER        SKIP IF INVALID FUNC  @L5A 29695966
         MNOTE 12,'DEFVALUE KEYWORD INVALID WITH FUNC=&FUNC'       @L5A 29695967
&TERM    SETB  1                            SET TERMINATE FLAG     @L5A 29695968
.*--------------------------------------------------------------------* 29695969
.*                                                                    * 29695970
.*       VALIDATE THE COPYOPER= KEYWORD                               * 29695971
.*                  (OPTIONAL KEYWORD WITH FUNC=PTPMC)             @L5A 29695972
.*                                                                    * 29695973
.*--------------------------------------------------------------------* 29695974
.CPYOPER ANOP  ,                                                        29695975
         AIF   ('&COPYOPER' EQ '').ACCESS        GO IF NO COPYOPER @L5A 29695976
         AIF   ('&FUNC' EQ 'PTPMC').CPYOP10                        @L5A 29695977
         AIF   (NOT &FUNCVAL).CPYOP10        SKIP IF INVALID FUNC  @L5A 29695978
         MNOTE 12,'COPYOPER KEYWORD INVALID WITH FUNC=&FUNC'       @L5A 29695979
&TERM    SETB  1                            SET TERMINATE FLAG     @L5A 29695980
         AGO   .ACCESS                                             @L5A 29695981
.CPYOP10 ANOP                                                      @L5A 29695982
         AIF   ('&COPYOPER' EQ 'ENABLE').ACCESS       GO IF VALID  @L5A 29695983
         AIF   ('&COPYOPER' EQ 'DISABLE').ACCESS      GO IF VALID  @L5A 29695984
         MNOTE 12,'COPYOPER=&COPYOPER INVALID'                     @L5A 29695985
&TERM    SETB  1                            SET TERMINATE FLAG     @L5A 29695986
.*--------------------------------------------------------------------* 29695987
.*                                                                    * 29695988
.*       VALIDATE THE ACCESS=   KEYWORD                               * 29695989
.*                  (OPTIONAL KEYWORD WITH FUNC=PTPMC)             @L5A 29695990
.*                                                                    * 29695991
.*--------------------------------------------------------------------* 29695992
.ACCESS  ANOP  ,                                                        29695993
         AIF   ('&ACCESS' EQ '').PTPMC0          GO IF NO ACCESS   @L5A 29695994
         AIF   ('&FUNC' EQ 'PTPMC').ACCESS0                        @L5A 29695995
         AIF   (NOT &FUNCVAL).ACCESS0        SKIP IF INVALID FUNC  @L5A 29695996
         MNOTE 12,'ACCESS KEYWORD INVALID WITH FUNC=&FUNC'         @L5A 29695997
&TERM    SETB  1                            SET TERMINATE FLAG     @L5A 29695998
         AGO   .PTPMC0                                             @L5A 29695999
.ACCESS0 ANOP                                                      @L5A 29696000
         AIF   ('&ACCESS' EQ 'RWDISCON').PTPMC0       GO IF VALID  @L5A 29696001
         MNOTE 12,'ACCESS=&ACCESS INVALID'                         @L5A 29696002
&TERM    SETB  1                            SET TERMINATE FLAG     @L5A 29696003
.*--------------------------------------------------------------------* 29696004
.*                                                                    * 29696005
.*       VALIDATE THAT AT LEAST ONE OF THE OPTIONAL KEYWORDS       @L5A 29696006
.*          IOLIB, COPYMODE, COPYOPER, ACCESS                      @L5A 29696007
.*       WAS SPECIFIED WITH FUNC=PTPMC                             @L5A 29696008
.*                                                                    * 29696009
.*--------------------------------------------------------------------* 29696010
.PTPMC0  ANOP  ,                                                        29696011
         AIF   ('&FUNC' NE 'PTPMC').CANCELO                        @L5A 29696012
         AIF   ('&COPYOPER' NE '' OR                                   +29696013
                '&COPYMODE' NE '' OR                                   +29696014
                '&ACCESS' NE '' OR                                     +29696015
                '&IOLIB' NE '').CANCELO                            @L5A 29696016
         AIF   (NOT &COMPLET).CANCELO                              @L5A 29696017
         MNOTE 12,'OPTIONAL KEYWORD MISSING WITH FUNC=&FUNC'       @L5A 29696018
&TERM    SETB  1                            SET TERMINATE FLAG     @L5A 29696019
.*--------------------------------------------------------------------* 29696100
.*                                                                    * 29696300
.*       VALIDATE THE CANCEL= KEYWORD      (OPTIONAL KEYWORD WITH  @L3A 29696500
.*                                          FUNC=IMPORT AND EXPORT)   * 29696700
.*--------------------------------------------------------------------* 29696900
.CANCELO ANOP  ,                                                        29697100
         AIF   ('&CANCEL' EQ '').TESTTRM     GO IF CANCEL OMITTED  @L3A 29697300
         AIF   ('&FUNC' EQ 'IMPORT' OR                                 +29697500
                '&FUNC' EQ 'EXPORT').CANC100 GO IF CORRECT FUNC    @L3A 29697700
         AIF   (NOT &FUNCVAL).CANC100        SKIP ERROR IF INVALID FUNC 29697900
         MNOTE 12,'CANCEL KEYWORD INVALID WITH FUNC=&FUNC'         @L3A 29698100
&TERM    SETB  1                            SET TERMINATE FLAG     @L3A 29698300
         AGO   .TESTTRM                                            @L3A 29698500
.CANC100 ANOP                                                      @L3A 29698700
         AIF   ('&CANCEL' EQ 'YES' OR '&CANCEL' EQ 'NO').TESTTRM   @L3A 29698900
         MNOTE 12,'CANCEL=&CANCEL INVALID'                         @L3A 29699100
&TERM    SETB  1                            SET TERMINATE FLAG     @L3A 29699300
.*--------------------------------------------------------------------* 29700000
.*                                                                    * 29750000
.*       VALIDITY CHECKING COMPLETE.  CHECK FOR TERMINAL ERROR.       * 29800000
.*                                                                    * 29850000
.*--------------------------------------------------------------------* 29900000
.TESTTRM ANOP  ,                                                        29950000
         AIF   ('&LABEL' EQ '').TES1000     GO IF STMT LABEL OMITTED    30000000
&LABEL   DC    0H'0'                                                    30050000
.TES1000 ANOP  ,                                                        30100000
         AIF   (NOT &TERM).TES2000          GO IF NO TERMINAL ERROR     30150000
         MEXIT ,                                                        30200000
.TES2000 ANOP  ,                                                        30250000
         AIF   (NOT &MODIFY OR                                         +30300000
               '&ACCESS' NE '' OR                                      +30307000
               '&COPYOPER' NE '' OR                                    +30314000
               '&COPYMODE' NE '' OR                                    +30321000
               '&DATATYPE' NE '' OR                                    +30328000
               '&DEFVALUE' NE '' OR                                    +30335000
               '&IOLIB' NE '' OR                                       +30342000
               '&DEVTYPE' NE '' OR                                     +30350000
               '&EXITINFO' NE '' OR                                    +30400000
               '&EJECTOPT' NE '' OR                                    +30450000
               '&BULKEJCT' NE '' OR                                    +30500000
               '&CANCEL' NE '' OR                                      +30525000
               '&EXPDATE' NE '' OR                                     +30550000
               '&FUNC' NE '' OR                                        +30600000
               '&GRPNAME' NE '' OR                                     +30650000
               '&LIBNAME' NE '' OR                                     +30700000
               '&SUBPOOL' NE '' OR                                     +30725000
               '&LOC' NE '' OR                                         +30731000
               '&TCDBCHK' NE '' OR                                     +30737500
               '&TYPE' NE '' OR                                        +30750000
               '&UCBPTR' NE '' OR                                      +30775000
               '&USE' NE '' OR                                         +30800000
               '&USERID' NE '' OR                                      +30825000
               '&VOLUME' NE '' OR                                      +30850000
               '&VOLLIST' NE '' OR                                     +30900000
               '&VOLINFO' NE '' OR                                     +30925000
               '&WRTDATE' NE '' OR                                     +30950000
               '&WRTPROT' NE '').GENERAT   GO IF NOT MF=M OR AT LEAST   31000000
.*                                         ONE KEYWORD SPECIFIED   @L5C 31069990
         MNOTE 4,'NO KEYWORDS SUPPLIED, NO CODE GENERATED'              31100000
         MEXIT ,                                                        31150000
.*--------------------------------------------------------------------* 31200000
.*                                                                    * 31250000
.*       GENERATE THE EXECUTABLE CODE FOR MF=M AND MF=E               * 31300000
.*                                                                    * 31350000
.*--------------------------------------------------------------------* 31400000
.GENERAT ANOP  ,                                                        31450000
         AIF   (&REGLIST).GEN0200           GO IF REGISTER NOTATION     31500000
         LA    1,&PLNAME                    PARAMETER LIST ADDRESS      31550000
         AGO   .GEN0400                                                 31600000
.GEN0200 ANOP  ,                                                        31650000
&REG     SETC  '&PLNAME'(2,K'&PLNAME-2)                                 31700000
         AIF   ('&REG' EQ '1' OR                                       +31750000
               '&REG' EQ 'R1').GEN0400      GO IF REGISTER 1 SPECIFIED  31800000
         LR    1,&REG                       PARAMETER LIST ADDRESS      31850000
.*--------------------------------------------------------------------* 31900000
.*       SET UP FUNCTION                                              * 31950000
.*--------------------------------------------------------------------* 32000000
.GEN0400 ANOP  ,                                                        32050000
         AIF   ('&FUNC' EQ '').GEN2000      GO IF FUNC OMITTED          32100000
         OI    LCSFLG1-LCSPL(1),LCS_FUNC    SET FUNCTION KEYWORD FLAG   32150000
         AIF   ('&FUNC' NE 'CUA').GEN0600   GO IF NOT FUNC=CUA          32200000
         MVI   LCSFUNC-LCSPL(1),LCSCUA      SET CUA FUNCTION            32250000
         AGO   .GEN2000                                                 32300000
.GEN0600 ANOP  ,                                                        32350000
         AIF   ('&FUNC' NE 'MCE').GEN0605   GO IF NOT FUNC=MCE     @D4C 32400000
         MVI   LCSFUNC-LCSPL(1),LCSMCE      SET MCE FUNCTION            32450000
         AGO   .GEN2000                                            @D1A 32500000
.GEN0605 ANOP  ,                                                        32510000
         AIF   ('&FUNC' NE 'TVE').GEN0610   GO IF NOT FUNC=TVE     @D4A 32520000
         MVI   LCSFUNC-LCSPL(1),LCSTVE      SET TVE FUNCTION            32530000
         AGO   .GEN2000                                            @D4A 32540000
.GEN0610 ANOP  ,                                                   @D1A 32550000
         AIF   ('&FUNC' NE 'QVR').GEN0620   GO IF NOT FUNC=QVR     @D3A 32600000
         MVI   LCSFUNC-LCSPL(1),LCSQVR      SET QVR FUNCTION            32650000
         AGO   .GEN2000                                            @D3A 32700000
.GEN0620 ANOP  ,                                                   @L3A 32710000
         AIF   ('&FUNC' NE 'IMPORT').GEN0630  GO IF NOT IMPORT     @L3A 32720000
         MVI   LCSFUNC-LCSPL(1),LCSIMPRT    SET IMPORT FUNCTION    @L3A 32730000
         AGO   .GEN2000                                            @L3A 32740000
.GEN0630 ANOP  ,                                                   @L3A 32750000
         AIF   ('&FUNC' NE 'EXPORT').GEN0640  GO IF NOT EXPORT     @L3A 32760000
         MVI   LCSFUNC-LCSPL(1),LCSEXPRT    SET EXPORT FUNCTION    @L3A 32770000
         AGO   .GEN2000                                            @L3A 32780000
.GEN0640 ANOP  ,                                                   @L5A 32790990
         AIF   ('&FUNC' NE 'PTPMC').GEN0650   GO IF NOT PTPMC      @L5A 32791980
         MVI   LCSFUNC-LCSPL(1),LCSPTPMC    SET PTPMC FUNCTION     @L5A 32792970
         AGO   .GEN2000                                            @L5A 32793960
.GEN0650 ANOP  ,                                                   @L3A 32794950
         AIF   ('&FUNC' NE 'PTPDATA').GEN0660   GO IF NOT PTPDATA  @L5A 32795940
         MVI   LCSFUNC-LCSPL(1),LCSPTPDT    SET PTPDATA FUNCTION   @L5A 32796930
         AGO   .GEN2000                                            @L5A 32797920
.GEN0660 ANOP  ,                                                   @L5C 32798910
         MVI   LCSFUNC-LCSPL(1),LCSEJECT    SET EJECT FUNCTION          32800000
.*--------------------------------------------------------------------* 32850000
.*       SET UP TYPE                                                  * 32900000
.*--------------------------------------------------------------------* 32950000
.GEN2000 ANOP  ,                                                        33000000
         AIF   ('&TYPE'  EQ '').GEN2400     GO IF TYPE OMITTED          33050000
         OI    LCSFLG1-LCSPL(1),LCS_TYPE    SET TYPE KEYWORD FLAG       33100000
         MVI   LCSTYPE-LCSPL(1),LCSTAPE     SET TYPE VALUE              33150000
.*--------------------------------------------------------------------* 33200000
.*       SET UP VOLUME                                                * 33250000
.*--------------------------------------------------------------------* 33300000
.GEN2400 ANOP  ,                                                        33350000
         AIF   ('&VOLUME' EQ '').GEN2800    GO IF VOLUME OMITTED        33400000
         OI    LCSFLG1-LCSPL(1),LCS_VOLUME  SET VOLUME KEYWORD FLAG     33450000
         AIF   ('&VOLUME'(1,1) EQ '(').GEN2600  GO IF REG NOTATION      33500000
         MVC   LCSVOLSR-LCSPL(,1),&VOLUME   SET VOLUME VALUE            33550000
         AGO   .GEN2800                                                 33600000
.GEN2600 ANOP  ,                                                        33650000
&REG     SETC  '&VOLUME'(2,K'&VOLUME-2)                                 33700000
         MVC   LCSVOLSR-LCSPL(,1),0(&REG)   SET VOLUME VALUE            33750000
.*--------------------------------------------------------------------* 33800000
.*       SET UP USE                                                   * 33850000
.*--------------------------------------------------------------------* 33900000
.GEN2800 ANOP  ,                                                        33950000
         AIF   ('&USE' EQ '').GEN3200        GO IF USE OMITTED          34000000
         OI    LCSFLG1-LCSPL(1),LCS_USE     SET USE KEYWORD FLAG        34050000
         AIF   ('&USE' EQ 'PRIVATE').GEN2900                            34100000
         MVI   LCSUSE-LCSPL(1),LCSSCR       SET USE=SCRATCH             34150000
         AGO   .GEN3200                                                 34200000
.GEN2900 MVI   LCSUSE-LCSPL(1),LCSPRIV      SET USE=PRIVATE             34250000
.*--------------------------------------------------------------------* 34300000
.*       SET UP DEVTYPE                                               * 34350000
.*--------------------------------------------------------------------* 34400000
.GEN3200 ANOP  ,                                                        34450000
         AIF   ('&DEVTYPE' EQ '').GEN3600   GO IF DEVICE TYPE OMITTED   34500000
         OI    LCSFLG2-LCSPL(1),LCS_DEVTYPE SET DEVTYPE KEYWORD FLAG    34550000
         AIF   ('&DEVTYPE'(1,1) EQ '(').GEN3400  GO IF REG NOTATION     34600000
         MVC   LCSDVTYP-LCSPL(,1),&DEVTYPE  SET DEVTYPE VALUE           34650000
         AGO   .GEN3600                                                 34700000
.GEN3400 ANOP  ,                                                        34750000
&REG     SETC  '&DEVTYPE'(2,K'&DEVTYPE-2)                               34800000
         ST    &REG,LCSDVTYP-LCSPL(,1)      SET DEVTYPE VALUE     @D5C  34850000
.*--------------------------------------------------------------------* 34900000
.*       SET UP GRPNAME                                               * 34950000
.*--------------------------------------------------------------------* 35000000
.GEN3600 ANOP  ,                                                        35050000
         AIF   ('&GRPNAME' EQ '').GEN4000   GO IF GRPNAME OMITTED       35100000
         OI    LCSFLG2-LCSPL(1),LCS_GRPNAME SET GRPNAME KEYWORD FLAG    35150000
         AIF   ('&GRPNAME'(1,1) EQ '(').GEN3800  GO IF REG NOTATION     35200000
         MVC   LCSTRGRP-LCSPL(,1),&GRPNAME  SET STORAGE GROUP NAME      35250000
         AGO   .GEN4000                                                 35300000
.GEN3800 ANOP  ,                                                        35350000
&REG     SETC  '&GRPNAME'(2,K'&GRPNAME-2)                               35400000
         MVC   LCSTRGRP-LCSPL(,1),0(&REG)   SET STORAGE GROUP NAME      35450000
.*--------------------------------------------------------------------* 35500000
.*       SET UP EXPDATE                                               * 35550000
.*--------------------------------------------------------------------* 35600000
.GEN4000 ANOP  ,                                                        35650000
         AIF   ('&EXPDATE' EQ '').GEN4400   GO IF EXPDATE OMITTED       35700000
         OI    LCSFLG2-LCSPL(1),LCS_EXPDATE SET EXPDATE KEYWORD FLAG    35750000
         AIF   ('&EXPDATE'(1,1) EQ '(').GEN4200  GO IF REG NOTATION     35800000
         MVC   LCSEXPDT-LCSPL(,1),&EXPDATE  SET EXPDATE                 35850000
         AGO   .GEN4400                                                 35900000
.GEN4200 ANOP  ,                                                        35950000
&REG     SETC  '&EXPDATE'(2,K'&EXPDATE-2)                               36000000
         MVC   LCSEXPDT-LCSPL(,1),0(&REG)   SET EXPDATE VALUE           36050000
.*--------------------------------------------------------------------* 36100000
.*       SET UP WRTPROT                                               * 36150000
.*--------------------------------------------------------------------* 36200000
.GEN4400 ANOP  ,                                                        36250000
         AIF   ('&WRTPROT' EQ '').GEN4800   GO IF WRTPROT OMITTED       36300000
         OI    LCSFLG2-LCSPL(1),LCS_WRTPROT SET WRTPROT KEYWORD FLAG    36350000
         AIF   ('&WRTPROT'(1,1) EQ '(').GEN4600  GO IF REG NOTATION     36400000
         MVC   LCSWRTPR-LCSPL(,1),&WRTPROT  SET WRTPROT VALUE           36450000
         AGO   .GEN4800                                                 36500000
.GEN4600 ANOP  ,                                                        36550000
&REG     SETC  '&WRTPROT'(2,K'&WRTPROT-2)                               36600000
         MVC   LCSWRTPR-LCSPL(,1),0(&REG)   SET WRTPROT VALUE           36650000
.*--------------------------------------------------------------------* 36700000
.*       SET UP WRTDATE                                               * 36750000
.*--------------------------------------------------------------------* 36800000
.GEN4800 ANOP  ,                                                        36850000
         AIF   ('&WRTDATE' EQ '').GEN4850   GO IF WRTDATE OMITTED  @L3C 36900000
         OI    LCSFLG2-LCSPL(1),LCS_WRTDATE SET WRTDATE KEYWORD FLAG    36950000
.*--------------------------------------------------------------------* 36956200
.*       SET UP CANCEL                                             @L3A 36962400
.*--------------------------------------------------------------------* 36968600
.GEN4850 ANOP  ,                                                   @L3A 36974800
         AIF   ('&CANCEL' EQ '').GEN4900   GO IF CANCEL OMITTED    @L3A 36981000
         AIF   ('&CANCEL' EQ 'NO').GEN4900 GO IF CANCEL=NO         @L3A 36987200
         OI    LCSFLG3-LCSPL(1),LCS_CANCEL SET CANCEL KEYWORD FLAG @L3A 36993400
.*--------------------------------------------------------------------* 37000000
.*       SET UP EXITINFO                                           @D2A 37050000
.*--------------------------------------------------------------------* 37100000
.GEN4900 ANOP  ,                                                   @D2A 37150000
         AIF   ('&EXITINFO' EQ '').GEN4975  GO IF EXITINFO OMITTED @L2C 37200000
         OI    LCSFLG3-LCSPL(1),LCS_EXITINFO SET EXITINFO KEYWORD FLAG  37250000
         AIF   ('&EXITINFO'(1,1) EQ '(').GEN4950  GO IF REG NOTATION    37275000
         MVC   LCSEXITI-LCSPL(,1),&EXITINFO  SET EXITINFO VALUE         37300000
         AGO   .GEN4975                                            @L2C 37310000
.GEN4950 ANOP  ,                                                   @D5A 37320000
&REG     SETC  '&EXITINFO'(2,K'&EXITINFO-2)                        @D5A 37330000
         MVC   LCSEXITI-LCSPL(,1),0(&REG)    SET EXITINFO               37340000
.*--------------------------------------------------------------------* 37340700
.*       SET UP USERID                                             @L2A 37341400
.*--------------------------------------------------------------------* 37342100
.GEN4975 ANOP  ,                                                   @L2A 37342800
         AIF   ('&USERID' EQ '').GEN5000    GO IF USERID OMITTED   @L2A 37343500
         OI    LCSFLG3-LCSPL(1),LCS_USERID  SET USERID KEYWORD FLG @L2A 37344200
         AIF   ('&USERID'(1,1) EQ '(').GEN4980  GO IF REG NOTATION @L2A 37344900
         MVC   LCSUSERID-LCSPL(,1),&USERID  SET USERID VALUE       @L2A 37345600
         AGO   .GEN5000                                            @L2A 37346300
.GEN4980 ANOP  ,                                                   @L2A 37347000
&REG     SETC  '&USERID'(2,K'&USERID-2)                            @L2A 37347700
         MVC   LCSUSERID-LCSPL(,1),0(&REG)  SET USERID             @L2A 37348400
.*--------------------------------------------------------------------* 37350000
.*       SET UP EJECTOPT                                           @D3A 37400000
.*--------------------------------------------------------------------* 37450000
.GEN5000 ANOP  ,                                                   @D3A 37500000
         AIF   ('&EJECTOPT' EQ '').GEN5100  GO IF EJECTOPT OMITTED @D3A 37550000
         OI    LCSFLG3-LCSPL(1),LCS_EJECTOPT SET EJECTOPT KEYWORD FLAG  37600000
         AIF   ('&EJECTOPT' EQ 'PURGE').GEN5050                    @D3A 37650000
         MVI   LCSEJOPT-LCSPL(1),LCSKEEP    SET EJECTOPT=KEEP           37700000
         AGO   .GEN5100                                            @D3A 37750000
.GEN5050 MVI   LCSEJOPT-LCSPL(1),LCSPURGE   SET EJECTOPT=PURGE     @P2C 37800000
.*--------------------------------------------------------------------* 37850000
.*       SET UP BULKEJCT                                           @D3A 37900000
.*--------------------------------------------------------------------* 37950000
.GEN5100 ANOP  ,                                                   @D3A 38000000
         AIF   ('&BULKEJCT' EQ '').GEN5180  GO IF BULKEJCT OMITTED @D5C 38050000
         OI    LCSFLG3-LCSPL(1),LCS_BULKEJCT SET BULKEJCT KEYWORD FLAG  38100000
         AIF   ('&BULKEJCT' EQ 'YES').GEN5150                      @D3A 38150000
         MVI   LCSBULK-LCSPL(1),LCSBLNO     SET LCSBULK=NO              38200000
         AGO   .GEN5180                                            @D5C 38250000
.GEN5150 MVI   LCSBULK-LCSPL(1),LCSBLYES    SET LCSBULK=YES        @P1C 38300000
.*--------------------------------------------------------------------* 38302500
.*       SET UP VOLINFO                                            @D5A 38305000
.*--------------------------------------------------------------------* 38307500
.GEN5180 ANOP  ,                                                   @D5A 38310000
         AIF   ('&VOLINFO' EQ '').GEN5200   GO IF VOLINFO OMITTED  @L5C 38313490
         AIF   ('&VOLINFO' EQ 'NO').GEN5200                        @D5A 38315000
         OI    LCSFLG3-LCSPL(1),LCS_VOLINFO SET VOLINFO KEYWORD FLAG    38317500
.*--------------------------------------------------------------------* 38320000
.*       SET UP SUBPOOL (FOR VOLINFO OR PTPDATA)                   @L5C 38323490
.*--------------------------------------------------------------------* 38325000
.GEN5200 ANOP  ,                                                   @D5A 38327500
         AIF   ('&SUBPOOL' EQ '').GEN5275   GO IF SUBPOOL OMITTED  @L5C 38330990
         OI    LCSFLG1-LCSPL(1),LCS_SPNUM   SET SUBPOOL KEYWORD FLAG    38332500
         AIF   ('&SUBPOOL'(1,1) EQ '(').GEN5250 GO IF REG NOTATION @D5A 38335000
         MVC   LCSSPNUM-LCSPL(,1),&SUBPOOL  SET SUBPOOL VALUE           38337500
         AGO   .GEN5275                                            @L5C 38340990
.GEN5250 ANOP                                                      @D5A 38342500
&REG     SETC  '&SUBPOOL'(2,K'&SUBPOOL-2)                          @D5A 38345000
         MVC   LCSSPNUM-LCSPL(,1),0(&REG)   SET SUBPOOL VALUE           38347500
.*--------------------------------------------------------------------* 38347700
.*       SET UP LOC (FOR PTPDATA)                                  @L5A 38347900
.*--------------------------------------------------------------------* 38348100
.GEN5275 ANOP  ,                                                   @L5A 38348300
         AIF   ('&LOC' EQ '').GEN5300       GO IF LOC OMITTED      @L5A 38348500
         OI    LCSFLG4-LCSPL(1),LCS_SPLOC   SET LOC KEYWORD FLAG   @L5A 38348700
         AIF   ('&LOC' EQ 'BELOW').GEN5280  GO IF BELOW SPEC'D     @L5A 38348900
         MVI   LCSSPLOC-LCSPL(1),LCSANY     SET LOC VALUE          @L5A 38349100
         AGO   .GEN5300                                            @L5A 38349300
.GEN5280 ANOP                                                      @L5A 38349500
         MVI   LCSSPLOC-LCSPL(1),LCSBELOW   SET LOC VALUE          @L5A 38349700
.*--------------------------------------------------------------------* 38350000
.*       SET UP LIBNAME                                               * 38400000
.*--------------------------------------------------------------------* 38450000
.GEN5300 ANOP  ,                                                        38500000
         AIF   ('&LIBNAME' EQ '').GEN5400   GO IF LIBNAME OMITTED       38550000
         OI    LCSFLG2-LCSPL(1),LCS_LIBNAME SET LIBNAME KEYWORD FLAG    38600000
         AIF   ('&LIBNAME'(1,1) EQ '(').GEN5350  GO IF REG NOTATN  @D5C 38650000
         MVC   LCSLBNM-LCSPL(,1),&LIBNAME   SET LIBNAME VALUE           38700000
         AGO   .GEN5375                                            @L4C 38750000
.GEN5350 ANOP  ,                                                   @D5C 38800000
&REG     SETC  '&LIBNAME'(2,K'&LIBNAME-2)                               38850000
         MVC   LCSLBNM-LCSPL(,1),0(&REG)    SET LIBRARY NAME            38900000
.*--------------------------------------------------------------------* 38950000
.*       SET UP TCDBCHK (IF LIBNAME SPECIFIED)                     @L4A 38956200
.*--------------------------------------------------------------------* 38962400
.GEN5375 ANOP  ,                                                   @L4A 38968600
         AIF   ('&TCDBCHK' EQ '').GEN5400    GO IF TCDBCHK OMITTED @L4A 38974800
         AIF   ('&TCDBCHK' EQ 'YES').GEN5400                       @L4A 38981000
         OI    LCSFLG4-LCSPL(1),LCS_NOTCDBCK  SET TCDBCHK KEYWORD FLAG  38987200
.*--------------------------------------------------------------------* 38993400
.*       SET UP VOLLIST                                               * 39000000
.*--------------------------------------------------------------------* 39050000
.GEN5400 ANOP  ,                                                        39100000
         AIF   ('&VOLLIST' EQ '').GEN5500   GO IF VOLLIST OMITTED  @L5C 39169990
         OI    LCSFLG1-LCSPL(1),LCS_VOLIST  SET VOLLIST KEYWRD FLG @P2C 39200000
         AIF   ('&VOLLIST'(1,1) EQ '(').GEN5450  GO IF REG NOTATN  @L5C 39269990
         MVC   LCSVOL@-LCSPL(,1),&VOLLIST   SET VOLLIST ADDRESS         39300000
         AGO   .GEN5500                                            @L5C 39379990
.GEN5450 ANOP  ,                                                   @L5C 39409980
&REG     SETC  '&VOLLIST'(2,K'&VOLLIST-2)                               39450000
         ST    &REG,LCSVOL@-LCSPL(,1)        SET VOLLIST VALUE          39500000
.*--------------------------------------------------------------------* 39500050
.*       SET UP IOLIB                                              @L5A 39500100
.*--------------------------------------------------------------------* 39500150
.GEN5500 ANOP  ,                                                   @L5A 39500200
         AIF   ('&IOLIB' EQ '').GEN5600     GO IF IOLIB OMITTED    @L5A 39500250
         OI    LCSFLG4-LCSPL(1),LCS_IOLIB   SET IOLIB KEYWORD FLAG @L5A 39500300
         AIF   ('&IOLIB' EQ 'PRIMARY').GEN5510  GO SET PRIMARY     @L5A 39500350
         AIF   ('&IOLIB' EQ 'PREFERRED').GEN5520  GO SET PREFERRED @L5A 39500400
         AIF   ('&IOLIB' EQ 'BALANCED').GEN5530   GO SET BALANCED  @L5A 39500450
         MVI   LCSIOLIB-LCSPL(1),LCSIODFT   SET IOLIB=DEFAULT           39500500
         AGO   .GEN5600                                            @L5A 39500550
.GEN5510 MVI   LCSIOLIB-LCSPL(1),LCSPRIM    SET IOLIB=PRIMARY      @L5A 39500600
         AGO   .GEN5600                                            @L5A 39500650
.GEN5520 MVI   LCSIOLIB-LCSPL(1),LCSPREFD   SET IOLIB=PREFERRED    @L5A 39500700
         AGO   .GEN5600                                            @L5A 39500750
.GEN5530 MVI   LCSIOLIB-LCSPL(1),LCSBALCD   SET IOLIB=BALANCED     @L5A 39500800
.*--------------------------------------------------------------------* 39500850
.*       SET UP COPYMODE                                           @L5A 39500900
.*--------------------------------------------------------------------* 39500950
.GEN5600 ANOP  ,                                                   @L5A 39501000
         AIF   ('&COPYMODE' EQ '').GEN5625  GO IF COPYMODE OMITTED @L5A 39501050
         OI    LCSFLG4-LCSPL(1),LCS_COPYMODE  SET COPYMODE KEY FLG @L5A 39501100
         AIF   ('&COPYMODE' EQ 'IMMEDIATE').GEN5610 GOTO IMMEDIATE @L5A 39501150
         AIF   ('&COPYMODE' EQ 'DEFERRED').GEN5620  GOTO DEFERRED  @L5A 39501200
         MVI   LCSCPYMD-LCSPL(1),LCSCPYDF   SET COPYMODE=DEFAULT   @L5A 39501250
         AGO   .GEN5625                                            @L5A 39501300
.GEN5610 MVI   LCSCPYMD-LCSPL(1),LCSIMMED   SET COPYMODE=IMMEDIATE @L5A 39501350
         AGO   .GEN5625                                            @L5A 39501400
.GEN5620 MVI   LCSCPYMD-LCSPL(1),LCSDFERD   SET COPYMODE=DEFERRED  @L5A 39501450
.*--------------------------------------------------------------------* 39501500
.*       SET UP DEFVALUE                                           @L5A 39501550
.*--------------------------------------------------------------------* 39501600
.GEN5625 ANOP  ,                                                   @L5A 39501650
         AIF   ('&DEFVALUE' EQ '').GEN5700  GO IF DEFVALUE OMITTED @L5A 39501700
         OI    LCSFLG4-LCSPL(1),LCS_DEFTHRSH  SET DEFVALUE KEY FLG @L5A 39501750
         AIF   ('&DEFVALUE'(1,1) EQ '(').GEN5635 GO IF REG NOTATN  @L5A 39501800
         MVC   LCSDPTHV-LCSPL(,1),&DEFVALUE SET DEFVALUE HOURS     @L5A 39501850
         AGO   .GEN5700                     GO TO NEXT KEYWORD     @L5C 39501900
.GEN5635 ANOP  ,                            DEFVALUE REG NOTATION  @L5A 39501950
&REG     SETC  '&DEFVALUE'(2,K'&DEFVALUE-2)                        @L5A 39502000
         MVC   LCSDPTHV-LCSPL(,1),0(&REG)   SET DEFVALUE IN LCSPL  @L5A 39502050
.*--------------------------------------------------------------------* 39502100
.*       SET UP COPYOPER                                           @L5A 39502150
.*--------------------------------------------------------------------* 39502200
.GEN5700 ANOP  ,                                                   @L5A 39502250
         AIF   ('&COPYOPER' EQ '').GEN5800  GO IF COPYOPER OMITTED @L5A 39502300
         OI    LCSFLG4-LCSPL(1),LCS_COPYOPER  SET COPYOPER KEY FLG @L5A 39502350
         AIF   ('&COPYOPER' EQ 'ENABLE').GEN5710  GO SET ENABLE    @L5A 39502400
         MVI   LCSCPYOP-LCSPL(1),LCSDSABL   SET COPYOPER=DISABLE   @L5A 39502450
         AGO   .GEN5800                                            @L5A 39502500
.GEN5710 MVI   LCSCPYOP-LCSPL(1),LCSENABL   SET COPYOPER=ENABLE    @L5A 39502550
.*--------------------------------------------------------------------* 39502600
.*       SET UP ACCESS                                             @L5A 39502650
.*--------------------------------------------------------------------* 39502700
.GEN5800 ANOP  ,                                                   @L5A 39502750
         AIF   ('&ACCESS' EQ '').GEN5900    GO IF ACCESS OMITTED   @L5A 39502800
         OI    LCSFLG4-LCSPL(1),LCS_ACCESS  SET ACCESS KEY FLAG    @L5A 39502850
         MVI   LCSACCES-LCSPL(1),LCSRWDIS   SET ACCESS=RWDISCON    @L5A 39502900
.*--------------------------------------------------------------------* 39502950
.*       SET UP DATATYPE                                           @L5A 39503000
.*--------------------------------------------------------------------* 39503050
.GEN5900 ANOP  ,                                                   @L5A 39503100
         AIF   ('&DATATYPE' EQ '').GEN6000  GO IF DATATYPE OMITTED @L5A 39503150
         OI    LCSFLG4-LCSPL(1),LCS_DATATYPE  SET DATATYPE KEY FLG @L5A 39503200
         AIF   ('&DATATYPE' EQ 'DEVICE').GEN5910  GO SET DEVICE    @L5A 39503250
         MVI   LCSDATAT-LCSPL(1),LCSMODE    SET DATATYPE=MODE      @L5A 39503300
         AGO   .GEN6000                                            @L5A 39503350
.GEN5910 MVI   LCSDATAT-LCSPL(1),LCSDEVIC   SET DATATYPE=DEVICE    @L5A 39503400
.*--------------------------------------------------------------------* 39503800
.*       SET UP UCBPTR                                             @D4A 39507600
.*--------------------------------------------------------------------* 39511400
.GEN6000 ANOP  ,                                                        39515200
         AIF   ('&UCBPTR' EQ '').GEN6800    GO IF UCBPTR OMITTED   @D4A 39519000
         OI    LCSFLG1-LCSPL(1),LCS_UCBPTR  SET UCBPTR KEYWORD FLG      39522800
         AIF   ('&UCBPTR'(1,1) EQ '(').GEN6100  GO IF REG NOTATION @D4A 39526600
         MVC   LCSUCB@-LCSPL(,1),&UCBPTR    SET UCBPTR ADDRESS          39530400
         AGO   .GEN6800                                            @D4A 39534200
.GEN6100 ANOP  ,                                                   @D4A 39538000
&REG     SETC  '&UCBPTR'(2,K'&UCBPTR-2)                            @D4A 39541800
         ST    &REG,LCSUCB@-LCSPL(,1)       SET UCBPTR VALUE            39545600
.GEN6800 ANOP  ,                                                        39550000
         AIF   (&EXECUTE).LINKAGE           GO IF MF=E SPECIFIED        39600000
         MEXIT ,                                                        39650000
.*--------------------------------------------------------------------* 39700000
.*                                                                    * 39750000
.*     GENERATE THE LINKAGE TO LCS EXTERNAL SERVICES FOR MF=E         * 39800000
.*                                                                    * 39850000
.*--------------------------------------------------------------------* 39900000
.LINKAGE ANOP  ,                                                        39950000
         L     15,16(,0)                    FIND                        40000000
         L     15,1216(,15)                 ENTRY POINT                 40050000
         L     15,44(,15)                   FOR                         40100000
         L     15,192(,15)                  LCS EXTERNAL SERVICES       40150000
         BASSM 14,15                        INVOKE LCS EXTERNAL SVCS    40200000
         MEND  ,                                                     */ 40250000
*/********************************************************************/ 40300000
*/*                                                                  */ 40350000
*/*      PLX FORM OF CBRXLCS MACRO                                   */ 40419990
*/*      NOTE: PTPDATA AND PTPMC KEYWORDS ARE ASSEMBLER ONLY.    @L5A*/ 40439980
*/*        (IOLIB,COPYMODE,COPYOPER,DEFVALUE,ACCESS,DATATYPE,LOC)    */ 40459970
*/********************************************************************/ 40500000
*%CBRXLCS:  MACRO KEYS( BULKEJCT,                                       40550000
*                       CANCEL,                                         40575000
*                       DEVTYPE,                                        40600000
*                       DISP,                                           40650000
*                       EJECTOPT,                                       40700000
*                       EXITINFO,                                       40750000
*                       EXPDATE,                                        40800000
*                       FUNC,                                           40850000
*                       GRPNAME,                                        40900000
*                       LIBID,                                          40950000
*                       LIBNAME,                                        41000000
*                       SGLIST,                                         41050000
*                       SGSTATE,                                        41100000
*                       SUBPOOL,                                        41150000
*                       TCDBCHK,                                        41175000
*                       TYPE,                                           41200000
*                       UCBPTR,                                         41250000
*                       USE,                                            41300000
*                       USERID,                                         41325000
*                       VOLLIST,                                        41350000
*                       VOLUME,                                         41400000
*                       VOLINFO,                                        41425000
*                       WRTDATE,                                        41450000
*                       WRTPROT,                                        41500000
*                       VOLERRST,                                       41550000
*                       MF );                                /*@L4C*/   41600000
*ANS('?'||MACLABEL||'CBRXLCSP '||MACLIST||MACKEYS||';') RESCAN;         41650000
*%END CBRXLCS;                                                          41700000
