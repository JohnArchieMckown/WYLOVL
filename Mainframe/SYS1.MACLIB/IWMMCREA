*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWMMCREA                              -09/05/96-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Create delay monitoring environment           * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00001200
*     5645-001 (C) COPYRIGHT IBM CORP. 1993, 1997                     * 00001300
*                                                                     * 00001400
* STATUS= HBB6603                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*                                                                     * 00001800
*01* FUNCTION:                                                        * 00001900
*                                                                     * 00002000
*                                                                     * 00002100
*      The purpose of this service is to create a single delay        * 00002200
*      monitoring environment or a number of delay monitoring         * 00002300
*      environments so that work and resource managers may utilize    * 00002400
*      other delay monitoring services to reflect to MVS the          * 00002500
*      execution states and delays associated with work requests.     * 00002600
*                                                                     * 00002700
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00002800
*                                                                     * 00002900
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003000
*                                                                     * 00003100
*01* ENVIRONMENT:                                                     * 00003200
*                                                                     * 00003300
*                                                                     * 00003400
*      Dispatchable unit mode: Task mode.                             * 00003500
*                                                                     * 00003600
*      Minimum authorization: Supervisor state or program key mask    * 00003700
*                        (PKM) allowing keys 0-7.                     * 00003800
*                                                                     * 00003900
*      AMODE:            31-bit.                                      * 00004000
*                                                                     * 00004100
*      ASC mode:         Primary.                                     * 00004200
*                                                                     * 00004300
*      Cross Memory Mode: Non-XMEM or XMEM. Any P.S.H.                * 00004400
*                                                                     * 00004500
*      Interrupt status: Enabled for I/O and external interrupts.  No * 00004600
*                        (EUT) FRR established.                       * 00004700
*                                                                     * 00004800
*      Locks:            No locks held.                               * 00004900
*                                                                     * 00005000
*      Control parameters: Control parameters must be in the primary  * 00005100
*                        address space.                               * 00005200
*                                                                     * 00005300
*                                                                     * 00005400
*                                                                     * 00005500
*01* PROGRAMMING REQUIREMENTS:                                        * 00005600
*                                                                     * 00005700
*                                                                     * 00005800
*    1.  The macro CVT must be included to use this macro.            * 00005900
*                                                                     * 00006000
*    2.  The macro IWMYCON must be included to use this macro.        * 00006100
*                                                                     * 00006200
*    3.  The macro IWMPB must be in the library concatenation, since  * 00006300
*        it is included by IWMYCON.                                   * 00006400
*                                                                     * 00006500
*    4.  Note that the high order halfword of register 0, and the     * 00006600
*        reason code variable when specified, may be non-zero and     * 00006700
*        represents diagnostic data which is NOT part of the external * 00006800
*        interface.  The high order halfword should thus be excluded  * 00006900
*        from comparison with the reason code values described above. * 00007000
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 00007100
*        be used for this purpose.                                    * 00007200
*                                                                     * 00007300
*    5.  All character data, unless otherwise specified, is assumed   * 00007400
*        to be left justified and padded with blanks on the right, as * 00007500
*        needed, to occupy the specified number of bytes.             * 00007600
*                                                                     * 00007700
*                                                                     * 00007800
*                                                                     * 00007900
*01* RESTRICTIONS:                                                    * 00008000
*                                                                     * 00008100
*                                                                     * 00008200
*    1.  This macro may not be used prior to the completion of WLM    * 00008300
*        address space initialization.                                * 00008400
*                                                                     * 00008500
*    2.  This macro may only be used on MVS/ESA (version 3 or         * 00008600
*        higher), NOT versions 1 or 2 of MVS.                         * 00008700
*                                                                     * 00008800
*    3.  This macro may only be used on MVS/ESA SP5.3 or higher       * 00008900
*        levels for REQTYPE(SINGLE|MULTIPLE).                         * 00009000
*                                                                     * 00009100
*    4.  This macro may not be used during task/address space         * 00009200
*        termination.                                                 * 00009300
*                                                                     * 00009400
*    5.  If the key specified on IWMMCREA is a user key (8-F), then   * 00009500
*        the caller must be in non-cross-memory mode (P=S=H)          * 00009600
*                                                                     * 00009700
*    6.  While not a restriction for IWMMCREA, it should be noted     * 00009800
*        that when the key specified is a user key (8-F), the delay   * 00009900
*        monitoring token may only be passed (to any service          * 00010000
*        whatsoever), when primary addressability exists to the       * 00010100
*        performance block obtained by IWMMCREA.  This condition may  * 00010200
*        be satisfied by ensuring that the then current primary       * 00010300
*        matches primary at the time that IWMMCREA was invoked.  If   * 00010400
*        these other services are invoked in a subspace, the          * 00010500
*        condition may be satisfied by ensuring that the performance  * 00010600
*        block is shared with the base space.                         * 00010700
*                                                                     * 00010800
*    7.  This service provides a task and address space resource      * 00010900
*        managers to clean up any resouces obtained during task and   * 00011000
*        address space terminations.  Once the calling task or        * 00011100
*        address space terminates, the monitoring token returned by   * 00011200
*        IWMMCREA must not be used for any services.                  * 00011300
*                                                                     * 00011400
*                                                                     * 00011500
*                                                                     * 00011600
*01* INPUT REGISTER INFORMATION:                                      * 00011700
*                                                                     * 00011800
*    Before issuing the IWMMCREA macro, the caller does not have to   * 00011900
*    place any information into any register unless using it in       * 00012000
*    register notation for a particular parameter, or using it as a   * 00012100
*    base register.                                                   * 00012200
*                                                                     * 00012300
*01* OUTPUT REGISTER INFORMATION:                                     * 00012400
*                                                                     * 00012500
*    When control returns to the caller, the GPRs contain:            * 00012600
*                                                                     * 00012700
*                                                                     * 00012800
*    REGISTER  CONTENTS                                               * 00012900
*                                                                     * 00013000
*    0         Reason code if GR15 return code is non-zero            * 00013100
*                                                                     * 00013200
*    1         Used as work registers by the system                   * 00013300
*                                                                     * 00013400
*    2-13      Unchanged                                              * 00013500
*                                                                     * 00013600
*    14        Used as work registers by the system                   * 00013700
*                                                                     * 00013800
*    15        Return code                                            * 00013900
*                                                                     * 00014000
*                                                                     * 00014100
*                                                                     * 00014200
*    When control returns to the caller, the ARs contain:             * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*    REGISTER  CONTENTS                                               * 00014600
*                                                                     * 00014700
*    0-1       Used as work registers by the system                   * 00014800
*                                                                     * 00014900
*    2-13      Unchanged                                              * 00015000
*                                                                     * 00015100
*    14-15     Used as work registers by the system                   * 00015200
*                                                                     * 00015300
*                                                                     * 00015400
*                                                                     * 00015500
*    Some callers depend on register contents remaining the same      * 00015600
*    before and after issuing a service.  If the system changes the   * 00015700
*    contents of registers on which the caller depends, the caller    * 00015800
*    must save them before issuing the service, and restore them      * 00015900
*    after the system returns control.                                * 00016000
*                                                                     * 00016100
*01* PERFORMANCE IMPLICATIONS:                                        * 00016200
*                                                                     * 00016300
*    None                                                             * 00016400
*                                                                     * 00016500
*01* SYNTAX:                                                          * 00016600
*                                                                     * 00016700
*[xlabel]  IWMMCREA  [ REQTYPE=SINGLE                                * 00016800
*                    |     ,MONTKN=xmontkn]                           * 00016900
*                    [,REQTYPE=MULTIPLE                              * 00017000
*                          ,AMOUNT=xamount                            * 00017100
*                          ,MONTKN_LIST=xmontkn_list                  * 00017200
*                          ,MONTKN_LISTLEN                            * 00017300
*                                          =xmontkn_listlen]          * 00017400
*                     ,SUBSYSP=CONNECT                               * 00017500
*                    |     ,CONNTKN=xconntkn                          * 00017600
*                     ,SUBSYSP=VALUE                                 * 00017700
*                          ,SUBSYS=xsubsys                            * 00017800
*                          ,SUBSYSNM=xsubsysnm                        * 00017900
*                     ,MONTKNKEYP=VALUE                              * 00018000
*                    |     ,MONTKNKEY=xmontknkey                      * 00018100
*                     ,MONTKNKEYP=PSWKEY                             * 00018200
*                     [,RETCODE=xretcode]                             * 00018300
*                     [,RSNCODE=xrsncode]                             * 00018400
*                     [,PLISTVER=xplistver|IMPLIED_VERSION]         * 00018500
*                    [,MF=S]                                         * 00018600
*                    [,MF=(L,xmfctrl,xmfattr|0D)]                  * 00018700
*                    [,MF=(E,xmfctrl,COMPLETE)]                    * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*      Where:                                                         * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*      [xlabel]                                                       * 00019400
*          is an optional symbol, starting in column 1, that is the   * 00019500
*          name on the IWMMCREA macro invocation.  The name must      * 00019600
*          conform to the rules for an ordinary assembler language    * 00019700
*          symbol.                                                    * 00019800
*          DEFAULT: No name.                                          * 00019900
*                                                                     * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*                                                                     * 00020300
*      [REQTYPE=SINGLE|MULTIPLE]                                    * 00020400
*          is an optional keyword input indicates whether the request * 00020500
*          is to create a single delay monitoring environment or to   * 00020600
*          create multiple delay monitoring environments.             * 00020700
*          DEFAULT: SINGLE                                            * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*          [REQTYPE=SINGLE                                            * 00021100
*              The request is to create a single delay monitoring     * 00021200
*              environment.                                           * 00021300
*                                                                     * 00021400
*                                                                     * 00021500
*              MONTKN=xmontkn]                                        * 00021600
*                  is the name (RS-type), or address in register      * 00021700
*                  (2)-(12), of a required 32 bit output which will   * 00021800
*                  receive the delay monitoring token.                * 00021900
*                                                                     * 00022000
*                                                                     * 00022100
*                                                                     * 00022200
*          [REQTYPE=MULTIPLE                                          * 00022300
*              The request is to create a number of delay monitoring  * 00022400
*              environments.                                          * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*              AMOUNT=xamount                                         * 00022800
*                  is the name (RS-type), or address in register      * 00022900
*                  (2)-(12), of a required fullword input which       * 00023000
*                  specifies the number of delay monitoring           * 00023100
*                  environments to be created.                        * 00023200
*                                                                     * 00023300
*                  While there is no restriction on the number of     * 00023400
*                  delay monitoring environments to be created,       * 00023500
*                  caller should only create the minimum number of    * 00023600
*                  delay monitoring environments that are needed.     * 00023700
*                                                                     * 00023800
*                  If there are too many unused delay monitoring      * 00023900
*                  environments existing in the system, the storage   * 00024000
*                  and CPU overheads may be significant.              * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*              MONTKN_LIST=xmontkn_list                               * 00024600
*                  is the name (RS-type), or address in register      * 00024700
*                  (2)-(12), of a required character input which      * 00024800
*                  specifies an area into which a list of delay       * 00024900
*                  monitoring tokens will be placed.                  * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*                                                                     * 00025400
*              MONTKN_LISTLEN=xmontkn_listlen]                        * 00025500
*                  is the name (RS-type), or address in register      * 00025600
*                  (2)-(12), of a required fullword input which       * 00025700
*                  specifies the length (in bytes) of the area        * 00025800
*                  identified by the MONTKN_LIST keyword.             * 00025900
*                                                                     * 00026000
*                  Size of this area must be at least the size of     * 00026100
*                  MONTKN (see MONTKN keyword) times AMOUNT.  If the  * 00026200
*                  user specified area is not large enough to return  * 00026300
*                  the delay monitoring tokens, a specific            * 00026400
*                  return/reason code will be returned and the        * 00026500
*                  request will not be processed.                     * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*                                                                     * 00027200
*                                                                     * 00027300
*                                                                     * 00027400
*      SUBSYSP=CONNECT|VALUE                                        * 00027500
*          is a required keyword input which describes how the        * 00027600
*          calling subsystem is providing identification.             * 00027700
*                                                                     * 00027800
*                                                                     * 00027900
*          SUBSYSP=CONNECT                                            * 00028000
*                                                                     * 00028100
*              indicates that the connect token is being passed.      * 00028200
*                                                                     * 00028300
*                                                                     * 00028400
*              CONNTKN=xconntkn                                       * 00028500
*                  is the name (RS-type), or address in register      * 00028600
*                  (2)-(12), of a required 32 bit input which         * 00028700
*                  contains the connect token associated with the     * 00028800
*                  subsystem.                                         * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*                                                                     * 00029200
*          SUBSYSP=VALUE                                              * 00029300
*                                                                     * 00029400
*              indicates that the subsystem name is being passed      * 00029500
*              directly.                                              * 00029600
*                                                                     * 00029700
*                                                                     * 00029800
*              SUBSYS=xsubsys                                         * 00029900
*                  is the name (RS-type), or address in register      * 00030000
*                  (2)-(12), of a required 4 character input which    * 00030100
*                  contains the generic subsystem type (e.g. IMS,     * 00030200
*                  CICS, etc.).                                       * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*                                                                     * 00030600
*                                                                     * 00030700
*              SUBSYSNM=xsubsysnm                                     * 00030800
*                  is the name (RS-type), or address in register      * 00030900
*                  (2)-(12), of a required 8 character input which    * 00031000
*                  contains the subsystem name.                       * 00031100
*                                                                     * 00031200
*                                                                     * 00031300
*                                                                     * 00031400
*                                                                     * 00031500
*                                                                     * 00031600
*                                                                     * 00031700
*                                                                     * 00031800
*                                                                     * 00031900
*      MONTKNKEYP=VALUE|PSWKEY                                      * 00032000
*          is a required keyword input which describes how the input  * 00032100
*          key should be obtained.                                    * 00032200
*                                                                     * 00032300
*                                                                     * 00032400
*          MONTKNKEYP=VALUE                                           * 00032500
*                                                                     * 00032600
*              indicates that the key is being passed explicitly via  * 00032700
*              MONTKNKEY.                                             * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*              MONTKNKEY=xmontknkey                                   * 00033100
*                  is the name (RS-type), or address in register      * 00033200
*                  (2)-(12), of a required 8 bit input which contains * 00033300
*                  the key in which the delay monitoring services     * 00033400
*                  will be invoked subsequently when using the output * 00033500
*                  MONTKN.  The low order 4 bits (bits 4-7) contain   * 00033600
*                  the key value.  The high order 4 bits (bits 0-3)   * 00033700
*                  must be 0.                                         * 00033800
*                                                                     * 00033900
*                                                                     * 00034000
*                                                                     * 00034100
*          MONTKNKEYP=PSWKEY                                          * 00034200
*                                                                     * 00034300
*              indicates that the current PSW key should be used.     * 00034400
*                                                                     * 00034500
*                                                                     * 00034600
*                                                                     * 00034700
*                                                                     * 00034800
*                                                                     * 00034900
*                                                                     * 00035000
*      [RETCODE=xretcode]                                             * 00035100
*          is the name (RS-type) of an optional fullword output       * 00035200
*          variable, or register (2)-(12), into which the return code * 00035300
*          is to be copied from GPR 15.                               * 00035400
*                                                                     * 00035500
*                                                                     * 00035600
*                                                                     * 00035700
*                                                                     * 00035800
*      [RSNCODE=xrsncode]                                             * 00035900
*          is the name (RS-type) of an optional fullword output       * 00036000
*          variable, or register (2)-(12), into which the reason code * 00036100
*          is to be copied from GPR 0.                                * 00036200
*                                                                     * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*      [PLISTVER=xplistver|IMPLIED_VERSION]                         * 00036700
*          is an optional byte input decimal value in the "0-1" range * 00036800
*          that specifies the macro version.  PLISTVER is the only    * 00036900
*          key allowed on the list form of MF and determines which    * 00037000
*          parameter list is generated.  The macro keys associated    * 00037100
*          with each supported version of the macro are listed in     * 00037200
*          MACRO USAGE NOTE 2.  Note that MAX may be specified        * 00037300
*          instead of a number, and the parameter list will be of the * 00037400
*          largest size currently supported. This size may grow from  * 00037500
*          release to release (thus possibly affecting the amount of  * 00037600
*          storage needed by your program).  If your program can      * 00037700
*          tolerate this, IBM recommends that you always specify MAX  * 00037800
*          when creating the list form parameter list as that will    * 00037900
*          ensure that the list form parameter list is always long    * 00038000
*          enough to hold whatever parameters might be specified on   * 00038100
*          the execute form.                                          * 00038200
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00038300
*          default is the lowest version which allows all of the      * 00038400
*          parameters specified on the invocation to be processed.    * 00038500
*                                                                     * 00038600
*                                                                     * 00038700
*                                                                     * 00038800
*                                                                     * 00038900
*      [MF=S|L|E]                                                   * 00039000
*          is an optional keyword input which specifies the macro     * 00039100
*          form.                                                      * 00039200
*          DEFAULT: S                                                 * 00039300
*                                                                     * 00039400
*                                                                     * 00039500
*          [MF=S]                                                     * 00039600
*              specifies the standard form of the macro.  The "S"     * 00039700
*              form generates code to put the parameters into an      * 00039800
*              in-line parameter list and invoke the desired service. * 00039900
*              Full checking for required macro keys is done along    * 00040000
*              with supplying defaults for omitted optional           * 00040100
*              parameters.                                            * 00040200
*                                                                     * 00040300
*          [MF=(L,xmfctrl,xmfattr|0D)]                              * 00040400
*              specifies the list form of the macro.  The "L" form    * 00040500
*              defines an area to be used for the parameter list.     * 00040600
*              Only the PLISTVER key may be specified on the          * 00040700
*              invocation.  All other macro parameters are flagged as * 00040800
*              errors.  If PLISTVER is not specified, the original    * 00040900
*              parameter list definition is used.                     * 00041000
*                                                                     * 00041100
*            ,xmfctrl                                                 * 00041200
*              is a required input.  It is the name of a storage area * 00041300
*              for the parameter list.                                * 00041400
*                                                                     * 00041500
*            ,xmfattr|0D                                            * 00041600
*              is an optional 60 character input string that varies   * 00041700
*              from 1 to 60 characters. Use it to force boundary      * 00041800
*              alignment of the parameter list. Use any value that    * 00041900
*              represents a boundary and is valid on an assembler DS  * 00042000
*              pseudo op.                                             * 00042100
*              DEFAULT: 0D which forces the parameter list to a       * 00042200
*              doubleword boundary.                                   * 00042300
*                                                                     * 00042400
*          [MF=(E,xmfctrl,COMPLETE)]                                * 00042500
*              specifies the execute form of the macro.  The "E" form * 00042600
*              generates code to put the parameters into the          * 00042700
*              parameter list specified by xmfctrl and provides full  * 00042800
*              syntax checking with default setting.                  * 00042900
*                                                                     * 00043000
*            ,xmfctrl                                                 * 00043100
*              is a required input.  It is the name (RS-type), or     * 00043200
*              address in register (1)-(12), of a storage area for    * 00043300
*              the parameter list.                                    * 00043400
*                                                                     * 00043500
*            ,COMPLETE                                              * 00043600
*              is an optional keyword input which specifies the       * 00043700
*              degree of macro parameter syntax checking.             * 00043800
*              DEFAULT: COMPLETE                                      * 00043900
*                                                                     * 00044000
*                                                                     * 00044100
*              COMPLETE                                               * 00044200
*                  Checking for required macro keys is done and       * 00044300
*                  defaults are supplied for omitted optional         * 00044400
*                  parameters.                                        * 00044500
*                                                                     * 00044600
*                                                                     * 00044700
*                                                                     * 00044800
*                                                                     * 00044900
*                                                                     * 00045000
*                                                                     * 00045100
*                                                                     * 00045200
*01* ABEND CODES:  None.                                              * 00045300
*                                                                     * 00045400
*01* RETURN CODES:                                                    * 00045500
*                                                                     * 00045600
*                                                                     * 00045700
*            0    Name: IwmRetCodeOk                                  * 00045800
*                                                                     * 00045900
*                 Meaning: Successful completion.                     * 00046000
*                                                                     * 00046100
*                 Action: None required.                              * 00046200
*                                                                     * 00046300
*            4    Name: IwmRetCodeWarning                             * 00046400
*                                                                     * 00046500
*                 Meaning: Successful completion, unusual conditions  * 00046600
*                 noted.                                              * 00046700
*                                                                     * 00046800
*                                                                     * 00046900
*                 HEX REASON  MEANING/ACTION                          * 00047000
*                 CODE                                                * 00047100
*                                                                     * 00047200
*                 xxxx0401    Name: IwmRsnCodeNoWLM                   * 00047300
*                                                                     * 00047400
*                             Meaning:  System does not support delay * 00047500
*                             monitoring services.  The delay         * 00047600
*                             monitoring token returned is useable in * 00047700
*                             other services.  However use of this    * 00047800
*                             token will NOT result in the action     * 00047900
*                             requested of those services.  This      * 00048000
*                             return code is only set when the MVS    * 00048100
*                             release is prior to MVS/ESA SP5.1.0.    * 00048200
*                                                                     * 00048300
*                             Action: None required.                  * 00048400
*                                                                     * 00048500
*                 xxxx0409    Name: IwmRsnCodeNoConn                  * 00048600
*                                                                     * 00048700
*                             Meaning:  Connect token does not        * 00048800
*                             reflect a successful Connect.  The      * 00048900
*                             delay monitoring token returned is      * 00049000
*                             useable in other services.  However use * 00049100
*                             of this token will NOT result in the    * 00049200
*                             action requested of those services.     * 00049300
*                                                                     * 00049400
*                             Action: None required.                  * 00049500
*                                                                     * 00049600
*                                                                     * 00049700
*                                                                     * 00049800
*            8    Name: IwmRetCodeInvocError                          * 00049900
*                                                                     * 00050000
*                 Meaning: Invalid invocation environment or          * 00050100
*                 parameters.                                         * 00050200
*                                                                     * 00050300
*                                                                     * 00050400
*                 HEX REASON  MEANING/ACTION                          * 00050500
*                 CODE                                                * 00050600
*                                                                     * 00050700
*                 xxxx0801    Name: IwmRsnCodeSrbMode                 * 00050800
*                                                                     * 00050900
*                             Meaning:  Caller is in SRB mode.        * 00051000
*                                                                     * 00051100
*                             Action: Avoid requesting this function  * 00051200
*                             while in SRB mode.                      * 00051300
*                                                                     * 00051400
*                 xxxx0802    Name: IwmRsnCodeXmemUserKeyTkn          * 00051500
*                                                                     * 00051600
*                             Meaning:  Caller is in cross-memory     * 00051700
*                             mode while the token was requested in   * 00051800
*                             user key.                               * 00051900
*                                                                     * 00052000
*                             Action: Avoid requesting this function  * 00052100
*                             while in cross-memory mode.             * 00052200
*                                                                     * 00052300
*                 xxxx0803    Name: IwmRsnCodeDisabled                * 00052400
*                                                                     * 00052500
*                             Meaning:  Caller is disabled.           * 00052600
*                                                                     * 00052700
*                             Action: Avoid requesting this function  * 00052800
*                             while disabled.                         * 00052900
*                                                                     * 00053000
*                 xxxx0804    Name: IwmRsnCodeLocked                  * 00053100
*                                                                     * 00053200
*                             Meaning: Caller is locked.              * 00053300
*                                                                     * 00053400
*                             Action: Avoid requesting this function  * 00053500
*                             while locked.                           * 00053600
*                                                                     * 00053700
*                 xxxx080B    Name: IwmRsnCodeBadPl                   * 00053800
*                                                                     * 00053900
*                             Meaning:  Error accessing parameter     * 00054000
*                             list.                                   * 00054100
*                                                                     * 00054200
*                             Action: Check for possible storage      * 00054300
*                             overlay.                                * 00054400
*                                                                     * 00054500
*                 xxxx0810    Name: IwmRsnCodeEutFrr                  * 00054600
*                                                                     * 00054700
*                             Meaning:  Caller has EUT FRR            * 00054800
*                             established.                            * 00054900
*                                                                     * 00055000
*                             Action: Avoid requesting this function  * 00055100
*                             with an EUT FRR set.                    * 00055200
*                                                                     * 00055300
*                 xxxx0821    Name: IwmRsnCodeBadConn                 * 00055400
*                                                                     * 00055500
*                             Meaning:  Input connect token does not  * 00055600
*                             pass validity checking.                 * 00055700
*                                                                     * 00055800
*                             Action: Check for possible storage      * 00055900
*                             overlay.                                * 00056000
*                                                                     * 00056100
*                 xxxx0823    Name: IwmRsnCodeDatoff                  * 00056200
*                                                                     * 00056300
*                             Meaning: Caller invoked service while   * 00056400
*                             DATOFF                                  * 00056500
*                                                                     * 00056600
*                             Action: Avoid requesting this function  * 00056700
*                             in this environment.                    * 00056800
*                                                                     * 00056900
*                 xxxx0824    Name: IwmRsnCodeAmode24                 * 00057000
*                                                                     * 00057100
*                             Meaning: Caller invoked service but was * 00057200
*                             in 24 bit addressing mode.              * 00057300
*                                                                     * 00057400
*                             Action: Request this function only when * 00057500
*                             you are in 31 bit addressing mode.      * 00057600
*                                                                     * 00057700
*                 xxxx0825    Name: IwmRsnCodeAscModeNotPrimary       * 00057800
*                                                                     * 00057900
*                             Meaning: Caller invoked service but was * 00058000
*                             not DAT on Primary ASC mode.            * 00058100
*                                                                     * 00058200
*                             Action: Avoid requesting this function  * 00058300
*                             in this environment.                    * 00058400
*                                                                     * 00058500
*                 xxxx0826    Name: IwmRsnCodeTaskTerm                * 00058600
*                                                                     * 00058700
*                             Meaning:  Caller invoked service while  * 00058800
*                             task termination is in progress for the * 00058900
*                             TCB associated with the owner.          * 00059000
*                                                                     * 00059100
*                             Action: Avoid requesting this function  * 00059200
*                             in this environment.                    * 00059300
*                                                                     * 00059400
*                 xxxx0827    Name: IwmRsnCodeRsvdNot0                * 00059500
*                                                                     * 00059600
*                             Meaning:  Reserved field in parameter   * 00059700
*                             list was non-zero.                      * 00059800
*                                                                     * 00059900
*                             Action: Check for possible storage      * 00060000
*                             overlay of the parameter list.          * 00060100
*                                                                     * 00060200
*                 xxxx0828    Name: IwmRsnCodeBadVersion              * 00060300
*                                                                     * 00060400
*                             Meaning: Version number in parameter    * 00060500
*                             list is not valid.                      * 00060600
*                                                                     * 00060700
*                             Action: Check for possible storage      * 00060800
*                             overlay of the parameter list.          * 00060900
*                                                                     * 00061000
*                 xxxx0829    Name: IwmRsnCodeBadOptions              * 00061100
*                                                                     * 00061200
*                             Meaning:  Parameter list omits required * 00061300
*                             parameters or supplies mutually         * 00061400
*                             exclusive parameters or provides data   * 00061500
*                             associated with options not selected.   * 00061600
*                                                                     * 00061700
*                             Action: Check for possible storage      * 00061800
*                             overlay of the parameter list.          * 00061900
*                                                                     * 00062000
*                 xxxx0844    Name: IwmRsnCodeBadMonTknListLen        * 00062100
*                                                                     * 00062200
*                             Meaning:  The storage area length       * 00062300
*                             specified on the MONTKN_LISTLEN         * 00062400
*                             parameter is not large enough to        * 00062500
*                             contain the data being returned. No     * 00062600
*                             data is returned.                       * 00062700
*                                                                     * 00062800
*                             Action: Invoke the function with an     * 00062900
*                             output area sufficient to receive the   * 00063000
*                             data.                                   * 00063100
*                                                                     * 00063200
*                                                                     * 00063300
*                                                                     * 00063400
*            C    Name: IwmRetCodeEnvError                            * 00063500
*                                                                     * 00063600
*                 Meaning: Environmental error.                       * 00063700
*                                                                     * 00063800
*                                                                     * 00063900
*                 HEX REASON  MEANING/ACTION                          * 00064000
*                 CODE                                                * 00064100
*                                                                     * 00064200
*                 xxxx0C01    Name: IwmRsnCodeNoStg                   * 00064300
*                                                                     * 00064400
*                             Meaning:  Storage is not available for  * 00064500
*                             the request.                            * 00064600
*                                                                     * 00064700
*                             Action: There is a storage shortage.    * 00064800
*                             The function may work successfully at a * 00064900
*                             later time.                             * 00065000
*                                                                     * 00065100
*                 xxxx0C09    Name: IwmRsnCodeNoResmgr                * 00065200
*                                                                     * 00065300
*                             Meaning: Resource manager could not be  * 00065400
*                             established.                            * 00065500
*                                                                     * 00065600
*                             Action: No action required.  This       * 00065700
*                             condition may be due to a storage       * 00065800
*                             shortage condition.                     * 00065900
*                                                                     * 00066000
*                                                                     * 00066100
*                                                                     * 00066200
*            10   Name: IwmRetCodeCompError                           * 00066300
*                                                                     * 00066400
*                 Meaning: Component error.                           * 00066500
*                                                                     * 00066600
*                 Action: No action required.  The function may be    * 00066700
*                 successful if invoked again.                        * 00066800
*                                                                     * 00066900
*                                                                     * 00067000
*                                                                     * 00067100
*01* REASON CODES:                                                    * 00067200
*                                                                     * 00067300
*       A unique reason code will be returned whenever the return     * 00067400
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00067500
*       under their corresponding return code.  Reason code and       * 00067600
*       return code constants are defined within IWMYCON.  Note that  * 00067700
*       the high order halfword of register 0, and the reason code    * 00067800
*       variable when specified, may be non-zero and represents       * 00067900
*       diagnostic data which is NOT part of the external interface.  * 00068000
*       The high order halfword should thus be excluded from          * 00068100
*       comparison with the reason code values described above.  The  * 00068200
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00068300
*       used for this purpose.                                        * 00068400
*                                                                     * 00068500
*01* MODULE TYPE:  ASSEM MACRO                                        * 00068600
*                                                                     * 00068700
*02*   PROCESSOR:  ASSEM                                              * 00068800
*                                                                     * 00068900
*01* COMPONENT:  SCWLM                                                * 00069000
*                                                                     * 00069100
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00069200
*                                                                     * 00069300
*01* EXAMPLES:                                                        * 00069400
*                                                                     * 00069500
*01* MACRO USAGE NOTES:                                               * 00069600
*                                                                     * 00069700
*                                                                     * 00069800
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00069900
*        global macro variable.  Any value other than 'NO' will       * 00070000
*        result in the macro expansion being printed.  The default is * 00070100
*        'YES'.  The following examples illustrate how the ZPRINT     * 00070200
*        variable should be set.                                      * 00070300
*                                                                     * 00070400
*                    GBLC &ZPRINT                                     * 00070500
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00070600
*                                                                     * 00070700
*                                                                     * 00070800
*    2.  The IWMMCREA macro supports multiple versions. The macro key * 00070900
*        list  below  contains the version level in which the key was * 00071000
*        first  introduced.  Positionals  are  identified by the word * 00071100
*        'Positional'  followed by the numeric value of its position. * 00071200
*        Nested  positionals  are  preceded  by their outer key.  The * 00071300
*        lowest value represents the original version and the highest * 00071400
*        value  represents  the  most  recent version of the IWMMCREA * 00071500
*        macro.    When  specifying  PLISTVER,  be sure that it is as * 00071600
*        least  as high as the highest version number of all the keys * 00071700
*        being used.                                                  * 00071800
*                                                                     * 00071900
*        VERSION   KEY                                                * 00072000
*                                                                     * 00072100
*              0      CONNTKN                                         * 00072200
*                     MONTKN                                          * 00072300
*                     MONTKNKEY                                       * 00072400
*                     MONTKNKEYP                                      * 00072500
*                     SUBSYS                                          * 00072600
*                     SUBSYSNM                                        * 00072700
*                     SUBSYSP                                         * 00072800
*              1      AMOUNT                                          * 00072900
*                     MONTKN_LIST                                     * 00073000
*                     MONTKN_LISTLEN                                  * 00073100
*                     REQTYPE                                         * 00073200
*                                                                     * 00073300
*                                                                     * 00073400
*                                                                     * 00073500
*01* CHANGE ACTIVITY:                                                 * 00073600
*                                                                     * 00073700
*   Flag LineItem  FMID    Date   ID    Comment                       * 00073800
*                                                                     * 00073900
*    $L0=WLMI     HBB5510 920309 PD16:  Workload Manager I            * 00074000
*    $L1=WLMP     HBB6603 950309 PDRK:  Dynamic buffer pool           * 00074100
*                                         management support          * 00074200
*    $O1=OW19255  HBB5520 960318 PDDA:  Add additional restriction    * 00074300
*                                         text to macro.              * 00074400
****** END OF SPECIFICATIONS *****************************************/ 00074500
*/********************************************************************* 00074600
         MACRO                                                          00074700
&XLABEL  IWMMCREA &REQTYPE=,&MONTKN=,&AMOUNT=,&MONTKN_LIST=,           *00074800
               &MONTKN_LISTLEN=,&SUBSYSP=,&CONNTKN=,&SUBSYS=,          *00074900
               &SUBSYSNM=,&MONTKNKEYP=,&MONTKNKEY=,&RETCODE=,&RSNCODE=,*00075000
               &PLISTVER=,&MF=                                          00075100
.*                                                                      00075200
*                    MACDATE -09/05/96-<1>                              00075300
.*                                                                      00075400
.*******************************************************************    00075500
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00075600
.*******************************************************************    00075700
                    GBLC  &ZPRINT     YES=PRINT NO=NO PRINT             00075800
                    GBLC  &ZTEST      YES=TEST NO=NO TEST               00075900
                    GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX       00076000
.*                                                                      00076100
                    GBLC  &ZIWMMCREA  YES=MACRO USED AT LEAST ONCE      00076200
.*******************************************************************    00076300
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00076400
.*******************************************************************    00076500
                    LCLC  &ZMS        ERROR MESSAGE WORK AREA           00076600
                    LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS      00076700
                    LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED        00076800
                    LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR       00076900
                    LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE       00077000
                    LCLA  &ZAWRK      USED AS A WORK AREA               00077100
                    LCLA  &ZASIZ      USED FOR SIZE OF VALUE            00077200
                    LCLA  &ZN         NUMERIC WORK VARIABLE             00077300
                    LCLC  &ZC         CHARACTER WORK VARIABLE           00077400
                    LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE       00077500
                    LCLA  &ZTLA       VALUE TOO LONG VARIABLE           00077600
                    LCLA  &ZMACRET    MACRO RETURN CODE                 00077700
&ZMACRET            SETA  0           ASSUME NO ERRORS                  00077800
.*                                                                      00077900
                    LCLC  &ZCSYSLIST(255)       NONXKEY, POS ARRAY      00078000
                    LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()        00078100
                    LCLA  &ZPLLEN     PARAMETER LIST LENGTH             00078200
                    LCLC  &ZENDBASEPL           End of base PL          00078300
                    LCLA  &ZPLWORKA   PARAMETER LIST LENGTH             00078400
.*******************************************************************    00078500
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00078600
.*******************************************************************    00078700
                    LCLA  &ZI         INDEX FOR ARRAY                   00078800
                    LCLA  &ZJ         INDEX FOR PARMS                   00078900
                    LCLA  &ZK         INDEX FOR PARSE                   00079000
                    LCLA  &ZLO        LOW RANGE VALUE                   00079100
                    LCLA  &ZHI        HIGH RANGE VALUE                  00079200
                    LCLC  &ZW         WORK AREA FOR PARM                00079300
.********************************************************************   00079400
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00079500
.********************************************************************   00079600
                    GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL           00079700
                    GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE    00079800
.*                                                                      00079900
                    AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED    00080000
                    AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED     00080100
                    SPLEVEL  TEST                                       00080200
.ZSYS2              ANOP  ,                                             00080300
                    AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1         00080400
                    AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1         00080500
                    SYSSTATE TEST                                       00080600
                    AGO   .ZSYS4                                        00080700
.ZSYS3              ANOP  ,                                             00080800
&SYSASCE            SETC  'P'         ASSUME SYSSTATE PRIMARY           00080900
.ZSYS4              ANOP  ,                                             00081000
.*******************************************************************    00081100
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00081200
.*******************************************************************    00081300
                    LCLC  &XREQTYPE   ++ VALUE                          00081400
                    LCLC  &XMONTKN    ++ NAME                           00081500
                    LCLC  &XAMOUNT    ++ NAME                           00081600
                    LCLC  &XMONTKN_LIST         ++ NAME                 00081700
                    LCLC  &XMONTKN_LISTLEN      ++ NAME                 00081800
                    LCLC  &XSUBSYSP   ++ VALUE                          00081900
                    LCLC  &XCONNTKN   ++ NAME                           00082000
                    LCLC  &XSUBSYS    ++ NAME                           00082100
                    LCLC  &XSUBSYSNM  ++ NAME                           00082200
                    LCLC  &XMONTKNKEYP          ++ VALUE                00082300
                    LCLC  &XMONTKNKEY           ++ NAME                 00082400
                    LCLC  &XRETCODE   ++ NAME                           00082500
                    LCLC  &XRSNCODE   ++ NAME                           00082600
                    LCLA  &XPLISTVER  ++ VALUE                          00082700
                    LCLC  &XMF        ++ VALUE                          00082800
                    LCLC  &XMFCTRL    ++ NAME                           00082900
                    LCLC  &XMFATTR    ++ VALUE                          00083000
                    LCLC  &XMFSCK     ++ VALUE                          00083100
.*******************************************************************    00083200
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00083300
.*******************************************************************    00083400
                    LCLC  &ZXREQTYPE  ++ INPUT VALUE                    00083500
                    LCLC  &ZXMONTKN   ++ OUTPUT NAME                    00083600
                    LCLC  &ZXAMOUNT   ++ INPUT NAME                     00083700
                    LCLC  &ZXMONTKN_LIST        ++ INPUT NAME           00083800
                    LCLC  &ZXMONTKN_LISTLEN     ++ INPUT NAME           00083900
                    LCLC  &ZXSUBSYSP  ++ INPUT VALUE                    00084000
                    LCLC  &ZXCONNTKN  ++ INPUT NAME                     00084100
                    LCLC  &ZXSUBSYS   ++ INPUT NAME                     00084200
                    LCLC  &ZXSUBSYSNM           ++ INPUT NAME           00084300
                    LCLC  &ZXMONTKNKEYP         ++ INPUT VALUE          00084400
                    LCLC  &ZXMONTKNKEY          ++ INPUT NAME           00084500
                    LCLC  &ZXRETCODE  ++ OUTPUT NAME                    00084600
                    LCLC  &ZXRSNCODE  ++ OUTPUT NAME                    00084700
                    LCLC  &ZXPLISTVER           ++ INPUT VALUE          00084800
                    LCLC  &ZXMF       ++ INPUT VALUE                    00084900
                    LCLC  &ZXMFCTRL   ++ INPUT NAME                     00085000
                    LCLC  &ZXMFATTR   ++ INPUT VALUE                    00085100
                    LCLC  &ZXMFSCK    ++ INPUT VALUE                    00085200
.********************************************************************   00085300
.***AC.PLV01  PROCESS PLISTVER                                      *   00085400
.********************************************************************   00085500
&XPLISTVER      SETA  0                                                 00085600
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00085700
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00085800
&XPLISTVER      SETA  1                                                 00085900
.ZPLV0          ANOP  ,                                                 00086000
.*                                                                      00086100
                AIF   ('&REQTYPE' EQ '').ZPLV1E                         00086200
                AIF   (&XPLISTVER GE 1).ZPLV1E                          00086300
&XPLISTVER      SETA  1                                                 00086400
.ZPLV1E         ANOP  ,                                                 00086500
.*                                                                      00086600
                AIF   ('&AMOUNT' EQ '').ZPLV2E                          00086700
                AIF   (&XPLISTVER GE 1).ZPLV2E                          00086800
&XPLISTVER      SETA  1                                                 00086900
.ZPLV2E         ANOP  ,                                                 00087000
.*                                                                      00087100
                AIF   ('&MONTKN_LIST' EQ '').ZPLV3E                     00087200
                AIF   (&XPLISTVER GE 1).ZPLV3E                          00087300
&XPLISTVER      SETA  1                                                 00087400
.ZPLV3E         ANOP  ,                                                 00087500
.*                                                                      00087600
                AIF   ('&MONTKN_LISTLEN' EQ '').ZPLV4E                  00087700
                AIF   (&XPLISTVER GE 1).ZPLV4E                          00087800
&XPLISTVER      SETA  1                                                 00087900
.ZPLV4E         ANOP  ,                                                 00088000
.*                                                                      00088100
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00088200
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00088300
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00088400
.*-------------------------------------------------------------------   00088500
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00088600
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00088700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00088800
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00088900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00089000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00089100
                AGO   .ZPVCK2                                           00089200
.ZPVCK3         ANOP  ,                                                 00089300
.*-------------------------------------------------------------------   00089400
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00089500
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00089600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00089700
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00089800
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00089900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00090000
                AGO   .ZPVCKE                                           00090100
.ZPVCK2         ANOP  ,                                                 00090200
.*-------------------------------------------------------------------   00090300
&ZCVAL          SETC  '&PLISTVER(1)'                                    00090400
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00090500
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00090600
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00090700
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00090800
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00090900
.ZPVCK6         ANOP  ,                                                 00091000
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00091100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00091200
&ZMS            SETC  '&ZMS THE RANGE IS "0-1"'                         00091300
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00091400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00091500
&XPLISTVER      SETA  1                                                 00091600
                AGO   .ZPVCKE                                           00091700
.*-------------------------------------------------------------------   00091800
.ZPVCK4A        ANOP  ,                                                 00091900
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00092000
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00092100
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00092200
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00092300
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00092400
                MNOTE 8,' &ZMS IS REQUIRED.'                            00092500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00092600
                AGO   .ZPVCK5                                           00092700
.ZPVCK4         ANOP  ,                                                 00092800
&XPLISTVER      SETA  &PLISTVER(1)                                      00092900
.ZPVCK5         ANOP  ,                                                 00093000
.ZPVCKE         ANOP  ,                                                 00093100
.********************************************************************   00093200
.***AG.MF01 PROCESS MF MACRO FORMS                                      00093300
.********************************************************************   00093400
                    ACTR  10000                                         00093500
.*------------------------------------------------------------------    00093600
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00093700
&XMF                SETC  ''          INITIALIZE XVARIABLE              00093800
.*-------------------------------------------------------------------   00093900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00094000
.ZG51               ANOP  ,                                             00094100
&ZTLC               SETC 'S'                                            00094200
                    AIF   ('&MF(1)' NE '&ZTLC').ZG52                    00094300
&XMF                SETC  'S'         SET KEYWORD                       00094400
                    AIF   (N'&MF LE 1).ZG51A    CK NUM                  00094500
&ZMS                SETC  '"MF='      *KPOSA* MNOTE                     00094600
&ZMS                SETC  '&ZMS.&MF"'                                   00094700
&ZMS                SETC  '&ZMS "MF"'                                   00094800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00094900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00095000
.ZG51A              ANOP  ,                                             00095100
.*-------------------------------------------------------------------   00095200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00095300
.ZG52               ANOP  ,                                             00095400
&ZTLC               SETC 'L'                                            00095500
                    AIF   ('&MF(1)' NE '&ZTLC').ZG59                    00095600
&XMF                SETC  'L'         SET KEYWORD                       00095700
                    AIF   (N'&MF LE 3).ZG52A    CK NUM                  00095800
&ZMS                SETC  '"MF='      *KPOSA* MNOTE                     00095900
&ZMS                SETC  '&ZMS.&MF"'                                   00096000
&ZMS                SETC  '&ZMS "MF"'                                   00096100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'          00096200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00096300
.ZG52A              ANOP  ,                                             00096400
.*-------------------------------------------------------------------   00096500
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00096600
                    AIF   (N'&SYSLIST NE 0).ZG52B  POSITIONALS?         00096700
                    AIF   ('&REQTYPE' NE '').ZG52B  KEYS?               00096800
                    AIF   ('&MONTKN' NE '').ZG52B  KEYS?                00096900
                    AIF   ('&AMOUNT' NE '').ZG52B  KEYS?                00097000
                    AIF   ('&MONTKN_LIST' NE '').ZG52B  KEYS?           00097100
                    AIF   ('&MONTKN_LISTLEN' NE '').ZG52B  KEYS?        00097200
                    AIF   ('&SUBSYSP' NE '').ZG52B  KEYS?               00097300
                    AIF   ('&CONNTKN' NE '').ZG52B  KEYS?               00097400
                    AIF   ('&SUBSYS' NE '').ZG52B  KEYS?                00097500
                    AIF   ('&SUBSYSNM' NE '').ZG52B  KEYS?              00097600
                    AIF   ('&MONTKNKEYP' NE '').ZG52B  KEYS?            00097700
                    AIF   ('&MONTKNKEY' NE '').ZG52B  KEYS?             00097800
                    AIF   ('&RETCODE' NE '').ZG52B  KEYS?               00097900
                    AIF   ('&RSNCODE' NE '').ZG52B  KEYS?               00098000
                    AGO    .ZG52C     INVOCATION OKAY                   00098100
.ZG52B              ANOP  ,                                             00098200
&ZMS                SETC  'THE "L" FORM OF "MF"'  *MFLA* MNOTE          00098300
&ZMS                SETC  '&ZMS CAN ONLY HAVE'                          00098400
&ZMS                SETC  '&ZMS THE "PLISTVER" KEY'                     00098500
                    MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'        00098600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00098700
.ZG52C              ANOP  ,                                             00098800
.*-------------------------------------------------------------------   00098900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00099000
&ZXMFCTRL           SETC  'INPUT'     SET IN/OUTPUT                     00099100
&XMFCTRL            SETC  '&MF(2,1)'  SET XVARIABLE                     00099200
                    AIF   (N'&MF(2) GT 1).ZG54B  MULTI PARMS            00099300
&XMFCTRL            SETC  '&MF(2)'    SET XVARIABLE                     00099400
.ZG54B              AIF   (K'&MF(2) GT 0).ZG54C                         00099500
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00099600
&ZMS                SETC  'WHEN "L" IS SPECIFIED'  *KRQDA*              00099700
&ZMS                SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'           00099800
                    MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                  00099900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00100000
.ZG54C              ANOP  ,                                             00100100
.*-------------------------------------------------------------------   00100200
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00100300
                    AIF   (K'&ZXMFCTRL LE 0).ZG54P  NOT I/O             00100400
                    AIF   ('&XMFCTRL'(1,1) NE '(').ZG54P                00100500
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00100600
&ZMS                SETC  '"MF='      *KGPRA* MNOTE                     00100700
&ZMS                SETC  '&ZMS.&MF"'                                   00100800
&ZMS                SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'     00100900
                    MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'             00101000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00101100
.ZG54P              ANOP  ,                                             00101200
.*-------------------------------------------------------------------   00101300
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00101400
&ZXMFATTR           SETC  'INPUT'     SET IN/OUTPUT                     00101500
&XMFATTR            SETC  '0D'                                          00101600
                    AIF   (K'&MF(3) LE 0).ZG57B  PARM                   00101700
&XMFATTR            SETC  '&MF(3,1)'  SET XVARIABLE                     00101800
                    AIF   (N'&MF(3) GT 1).ZG57B  MULTI PARMS            00101900
&XMFATTR            SETC  '&MF(3)'    SET XVARIABLE                     00102000
.ZG57B              ANOP  ,                                             00102100
.*-------------------------------------------------------------------   00102200
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00102300
                    AIF   (K'&ZXMFATTR LE 0).ZG57P  NOT I/O             00102400
                    AIF   ('&XMFATTR'(1,1) NE '(').ZG57P                00102500
&ZXMFATTR           SETC  ''          RESET IN/OUTPUT                   00102600
&ZMS                SETC  '"MF='      *KGPRA* MNOTE                     00102700
&ZMS                SETC  '&ZMS.&MF"'                                   00102800
&ZMS                SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'     00102900
                    MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'             00103000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00103100
.ZG57P              ANOP  ,                                             00103200
.*-------------------------------------------------------------------   00103300
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00103400
                    AIF   (K'&ZXMFATTR LE 0).ZG57S  NOT I/O             00103500
                    AIF   (K'&XMFATTR LE 60).ZG57S  LNG OK              00103600
&ZXMFATTR           SETC  ''          RESET IN/OUTPUT                   00103700
&ZMS                SETC  '"MF='      *KLNGA* MNOTE                     00103800
&ZMS                SETC  '&ZMS.&MF"'                                   00103900
&ZMS                SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'         00104000
                    MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'            00104100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00104200
.ZG57S              ANOP  ,                                             00104300
.*-------------------------------------------------------------------   00104400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00104500
.ZG59               ANOP  ,                                             00104600
&ZTLC               SETC 'E'                                            00104700
                    AIF   ('&MF(1)' NE '&ZTLC').ZG67                    00104800
&XMF                SETC  'E'         SET KEYWORD                       00104900
                    AIF   (N'&MF LE 3).ZG59A    CK NUM                  00105000
&ZMS                SETC  '"MF='      *KPOSA* MNOTE                     00105100
&ZMS                SETC  '&ZMS.&MF"'                                   00105200
&ZMS                SETC  '&ZMS "MF"'                                   00105300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'          00105400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00105500
.ZG59A              ANOP  ,                                             00105600
.*-------------------------------------------------------------------   00105700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00105800
&ZXMFCTRL           SETC  'INPUT'     SET IN/OUTPUT                     00105900
&XMFCTRL            SETC  '&MF(2,1)'  SET XVARIABLE                     00106000
                    AIF   (N'&MF(2) GT 1).ZG61B  MULTI PARMS            00106100
&XMFCTRL            SETC  '&MF(2)'    SET XVARIABLE                     00106200
.ZG61B              AIF   (K'&MF(2) GT 0).ZG61C                         00106300
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00106400
&ZMS                SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*              00106500
&ZMS                SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'           00106600
                    MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                  00106700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00106800
.ZG61C              ANOP  ,                                             00106900
.*-------------------------------------------------------------------   00107000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00107100
                    AIF   (K'&ZXMFCTRL LE 0).ZG61R  NOT I/O             00107200
                    AIF   ('&XMFCTRL'(1,1) NE '(').ZG61R                00107300
&ZCGPR              SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                    00107400
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG61P                  00107500
                    AIF   (K'&ZCGPR GT 2).ZG61Q                         00107600
                    AIF   ('&ZCGPR' EQ '0').ZG61Q                       00107700
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00107800
                    AIF   (T'&ZCGPR NE 'N').ZG61Q  INVALID REG NAME     00107900
.ZG61P              ANOP  ,                                             00108000
                    AIF   (T'&ZCGPR NE 'N').ZG61R  NON NUMERIC          00108100
                    AIF   ('&ZCGPR' LT '1').ZG61Q                       00108200
                    AIF   ('&ZCGPR' LE '12').ZG61R                      00108300
.ZG61Q              ANOP  ,                                             00108400
&ZMS                SETC  '"MF='      *KGPRA* MNOTE                     00108500
&ZMS                SETC  '&ZMS.&MF"'                                   00108600
&ZMS                SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'     00108700
                    MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'              00108800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00108900
.ZG61R              ANOP  ,                                             00109000
.*-------------------------------------------------------------------   00109100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00109200
&XMFSCK             SETC  ''          INITIALIZE XVARIABLE              00109300
.ZG65A   AIF   ('&MF(3)' NE 'COMPLETE').ZG66A                           00109400
&XMFSCK             SETC  'COMPLETE'  SET KEYWORD                       00109500
.*-------------------------------------------------------------------   00109600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00109700
.ZG66A              AIF   (K'&XMFSCK GT 0).ZG66C  KEYWORD               00109800
                    AIF   (K'&MF(3) LE 0).ZG66B                         00109900
&ZMS                SETC  '"MF='      *KUKWA* MNOTE                     00110000
&ZMS                SETC  '&ZMS.&MF"'                                   00110100
&ZMS                SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '     00110200
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00110300
&ZMS                SETC  '&ZMS "COMPLETE".'    VALID KEYWORD           00110400
                    MNOTE 8,' &ZMS '                                    00110500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00110600
.ZG66B              ANOP  ,                                             00110700
&XMFSCK             SETC  'COMPLETE'  SET DEFAULT KEYWORD               00110800
.ZG66C              ANOP  ,                                             00110900
&ZXMFSCK            SETC  'INPUT'     SET IN/OUTPUT                     00111000
.*------------------------------------------------------------------    00111100
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00111200
.ZG67               ANOP  ,                                             00111300
&ZXMF               SETC  'INPUT'     SET IN/OUTPUT                     00111400
                    AIF   (K'&XMF GT 0).ZG67E   VALID ARG               00111500
                    AIF   (T'&MF EQ 'O').ZG67D  OMITTED                 00111600
&ZASYSLNDX          SETA  0                                             00111700
.ZG67A              ANOP  ,           POSITIONAL MACRO KEY              00111800
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00111900
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG67C              00112000
&ZTLC               SETC 'MF'                                           00112100
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG67A     00112200
.ZG67B              ANOP  ,                                             00112300
&ZXMF               SETC  ''          RESET IN/OUTPUT                   00112400
&ZMS                SETC  'THE "MF" KEY'        *KOPTA* MNOTE           00112500
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00112600
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00112700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00112800
                    AGO   .ZG67E                                        00112900
.ZG67C              ANOP  ,                                             00113000
&ZXMF               SETC  ''          RESET IN/OUTPUT                   00113100
&ZMS                SETC  '"MF='      *KUKWA* MNOTE                     00113200
&ZMS                SETC  '&ZMS.&MF"'                                   00113300
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00113400
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00113500
&ZMS                SETC  '&ZMS "S",'           VALID KEYWORD           00113600
&ZMS                SETC  '&ZMS "L",'           VALID KEYWORD           00113700
&ZMS                SETC  '&ZMS OR "E".'        VALID KEYWORD           00113800
                    MNOTE 8,' &ZMS '                                    00113900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00114000
                    AGO   .ZG67E                                        00114100
.ZG67D              ANOP  ,                                             00114200
&XMF                SETC  'S'         SET DEFAULT KEYWORD               00114300
&XMFSCK             SETC  'COMPLETE'  COMPLETE CHECKING                 00114400
.ZG67E              ANOP  ,                                             00114500
.********************************************************************   00114600
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00114700
.********************************************************************   00114800
                    ACTR  10000                                         00114900
.*-------------------------------------------------------------------   00115000
.***AG.MF03 MF=(SLE)                                                    00115100
                    AIF   ('&XMF' EQ 'L').ZGMFX                         00115200
.*------------------------------------------------------------------    00115300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00115400
&XREQTYPE           SETC  ''          INITIALIZE XVARIABLE              00115500
.*-------------------------------------------------------------------   00115600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00115700
.ZG3                ANOP  ,                                             00115800
                    AIF   (K'&REQTYPE(1) LE 0).ZG3A                     00115900
&ZTLC               SETC 'SINGLE'                                       00116000
                    AIF   ('&REQTYPE(1)' NE '&ZTLC').ZG7                00116100
&XREQTYPE           SETC  'SINGLE'    SET KEYWORD                       00116200
                    AIF   (N'&REQTYPE LE 1).ZG3A  CK NUM                00116300
&ZMS                SETC  '"REQTYPE='           *KPOSA* MNOTE           00116400
&ZMS                SETC  '&ZMS.&REQTYPE"'                              00116500
&ZMS                SETC  '&ZMS "REQTYPE"'                              00116600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00116700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00116800
.ZG3A               ANOP  ,                                             00116900
.*------------------------------------------------------------------    00117000
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00117100
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00117200
.ZG3A0              AIF   (K'&AMOUNT LE 0).ZG3A1  OK                    00117300
&ZCVAL              SETC '&ZCVAL AMOUNT'        INCORRECT KEY USED      00117400
.ZG3A1              AIF   (K'&MONTKN_LIST LE 0).ZG3A2  OK               00117500
&ZCVAL              SETC '&ZCVAL MONTKN_LIST'   INCORRECT KEY USED      00117600
.ZG3A2              AIF   (K'&MONTKN_LISTLEN LE 0).ZG3A3  OK            00117700
&ZCVAL              SETC '&ZCVAL MONTKN_LISTLEN'  INCORRECT KEY USED    00117800
.ZG3A3              AIF   (K'&ZCVAL LE 0).ZG3A4  OK                     00117900
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00118000
&ZMS                SETC  '"REQTYPE'  *KMEIA* MNOTE                     00118100
&ZMS                SETC  '&ZMS.=&REQTYPE"'                             00118200
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00118300
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00118400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00118500
.ZG3A4              ANOP  ,                                             00118600
.*----------------------------------------------------------------***   00118700
.***AG.KXVAR05 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE KEY                00118800
                    AIF   (N'&MONTKN LE 1).ZG5A  CK NUM                 00118900
&ZMS                SETC  '"MONTKN='  *KPOSA* MNOTE                     00119000
&ZMS                SETC  '&ZMS.&MONTKN"'                               00119100
&ZMS                SETC  '&ZMS "MONTKN"'                               00119200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00119300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00119400
.ZG5A               ANOP  ,                                             00119500
.*-------------------------------------------------------------------   00119600
.***AG.KXVAR06 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE                    00119700
&ZXMONTKN           SETC  'OUTPUT'    SET IN/OUTPUT                     00119800
&XMONTKN            SETC  '&MONTKN(1)'          SET XVARIABLE           00119900
                    AIF   (N'&MONTKN GT 1).ZG5B  MULTI PARMS            00120000
&XMONTKN            SETC  '&MONTKN'   SET XVARIABLE                     00120100
.ZG5B               AIF   (K'&MONTKN(1) GT 0).ZG5C                      00120200
&ZXMONTKN           SETC  ''          RESET IN/OUTPUT                   00120300
&ZMS                SETC  'WHEN "SINGLE" IS SPECIFIED'  *KRQDA*         00120400
&ZMS                SETC  '&ZMS , "MONTKN" KEY AND ITS ARGUMENT'        00120500
                    MNOTE 8,' &ZMS ARE REQUIRED.'                       00120600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00120700
.ZG5C               ANOP  ,                                             00120800
.*-------------------------------------------------------------------   00120900
.***AG.KCK02 NAME, OPT RQD OUTPUT, KEYS -GPR OUT OF RANGE               00121000
                    AIF   (K'&ZXMONTKN LE 0).ZG5R  NOT I/O              00121100
                    AIF   ('&XMONTKN'(1,1) NE '(').ZG5R                 00121200
&ZCGPR              SETC  '&XMONTKN'(2,K'&XMONTKN-2)                    00121300
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                   00121400
                    AIF   (K'&ZCGPR GT 2).ZG5Q                          00121500
                    AIF   ('&ZCGPR' EQ '0').ZG5Q                        00121600
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00121700
                    AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME      00121800
.ZG5P               ANOP  ,                                             00121900
                    AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC           00122000
                    AIF   ('&ZCGPR' LT '2').ZG5Q                        00122100
                    AIF   ('&ZCGPR' LE '12').ZG5R                       00122200
.ZG5Q               ANOP  ,                                             00122300
&ZMS                SETC  '"MONTKN='  *KGPRA* MNOTE                     00122400
&ZMS                SETC  '&ZMS.&MONTKN"'                               00122500
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00122600
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00122700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00122800
.ZG5R               ANOP  ,                                             00122900
.*-------------------------------------------------------------------   00123000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00123100
.ZG7                ANOP  ,                                             00123200
&ZTLC               SETC 'MULTIPLE'                                     00123300
                    AIF   ('&REQTYPE(1)' NE '&ZTLC').ZG17               00123400
&XREQTYPE           SETC  'MULTIPLE'  SET KEYWORD                       00123500
                    AIF   (N'&REQTYPE LE 1).ZG7A  CK NUM                00123600
&ZMS                SETC  '"REQTYPE='           *KPOSA* MNOTE           00123700
&ZMS                SETC  '&ZMS.&REQTYPE"'                              00123800
&ZMS                SETC  '&ZMS "REQTYPE"'                              00123900
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00124000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00124100
.ZG7A               ANOP  ,                                             00124200
.*------------------------------------------------------------------    00124300
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00124400
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00124500
.ZG7A0              AIF   (K'&MONTKN LE 0).ZG7A1  OK                    00124600
&ZCVAL              SETC '&ZCVAL MONTKN'        INCORRECT KEY USED      00124700
.ZG7A1              AIF   (K'&ZCVAL LE 0).ZG7A2  OK                     00124800
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00124900
&ZMS                SETC  '"REQTYPE'  *KMEIA* MNOTE                     00125000
&ZMS                SETC  '&ZMS.=&REQTYPE"'                             00125100
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00125200
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00125300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00125400
.ZG7A2              ANOP  ,                                             00125500
.*----------------------------------------------------------------***   00125600
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00125700
                    AIF   (N'&AMOUNT LE 1).ZG9A  CK NUM                 00125800
&ZMS                SETC  '"AMOUNT='  *KPOSA* MNOTE                     00125900
&ZMS                SETC  '&ZMS.&AMOUNT"'                               00126000
&ZMS                SETC  '&ZMS "AMOUNT"'                               00126100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00126200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00126300
.ZG9A               ANOP  ,                                             00126400
.*-------------------------------------------------------------------   00126500
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00126600
&ZXAMOUNT           SETC  'INPUT'     SET IN/OUTPUT                     00126700
&XAMOUNT            SETC  '&AMOUNT(1)'          SET XVARIABLE           00126800
                    AIF   (N'&AMOUNT GT 1).ZG9B  MULTI PARMS            00126900
&XAMOUNT            SETC  '&AMOUNT'   SET XVARIABLE                     00127000
.ZG9B               AIF   (K'&AMOUNT(1) GT 0).ZG9C                      00127100
&ZXAMOUNT           SETC  ''          RESET IN/OUTPUT                   00127200
&ZMS                SETC  ' '         *KRQDA*                           00127300
&ZMS                SETC  '&ZMS "AMOUNT" KEY AND ITS ARGUMENT'          00127400
                    MNOTE 8,' &ZMS ARE REQUIRED.'                       00127500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00127600
.ZG9C               ANOP  ,                                             00127700
.*-------------------------------------------------------------------   00127800
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00127900
                    AIF   (K'&ZXAMOUNT LE 0).ZG9R  NOT I/O              00128000
                    AIF   ('&XAMOUNT'(1,1) NE '(').ZG9R                 00128100
&ZCGPR              SETC  '&XAMOUNT'(2,K'&XAMOUNT-2)                    00128200
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG9P                   00128300
                    AIF   (K'&ZCGPR GT 2).ZG9Q                          00128400
                    AIF   ('&ZCGPR' EQ '0').ZG9Q                        00128500
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00128600
                    AIF   (T'&ZCGPR NE 'N').ZG9Q  INVALID REG NAME      00128700
.ZG9P               ANOP  ,                                             00128800
                    AIF   (T'&ZCGPR NE 'N').ZG9R  NON NUMERIC           00128900
                    AIF   ('&ZCGPR' LT '2').ZG9Q                        00129000
                    AIF   ('&ZCGPR' LE '12').ZG9R                       00129100
.ZG9Q               ANOP  ,                                             00129200
&ZMS                SETC  '"AMOUNT='  *KGPRA* MNOTE                     00129300
&ZMS                SETC  '&ZMS.&AMOUNT"'                               00129400
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00129500
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00129600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00129700
.ZG9R               ANOP  ,                                             00129800
.*----------------------------------------------------------------***   00129900
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00130000
                    AIF   (N'&MONTKN_LIST LE 1).ZG12A  CK NUM           00130100
&ZMS                SETC  '"MONTKN_LIST='       *KPOSA* MNOTE           00130200
&ZMS                SETC  '&ZMS.&MONTKN_LIST"'                          00130300
&ZMS                SETC  '&ZMS "MONTKN_LIST"'                          00130400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00130500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00130600
.ZG12A              ANOP  ,                                             00130700
.*-------------------------------------------------------------------   00130800
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00130900
&ZXMONTKN_LIST      SETC  'INPUT'     SET IN/OUTPUT                     00131000
&XMONTKN_LIST       SETC  '&MONTKN_LIST(1)'     SET XVARIABLE           00131100
                    AIF   (N'&MONTKN_LIST GT 1).ZG12B  MULTI PARMS      00131200
&XMONTKN_LIST       SETC  '&MONTKN_LIST'        SET XVARIABLE           00131300
.ZG12B              AIF   (K'&MONTKN_LIST(1) GT 0).ZG12C                00131400
&ZXMONTKN_LIST      SETC  ''          RESET IN/OUTPUT                   00131500
&ZMS                SETC  ' '         *KRQDA*                           00131600
&ZMS                SETC  '&ZMS "MONTKN_LIST" KEY AND ITS ARGUMENT'     00131700
                    MNOTE 8,' &ZMS ARE REQUIRED.'                       00131800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00131900
.ZG12C              ANOP  ,                                             00132000
.*-------------------------------------------------------------------   00132100
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00132200
                    AIF   (K'&ZXMONTKN_LIST LE 0).ZG12R  NOT I/O        00132300
                    AIF   ('&XMONTKN_LIST'(1,1) NE '(').ZG12R           00132400
&ZCGPR              SETC  '&XMONTKN_LIST'(2,K'&XMONTKN_LIST-2)          00132500
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG12P                  00132600
                    AIF   (K'&ZCGPR GT 2).ZG12Q                         00132700
                    AIF   ('&ZCGPR' EQ '0').ZG12Q                       00132800
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00132900
                    AIF   (T'&ZCGPR NE 'N').ZG12Q  INVALID REG NAME     00133000
.ZG12P              ANOP  ,                                             00133100
                    AIF   (T'&ZCGPR NE 'N').ZG12R  NON NUMERIC          00133200
                    AIF   ('&ZCGPR' LT '2').ZG12Q                       00133300
                    AIF   ('&ZCGPR' LE '12').ZG12R                      00133400
.ZG12Q              ANOP  ,                                             00133500
&ZMS                SETC  '"MONTKN_LIST='       *KGPRA* MNOTE           00133600
&ZMS                SETC  '&ZMS.&MONTKN_LIST"'                          00133700
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00133800
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00133900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00134000
.ZG12R              ANOP  ,                                             00134100
.*----------------------------------------------------------------***   00134200
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00134300
                    AIF   (N'&MONTKN_LISTLEN LE 1).ZG15A  CK NUM        00134400
&ZMS                SETC  '"MONTKN_LISTLEN='    *KPOSA* MNOTE           00134500
&ZMS                SETC  '&ZMS.&MONTKN_LISTLEN"'                       00134600
&ZMS                SETC  '&ZMS "MONTKN_LISTLEN"'                       00134700
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00134800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00134900
.ZG15A              ANOP  ,                                             00135000
.*-------------------------------------------------------------------   00135100
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00135200
&ZXMONTKN_LISTLEN   SETC  'INPUT'     SET IN/OUTPUT                     00135300
&XMONTKN_LISTLEN    SETC  '&MONTKN_LISTLEN(1)'  SET XVARIABLE           00135400
                    AIF   (N'&MONTKN_LISTLEN GT 1).ZG15B  MULTI PARMS   00135500
&XMONTKN_LISTLEN    SETC  '&MONTKN_LISTLEN'     SET XVARIABLE           00135600
.ZG15B              AIF   (K'&MONTKN_LISTLEN(1) GT 0).ZG15C             00135700
&ZXMONTKN_LISTLEN   SETC  ''          RESET IN/OUTPUT                   00135800
&ZMS                SETC  ' '         *KRQDA*                           00135900
&ZMS                SETC  '&ZMS "MONTKN_LISTLEN" KEY AND ITS ARGUMENT'  00136000
                    MNOTE 8,' &ZMS ARE REQUIRED.'                       00136100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00136200
.ZG15C              ANOP  ,                                             00136300
.*-------------------------------------------------------------------   00136400
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00136500
                    AIF   (K'&ZXMONTKN_LISTLEN LE 0).ZG15R  NOT I/O     00136600
                    AIF   ('&XMONTKN_LISTLEN'(1,1) NE '(').ZG15R        00136700
&ZCGPR              SETC  '&XMONTKN_LISTLEN'(2,K'&XMONTKN_LISTLEN-2)    00136800
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG15P                  00136900
                    AIF   (K'&ZCGPR GT 2).ZG15Q                         00137000
                    AIF   ('&ZCGPR' EQ '0').ZG15Q                       00137100
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00137200
                    AIF   (T'&ZCGPR NE 'N').ZG15Q  INVALID REG NAME     00137300
.ZG15P              ANOP  ,                                             00137400
                    AIF   (T'&ZCGPR NE 'N').ZG15R  NON NUMERIC          00137500
                    AIF   ('&ZCGPR' LT '2').ZG15Q                       00137600
                    AIF   ('&ZCGPR' LE '12').ZG15R                      00137700
.ZG15Q              ANOP  ,                                             00137800
&ZMS                SETC  '"MONTKN_LISTLEN='    *KGPRA* MNOTE           00137900
&ZMS                SETC  '&ZMS.&MONTKN_LISTLEN"'                       00138000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00138100
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00138200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00138300
.ZG15R              ANOP  ,                                             00138400
.*------------------------------------------------------------------    00138500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00138600
.ZG17               ANOP  ,                                             00138700
&ZXREQTYPE          SETC  'INPUT'     SET IN/OUTPUT                     00138800
                    AIF   (K'&XREQTYPE GT 0).ZG17E  VALID ARG           00138900
                    AIF   (T'&REQTYPE EQ 'O').ZG17D  OMITTED            00139000
&ZASYSLNDX          SETA  0                                             00139100
.ZG17A              ANOP  ,           POSITIONAL MACRO KEY              00139200
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00139300
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG17C              00139400
&ZTLC               SETC 'REQTYPE'                                      00139500
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG17A     00139600
.ZG17B              ANOP  ,                                             00139700
&ZXREQTYPE          SETC  ''          RESET IN/OUTPUT                   00139800
&ZMS                SETC  'THE "REQTYPE" KEY'   *KOPTA* MNOTE           00139900
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00140000
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00140100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00140200
                    AGO   .ZG17E                                        00140300
.ZG17C              ANOP  ,                                             00140400
&ZXREQTYPE          SETC  ''          RESET IN/OUTPUT                   00140500
&ZMS                SETC  '"REQTYPE='           *KUKWA* MNOTE           00140600
&ZMS                SETC  '&ZMS.&REQTYPE"'                              00140700
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00140800
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00140900
&ZMS                SETC  '&ZMS "SINGLE"'       VALID KEYWORD           00141000
&ZMS                SETC  '&ZMS OR "MULTIPLE".'  VALID KEYWORD          00141100
                    MNOTE 8,' &ZMS '                                    00141200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00141300
                    AGO   .ZG17E                                        00141400
.ZG17D              ANOP  ,                                             00141500
&XREQTYPE           SETC  'SINGLE'    SET DEFAULT KEYWORD               00141600
.ZG17E              ANOP  ,                                             00141700
.*------------------------------------------------------------------    00141800
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00141900
&XSUBSYSP           SETC  ''          INITIALIZE XVARIABLE              00142000
.*-------------------------------------------------------------------   00142100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00142200
.ZG20               ANOP  ,                                             00142300
                    AIF   (K'&SUBSYSP(1) LE 0).ZG20A                    00142400
&ZTLC               SETC 'CONNECT'                                      00142500
                    AIF   ('&SUBSYSP(1)' NE '&ZTLC').ZG24               00142600
&XSUBSYSP           SETC  'CONNECT'   SET KEYWORD                       00142700
                    AIF   (N'&SUBSYSP LE 1).ZG20A  CK NUM               00142800
&ZMS                SETC  '"SUBSYSP='           *KPOSA* MNOTE           00142900
&ZMS                SETC  '&ZMS.&SUBSYSP"'                              00143000
&ZMS                SETC  '&ZMS "SUBSYSP"'                              00143100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00143200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00143300
.ZG20A              ANOP  ,                                             00143400
.*------------------------------------------------------------------    00143500
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00143600
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00143700
.ZG20A0             AIF   (K'&SUBSYS LE 0).ZG20A1  OK                   00143800
&ZCVAL              SETC '&ZCVAL SUBSYS'        INCORRECT KEY USED      00143900
.ZG20A1             AIF   (K'&SUBSYSNM LE 0).ZG20A2  OK                 00144000
&ZCVAL              SETC '&ZCVAL SUBSYSNM'      INCORRECT KEY USED      00144100
.ZG20A2             AIF   (K'&ZCVAL LE 0).ZG20A3  OK                    00144200
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00144300
&ZMS                SETC  '"SUBSYSP'  *KMEIA* MNOTE                     00144400
&ZMS                SETC  '&ZMS.=&SUBSYSP"'                             00144500
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00144600
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00144700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00144800
.ZG20A3             ANOP  ,                                             00144900
.*----------------------------------------------------------------***   00145000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00145100
                    AIF   (N'&CONNTKN LE 1).ZG22A  CK NUM               00145200
&ZMS                SETC  '"CONNTKN='           *KPOSA* MNOTE           00145300
&ZMS                SETC  '&ZMS.&CONNTKN"'                              00145400
&ZMS                SETC  '&ZMS "CONNTKN"'                              00145500
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00145600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00145700
.ZG22A              ANOP  ,                                             00145800
.*-------------------------------------------------------------------   00145900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00146000
&ZXCONNTKN          SETC  'INPUT'     SET IN/OUTPUT                     00146100
&XCONNTKN           SETC  '&CONNTKN(1)'         SET XVARIABLE           00146200
                    AIF   (N'&CONNTKN GT 1).ZG22B  MULTI PARMS          00146300
&XCONNTKN           SETC  '&CONNTKN'  SET XVARIABLE                     00146400
.ZG22B              AIF   (K'&CONNTKN(1) GT 0).ZG22C                    00146500
&ZXCONNTKN          SETC  ''          RESET IN/OUTPUT                   00146600
&ZMS                SETC  ' '         *KRQDA*                           00146700
&ZMS                SETC  '&ZMS "CONNTKN" KEY AND ITS ARGUMENT'         00146800
                    MNOTE 8,' &ZMS ARE REQUIRED.'                       00146900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00147000
.ZG22C              ANOP  ,                                             00147100
.*-------------------------------------------------------------------   00147200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00147300
                    AIF   (K'&ZXCONNTKN LE 0).ZG22R  NOT I/O            00147400
                    AIF   ('&XCONNTKN'(1,1) NE '(').ZG22R               00147500
&ZCGPR              SETC  '&XCONNTKN'(2,K'&XCONNTKN-2)                  00147600
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                  00147700
                    AIF   (K'&ZCGPR GT 2).ZG22Q                         00147800
                    AIF   ('&ZCGPR' EQ '0').ZG22Q                       00147900
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00148000
                    AIF   (T'&ZCGPR NE 'N').ZG22Q  INVALID REG NAME     00148100
.ZG22P              ANOP  ,                                             00148200
                    AIF   (T'&ZCGPR NE 'N').ZG22R  NON NUMERIC          00148300
                    AIF   ('&ZCGPR' LT '2').ZG22Q                       00148400
                    AIF   ('&ZCGPR' LE '12').ZG22R                      00148500
.ZG22Q              ANOP  ,                                             00148600
&ZMS                SETC  '"CONNTKN='           *KGPRA* MNOTE           00148700
&ZMS                SETC  '&ZMS.&CONNTKN"'                              00148800
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00148900
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00149000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00149100
.ZG22R              ANOP  ,                                             00149200
.*-------------------------------------------------------------------   00149300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00149400
.ZG24               ANOP  ,                                             00149500
&ZTLC               SETC 'VALUE'                                        00149600
                    AIF   ('&SUBSYSP(1)' NE '&ZTLC').ZG31               00149700
&XSUBSYSP           SETC  'VALUE'     SET KEYWORD                       00149800
                    AIF   (N'&SUBSYSP LE 1).ZG24A  CK NUM               00149900
&ZMS                SETC  '"SUBSYSP='           *KPOSA* MNOTE           00150000
&ZMS                SETC  '&ZMS.&SUBSYSP"'                              00150100
&ZMS                SETC  '&ZMS "SUBSYSP"'                              00150200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00150300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00150400
.ZG24A              ANOP  ,                                             00150500
.*------------------------------------------------------------------    00150600
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00150700
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00150800
.ZG24A0             AIF   (K'&CONNTKN LE 0).ZG24A1  OK                  00150900
&ZCVAL              SETC '&ZCVAL CONNTKN'       INCORRECT KEY USED      00151000
.ZG24A1             AIF   (K'&ZCVAL LE 0).ZG24A2  OK                    00151100
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00151200
&ZMS                SETC  '"SUBSYSP'  *KMEIA* MNOTE                     00151300
&ZMS                SETC  '&ZMS.=&SUBSYSP"'                             00151400
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00151500
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00151600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00151700
.ZG24A2             ANOP  ,                                             00151800
.*----------------------------------------------------------------***   00151900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00152000
                    AIF   (N'&SUBSYS LE 1).ZG26A  CK NUM                00152100
&ZMS                SETC  '"SUBSYS='  *KPOSA* MNOTE                     00152200
&ZMS                SETC  '&ZMS.&SUBSYS"'                               00152300
&ZMS                SETC  '&ZMS "SUBSYS"'                               00152400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00152500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00152600
.ZG26A              ANOP  ,                                             00152700
.*-------------------------------------------------------------------   00152800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00152900
&ZXSUBSYS           SETC  'INPUT'     SET IN/OUTPUT                     00153000
&XSUBSYS            SETC  '&SUBSYS(1)'          SET XVARIABLE           00153100
                    AIF   (N'&SUBSYS GT 1).ZG26B  MULTI PARMS           00153200
&XSUBSYS            SETC  '&SUBSYS'   SET XVARIABLE                     00153300
.ZG26B              AIF   (K'&SUBSYS(1) GT 0).ZG26C                     00153400
&ZXSUBSYS           SETC  ''          RESET IN/OUTPUT                   00153500
&ZMS                SETC  ' '         *KRQDA*                           00153600
&ZMS                SETC  '&ZMS "SUBSYS" KEY AND ITS ARGUMENT'          00153700
                    MNOTE 8,' &ZMS ARE REQUIRED.'                       00153800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00153900
.ZG26C              ANOP  ,                                             00154000
.*-------------------------------------------------------------------   00154100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00154200
                    AIF   (K'&ZXSUBSYS LE 0).ZG26R  NOT I/O             00154300
                    AIF   ('&XSUBSYS'(1,1) NE '(').ZG26R                00154400
&ZCGPR              SETC  '&XSUBSYS'(2,K'&XSUBSYS-2)                    00154500
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                  00154600
                    AIF   (K'&ZCGPR GT 2).ZG26Q                         00154700
                    AIF   ('&ZCGPR' EQ '0').ZG26Q                       00154800
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00154900
                    AIF   (T'&ZCGPR NE 'N').ZG26Q  INVALID REG NAME     00155000
.ZG26P              ANOP  ,                                             00155100
                    AIF   (T'&ZCGPR NE 'N').ZG26R  NON NUMERIC          00155200
                    AIF   ('&ZCGPR' LT '2').ZG26Q                       00155300
                    AIF   ('&ZCGPR' LE '12').ZG26R                      00155400
.ZG26Q              ANOP  ,                                             00155500
&ZMS                SETC  '"SUBSYS='  *KGPRA* MNOTE                     00155600
&ZMS                SETC  '&ZMS.&SUBSYS"'                               00155700
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00155800
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00155900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00156000
.ZG26R              ANOP  ,                                             00156100
.*----------------------------------------------------------------***   00156200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00156300
                    AIF   (N'&SUBSYSNM LE 1).ZG29A  CK NUM              00156400
&ZMS                SETC  '"SUBSYSNM='          *KPOSA* MNOTE           00156500
&ZMS                SETC  '&ZMS.&SUBSYSNM"'                             00156600
&ZMS                SETC  '&ZMS "SUBSYSNM"'                             00156700
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00156800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00156900
.ZG29A              ANOP  ,                                             00157000
.*-------------------------------------------------------------------   00157100
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00157200
&ZXSUBSYSNM         SETC  'INPUT'     SET IN/OUTPUT                     00157300
&XSUBSYSNM          SETC  '&SUBSYSNM(1)'        SET XVARIABLE           00157400
                    AIF   (N'&SUBSYSNM GT 1).ZG29B  MULTI PARMS         00157500
&XSUBSYSNM          SETC  '&SUBSYSNM'           SET XVARIABLE           00157600
.ZG29B              AIF   (K'&SUBSYSNM(1) GT 0).ZG29C                   00157700
&ZXSUBSYSNM         SETC  ''          RESET IN/OUTPUT                   00157800
&ZMS                SETC  ' '         *KRQDA*                           00157900
&ZMS                SETC  '&ZMS "SUBSYSNM" KEY AND ITS ARGUMENT'        00158000
                    MNOTE 8,' &ZMS ARE REQUIRED.'                       00158100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00158200
.ZG29C              ANOP  ,                                             00158300
.*-------------------------------------------------------------------   00158400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00158500
                    AIF   (K'&ZXSUBSYSNM LE 0).ZG29R  NOT I/O           00158600
                    AIF   ('&XSUBSYSNM'(1,1) NE '(').ZG29R              00158700
&ZCGPR              SETC  '&XSUBSYSNM'(2,K'&XSUBSYSNM-2)                00158800
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                  00158900
                    AIF   (K'&ZCGPR GT 2).ZG29Q                         00159000
                    AIF   ('&ZCGPR' EQ '0').ZG29Q                       00159100
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00159200
                    AIF   (T'&ZCGPR NE 'N').ZG29Q  INVALID REG NAME     00159300
.ZG29P              ANOP  ,                                             00159400
                    AIF   (T'&ZCGPR NE 'N').ZG29R  NON NUMERIC          00159500
                    AIF   ('&ZCGPR' LT '2').ZG29Q                       00159600
                    AIF   ('&ZCGPR' LE '12').ZG29R                      00159700
.ZG29Q              ANOP  ,                                             00159800
&ZMS                SETC  '"SUBSYSNM='          *KGPRA* MNOTE           00159900
&ZMS                SETC  '&ZMS.&SUBSYSNM"'                             00160000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00160100
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00160200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00160300
.ZG29R              ANOP  ,                                             00160400
.*------------------------------------------------------------------    00160500
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00160600
.ZG31               ANOP  ,                                             00160700
&ZXSUBSYSP          SETC  'INPUT'     SET IN/OUTPUT                     00160800
                    AIF   (K'&XSUBSYSP GT 0).ZG31E  VALID ARG           00160900
                    AIF   (T'&SUBSYSP EQ 'O').ZG31D  OMITTED            00161000
&ZASYSLNDX          SETA  0                                             00161100
.ZG31A              ANOP  ,           POSITIONAL MACRO KEY              00161200
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00161300
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG31C              00161400
&ZTLC               SETC 'SUBSYSP'                                      00161500
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG31A     00161600
.ZG31B              ANOP  ,                                             00161700
&ZXSUBSYSP          SETC  ''          RESET IN/OUTPUT                   00161800
&ZMS                SETC  'THE "SUBSYSP" KEY'   *KOPTA* MNOTE           00161900
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00162000
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00162100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00162200
                    AGO   .ZG31E                                        00162300
.ZG31C              ANOP  ,                                             00162400
&ZXSUBSYSP          SETC  ''          RESET IN/OUTPUT                   00162500
&ZMS                SETC  '"SUBSYSP='           *KUKWA* MNOTE           00162600
&ZMS                SETC  '&ZMS.&SUBSYSP"'                              00162700
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00162800
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00162900
&ZMS                SETC  '&ZMS "CONNECT"'      VALID KEYWORD           00163000
&ZMS                SETC  '&ZMS OR "VALUE".'    VALID KEYWORD           00163100
                    MNOTE 8,' &ZMS '                                    00163200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00163300
                    AGO   .ZG31E                                        00163400
.ZG31D              ANOP  ,                                             00163500
&XSUBSYSP           SETC  'CONNECT'   SET DEFAULT KEYWORD               00163600
.ZG31E              ANOP  ,                                             00163700
.*------------------------------------------------------------------    00163800
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00163900
                    AIF   (K'&SUBSYSP(1) GT 0).ZG31F  PARM              00164000
&XSUBSYSP           SETC  ''          ENSURE NULL KEYWORD               00164100
&ZXSUBSYSP          SETC  ''          RESET IN/OUTPUT                   00164200
&ZMS                SETC  'THE'                                         00164300
&ZMS                SETC  '&ZMS "SUBSYSP" KEY AND ITS ARGUMENT'         00164400
&ZMS                SETC  '&ZMS ARE REQUIRED.'                          00164500
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00164600
&ZMS                SETC  '&ZMS "CONNECT"'      VALID KEYWORD           00164700
&ZMS                SETC  '&ZMS OR "VALUE".'    VALID KEYWORD           00164800
                    MNOTE 8,' &ZMS '                                    00164900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00165000
.ZG31F              ANOP  ,                                             00165100
.*------------------------------------------------------------------    00165200
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00165300
&XMONTKNKEYP        SETC  ''          INITIALIZE XVARIABLE              00165400
.*-------------------------------------------------------------------   00165500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00165600
.ZG34               ANOP  ,                                             00165700
                    AIF   (K'&MONTKNKEYP(1) LE 0).ZG34A                 00165800
&ZTLC               SETC 'VALUE'                                        00165900
                    AIF   ('&MONTKNKEYP(1)' NE '&ZTLC').ZG38            00166000
&XMONTKNKEYP        SETC  'VALUE'     SET KEYWORD                       00166100
                    AIF   (N'&MONTKNKEYP LE 1).ZG34A  CK NUM            00166200
&ZMS                SETC  '"MONTKNKEYP='        *KPOSA* MNOTE           00166300
&ZMS                SETC  '&ZMS.&MONTKNKEYP"'                           00166400
&ZMS                SETC  '&ZMS "MONTKNKEYP"'                           00166500
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00166600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00166700
.ZG34A              ANOP  ,                                             00166800
.*----------------------------------------------------------------***   00166900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00167000
                    AIF   (N'&MONTKNKEY LE 1).ZG36A  CK NUM             00167100
&ZMS                SETC  '"MONTKNKEY='         *KPOSA* MNOTE           00167200
&ZMS                SETC  '&ZMS.&MONTKNKEY"'                            00167300
&ZMS                SETC  '&ZMS "MONTKNKEY"'                            00167400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00167500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00167600
.ZG36A              ANOP  ,                                             00167700
.*-------------------------------------------------------------------   00167800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00167900
&ZXMONTKNKEY        SETC  'INPUT'     SET IN/OUTPUT                     00168000
&XMONTKNKEY         SETC  '&MONTKNKEY(1)'       SET XVARIABLE           00168100
                    AIF   (N'&MONTKNKEY GT 1).ZG36B  MULTI PARMS        00168200
&XMONTKNKEY         SETC  '&MONTKNKEY'          SET XVARIABLE           00168300
.ZG36B              AIF   (K'&MONTKNKEY(1) GT 0).ZG36C                  00168400
&ZXMONTKNKEY        SETC  ''          RESET IN/OUTPUT                   00168500
&ZMS                SETC  ' '         *KRQDA*                           00168600
&ZMS                SETC  '&ZMS "MONTKNKEY" KEY AND ITS ARGUMENT'       00168700
                    MNOTE 8,' &ZMS ARE REQUIRED.'                       00168800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00168900
.ZG36C              ANOP  ,                                             00169000
.*-------------------------------------------------------------------   00169100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00169200
                    AIF   (K'&ZXMONTKNKEY LE 0).ZG36R  NOT I/O          00169300
                    AIF   ('&XMONTKNKEY'(1,1) NE '(').ZG36R             00169400
&ZCGPR              SETC  '&XMONTKNKEY'(2,K'&XMONTKNKEY-2)              00169500
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG36P                  00169600
                    AIF   (K'&ZCGPR GT 2).ZG36Q                         00169700
                    AIF   ('&ZCGPR' EQ '0').ZG36Q                       00169800
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00169900
                    AIF   (T'&ZCGPR NE 'N').ZG36Q  INVALID REG NAME     00170000
.ZG36P              ANOP  ,                                             00170100
                    AIF   (T'&ZCGPR NE 'N').ZG36R  NON NUMERIC          00170200
                    AIF   ('&ZCGPR' LT '2').ZG36Q                       00170300
                    AIF   ('&ZCGPR' LE '12').ZG36R                      00170400
.ZG36Q              ANOP  ,                                             00170500
&ZMS                SETC  '"MONTKNKEY='         *KGPRA* MNOTE           00170600
&ZMS                SETC  '&ZMS.&MONTKNKEY"'                            00170700
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00170800
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00170900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00171000
.ZG36R              ANOP  ,                                             00171100
.*-------------------------------------------------------------------   00171200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00171300
.ZG38               ANOP  ,                                             00171400
&ZTLC               SETC 'PSWKEY'                                       00171500
                    AIF   ('&MONTKNKEYP(1)' NE '&ZTLC').ZG39            00171600
&XMONTKNKEYP        SETC  'PSWKEY'    SET KEYWORD                       00171700
                    AIF   (N'&MONTKNKEYP LE 1).ZG38A  CK NUM            00171800
&ZMS                SETC  '"MONTKNKEYP='        *KPOSA* MNOTE           00171900
&ZMS                SETC  '&ZMS.&MONTKNKEYP"'                           00172000
&ZMS                SETC  '&ZMS "MONTKNKEYP"'                           00172100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00172200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00172300
.ZG38A              ANOP  ,                                             00172400
.*------------------------------------------------------------------    00172500
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00172600
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00172700
.ZG38A0             AIF   (K'&MONTKNKEY LE 0).ZG38A1  OK                00172800
&ZCVAL              SETC '&ZCVAL MONTKNKEY'     INCORRECT KEY USED      00172900
.ZG38A1             AIF   (K'&ZCVAL LE 0).ZG38A2  OK                    00173000
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00173100
&ZMS                SETC  '"MONTKNKEYP'         *KMEIA* MNOTE           00173200
&ZMS                SETC  '&ZMS.=&MONTKNKEYP"'                          00173300
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00173400
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00173500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00173600
.ZG38A2             ANOP  ,                                             00173700
.*------------------------------------------------------------------    00173800
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00173900
.ZG39               ANOP  ,                                             00174000
&ZXMONTKNKEYP       SETC  'INPUT'     SET IN/OUTPUT                     00174100
                    AIF   (K'&XMONTKNKEYP GT 0).ZG39E  VALID ARG        00174200
                    AIF   (T'&MONTKNKEYP EQ 'O').ZG39D  OMITTED         00174300
&ZASYSLNDX          SETA  0                                             00174400
.ZG39A              ANOP  ,           POSITIONAL MACRO KEY              00174500
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00174600
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG39C              00174700
&ZTLC               SETC 'MONTKNKEYP'                                   00174800
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG39A     00174900
.ZG39B              ANOP  ,                                             00175000
&ZXMONTKNKEYP       SETC  ''          RESET IN/OUTPUT                   00175100
&ZMS                SETC  'THE "MONTKNKEYP" KEY'  *KOPTA* MNOTE         00175200
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00175300
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00175400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00175500
                    AGO   .ZG39E                                        00175600
.ZG39C              ANOP  ,                                             00175700
&ZXMONTKNKEYP       SETC  ''          RESET IN/OUTPUT                   00175800
&ZMS                SETC  '"MONTKNKEYP='        *KUKWA* MNOTE           00175900
&ZMS                SETC  '&ZMS.&MONTKNKEYP"'                           00176000
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00176100
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00176200
&ZMS                SETC  '&ZMS "VALUE"'        VALID KEYWORD           00176300
&ZMS                SETC  '&ZMS OR "PSWKEY".'   VALID KEYWORD           00176400
                    MNOTE 8,' &ZMS '                                    00176500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00176600
                    AGO   .ZG39E                                        00176700
.ZG39D              ANOP  ,                                             00176800
&XMONTKNKEYP        SETC  'VALUE'     SET DEFAULT KEYWORD               00176900
.ZG39E              ANOP  ,                                             00177000
.*------------------------------------------------------------------    00177100
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00177200
                    AIF   (K'&MONTKNKEYP(1) GT 0).ZG39F  PARM           00177300
&XMONTKNKEYP        SETC  ''          ENSURE NULL KEYWORD               00177400
&ZXMONTKNKEYP       SETC  ''          RESET IN/OUTPUT                   00177500
&ZMS                SETC  'THE'                                         00177600
&ZMS                SETC  '&ZMS "MONTKNKEYP" KEY AND ITS ARGUMENT'      00177700
&ZMS                SETC  '&ZMS ARE REQUIRED.'                          00177800
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00177900
&ZMS                SETC  '&ZMS "VALUE"'        VALID KEYWORD           00178000
&ZMS                SETC  '&ZMS OR "PSWKEY".'   VALID KEYWORD           00178100
                    MNOTE 8,' &ZMS '                                    00178200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00178300
.ZG39F              ANOP  ,                                             00178400
.*----------------------------------------------------------------***   00178500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00178600
                    AIF   (N'&RETCODE LE 1).ZG41A  CK NUM               00178700
&ZMS                SETC  '"RETCODE='           *KPOSA* MNOTE           00178800
&ZMS                SETC  '&ZMS.&RETCODE"'                              00178900
&ZMS                SETC  '&ZMS "RETCODE"'                              00179000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00179100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00179200
.ZG41A              ANOP  ,                                             00179300
.*-------------------------------------------------------------------   00179400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00179500
                    AIF   (K'&RETCODE(1) LE 0).ZG41C  NO PARM           00179600
&ZXRETCODE          SETC  'OUTPUT'    SET OUTPUT                        00179700
&XRETCODE           SETC  '&RETCODE(1)'         SET XVARIABLE           00179800
                    AIF   (N'&RETCODE GT 1).ZG41C                       00179900
&XRETCODE           SETC  '&RETCODE'  SET XVARIABLE                     00180000
.ZG41C              ANOP  ,                                             00180100
.*-------------------------------------------------------------------   00180200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00180300
                    AIF   (K'&ZXRETCODE LE 0).ZG41R  NOT I/O            00180400
                    AIF   ('&XRETCODE'(1,1) NE '(').ZG41R               00180500
&ZCGPR              SETC  '&XRETCODE'(2,K'&XRETCODE-2)                  00180600
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG41P                  00180700
                    AIF   (K'&ZCGPR GT 2).ZG41Q                         00180800
                    AIF   ('&ZCGPR' EQ '0').ZG41Q                       00180900
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00181000
                    AIF   (T'&ZCGPR NE 'N').ZG41Q  INVALID REG NAME     00181100
.ZG41P              ANOP  ,                                             00181200
                    AIF   (T'&ZCGPR NE 'N').ZG41R  NON NUMERIC          00181300
                    AIF   ('&ZCGPR' LT '2').ZG41Q                       00181400
                    AIF   ('&ZCGPR' LE '12').ZG41R                      00181500
.ZG41Q              ANOP  ,                                             00181600
&ZMS                SETC  '"RETCODE='           *KGPRA* MNOTE           00181700
&ZMS                SETC  '&ZMS.&RETCODE"'                              00181800
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00181900
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00182000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00182100
.ZG41R              ANOP  ,                                             00182200
.*----------------------------------------------------------------***   00182300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00182400
                    AIF   (N'&RSNCODE LE 1).ZG44A  CK NUM               00182500
&ZMS                SETC  '"RSNCODE='           *KPOSA* MNOTE           00182600
&ZMS                SETC  '&ZMS.&RSNCODE"'                              00182700
&ZMS                SETC  '&ZMS "RSNCODE"'                              00182800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00182900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00183000
.ZG44A              ANOP  ,                                             00183100
.*-------------------------------------------------------------------   00183200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00183300
                    AIF   (K'&RSNCODE(1) LE 0).ZG44C  NO PARM           00183400
&ZXRSNCODE          SETC  'OUTPUT'    SET OUTPUT                        00183500
&XRSNCODE           SETC  '&RSNCODE(1)'         SET XVARIABLE           00183600
                    AIF   (N'&RSNCODE GT 1).ZG44C                       00183700
&XRSNCODE           SETC  '&RSNCODE'  SET XVARIABLE                     00183800
.ZG44C              ANOP  ,                                             00183900
.*-------------------------------------------------------------------   00184000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00184100
                    AIF   (K'&ZXRSNCODE LE 0).ZG44R  NOT I/O            00184200
                    AIF   ('&XRSNCODE'(1,1) NE '(').ZG44R               00184300
&ZCGPR              SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                  00184400
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG44P                  00184500
                    AIF   (K'&ZCGPR GT 2).ZG44Q                         00184600
                    AIF   ('&ZCGPR' EQ '0').ZG44Q                       00184700
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00184800
                    AIF   (T'&ZCGPR NE 'N').ZG44Q  INVALID REG NAME     00184900
.ZG44P              ANOP  ,                                             00185000
                    AIF   (T'&ZCGPR NE 'N').ZG44R  NON NUMERIC          00185100
                    AIF   ('&ZCGPR' LT '2').ZG44Q                       00185200
                    AIF   ('&ZCGPR' LE '12').ZG44R                      00185300
.ZG44Q              ANOP  ,                                             00185400
&ZMS                SETC  '"RSNCODE='           *KGPRA* MNOTE           00185500
&ZMS                SETC  '&ZMS.&RSNCODE"'                              00185600
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00185700
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00185800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00185900
.ZG44R              ANOP  ,                                             00186000
.******************************************************************     00186100
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00186200
.******************************************************************     00186300
                    ACTR  10000                                         00186400
.*----------------------------------------------------------------***   00186500
.***AH.P02 EXTRA POSITIONALS                                            00186600
                    AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS          00186700
                    AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL          00186800
                    AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL      00186900
                    AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL       00187000
.ZGLISTX1           ANOP  ,                                             00187100
&ZCVAL              SETC  ''          ERROR FIELD                       00187200
&ZAWRK              SETA  0           POSITIONAL NUMBER                 00187300
.ZGLIST2            ANOP  ,                                             00187400
&ZAWRK              SETA  &ZAWRK+1    NEXT POSITIONAL                   00187500
                    AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE          00187600
&ZCVAL              SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA               00187700
                    AGO   .ZGLIST2                                      00187800
.*                                                                      00187900
.ZGLIST3            ANOP  ,                                             00188000
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA            00188100
&ZMS                SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE      00188200
&ZMS                SETC  '&ZMS "&ZCVAL"'                               00188300
&ZMS                SETC  '&ZMS CANNOT BE USED.'                        00188400
&ZMS                SETC  '&ZMS NO POSITIONAL ARGUMENTS'                00188500
                    MNOTE 8,' &ZMS ARE ALLOWED.'                        00188600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00188700
.ZGLISTX            ANOP  ,                                             00188800
&ZASYSLNDX          SETA  0                                             00188900
.*-------------------------------------------------------------------   00189000
.***AG.MF04 MF=(SLE)                                                    00189100
.ZGMFX              ANOP  ,           END OF FULL SYNTAX CHECK          00189200
.*******************************************************************    00189300
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00189400
.*******************************************************************    00189500
                    AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED          00189600
.*******************************************************************    00189700
.***AE.01  START OF IWMMCREA MACRO CODE                                 00189800
.*******************************************************************    00189900
                    LCLC  &M0M0001                 NAME                 00190000
&M0M0001            SETC  '&XLABEL'                SET NAME             00190100
                    AIF   (K'&XLABEL NE 0).XLAB2                        00190200
&M0M0001            SETC  'M00M&SYSNDX'            DEFAULT NAME         00190300
.*                                                                      00190400
.XLAB2              ANOP  ,                                             00190500
                    AIF   ('&XMF' EQ 'L').XLAB3                         00190600
&M0M0001 DS    0H                             IWMMCREA-1                00190700
.XLAB3              ANOP  ,                                             00190800
.*******************************************************************    00190900
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00191000
.*******************************************************************    00191100
              PUSH  PRINT                                               00191200
                    AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON    00191300
                    PRINT OFF         ++ PR01                           00191400
                    AGO   .ZPRNTXX                                      00191500
.ZPRINTX            PRINT ON                                            00191600
.ZPRNTXX            ANOP  ,                                             00191700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00191800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00191900
.********************************************************************   00192000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00192100
.********************************************************************   00192200
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00192300
                      LCLA  &ZOPN1         INVOCATION INDEX             00192400
                      LCLC  &ZOPL(4095)    LABEL                        00192500
                      LCLC  &ZOPO(4095)    OPERATION                    00192600
                      LCLC  &ZOPV(4095)    VALUE                        00192700
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00192800
.*                                                                      00192900
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00193000
.******************************************************************     00193100
.***AL.L10 IWMMCREA FMT=LIST MF=S|L PARAMETERS                          00193200
.******************************************************************     00193300
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00193400
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00193500
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00193600
&XMFATTR              SETC  '0D'                                        00193700
.*                                                                      00193800
&ZOPN                 SETA  &ZOPN+1                                     00193900
&ZOPL(&ZOPN)          SETC  ' '                                         00194000
&ZOPO(&ZOPN)          SETC  'B'                                         00194100
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00194200
&ZOPD(&ZOPN)          SETC  '++ IWMMCREA ARG PARMS'                     00194300
.*                                                                      00194400
&ZOPN                 SETA  &ZOPN+1                                     00194500
&ZOPL(&ZOPN)          SETC  ' '                                         00194600
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00194700
&ZOPV(&ZOPN)          SETC  '1'                                         00194800
&ZOPD(&ZOPN)          SETC  ' '                                         00194900
.*                                                                      00195000
.ZLMFSL2              ANOP  ,                                           00195100
.*-------------------------------------------------------------------   00195200
.***AM.L00  IWMMCREA FMT=LIST name                                      00195300
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00195400
&ZOPN                 SETA &ZOPN+1                                      00195500
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00195600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00195700
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00195800
&ZOPD(&ZOPN)          SETC '++ IWMMCREA NAME'                           00195900
.ZLMFSL2M             ANOP  ,                                           00196000
.*-------------------------------------------------------------------   00196100
.***AM.L01  IWMMCREA FMT=LIST PARAMETERS                                00196200
&ZOPN                 SETA &ZOPN+1                                      00196300
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00196400
&ZOPO(&ZOPN)          SETC 'DS'                                         00196500
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00196600
&ZOPD(&ZOPN)          SETC '++ IWMMCREA PARM LIST'                      00196700
.*-------------------------------------------------------------------   00196800
.***AM.L02 XVERSION XL1                                                 00196900
&ZOPN                 SETA &ZOPN+1                                      00197000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00197100
&ZOPO(&ZOPN)          SETC 'DS'                                         00197200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00197300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00197400
.*-------------------------------------------------------------------   00197500
.***AM.L03 XCREATE_OPTIONS BL.8                                         00197600
&ZOPN                 SETA &ZOPN+1                                      00197700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCREATE_OPTIONS'                  00197800
&ZOPO(&ZOPN)          SETC 'DS'                                         00197900
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00198000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00198100
.*                                                                      00198200
&ZOPN                 SETA  &ZOPN+1                                     00198300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XMONTKNKEYP_VALUE'               00198400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00198500
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00198600
&ZOPD(&ZOPN)          SETC  '++ XMONTKNKEYP.'                           00198700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).VALUE'                        00198800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00198900
.*                                                                      00199000
&ZOPN                 SETA  &ZOPN+1                                     00199100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSUBSYSP_CONNECT'                00199200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00199300
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00199400
&ZOPD(&ZOPN)          SETC  '++ XSUBSYSP.'                              00199500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CONNECT'                      00199600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00199700
.*                                                                      00199800
&ZOPN                 SETA  &ZOPN+1                                     00199900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSUBSYSP_VALUE'                  00200000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00200100
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00200200
&ZOPD(&ZOPN)          SETC  '++ XSUBSYSP.'                              00200300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).VALUE'                        00200400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00200500
.*-------------------------------------------------------------------   00200600
.***AM.L09  XRSV0002 CL1                                                00200700
&ZOPN                 SETA &ZOPN+1                                      00200800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         00200900
&ZOPO(&ZOPN)          SETC 'DS'                                         00201000
&ZOPV(&ZOPN)          SETC 'CL1'                                        00201100
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0002'                      00201200
.*-------------------------------------------------------------------   00201300
.***AM.L09  XMONTKNKEY BL.8                                             00201400
&ZOPN                 SETA &ZOPN+1                                      00201500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKNKEY'                       00201600
&ZOPO(&ZOPN)          SETC 'DS'                                         00201700
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00201800
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKNKEY  XMONTKNKEY'                00201900
.*-------------------------------------------------------------------   00202000
.***AM.L09  XMONTKN BL.32                                               00202100
&ZOPN                 SETA &ZOPN+1                                      00202200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN'                          00202300
&ZOPO(&ZOPN)          SETC 'DS'                                         00202400
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00202500
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN  XMONTKN'                      00202600
.*-------------------------------------------------------------------   00202700
.***AM.L09  XSUBSYS CL4                                                 00202800
&ZOPN                 SETA &ZOPN+1                                      00202900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSUBSYS'                          00203000
&ZOPO(&ZOPN)          SETC 'DS'                                         00203100
&ZOPV(&ZOPN)          SETC 'CL4'                                        00203200
&ZOPD(&ZOPN)          SETC '++ &ZXSUBSYS  XSUBSYS'                      00203300
.*-------------------------------------------------------------------   00203400
.***AM.L09  XSUBSYSNM CL8                                               00203500
&ZOPN                 SETA &ZOPN+1                                      00203600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSUBSYSNM'                        00203700
&ZOPO(&ZOPN)          SETC 'DS'                                         00203800
&ZOPV(&ZOPN)          SETC 'CL8'                                        00203900
&ZOPD(&ZOPN)          SETC '++ &ZXSUBSYSNM  XSUBSYSNM'                  00204000
.*-------------------------------------------------------------------   00204100
.***AM.L09  XCONNTKN BL.32                                              00204200
&ZOPN                 SETA &ZOPN+1                                      00204300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCONNTKN'                         00204400
&ZOPO(&ZOPN)          SETC 'DS'                                         00204500
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00204600
&ZOPD(&ZOPN)          SETC '++ &ZXCONNTKN  XCONNTKN'                    00204700
.*-------------------------------------------------------------------   00204800
.***AM.L09  XRSV0018 CL4                                                00204900
&ZOPN                 SETA &ZOPN+1                                      00205000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0018'                         00205100
&ZOPO(&ZOPN)          SETC 'DS'                                         00205200
&ZOPV(&ZOPN)          SETC 'CL4'                                        00205300
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0018'                      00205400
.*-------------------------------------------------------------------   00205500
.***AM.MLM2 SAVED LOCATION COUNTER                                      00205600
                      AIF  (&XPLISTVER GE 1).ZL12LA                     00205700
                      AIF  ('&ZENDBASEPL' NE '').ZL12LA                 00205800
&ZENDBASEPL           SETC 'YES'                                        00205900
&ZOPN                 SETA &ZOPN+1                                      00206000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00206100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00206200
&ZOPV(&ZOPN)          SETC '*'                                          00206300
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00206400
.ZL12LA               ANOP  ,                                           00206500
.*-------------------------------------------------------------------   00206600
.***AM.LVER1                                                            00206700
                      AIF  (&XPLISTVER LT 1).ZL12L                      00206800
.*-------------------------------------------------------------------   00206900
.*-------------------------------------------------------------------   00207000
.***AM.L09  XPLISTLEN XL2                                               00207100
&ZOPN                 SETA &ZOPN+1                                      00207200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00207300
&ZOPO(&ZOPN)          SETC 'DS'                                         00207400
&ZOPV(&ZOPN)          SETC 'XL2'                                        00207500
&ZOPD(&ZOPN)          SETC '++ INPUT  XPLISTLEN'                        00207600
.*-------------------------------------------------------------------   00207700
.***AM.LVER2                                                            00207800
.ZL12L                ANOP  ,                                           00207900
.*-------------------------------------------------------------------   00208000
.*-------------------------------------------------------------------   00208100
.***AM.LVER1                                                            00208200
                      AIF  (&XPLISTVER LT 1).ZL13L                      00208300
.*-------------------------------------------------------------------   00208400
.*-------------------------------------------------------------------   00208500
.***AM.L03 XREQTYPE_OPTIONS BL.8                                        00208600
&ZOPN                 SETA &ZOPN+1                                      00208700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQTYPE_OPTIONS'                 00208800
&ZOPO(&ZOPN)          SETC 'DS'                                         00208900
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00209000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00209100
.*-------------------------------------------------------------------   00209200
.***AM.LVER2                                                            00209300
.ZL13L                ANOP  ,                                           00209400
.*-------------------------------------------------------------------   00209500
.*-------------------------------------------------------------------   00209600
.***AM.LVER1                                                            00209700
                      AIF  (&XPLISTVER LT 1).ZL14L                      00209800
.*-------------------------------------------------------------------   00209900
.*                                                                      00210000
&ZOPN                 SETA  &ZOPN+1                                     00210100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQTYPE_MULTIPLE'               00210200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00210300
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00210400
&ZOPD(&ZOPN)          SETC  '++ XREQTYPE.'                              00210500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MULTIPLE'                     00210600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00210700
.*-------------------------------------------------------------------   00210800
.***AM.LVER2                                                            00210900
.ZL14L                ANOP  ,                                           00211000
.*-------------------------------------------------------------------   00211100
.*-------------------------------------------------------------------   00211200
.***AM.LVER1                                                            00211300
                      AIF  (&XPLISTVER LT 1).ZL15L                      00211400
.*-------------------------------------------------------------------   00211500
.*-------------------------------------------------------------------   00211600
.***AM.L09  XRSV001F CL1                                                00211700
&ZOPN                 SETA &ZOPN+1                                      00211800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV001F'                         00211900
&ZOPO(&ZOPN)          SETC 'DS'                                         00212000
&ZOPV(&ZOPN)          SETC 'CL1'                                        00212100
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV001F'                      00212200
.*-------------------------------------------------------------------   00212300
.***AM.LVER2                                                            00212400
.ZL15L                ANOP  ,                                           00212500
.*-------------------------------------------------------------------   00212600
.*-------------------------------------------------------------------   00212700
.***AM.LVER1                                                            00212800
                      AIF  (&XPLISTVER LT 1).ZL16L                      00212900
.*-------------------------------------------------------------------   00213000
.*-------------------------------------------------------------------   00213100
.***AM.L09  XAMOUNT F                                                   00213200
&ZOPN                 SETA &ZOPN+1                                      00213300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAMOUNT'                          00213400
&ZOPO(&ZOPN)          SETC 'DS'                                         00213500
&ZOPV(&ZOPN)          SETC 'F'                                          00213600
&ZOPD(&ZOPN)          SETC '++ &ZXAMOUNT  XAMOUNT'                      00213700
.*-------------------------------------------------------------------   00213800
.***AM.LVER2                                                            00213900
.ZL16L                ANOP  ,                                           00214000
.*-------------------------------------------------------------------   00214100
.*-------------------------------------------------------------------   00214200
.***AM.LVER1                                                            00214300
                      AIF  (&XPLISTVER LT 1).ZL17L                      00214400
.*-------------------------------------------------------------------   00214500
.*-------------------------------------------------------------------   00214600
.***AM.L09 ADDR XMONTKN_LIST A                                          00214700
&ZOPN                 SETA &ZOPN+1                                      00214800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN_LIST_ADDR'                00214900
&ZOPO(&ZOPN)          SETC 'DS'                                         00215000
&ZOPV(&ZOPN)          SETC 'A'                                          00215100
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN_LIST ADDR XMONTKN_LIST'        00215200
.*-------------------------------------------------------------------   00215300
.***AM.LVER2                                                            00215400
.ZL17L                ANOP  ,                                           00215500
.*-------------------------------------------------------------------   00215600
.*-------------------------------------------------------------------   00215700
.***AM.LVER1                                                            00215800
                      AIF  (&XPLISTVER LT 1).ZL18L                      00215900
.*-------------------------------------------------------------------   00216000
.*-------------------------------------------------------------------   00216100
.***AM.L09  XMONTKN_LISTLEN F                                           00216200
&ZOPN                 SETA &ZOPN+1                                      00216300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN_LISTLEN'                  00216400
&ZOPO(&ZOPN)          SETC 'DS'                                         00216500
&ZOPV(&ZOPN)          SETC 'F'                                          00216600
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN_LISTLEN  XMONTKN_LISTLEN'      00216700
.*-------------------------------------------------------------------   00216800
.***AM.LVER2                                                            00216900
.ZL18L                ANOP  ,                                           00217000
.*-------------------------------------------------------------------   00217100
.*-------------------------------------------------------------------   00217200
.***AM.L10 END OF IWMMCREA LIST PARAMETERS                              00217300
&ZOPN                 SETA &ZOPN+1                                      00217400
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00217500
&ZOPO(&ZOPN)          SETC 'EQU'                                        00217600
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00217700
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00217800
.*                                                                      00217900
&ZOPN                 SETA &ZOPN+1                                      00218000
&ZOPL(&ZOPN)          SETC ' '                                          00218100
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00218200
&ZOPV(&ZOPN)          SETC '1'                                          00218300
&ZOPD(&ZOPN)          SETC ' '                                          00218400
.*-------------------------------------------------------------------   00218500
.***AL.L12 IWMMCREA FMT=LIST MF=S|L PARAMETERS                          00218600
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00218700
.*                                                                      00218800
&ZOPN                 SETA  &ZOPN+1                                     00218900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00219000
&ZOPO(&ZOPN)          SETC  'DC'                                        00219100
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00219200
&ZOPD(&ZOPN)          SETC  '++ IWMMCREA ARG PARMS'                     00219300
.*                                                                      00219400
.ZLMFSLX              ANOP  ,                                           00219500
.*-------------------------------------------------------------------   00219600
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00219700
&ZPLLEN               SETA 28                                           00219800
.*                                                                      00219900
                      AIF  (&XPLISTVER LT 1).ZLLEN2Z                    00220000
&ZPLLEN               SETA 44                                           00220100
.ZLLEN2Z              ANOP  ,                                           00220200
.*                                                                      00220300
.******************************************************************     00220400
.***AI.L01 IWMMCREA FMT=LIST FILL IN PARAMETER AREA                     00220500
.******************************************************************     00220600
                      ACTR  10000                                       00220700
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00220800
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00220900
&ZCVAL                SETC  'LAE'          XAX MODE                     00221000
.ZIMFXA               ANOP ,                                            00221100
.*                                                                      00221200
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00221300
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00221400
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00221500
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00221600
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00221700
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00221800
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00221900
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00222000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00222100
&ZOPN                 SETA  &ZOPN+1                                     00222200
&ZOPL(&ZOPN)          SETC  ' '                                         00222300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00222400
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00222500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00222600
                      AGO   .ZIMFNX                                     00222700
.*                                                                      00222800
.ZIMFN2               ANOP ,                                            00222900
&ZOPN                 SETA  &ZOPN+1                                     00223000
&ZOPL(&ZOPN)          SETC  ' '                                         00223100
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00223200
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00223300
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00223400
.ZIMFNX               ANOP ,                                            00223500
.********************************************************************   00223600
.***AI.L02 IWMMCREA FMT=LIST INITIALIZE PARAMETER AREA                  00223700
.********************************************************************   00223800
.***AI.L03 MF=(SLE)                                                     00223900
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00224000
.*                                                                      00224100
&ZOPN                 SETA  &ZOPN+1                                     00224200
&ZOPL(&ZOPN)          SETC  ' '                                         00224300
&ZOPO(&ZOPN)          SETC  'XC'                                        00224400
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00224500
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00224600
.ZIMFLX               ANOP  ,                                           00224700
.*-------------------------------------------------------------------   00224800
.***AI.L04A XVERSION XL1                                                00224900
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00225000
&ZOPN                 SETA  &ZOPN+1                                     00225100
&ZOPL(&ZOPN)          SETC  ' '                                         00225200
&ZOPO(&ZOPN)          SETC  'MVI'                                       00225300
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00225400
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00225500
.ZIMFVW               ANOP  ,                                           00225600
.*-------------------------------------------------------------------   00225700
.***AI.L05 XCREATE_OPTIONS BL1                                          00225800
&ZW                   SETC  ''                                          00225900
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00226000
.*-------------------------------------------------------------------   00226100
.***AI.L08 XCREATE_OPTIONS "VALUE"                                      00226200
.***      BL1'1XXXXXXX'                                                 00226300
         AIF   ('&XMONTKNKEYP' NE 'VALUE').ZI3A                         00226400
&ZW                   SETC  '&ZW.1'                                     00226500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00226600
                      AGO   .ZI3C                                       00226700
.*                                                                      00226800
.ZI3A                 ANOP  ,                                           00226900
&ZW                   SETC  '&ZW.0'                                     00227000
.ZI3C                 ANOP  ,                                           00227100
.*-------------------------------------------------------------------   00227200
.***AI.L08 XCREATE_OPTIONS "CONNECT"                                    00227300
.***      BL1'X1XXXXXX'                                                 00227400
         AIF   ('&XSUBSYSP' NE 'CONNECT').ZI4A                          00227500
&ZW                   SETC  '&ZW.1'                                     00227600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00227700
                      AGO   .ZI4C                                       00227800
.*                                                                      00227900
.ZI4A                 ANOP  ,                                           00228000
&ZW                   SETC  '&ZW.0'                                     00228100
.ZI4C                 ANOP  ,                                           00228200
.*-------------------------------------------------------------------   00228300
.***AI.L08 XCREATE_OPTIONS "VALUE"                                      00228400
.***      BL1'XX1XXXXX'                                                 00228500
         AIF   ('&XSUBSYSP' NE 'VALUE').ZI5A                            00228600
&ZW                   SETC  '&ZW.100000'                                00228700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00228800
                      AGO   .ZI5C                                       00228900
.*                                                                      00229000
.ZI5A                 ANOP  ,                                           00229100
&ZW                   SETC  '&ZW.000000'                                00229200
.ZI5C                 ANOP  ,                                           00229300
.*-------------------------------------------------------------------   00229400
.***AI.L11 XCREATE_OPTIONS BL1                                          00229500
                      AIF   ('&ZCLNG' NE 'YES').ZI5E  ALL ZERO BITS     00229600
&ZOPN                 SETA  &ZOPN+1                                     00229700
&ZOPL(&ZOPN)          SETC  ' '                                         00229800
&ZOPO(&ZOPN)          SETC  'OI'                                        00229900
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00230000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00230100
.ZI5E                 ANOP  ,                                           00230200
.*-------------------------------------------------------------------   00230300
.***AI.L25  XMONTKNKEY XL1                                              00230400
                      AIF   ('&ZXMONTKNKEY' EQ '').ZI7E                 00230500
                      AIF   ('&ZXMONTKNKEY' EQ 'OUTPUT').ZI7E           00230600
&ZCGPR                SETC  '&XMONTKNKEY'                               00230700
.*                                                                      00230800
                      AIF   ('&XMONTKNKEY'(1,1) NE '(').ZI7B            00230900
&ZCGPR   SETC  '0('.'&XMONTKNKEY'(2,K'&XMONTKNKEY-2).')'                00231000
                      AGO   .ZI7D                                       00231100
.ZI7B                 ANOP  ,                                           00231200
.*                                                                      00231300
&ZC                   SETC  '&XMONTKNKEY'(1,1)                          00231400
                      AIF   (T'&ZC NE 'N').ZI7D                         00231500
&ZC                   SETC  '&XMONTKNKEY'                               00231600
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI7D                00231700
&ZCGPR                SETC  '=BL1''&XMONTKNKEY'''                       00231800
.*                                                                      00231900
.ZI7D                 ANOP  ,                                           00232000
.*                                                                      00232100
&ZOPN                 SETA  &ZOPN+1                                     00232200
&ZOPL(&ZOPN)          SETC  ' '                                         00232300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00232400
&ZOPV(&ZOPN)          SETC  '3(1,1),&ZCGPR'                             00232500
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKNKEY XMONTKNKEY'                00232600
.*                                                                      00232700
.ZI7E                 ANOP  ,                                           00232800
.*-------------------------------------------------------------------   00232900
.***AI.L25  XSUBSYS CL4                                                 00233000
                      AIF   ('&ZXSUBSYS' EQ '').ZI9E                    00233100
                      AIF   ('&ZXSUBSYS' EQ 'OUTPUT').ZI9E              00233200
&ZCGPR                SETC  '&XSUBSYS'                                  00233300
.*                                                                      00233400
                      AIF   ('&XSUBSYS'(1,1) NE '(').ZI9B               00233500
&ZCGPR   SETC  '0('.'&XSUBSYS'(2,K'&XSUBSYS-2).')'                      00233600
.ZI9B                 ANOP  ,                                           00233700
.*                                                                      00233800
&ZOPN                 SETA  &ZOPN+1                                     00233900
&ZOPL(&ZOPN)          SETC  ' '                                         00234000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00234100
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             00234200
&ZOPD(&ZOPN)          SETC  '++ &ZXSUBSYS XSUBSYS'                      00234300
.*                                                                      00234400
.ZI9E                 ANOP  ,                                           00234500
.*-------------------------------------------------------------------   00234600
.***AI.L25  XSUBSYSNM CL8                                               00234700
                      AIF   ('&ZXSUBSYSNM' EQ '').ZI10E                 00234800
                      AIF   ('&ZXSUBSYSNM' EQ 'OUTPUT').ZI10E           00234900
&ZCGPR                SETC  '&XSUBSYSNM'                                00235000
.*                                                                      00235100
                      AIF   ('&XSUBSYSNM'(1,1) NE '(').ZI10B            00235200
&ZCGPR   SETC  '0('.'&XSUBSYSNM'(2,K'&XSUBSYSNM-2).')'                  00235300
.ZI10B                ANOP  ,                                           00235400
.*                                                                      00235500
&ZOPN                 SETA  &ZOPN+1                                     00235600
&ZOPL(&ZOPN)          SETC  ' '                                         00235700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00235800
&ZOPV(&ZOPN)          SETC  '12(8,1),&ZCGPR'                            00235900
&ZOPD(&ZOPN)          SETC  '++ &ZXSUBSYSNM XSUBSYSNM'                  00236000
.*                                                                      00236100
.ZI10E                ANOP  ,                                           00236200
.*-------------------------------------------------------------------   00236300
.***AI.L25  XCONNTKN XL4                                                00236400
                      AIF   ('&ZXCONNTKN' EQ '').ZI11E                  00236500
                      AIF   ('&ZXCONNTKN' EQ 'OUTPUT').ZI11E            00236600
&ZCGPR                SETC  '&XCONNTKN'                                 00236700
.*                                                                      00236800
                      AIF   ('&XCONNTKN'(1,1) NE '(').ZI11B             00236900
&ZCGPR   SETC  '0('.'&XCONNTKN'(2,K'&XCONNTKN-2).')'                    00237000
                      AGO   .ZI11D                                      00237100
.ZI11B                ANOP  ,                                           00237200
.*                                                                      00237300
&ZC                   SETC  '&XCONNTKN'(1,1)                            00237400
                      AIF   (T'&ZC NE 'N').ZI11D                        00237500
&ZC                   SETC  '&XCONNTKN'                                 00237600
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI11D               00237700
&ZCGPR                SETC  '=BL4''&XCONNTKN'''                         00237800
.*                                                                      00237900
.ZI11D                ANOP  ,                                           00238000
.*                                                                      00238100
&ZOPN                 SETA  &ZOPN+1                                     00238200
&ZOPL(&ZOPN)          SETC  ' '                                         00238300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00238400
&ZOPV(&ZOPN)          SETC  '20(4,1),&ZCGPR'                            00238500
&ZOPD(&ZOPN)          SETC  '++ &ZXCONNTKN XCONNTKN'                    00238600
.*                                                                      00238700
.ZI11E                ANOP  ,                                           00238800
.*-------------------------------------------------------------------   00238900
.***AI.LVER01                                                           00239000
                      AIF  (&XPLISTVER LT 1).ZI13Z                      00239100
.*-------------------------------------------------------------------   00239200
.***AI.L04 XPLISTLEN XL2                                                00239300
&ZOPN                 SETA  &ZOPN+1                                     00239400
&ZOPL(&ZOPN)          SETC  ' '                                         00239500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00239600
&ZOPV(&ZOPN)          SETC  '28(2,1),=AL2(&ZPLLEN)'                     00239700
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00239800
.*-------------------------------------------------------------------   00239900
.***AI.LVER02                                                           00240000
.ZI13Z                ANOP  ,                                           00240100
.*-------------------------------------------------------------------   00240200
.***AI.LVER01                                                           00240300
                      AIF  (&XPLISTVER LT 1).ZI14Z                      00240400
.*-------------------------------------------------------------------   00240500
.***AI.L05 XREQTYPE_OPTIONS BL1                                         00240600
&ZW                   SETC  ''                                          00240700
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00240800
.*-------------------------------------------------------------------   00240900
.***AI.LVER02                                                           00241000
.ZI14Z                ANOP  ,                                           00241100
.*-------------------------------------------------------------------   00241200
.***AI.LVER01                                                           00241300
                      AIF  (&XPLISTVER LT 1).ZI15Z                      00241400
.*-------------------------------------------------------------------   00241500
.***AI.L08 XREQTYPE_OPTIONS "MULTIPLE"                                  00241600
.***      BL1'1XXXXXXX'                                                 00241700
         AIF   ('&XREQTYPE' NE 'MULTIPLE').ZI15A                        00241800
&ZW                   SETC  '&ZW.10000000'                              00241900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00242000
                      AGO   .ZI15C                                      00242100
.*                                                                      00242200
.ZI15A                ANOP  ,                                           00242300
&ZW                   SETC  '&ZW.00000000'                              00242400
.ZI15C                ANOP  ,                                           00242500
.*-------------------------------------------------------------------   00242600
.***AI.L11 XREQTYPE_OPTIONS BL1                                         00242700
                      AIF   ('&ZCLNG' NE 'YES').ZI15E  ALL ZERO BITS    00242800
&ZOPN                 SETA  &ZOPN+1                                     00242900
&ZOPL(&ZOPN)          SETC  ' '                                         00243000
&ZOPO(&ZOPN)          SETC  'OI'                                        00243100
&ZOPV(&ZOPN)          SETC  '30(1),B''&ZW'''                            00243200
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00243300
.ZI15E                ANOP  ,                                           00243400
.*-------------------------------------------------------------------   00243500
.***AI.LVER02                                                           00243600
.ZI15Z                ANOP  ,                                           00243700
.*-------------------------------------------------------------------   00243800
.***AI.LVER01                                                           00243900
                      AIF  (&XPLISTVER LT 1).ZI16Z                      00244000
.*-------------------------------------------------------------------   00244100
.***AI.LVER02                                                           00244200
.ZI16Z                ANOP  ,                                           00244300
.*-------------------------------------------------------------------   00244400
.***AI.LVER01                                                           00244500
                      AIF  (&XPLISTVER LT 1).ZI17Z                      00244600
.*-------------------------------------------------------------------   00244700
.***AI.L25  XAMOUNT F                                                   00244800
                      AIF   ('&ZXAMOUNT' EQ '').ZI17E                   00244900
                      AIF   ('&ZXAMOUNT' EQ 'OUTPUT').ZI17E             00245000
&ZCGPR                SETC  '&XAMOUNT'                                  00245100
.*                                                                      00245200
                      AIF   ('&XAMOUNT'(1,1) NE '(').ZI17B              00245300
&ZCGPR   SETC  '0('.'&XAMOUNT'(2,K'&XAMOUNT-2).')'                      00245400
                      AGO   .ZI17D                                      00245500
.ZI17B                ANOP  ,                                           00245600
.*                                                                      00245700
&ZC                   SETC  '&XAMOUNT'(1,1)                             00245800
                      AIF   (T'&ZC NE 'N').ZI17D                        00245900
&ZC                   SETC  '&XAMOUNT'                                  00246000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI17D               00246100
&ZCGPR                SETC  '=FL4''&XAMOUNT'''                          00246200
.*                                                                      00246300
.ZI17D                ANOP  ,                                           00246400
.*                                                                      00246500
&ZOPN                 SETA  &ZOPN+1                                     00246600
&ZOPL(&ZOPN)          SETC  ' '                                         00246700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00246800
&ZOPV(&ZOPN)          SETC  '32(4,1),&ZCGPR'                            00246900
&ZOPD(&ZOPN)          SETC  '++ &ZXAMOUNT XAMOUNT'                      00247000
.*                                                                      00247100
.ZI17E                ANOP  ,                                           00247200
.*-------------------------------------------------------------------   00247300
.***AI.LVER02                                                           00247400
.ZI17Z                ANOP  ,                                           00247500
.*-------------------------------------------------------------------   00247600
.***AI.LVER01                                                           00247700
                      AIF  (&XPLISTVER LT 1).ZI18Z                      00247800
.*-------------------------------------------------------------------   00247900
.***AI.L19 ADDR XMONTKN_LIST A                                          00248000
                      AIF   ('&ZXMONTKN_LIST' EQ '').ZI18H              00248100
&ZCLNG                SETC  '&XMONTKN_LIST'                             00248200
&ZCGPR                SETC  '14'                                        00248300
         AIF   ('&XMONTKN_LIST'(1,1) EQ '(').ZI18F  IN GPR              00248400
.*                                                                      00248500
&ZOPN                 SETA  &ZOPN+1                                     00248600
&ZOPL(&ZOPN)          SETC  ' '                                         00248700
&ZOPO(&ZOPN)          SETC  'LA'                                        00248800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00248900
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN_LIST XMONTKN_LIST'            00249000
.*                                                                      00249100
                      AGO   .ZI18G                                      00249200
.*                                                                      00249300
.ZI18F                ANOP  ,                                           00249400
&ZCGPR   SETC  '&XMONTKN_LIST'(2,K'&XMONTKN_LIST-2)                     00249500
.*                                                                      00249600
.ZI18G                ANOP  ,                                           00249700
.*                                                                      00249800
&ZOPN                 SETA  &ZOPN+1                                     00249900
&ZOPL(&ZOPN)          SETC  ' '                                         00250000
&ZOPO(&ZOPN)          SETC  'ST'                                        00250100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,36(,1)'                             00250200
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN_LIST XMONTKN_LIST'            00250300
.*                                                                      00250400
.ZI18H                ANOP  ,                                           00250500
.*-------------------------------------------------------------------   00250600
.***AI.LVER02                                                           00250700
.ZI18Z                ANOP  ,                                           00250800
.*-------------------------------------------------------------------   00250900
.***AI.LVER01                                                           00251000
                      AIF  (&XPLISTVER LT 1).ZI19Z                      00251100
.*-------------------------------------------------------------------   00251200
.***AI.L25  XMONTKN_LISTLEN F                                           00251300
                      AIF   ('&ZXMONTKN_LISTLEN' EQ '').ZI19E           00251400
                      AIF   ('&ZXMONTKN_LISTLEN' EQ 'OUTPUT').ZI19E     00251500
&ZCGPR                SETC  '&XMONTKN_LISTLEN'                          00251600
.*                                                                      00251700
                      AIF   ('&XMONTKN_LISTLEN'(1,1) NE '(').ZI19B      00251800
&ZCGPR   SETC  '0('.'&XMONTKN_LISTLEN'(2,K'&XMONTKN_LISTLEN-2).')'      00251900
                      AGO   .ZI19D                                      00252000
.ZI19B                ANOP  ,                                           00252100
.*                                                                      00252200
&ZC                   SETC  '&XMONTKN_LISTLEN'(1,1)                     00252300
                      AIF   (T'&ZC NE 'N').ZI19D                        00252400
&ZC                   SETC  '&XMONTKN_LISTLEN'                          00252500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI19D               00252600
&ZCGPR                SETC  '=FL4''&XMONTKN_LISTLEN'''                  00252700
.*                                                                      00252800
.ZI19D                ANOP  ,                                           00252900
.*                                                                      00253000
&ZOPN                 SETA  &ZOPN+1                                     00253100
&ZOPL(&ZOPN)          SETC  ' '                                         00253200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00253300
&ZOPV(&ZOPN)          SETC  '40(4,1),&ZCGPR'                            00253400
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN_LISTLEN XMONTKN_LISTLEN'      00253500
.*                                                                      00253600
.ZI19E                ANOP  ,                                           00253700
.*-------------------------------------------------------------------   00253800
.***AI.LVER02                                                           00253900
.ZI19Z                ANOP  ,                                           00254000
.*-------------------------------------------------------------------   00254100
&ZOPN1                SETA &ZOPN                                        00254200
.*******************************************************************    00254300
.***  PROCESS IWMMCREA OUTPUT PARAMETERS                                00254400
.*******************************************************************    00254500
                      ACTR  10000                                       00254600
.*------------------------------------------------------------------    00254700
.***AO.L02 XMONTKN XL4                                                  00254800
         AIF   ('&ZXMONTKN' EQ 'OUTPUT').ZO8A  OUTPUT                   00254900
         AIF   ('&ZXMONTKN' NE 'INOUT').ZO8C  INOUT                     00255000
.ZO8A    AIF   ('&XMONTKN'(1,1) NE '(').ZO8B  ADDR IN GPR               00255100
&ZCGPR   SETC  '&XMONTKN'(2,K'&XMONTKN-2)                               00255200
&ZOPN                 SETA  &ZOPN+1                                     00255300
&ZOPL(&ZOPN)          SETC  ' '                                         00255400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00255500
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),4(1)'                          00255600
&ZOPD(&ZOPN)          SETC  '++ XMONTKN XL4'                            00255700
                      AGO   .ZO8C                                       00255800
.*                                                                      00255900
.ZO8B                 ANOP  ,                                           00256000
&ZAWRK   SETA  K'&XMONTKN                                               00256100
         AIF   ('&XMONTKN'(&ZAWRK,1) NE ')').ZO8G                       00256200
&ZN      SETA  2                                                        00256300
.ZO8H    ANOP                                                           00256400
         AIF   (&ZN GE &ZAWRK).ZO8G                                     00256500
         AIF   ('&XMONTKN'(&ZN,1) NE '(').ZO8I                          00256600
&ZC      SETC  '&XMONTKN'(1,&ZN).'4'.','                                00256700
&ZC      SETC  '&ZC'.'&XMONTKN'(&ZN+1,&ZAWRK-&ZN).',4(1)'               00256800
         AGO   .ZO8J                                                    00256900
.ZO8I    ANOP                                                           00257000
&ZN      SETA  &ZN+1                                                    00257100
         AGO   .ZO8H                                                    00257200
.ZO8G    ANOP                                                           00257300
&ZC      SETC  '&XMONTKN.(4),4(1)'                                      00257400
.ZO8J    ANOP                                                           00257500
&ZOPN                 SETA  &ZOPN+1                                     00257600
&ZOPL(&ZOPN)          SETC  ' '                                         00257700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00257800
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00257900
&ZOPD(&ZOPN)          SETC  '++ XMONTKN XL4'                            00258000
.ZO8C                 ANOP  ,                                           00258100
.*******************************************************************    00258200
.***AO.X02  RETURN CODE PROCESSING                                      00258300
.*******************************************************************    00258400
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00258500
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00258600
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00258700
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00258800
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00258900
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00259000
&ZOPN                 SETA  &ZOPN+1                                     00259100
&ZOPL(&ZOPN)          SETC  ' '                                         00259200
&ZOPO(&ZOPN)          SETC  'ST'                                        00259300
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00259400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00259500
                      AGO   .ZMRETX                                     00259600
.*                                                                      00259700
.ZMRET2               ANOP  ,                                           00259800
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00259900
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00260000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00260100
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00260200
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00260300
&ZOPN                 SETA  &ZOPN+1                                     00260400
&ZOPL(&ZOPN)          SETC  ' '                                         00260500
&ZOPO(&ZOPN)          SETC  'LR'                                        00260600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00260700
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00260800
.ZMRETX               ANOP  ,                                           00260900
.*******************************************************************    00261000
.***AO.X03  REASON CODE PROCESSING                                      00261100
.*******************************************************************    00261200
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00261300
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00261400
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00261500
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00261600
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00261700
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00261800
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00261900
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00262000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00262100
&ZOPN                 SETA  &ZOPN+1                                     00262200
&ZOPL(&ZOPN)          SETC  ' '                                         00262300
&ZOPO(&ZOPN)          SETC  'ST'                                        00262400
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00262500
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00262600
                      AGO   .ZMRSNX                                     00262700
.*                                                                      00262800
.ZMRSN2               ANOP  ,                                           00262900
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00263000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00263100
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00263200
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00263300
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00263400
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00263500
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00263600
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00263700
&ZOPN                 SETA  &ZOPN+1                                     00263800
&ZOPL(&ZOPN)          SETC  ' '                                         00263900
&ZOPO(&ZOPN)          SETC  'LR'                                        00264000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00264100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00264200
.ZMRSNX               ANOP  ,                                           00264300
.*******************************************************************    00264400
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00264500
.*******************************************************************    00264600
.ZMFLX                ANOP  ,              MF=L PROCESSING              00264700
.*******************************************************************    00264800
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00264900
.*******************************************************************    00265000
                      ACTR  10000                                       00265100
.*                                                                      00265200
                      LCLA  &ZLC           COLUMN POSITION              00265300
                      LCLA  &ZOPX          LIST TABLE INDEX             00265400
                      LCLC  &ZLL           LABEL                        00265500
                      LCLC  &ZLOP          OPERATION                    00265600
                      LCLC  &ZLV           VALUE                        00265700
                      LCLC  &ZLD           DESCRIPTION                  00265800
.*                                                                      00265900
&ZOPX                 SETA  1                                           00266000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00266100
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00266200
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00266300
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00266400
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00266500
                      AIF   (K'&ZLD LE 0).ZL5                           00266600
&ZLC                  SETA  35             COMMENT COLUMN               00266700
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00266800
&ZLC                  SETA  33             COMMMENT COLUMN              00266900
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00267000
&ZLV                  SETC  '&ZLV'.' '                                  00267100
                      AGO   .ZL3                                        00267200
.*                                                                      00267300
.ZL4                  ANOP  ,                                           00267400
&ZLV                  SETC  '&ZLV'.' '                                  00267500
.ZL5                  ANOP  ,                                           00267600
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00267700
.*                                                                      00267800
&ZLL     &ZLOP &ZLV                                                     00267900
.*                                                                      00268000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00268100
                      AGO   .ZL2           CONTINUE LOOPING             00268200
.*                                                                      00268300
.ZLX                  ANOP  ,                                           00268400
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00268500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00268600
         L     14,16(0,0)              GET CVT ADDRESS                  00268700
         TM    CVTOSLV1-CVT(14),X'40'      TEST FOR WLM PRESENCE        00268800
         BO    WLM&SYSNDX              BRANCH WHEN WLM IS PRESENT       00268900
         LA    0,IWMRSNCODENOWLM       SET REASON CODE = NO WLM         00269000
         LA    15,IWMRETCODEWARNING    SET WARNING RETURN CODE          00269100
         B     END&SYSNDX              BRANCH TO END LABEL              00269200
WLM&SYSNDX DS    0H                    BRANCH LABEL FOR WLM PRESENT     00269300
         L     14,772(14,0)            GET SFT ADDRESS                  00269400
         L     14,380(14,0)            GET LX FOR SERVICE ROUTINE       00269500
         LA    15,1                    GET EX FOR SERVICE ROUTINE       00269600
         OR    14,15                   GET PC NUMBER                    00269700
         PC    0(14)                                                    00269800
END&SYSNDX DS    0H                    END LABEL                        00269900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00270000
.ZLINKX               ANOP  ,                                           00270100
.*******************************************************************    00270200
.***AP.X01  FORMAT GENERATED CODE                                       00270300
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00270400
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00270500
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00270600
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00270700
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00270800
                      AIF   (K'&ZLD LE 0).ZL51                          00270900
&ZLC                  SETA  35             COMMENT COLUMN               00271000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00271100
&ZLC                  SETA  33             COMMENT COLUMN               00271200
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00271300
&ZLV                  SETC  '&ZLV'.' '                                  00271400
                      AGO   .ZL31                                       00271500
.*                                                                      00271600
.ZL41                 ANOP  ,                                           00271700
&ZLV                  SETC  '&ZLV'.' '                                  00271800
.ZL51                 ANOP  ,                                           00271900
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00272000
.*                                                                      00272100
&ZLL     &ZLOP &ZLV                                                     00272200
.*                                                                      00272300
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00272400
                      AGO   .ZL21          CONTINUE LOOPING             00272500
.*                                                                      00272600
.ZLX1                 ANOP  ,                                           00272700
.*******************************************************************    00272800
.***AP.X02  END OF IWMMCREA MACRO                                       00272900
&ZIWMMCREA            SETC  'YES'          SET IWMMCREA USED            00273000
         POP   PRINT                                                    00273100
*                                            IWMMCREA-1                 00273200
         SPACE 1                                                        00273300
.ZLX2                 ANOP  ,                                           00273400
         MEND                                                           00273500
**********************************************************************/ 00273600
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00273700
*%IWMMCREA: MACRO KEYS(REQTYPE,MONTKN,AMOUNT,MONTKN_LIST,               00273800
*                 MONTKN_LISTLEN,SUBSYSP,CONNTKN,SUBSYS,SUBSYSNM,       00273900
*                 MONTKNKEYP,MONTKNKEY,RETCODE,RSNCODE,PLISTVER,MF);    00274000
*  ANS('?'||MACLABEL||' '||'IWMMCREP '||MACLIST||                       00274100
*         ' '||MACKEYS||';') COL(MACLMAR);                              00274200
*%END IWMMCREA;                                                         00274300
