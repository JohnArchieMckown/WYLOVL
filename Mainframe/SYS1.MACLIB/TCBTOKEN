*/*  START OF SPECIFICATIONS ****************************************   00050000
*                                                                       00100000
*01* MACRO NAME:  TCBTOKEN                                              00150000
*                                                                       00200000
*01* PROPRIETARY STATEMENT =                                            00250000
*                                                                       00300000
*     LICENSED MATERIALS - PROPERTY OF IBM                              00500000
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                       00537500
*     5645-001 (C)COPYRIGHT IBM CORP.  1988, 1997                       00575000
*     SEE COPYRIGHT INSTRUCTIONS                                        00612500
*                                                                       00650000
*01* STATUS:  HBB6603                                                   00670000
*                                                                       00690000
*01* EXTERNAL CLASSIFICATION: GUPI                                      00710000
*01* END OF EXTERNAL CLASSIFICATION:                                    00730000
*                                                                       00750000
*01* FUNCTION:                                                          00800000
*     PROVIDE THE INTERFACE TO THE TCBTOKEN SERVICE ROUTINE (IEAVTTKN). 00850000
*                                                                       00900000
*01* OPERATION:                                                         00950000
*     THE TCBTOKEN MACRO PARSES THE KEYWORDS SUPPLIED.  IN THE          01000000
*     EVENT OF AN ERROR, SYNTAX CHECKING WILL ATTEMPT TO CONTINUE       01050000
*     FOR THE REMAINDER OF THE INPUT.  NO DATA WILL BE GENERATED.       01100000
*                                                                       01150000
*     IF NO ERRORS ARE FOUND, DATA IS GENERATED DEPENDING UPON THE      01200000
*     MF FORM SPECIFIED.                                                01250000
*                                                                       01300000
*     IF THE LIST OPTION WAS REQUESTED, TCBTOKEN RESERVES THE STORAGE   01350000
*     FOR THE PARAMETER LIST USED BY IEAVTTKN, THE TCBTOKEN SERVICE     01400000
*     ROUTINE.                                                          01450000
*                                                                       01500000
*     IF THE EXECUTE FORM WAS REQUESTED, A PREVIOUSLY GENERATED         01550000
*     PARAMETER LIST IS FILLED IN WITH THE PROPER KEYWORD VALUES.  A    01600000
*     PC IS THEN DONE TO IEAVTTKN.  UPON RETURN FROM IEAVTTKN,          01650000
*     TCBTOKEN WILL PLACE THE PROPER OUTPUT PARAMETER IN THE            01700000
*     REQUESTED USER AREA.                                              01750000
*                                                                       01800000
*     IF THE MF KEYWORD WAS NOT SPECIFIED, THE STANDARD FORM IS         01850000
*     ASSUMED.  TCBTOKEN BOTH GENERATES AND FILLS IN THE PARAMETER      01900000
*     LIST WITH THE PROPER KEYWORD VALUES.  A PC IS THEN DONE TO        01950000
*     IEAVTTKN.  UPON RETURN FROM IEAVTTKN, TCBTOKEN WILL PLACE THE     02000000
*     PROPER OUTPUT PARAMETER IN THE REQUESTED USER AREA.               02050000
*                                                                       02100000
*01* SYNTAX:                                                            02150000
*                                                                       02200000
*       TCBTOKEN    TYPE=TOTTOKEN                                       02250000
*                                                                       02300000
*                   ,TCB=RX-ADDRESS|(2)-(12)                            02350000
*                                                                       02400000
*                   ,TTOKEN=RX-ADDRESS                                  02450000
*                                                                       02500000
*                       <,STOKEN=RX-ADDRESS>                            02550000
*                       <,ASCB=RX-ADDRESS|(2)-(12)>                     02600000
*                                                                       02650000
*                       <,MF=(E,RX-ADDRESS)|(E,(1)-(12))>               02700000
*                                                                       02750000
*                       <,RELATED=ANY-COMMENT>                          02800000
*                                                                       02850000
*                                                                       02900000
*       TCBTOKEN    TYPE=TOTCB                                          03050000
*                                                                       03100000
*                   ,TCB=RX-ADDRESS|(2)-(12)                            03150000
*                                                                       03200000
*                   ,TTOKEN=RX-ADDRESS                                  03250000
*                                                                       03300000
*                       <,ASCB=RX-ADDRESS|(2)-(12)>                     03316600
*                                                                       03333200
*                       <,MF=(E,RX-ADDRESS)|(E,(1)-(12))>               03350000
*                                                                       03400000
*                       <,RELATED=ANY-COMMENT>                          03450000
*                                                                       03500000
*                                                                       03550000
*       TCBTOKEN    TYPE=JOBSTEP                                        03551800
*                                                                       03553600
*                   ,TTOKEN=RX-ADDRESS                                  03555400
*                                                                       03557200
*                       <,MF=(E,RX-ADDRESS)|(E,(1)-(12))>               03559000
*                                                                       03560800
*                       <,RELATED=ANY-COMMENT>                          03562600
*                                                                       03564400
*                                                                       03566200
*       TCBTOKEN    TYPE=PARENT                                         03568000
*                                                                       03569800
*                   ,TTOKEN=RX-ADDRESS                                  03571600
*                                                                       03573400
*                       <,MF=(E,RX-ADDRESS)|(E,(1)-(12))>               03575200
*                                                                       03577000
*                       <,RELATED=ANY-COMMENT>                          03578800
*                                                                       03580600
*                                                                       03582400
*       TCBTOKEN    TYPE=CURRENT                                        03584200
*                                                                       03586000
*                   ,TTOKEN=RX-ADDRESS                                  03587800
*                                                                       03589600
*                       <,MF=(E,RX-ADDRESS)|(E,(1)-(12))>               03591400
*                                                                       03593200
*                       <,RELATED=ANY-COMMENT>                          03595000
*                                                                       03596800
*                                                                       03600000
*                                                                       03650000
*  LIST FORM OF TCBTOKEN:                                               03700000
*                                                                       03750000
*       TCBTOKEN    MF=L                                                03800000
*                                                                       03850000
*                       <,RELATED=ANY-VALUE>                            03900000
*                                                                       03950000
*                                                                       04000000
*                                                                       04050000
*01* COMPONENT:  SC1CL (TASK MANAGEMENT)                                04100000
*                                                                       04150000
*01* MACLIB:  AMACLIB                                                   04200000
*                                                                       04250000
*01* CHANGE-ACTIVITY:                                                   04300000
*    $L0=DATASPAC   HBB3310  861215  PD16BN:  DATA SPACES               04350000
*    $D1=DCR0017    HBB4410  871113  PD16CU:  ON A TOTCB REQUEST,       04358300
*                                             INCLUDE THE ASCB ADDRESS  04366600
*                                             AS OUTPUT                 04374900
*    $L1=PR410      HBB4410  890403  PD16EJ:  ADD JOBSTEP, PARENT,      04383200
*                                             AND CURRENT OPTIONS       04391500
*    $01=OW12442    HBB4430  950605  PD81XZ:  Support ALET              04394300
*                                             qualified addresses.      04397100
*                                                                       04400000
*** END OF SPECIFICATIONS ******************************************/   04450000
*                                                                       04500000
*/*                                                                     04550000
       MACRO                                                            04600000
&LABL  TCBTOKEN  &TYPE=,  1  TOTTOKEN/TOTCB/JOBSTEP/PARENT/CURRENT     X04650000
               &TCB=,     2                                            X04700000
               &TTOKEN=,  3                                            X04750000
               &STOKEN=,  4                                            X04800000
               &ASCB=,    5                                            X04850000
               &MF=,      6                                            X04900000
               &RELATED=     OPTIONAL VALUE FOR DOCUMENTATION           04950000
.*                                                                      05000000
.********************************************************************   05050000
.*      PUT OUT BAL MACDATE COMMENT LINE REGARDLESS OF ERRORS       *   05100000
.********************************************************************   05150000
.*                                                                      05200000
.*                                                                      05250000
.*                                                                      05300000
*              MACDATE = 04/03/89                                       05350000
.*                                                                      05400000
.*                                                                      05450000
.*                                                                      05500000
.*                                                                      05550000
.********************************************************************   05600000
.*     EACH KEYWORD HAS AN ASSOCIATED INDEX.  THESE INDICES ARE     *   05650000
.*     USED TO REFERENCE THE DESIRED KEYWORD VALUES IN ARRAYS       *   05700000
.*     DECLARED BELOW.  THE INDEX FOR EACH KEYWORD IS SHOWN IN THE  *   05750000
.*     MACRO PROTOTYPE STATEMENT TO THE RIGHT OF THE ASSOCIATED     *   05800000
.*     KEYWORD.                                                     *   05850000
.********************************************************************   05900000
.*                                                                      05950000
.*                                                                      06000000
.*                                                                      06050000
.********************************************************************   06100000
.*      VARIABLE DECLARATIONS                                       *   06150000
.********************************************************************   06200000
.*                                                                      06250000
        LCLA    &AWK         GENERAL USAGE LOCAL ARITHMETIC VARIABLE    06300000
        LCLA    &TYP         USED TO INDICATE WHICH TYPE WAS SPECIFIED  06350000
.*                                                                      06400000
        LCLB    &ENDIT       ERROR BIT USED TO STOP MACRO GENERATION    06450000
&ENDIT  SETB    0            INITIALIZE TO NO ERRORS                    06500000
.*                                                                      06550000
        LCLC    &CWK         GENERAL USAGE LOCAL CHARACTER VARIABLE     06600000
        LCLC    &GNAME1      LABEL FOR STANDARD FORM PARAMETER LIST     06650000
        LCLC    &GNAME2      BRANCH LABEL FOR THE STANDARD FORM         06700000
        LCLC    &GNAME3      LABEL FOR STANDARD FORM PARAMETER LIST     06750000
        LCLC    &GNAME4      BRANCH LABEL FOR THE STANDARD FORM         06800000
.*                                                                      06850000
        LCLC    &EPLV        VALUE OF THE PARAMETER ADDRESS IN THE      06900000
.*                           MF=(E,CNTLADDR) KEYWORD                    06950000
        LCLC    &LTE         LOAD TYPE (REGISTER OR ADDRESS) FOR        07000000
.*                           EXECUTE FORM PARAMETER LIST                07050000
.*                                'R' = REGISTER TYPE                   07100000
.*                                'A' = RX ADDRESS TYPE                 07150000
        LCLC    &MFTYPE      MF KEYWORD TYPE - S, L, OR E               07200000
.*                                'S' = STANDARD FORM                   07250000
.*                                'L' = LIST FORM                       07300000
.*                                'E' = EXECUTE FORM                    07350000
.*                                                                      07400000
.*                                                                      07450000
.********************************************************************   07500000
.*    ARRAY DECLARATIONS                                            *   07550000
.********************************************************************   07600000
.*                                                                      07650000
        LCLC    &KW1(5)      ARRAY USED TO HOLD THE KEYWORD NAMES       07700000
&KW1(1) SETC    'TYPE'                                                  07750000
&KW1(2) SETC    'TTOKEN'                                           @L1C 07800000
&KW1(3) SETC    'TCB'                                              @L1C 07850000
&KW1(4) SETC    'STOKEN'                                                07900000
&KW1(5) SETC    'ASCB'                                                  07950000
.*                                                                      08000000
        LCLB    &S1(8)       BITS USED TO KEEP TRACK OF KEYWORDS        08050000
.*                           SPECIFIED                                  08100000
&S1(1)  SETB    0            INITIALIZE TYPE NOT SPECIFIED              08200000
&S1(2)  SETB    0            INITIALIZE TTOKEN NOT SPECIFIED            08250000
&S1(3)  SETB    0            INITIALIZE TCB NOT SPECIFIED               08300000
&S1(4)  SETB    0            INITIALIZE STOKEN NOT SPECIFIED            08350000
&S1(5)  SETB    0            INITIALIZE ASCB NOT SPECIFIED              08400000
&S1(6)  SETB    0            BITS 6-8 ARE RESERVED                      08450000
&S1(7)  SETB    0                                                       08500000
&S1(8)  SETB    0                                                       08550000
.*                                                                      09550000
.********************************************************************   09600000
.*     CHECK FOR POSITIONAL PARAMETERS                              *   09650000
.********************************************************************   09700000
.*                                                                      09750000
         AIF    (N'&SYSLIST GE 1).ERR01    TOO MANY POSITIONALS         09800000
.NOPOS   ANOP   ,                                                       09850000
.*                                                                      09900000
.********************************************************************   09950000
.*     VALIDATE TYPE KEYWORD IF PRESENT                             *   10000000
.********************************************************************   10050000
.*                                                                      10100000
         AIF    ('&TYPE' EQ '').CHKTCB     IF OMITTED, EXIT TYPE        10150000
.*                                         VALIDATION                   10200000
&S1(1)   SETB   1                          INDICATE TYPE WAS SPECIFIED  10300000
.*                                                                      10350000
         AIF    (N'&TYPE GT 1).ERR02       TOO MANY SUBLISTS            10400000
.*                                                                      10450000
.OKSUBL  ANOP   ,                                                       10500000
         AIF    ('&TYPE(1)' NE 'TOTTOKEN').ISITTCB                      10550000
&TYP     SETA   1                          INDICATE TOTTOKEN SPECIFIED  10600000
         AGO    .CHKTCB                                                 10650000
.*                                                                      10700000
.ISITTCB ANOP   ,                                                       10750000
         AIF    ('&TYPE(1)' NE 'TOTCB').ISITJBSP                   @L1C 10800000
&TYP     SETA   2                          INDICATE TOTCB SPECIFIED     10850000
         AGO    .CHKTCB                                            @L1A 10856200
.ISITJBSP ANOP  ,                                                       10862400
         AIF    ('&TYPE(1)' NE 'JOBSTEP').ISITPRNT                 @L1A 10868600
&TYP     SETA   3                          INDICATE JOBSTEP            X10874800
                                            SPECIFIED              @L1A 10881000
         AGO    .CHKTCB                                            @L1A 10887200
.ISITPRNT ANOP  ,                                                       10893400
         AIF    ('&TYPE(1)' NE 'PARENT').ISITCRNT                  @L1A 10899600
&TYP     SETA   4                          INDICATE PARENT             X10905800
                                            SPECIFIED              @L1A 10912000
         AGO    .CHKTCB                                            @L1A 10918200
.ISITCRNT ANOP  ,                                                       10924400
         AIF    ('&TYPE(1)' NE 'CURRENT').ERR03                    @L1A 10930600
&TYP     SETA   5                          INDICATE CURRENT            X10936800
                                            SPECIFIED              @L1A 10943000
.*                                                                      10950000
.********************************************************************   11000000
.*       VALIDATE TCB KEYWORD IF PRESENT                            *   11050000
.********************************************************************   11100000
.*                                                                      11150000
.CHKTCB  ANOP   ,                                                       11200000
         AIF    ('&TCB' EQ '').CHKTTKN     IF OMITTED, EXIT TCB         11250000
.*                                         VALIDATION                   11300000
&S1(3)   SETB   1                          INDICATE TCB WAS            X11350000
                                            SPECIFIED              @L1C 11400000
         AIF    (N'&TCB GT 1).ERR04        TOO MANY SUBLISTS            11500000
.*                                                                      11550000
         AIF    ('&TCB'(1,1) NE '(').CHKTTKN                            11600000
         AIF    (T'&TCB NE 'N').CHKTTKN    IF THE REGISTER NAME IS NOT  11650000
.*                                         A SELF DEFINING NUMBER, EXIT 11700000
.*                                         THE TCB VALIDATION.  WE MUST 11750000
.*                                         HAVE FAITH THAT A REGISTER 2 11800000
.*                                         -12 WAS SPECIFIED.           11850000
.*                                                                      11900000
&AWK     SETA   K'&TCB-2                   LENGTH OF REGISTER           11950000
&CWK     SETC   '&TCB'(2,&AWK)             ISOLATE REGISTER             12000000
         AIF    ('&CWK' LT '2' OR '&CWK' GT '12').ERR05  REG.INVALID    12050000
.*                                                                      12100000
.*                                                                      12150000
.********************************************************************   12200000
.*       VALIDATE TTOKEN KEYWORD IF PRESENT                         *   12250000
.********************************************************************   12300000
.*                                                                      12350000
.CHKTTKN ANOP   ,                                                       12400000
         AIF    ('&TTOKEN' EQ '').CHKSTKN  IF OMITTED, EXIT TTOKEN      12450000
.*                                         VALIDATION                   12500000
&S1(2)   SETB   1                          INDICATE TTOKEN             X12550000
                                            SPECIFIED              @L1C 12600000
         AIF    (N'&TTOKEN GT 1).ERR06     TOO MANY SUBLISTS            12700000
         AIF    ('&TTOKEN'(1,1) EQ '(').ERR07   REGISTER NOT ALLOWED    12750000
.*                                                                      12800000
.*                                                                      12850000
.********************************************************************   12900000
.*       VALIDATE STOKEN KEYWORD IF PRESENT                         *   12950000
.********************************************************************   13000000
.*                                                                      13050000
.CHKSTKN ANOP   ,                                                       13100000
         AIF    ('&STOKEN' EQ '').CHKASCB  IF OMITTED, EXIT STOKEN      13150000
.*                                         VALIDATION                   13200000
&S1(4)   SETB   1                          INDICATE STOKEN SPECIFIED    13250000
.*                                                                      13300000
         AIF    (N'&STOKEN GT 1).ERR08     TOO MANY SUBLISTS            13350000
         AIF    ('&STOKEN'(1,1) EQ '(').ERR09  REGISTER NOT ALLOWED     13400000
.*                                                                      13450000
.*                                                                      13500000
.********************************************************************   13550000
.*       VALIDATE ASCB KEYWORD IF PRESENT                           *   13600000
.********************************************************************   13650000
.*                                                                      13700000
.CHKASCB ANOP   ,                                                       13750000
         AIF    ('&ASCB' EQ '').CHKMF      IF OMITTED, EXIT ASCB        13800000
.*                                         VALIDATION                   13850000
&S1(5)   SETB   1                          INDICATE ASCB SPECIFIED      13900000
.*                                                                      13950000
         AIF    (N'&ASCB GT 1).ERR10       TOO MANY SUBLISTS            14000000
         AIF    ('&ASCB'(1,1) NE '(').CHKMF                             14050000
         AIF    (T'&ASCB NE 'N').CHKMF     IF THE REGISTER NAME IS NOT  14100000
.*                                         A SELF DEFINING NUMBER, EXIT 14150000
.*                                         ASCB VALIDATION.  WE MUST    14200000
.*                                         HAVE FAITH THAT A REGISTER 2 14250000
.*                                         -12 WAS SPECIFIED.           14300000
.*                                                                      14350000
&AWK     SETA   K'&ASCB-2                  LENGTH OF REGISTER           14400000
&CWK     SETC   '&ASCB'(2,&AWK)            ISOLATE REGISTER             14450000
         AIF    ('&CWK' LT '2' OR '&CWK' GT '12').ERR11  REG. INVALID   14500000
.*                                                                      14550000
.*                                                                      14600000
.********************************************************************   14650000
.*       VALIDATE MF KEYWORD IF PRESENT                             *   14700000
.********************************************************************   14750000
.*                                                                      14800000
.CHKMF   ANOP   ,                                                       14850000
&MFTYPE  SETC   'S'                        SET MF TYPE TO STANDARD      14900000
         AIF    ('&MF' EQ '').EXITMF       IF MF OMITTED, EXIT MF       14950000
.*                                         VALIDATION                   15000000
.*                                                                      15050000
&MFTYPE  SETC   'L'                        SET MF TYPE TO LIST          15100000
         AIF    ('&MF' EQ 'L').EXITMF      MF=L,EXIT MF VALIDATION      15150000
.*                                                                      15200000
&MFTYPE  SETC   'E'                        SET MF TYPE TO EXECUTE FORM  15250000
         AIF    (N'&MF GT 2).ERR12         TOO MANY SUBLISTS            15300000
.*                                                                      15350000
         AIF    ('&MF(1)' NE 'E').ERR13    MAKE SURE 'E' WAS SPECIFIED  15400000
         AIF    ('&MF(2)' EQ '').ERR14     MAKE SURE A NON-NULL         15450000
.*                                         PARAMETER ADDRESS WAS        15500000
.*                                         SPECIFIED                    15550000
.*                                                                      15600000
         AIF    ('&MF(2)'(1,1) EQ '(').PROCREG  BRANCH TO PROCESS       15650000
.*                                         REGISTER TYPE OF PARAMETER   15700000
.*                                         LIST ADDRESS                 15750000
.*                                                                      15800000
&LTE     SETC   'A'                        INDICATE RX ADDRESS TYPE OF  15850000
.*                                         PARM LIST                    15900000
&EPLV    SETC   '&MF(2)'                   GET PARM LIST VALUE TO USE   15950000
.*                                         IN THE LAE INSTRUCTION       16000000
.*                                                                      16050000
         AGO    .EXITMF                                                 16100000
.*                                                                      16150000
.PROCREG ANOP   ,                                                       16200000
&LTE     SETC   'R'                        INDICATE REGISTER TYPE       16250000
.*                                         PARM LIST                    16300000
&EPLV    SETC   '&MF(2)'(2,K'&MF(2)-2)     EXTRACT REGISTER NAME FOR    16350000
.*                                         USE IN THE LAE INSTRUCTION   16400000
.*                                                                      16450000
         AIF    (N'&MF(2) GT 1).ERR15      PUT OUT ERROR MESSAGE IF     16500000
.*                                         MORE THAN ONE REGISTER WAS   16550000
.*                                         SPECIFIED                    16600000
.*                                                                      16650000
         AIF    (T'&MF(2) NE 'N').EXITMF   IF THE REGISTER NAME IS NOT  16700000
.*                                         A SELF DEFINING NUMBER, EXIT 16750000
.*                                         MF VALIDATION.  WE MUST HAVE 16800000
.*                                         FAITH THAT A REGISTER 2-12   16850000
.*                                         WAS SPECIFIED.               16900000
.*                                                                      16950000
&AWK     SETA   K'&MF(2)-2                 LENGTH OF REGISTER           17000000
&CWK     SETC   '&MF(2)'(2,&AWK)           ISOLATE REGISTER             17050000
         AIF    ('&CWK' LT '1' OR '&CWK' GT '12').ERR16  REG. INVALID   17100000
.*                                                                      17150000
.*                                                                      17200000
.********************************************************************   17250000
.*                                                                      17300000
.EXITMF  ANOP   ,                                                       17350000
         AIF    ('&MFTYPE' NE 'L').DEPEND1                         @L1C 17400000
.*                                                                      17450000
.********************************************************************   17500000
.*     LIST FORM WAS SPECIFIED                                      *   17550000
.********************************************************************   17600000
.*                                                                      17650000
&AWK     SETA   0                          MAKE SURE TYPE,TCB,TTOKEN,   17700000
.*                                         STOKEN,AND ASCB KEYWORDS     17750000
.*                                         WERE NOT SPECIFIED           17800000
.*                                                                      17850000
.MFL1    ANOP   ,                                                       17900000
&AWK     SETA   &AWK+1                     INCREMENT THE INDEX TO       17950000
.*                                         EXAMINE THE NEXT KEYWORD     18000000
         AIF    (&S1(&AWK) EQ 1).ERR17     PUT OUT ERROR MESSAGE IF     18050000
.*                                         KEYWORD WAS SPECIFIED        18100000
.MFL2    ANOP   ,                                                       18150000
         AIF    (&AWK LT 5).MFL1           BRANCH IF MORE KEYWORDS TO   18200000
.*                                         EXAMINE                      18250000
.*                                                                      18300000
         AIF    (&ENDIT EQ 0).GENLIST      IF NO ERRORS, GO GENERATE    18350000
.*                                         PARAMETER LIST               18400000
.*                                                                      18450000
         MEXIT                                                          18500000
.*                                                                      18550000
.********************************************************************   18600000
.*     GENERATE PARAMETER LIST                                      *   18650000
.********************************************************************   18700000
.*                                                                      18750000
.GENLIST ANOP   ,                                                       18800000
&LABL    DS     0F                                                      18850000
         DS     0CL16                      TCB TOKEN (INPUT/OUTPUT)     18900000
         DS     XL8                                                     18950000
         DS     F                                                       19000000
         DS     A                                                       19050000
         DS     A                          ASCB ADDRESS (INPUT)         19100000
         DS     0F                         FLAGS (INPUT)                19150000
         DS     FL1                        TYPE OF TCBTOKEN REQUEST     19200000
         DS     FL3                        RESERVED                     19250000
.*                                                                      19300000
         MEXIT                                                          19350000
.*                                                                      19400000
.********************************************************************   19450000
.*             CHECK TYPE KEYWORD DEPENDENCIES                          19475000
.*                                                                      19500000
.*       TYPE AND TTOKEN ARE REQUIRED KEYWORDS WHEN MF^=L               19550000
.********************************************************************   19600000
.*                                                                      19750000
.DEPEND1 ANOP   ,                                                  @L1A 19770000
&AWK     SETA   0                          CHECK BOTH TYPE AND         X19790000
                                            TTOKEN                 @L1C 19810000
.INCRMT  ANOP   ,                          NEXT LOOP               @L1A 19830000
&AWK     SETA   &AWK+1                     INCREMENT THE INDEX TO       19850000
.*                                         EXAMINE THE NEXT KEYWORD     19900000
         AIF    (&S1(&AWK) EQ 0).ERR18     PUT OUT ERROR MESSAGE       X19918400
                                            IF KEYWORD WAS NOT         X19936800
                                            SPECIFIED              @L1C 19955200
.DEPEND2 ANOP   ,                                                       19973600
         AIF    (&AWK LT 2).INCRMT         BRANCH IF MORE KEYWORDS     X19992000
                                           TO EXAMINE              @L1A 20010400
.DEPEND3 ANOP   ,                                                  @L1A 20028800
         AIF    (&TYP GT 2).DEPEND6        TCB IS NOT REQUIRED FOR     X20047200
                                           TYPE= JOBSTEP, CURRENT, OR  X20065600
                                           PARENT                  @L1A 20084000
         AIF    (&TYP NE 0).TESTTCB        EXIT IF NO TYPE             X20102400
                                            SPECIFIED              @L1A 20120800
         MEXIT                                                     @L1A 20139200
.TESTTCB ANOP   ,                          CHECK TCB.              @L1A 20157600
&AWK     SETA   3                                                  @L1A 20176000
         AIF    (&S1(&AWK) EQ 0).ERR22     PUT OUT ERROR MESSAGE IF    X20194400
                                            TCB KEYWORD NOT            X20212800
                                            SPECIFIED.             @L1A 20231200
.*                                                                      20250000
.********************************************************************   20300000
.*                                                                      20350000
.DEPEND4 ANOP   ,                                                  @L1A 20375000
         AIF    ('&TYPE(1)' NE 'TOTTOKEN').ITSTCB                       20400000
.*                                                                      20450000
.********************************************************************   20500000
.*     TOTTOKEN TYPE WAS SPECIFIED                                  *   20550000
.********************************************************************   20600000
.*                                                                      20650000
         AIF    ('&STOKEN' NE '' AND '&ASCB' NE '').ERR19               20700000
.*                                                                      20750000
         AIF    (&ENDIT EQ 0).GENCODE                                   20850000
.*                                                                      20900000
         MEXIT                                                          20950000
.*                                                                      21000000
.GENCODE ANOP   ,                                                       21050000
         AIF    ('&MFTYPE' EQ 'E').GENMFE1 GO DO EXECUTE FORM           21100000
.*                                                                      21150000
.********************************************************************   21200000
.*    STANDARD FORM SPECIFIED                                       *   21250000
.********************************************************************   21300000
.*                                                                      21350000
&GNAME1  SETC   'IHB'.'&SYSNDX'.'K'        SET UP NAMES FOR INLINE      21400000
.*                                         PARAMETER LIST               21450000
&GNAME2  SETC   'IHB'.'&SYSNDX'.'R'                                     21500000
.*                                                                      21550000
.*                                                                      21600000
&LABL    DS     0H                         TCBTOKEN SERVICE ROUTINE     21650000
*                                          CALL                         21700000
         LAE    1,0(0,0)                   ZERO ACCESS REGISTER 1       21750000
         LA     1,&GNAME1                  POINT REG 1 TO PARM LIST     21800000
.*                                                                      21850000
.********************************************************************   21900000
.*    GENERATE INLINE PARAMETER LIST                                *   21950000
.********************************************************************   22000000
.*                                                                      22050000
         AIF    ('&ASCB' EQ '').CKSTKN2                                 22100000
         AIF    ('&ASCB'(1,1) EQ '(').PAREN                             22150000
         MVC    16(4,1),&ASCB              MOVE ASCB ADDRESS INTO       22200000
*                                          THE PARAMETER LIST           22250000
         AGO    .FLAGIT                                                 22300000
.PAREN   ANOP                                                           22350000
         ST     &ASCB(1),16(1)             STORE THE ASCB ADDRESS INTO  22400000
*                                          THE PARAMETER LIST           22450000
         AGO    .FLAGIT                                                 22500000
.*                                                                      22550000
.CKSTKN2 ANOP   ,                                                       22600000
         AIF    ('&STOKEN' EQ '').FLAGIT                                22650000
         MVC    0(8,1),&STOKEN             MOVE THE STOKEN INTO THE     22700000
*                                          PARAMETER LIST               22750000
.*                                                                      22800000
.FLAGIT  ANOP   ,                                                       22850000
         AIF    ('&TCB'(1,1) EQ '(').PAREN2                             22900000
         MVC    12(4,1),&TCB               MOVE TCB ADDRESS INTO        22950000
*                                          THE PARAMETER LIST           23000000
         AGO    .MOVTYP                                                 23050000
.PAREN2  ANOP                                                           23100000
         ST     &TCB(1),12(1)              STORE THE TCB ADDRESS INTO   23150000
*                                          THE PARAMETER LIST           23200000
.*                                                                      23250000
.MOVTYP  ANOP   ,                                                       23300000
         MVI    20(1),&TYP                 MOVE TYPE OF REQUEST INTO    23350000
*                                          THE PARAMETER LIST           23400000
.*                                                                      23450000
         B      &GNAME2                    BRANCH AROUND PARM LIST      23500000
         CNOP   0,4                        FORCE PARAMETER LIST TO A    23550000
*                                          WORD BOUNDARY                23600000
.*                                                                      23650000
&GNAME1  DC     0CL16'0'                   TCB TOKEN (INPUT/OUTPUT)     23700000
         DC     XL8'0'                                                  23750000
         DC     F'0'                                                    23800000
         DC     A(0)                                                    23850000
         DC     A(0)                       ASCB ADDRESS (INPUT)         23900000
         DC     FL1'0'                     TYPE OF TCBTOKEN REQUEST     23950000
         DC     FL3'0'                     RESERVED                     24000000
.*                                                                      24050000
.********************************************************************   24100000
.*    GENERATE PC LINKAGE TO TCBTOKEN SERVICE ROUTINE.  NOTE - R14  *   24150000
.*    IS USED AS AN INDEX REGISTER TO AVOID SETTING AR14 TO ZERO.   *   24200000
.********************************************************************   24250000
.*                                                                      24300000
*                                                                       24350000
&GNAME2  L      14,16(0,0)                 GET ADDRESS OF CVT           24400000
         L      14,772(14,0)               GET ADDRESS OF SFT           24450000
         L      14,212(14,0)               GET LX/EX FOR SERVICE        24500000
*                                          ROUTINE                      24550000
         PC     0(14)                      PC TO TCBTOKEN SERVICE       24600000
.*                                                                      24650000
.********************************************************************   24700000
.*    STORE THE TTOKEN INTO THE USER'S AREA                         *   24750000
.********************************************************************   24800000
.*                                                                      24850000
         LAE    14,&TTOKEN                 GET ADDRESS OF USER'S AREA   24900000
         MVC    0(16,14),0(1)              STORE TTOKEN FROM THE        24950000
*                                          PARM LIST                    25000000
         MEXIT                                                          25050000
.*                                                                      25100000
.GENMFE1 ANOP   ,                                                       25150000
.*                                                                      25200000
.********************************************************************   25250000
.*    EXECUTE FORM SPECIFIED                                        *   25300000
.*                                                                  *   25350000
.*    NOTE THAT ALL OPTIONS REQUIRED ON THE STANDARD FORM OF THE    *   25400000
.*    MACRO ARE ALSO REQUIRED ON THE EXECUTE FORM!                  *   25450000
.********************************************************************   25500000
.*                                                                      25550000
&LABL    DS     0H                                                      25600000
.*                                                                      25650000
.********************************************************************   25700000
.*    PLACE PARAMETER LIST ADDRESS IN AR/GPR 1                      *   25750000
.********************************************************************   25800000
.*                                                                      25850000
         AIF    ('&LTE' EQ 'R').REG        BRANCH IF ADDRESS IS IN A    25900000
.*                                         REGISTER                     25950000
         LAE    1,&EPLV                    TCBTOKEN PARAMETER LIST      26000000
*                                          ADDRESS                      26050000
         AGO    .NEXT                      GO CONTINUE EXECUTE FORM     26100000
.*                                                                      26150000
.REG     ANOP   ,                                                       26200000
         LAE    1,0(0,&EPLV)               TCBTOKEN PARAMETER LIST      26250000
*                                          ADDRESS                      26300000
.*                                                                      26350000
.NEXT    ANOP   ,                                                       26400000
         XC     0(24,1),0(1)               CLEAR PARAMETER LIST         26450000
.*                                                                      26500000
.********************************************************************   26550000
.*    GENERATE PARAMETER LIST                                       *   26600000
.********************************************************************   26650000
.*                                                                      26700000
         AIF    ('&ASCB' EQ '').CKSTKN                                  26750000
         AIF    ('&ASCB'(1,1) EQ '(').PAREN3                            26800000
         MVC    16(4,1),&ASCB              MOVE ASCB ADDRESS INTO       26850000
*                                          THE PARAMETER LIST           26900000
         AGO    .DOFLG                                                  26950000
.PAREN3  ANOP                                                           27000000
         ST     &ASCB(1),16(,1)            STORE THE ASCB ADDRESS  @01C 27050000
*                                          INTO THE PARAMETER LIST      27100000
         AGO    .DOFLG                                                  27150000
.*                                                                      27200000
.CKSTKN  ANOP   ,                                                       27250000
         AIF    ('&STOKEN' EQ '').DOFLG                                 27300000
         MVC    0(8,1),&STOKEN             MOVE THE STOKEN INTO THE     27350000
*                                          PARAMETER LIST               27400000
.*                                                                      27450000
.DOFLG   ANOP   ,                                                       27500000
         AIF    ('&TCB'(1,1) EQ '(').PAREN4                             27550000
         MVC    12(4,1),&TCB               MOVE TCB ADDRESS INTO        27600000
*                                          THE PARAMETER LIST           27650000
         AGO    .MOVTYP2                                                27700000
.PAREN4  ANOP                                                           27750000
         ST     &TCB(1),12(,1)             STORE THE TCB ADDRESS   @01C 27800000
*                                          INTO THE PARAMETER LIST      27850000
.MOVTYP2 ANOP   ,                                                       27900000
         MVI    20(1),&TYP                 MOVE TYPE OF REQUEST INTO    27950000
*                                          THE PARAMETER LIST           28000000
.*                                                                      28050000
.********************************************************************   28100000
.*    GENERATE PC LINKAGE TO TCBTOKEN SERVICE ROUTINE.  NOTE - R14  *   28150000
.*    IS USED AS AN INDEX REGISTER TO AVOID SETTING AR14 TO ZERO.   *   28200000
.********************************************************************   28250000
.*                                                                      28300000
         L      14,16(0,0)                 GET ADDRESS OF CVT           28350000
         L      14,772(14,0)               GET ADDRESS OF SFT           28400000
         L      14,212(14,0)               GET LX/EX FOR SERVICE        28450000
*                                          ROUTINE                      28500000
         PC     0(14)                      PC TO TCBTOKEN SERVICE       28550000
.*                                                                      28600000
.********************************************************************   28650000
.*    STORE THE TTOKEN INTO THE USER'S AREA                         *   28700000
.********************************************************************   28750000
.*                                                                      28800000
         LAE    14,&TTOKEN                 GET ADDRESS OF USER'S AREA   28850000
         MVC    0(16,14),0(1)              STORE TTOKEN FROM THE        28900000
*                                          PARM LIST                    28950000
         MEXIT                                                          29000000
.*                                                                      29050000
.********************************************************************   29100000
.*                                                                      29150000
.ITSTCB  ANOP   ,                          ENSURE TYPE IS TOTCB         29200000
         AIF    ('&TYPE(1)' NE 'TOTCB').NOSTKN                          29250000
.*                                                                      29300000
.********************************************************************   29350000
.*    TOTCB TYPE WAS SPECIFIED                                      *   29400000
.********************************************************************   29450000
.*                                                                      29500000
         AIF    ('&STOKEN' NE '').ERR20                                 29550000
.*                                                                      29600000
.NOSTKN  ANOP   ,                                                       29650000
         AIF    (&ENDIT EQ 0).GENCOD                                    29850000
.*                                                                      29900000
         MEXIT                                                          29950000
.*                                                                      30000000
.GENCOD  ANOP   ,                                                       30050000
         AIF    ('&MFTYPE' EQ 'E').GENMFE2                              30100000
.*                                                                      30150000
.********************************************************************   30200000
.*    STANDARD FORM SPECIFIED                                       *   30250000
.********************************************************************   30300000
.*                                                                      30350000
&GNAME3  SETC   'IHB'.'&SYSNDX'.'T'        SET UP NAMES FOR INLINE      30400000
.*                                         PARAMETER LIST               30450000
&GNAME4  SETC   'IHB'.'&SYSNDX'.'W'                                     30500000
.*                                                                      30550000
.*                                                                      30600000
&LABL    DS     0H                         TCBTOKEN SERVICE ROUTINE     30650000
*                                          CALL                         30700000
         LAE    1,0(0,0)                   ZERO ACCESS REGISTER 1       30750000
         LA     1,&GNAME3                  POINT REG 1 TO PARM LIST     30800000
.*                                                                      30850000
.********************************************************************   30900000
.*    GENERATE INLINE PARAMETER LIST                                *   30950000
.********************************************************************   31000000
.*                                                                      31050000
         MVC    0(16,1),&TTOKEN            MOVE TTOKEN INTO             31100000
*                                          THE PARAMETER LIST           31150000
.*                                                                      31200000
         MVI    20(1),&TYP                 MOVE TYPE OF REQUEST INTO    31250000
*                                          THE PARAMETER LIST           31300000
.*                                                                      31350000
         B      &GNAME4                    BRANCH AROUND PARM LIST      31400000
         CNOP   0,4                        FORCE PARAMETER LIST TO A    31450000
*                                          WORD BOUNDARY                31500000
.*                                                                      31550000
&GNAME3  DC     0CL16'0'                   TCB TOKEN (INPUT/OUTPUT)     31600000
         DC     XL8'0'                                                  31650000
         DC     F'0'                                                    31700000
         DC     A(0)                                                    31750000
         DC     A(0)                       ASCB ADDRESS (INPUT/OUTPUT)  31800000
         DC     FL1'0'                     TYPE OF TCBTOKEN REQUEST     31850000
         DC     FL3'0'                     RESERVED                     31900000
.*                                                                      31950000
.********************************************************************   32000000
.*    GENERATE PC LINKAGE TO TCBTOKEN SERVICE ROUTINE.  NOTE - R14  *   32050000
.*    IS USED AS AN INDEX REGISTER TO AVOID SETTING AR14 TO ZERO.   *   32100000
.********************************************************************   32150000
.*                                                                      32200000
*                                                                       32250000
&GNAME4  L      14,16(0,0)                 GET ADDRESS OF CVT           32300000
         L      14,772(14,0)               GET ADDRESS OF SFT           32350000
         L      14,212(14,0)               GET LX/EX FOR SERVICE        32400000
*                                          ROUTINE                      32450000
         PC     0(14)                      PC TO TCBTOKEN SERVICE       32500000
.*                                                                      32550000
.********************************************************************   32600000
.*    STORE THE TCB ADDRESS INTO THE USER'S AREA                    *   32650000
.********************************************************************   32700000
.*                                                                      32750000
         AIF    ('&TCB'(1,1) EQ '(').PAR1                               32800000
         LAE    14,&TCB                    GET ADDRESS OF USER'S AREA   32850000
         AGO    .MOVE1                                             @D1C 32900000
.PAR1    ANOP   ,                                                       32950000
         LAE    14,0(0,&TCB(1))            GET ADDRESS OF USER'S AREA   33000000
.*                                                                      33050000
.MOVE1   ANOP   ,                                                  @D1C 33100000
         MVC    0(4,14),12(1)              STORE TCB ADDRESS FROM THE   33150000
*                                          PARM LIST                    33200000
.*                                                                      33202600
.********************************************************************   33205200
.*    IF ASCB KEYWORD IS SPECIFIED, STORE IT INTO THE USER'S AREA   *   33207800
.********************************************************************   33210400
.*                                                                      33213000
         AIF    ('&ASCB' EQ '').DONEST                             @D1A 33215600
         AIF    ('&ASCB'(1,1) EQ '(').ISREGST                      @D1A 33218200
         LAE    14,&ASCB                   GET ADDRESS OF USER'S        33220800
*                                          AREA                    @D1A 33223400
         AGO    .MOVASCB                                           @D1A 33226000
.ISREGST ANOP   ,                                                  @D1A 33228600
         LAE    14,0(0,&ASCB(1))           GET ADDRESS OF USER'S        33231200
*                                          AREA                    @D1A 33233800
.*                                                                      33236400
.MOVASCB ANOP   ,                                                  @D1A 33239000
         MVC    0(4,14),16(1)              STORE ASCB ADDRESS FROM THE  33241600
*                                          PARM LIST               @D1A 33244200
.DONEST  ANOP   ,                                                  @D1A 33246800
         MEXIT                                                          33250000
.*                                                                      33300000
.GENMFE2 ANOP   ,                                                       33350000
.*                                                                      33400000
.********************************************************************   33450000
.*    EXECUTE FORM SPECIFIED                                        *   33500000
.*                                                                  *   33550000
.*    NOTE THAT ALL OPTIONS REQUIRED ON THE STANDARD FORM OF THE    *   33600000
.*    MACRO ARE ALSO REQUIRED ON THE EXECUTE FORM!                  *   33650000
.********************************************************************   33700000
.*                                                                      33750000
&LABL    DS     0H                                                      33800000
.*                                                                      33850000
.********************************************************************   33900000
.*    PLACE PARAMETER LIST ADDRESS IN AR/GPR 1                      *   33950000
.********************************************************************   34000000
.*                                                                      34050000
         AIF    ('&LTE' EQ 'R').REGS       BRANCH IF ADDRESS IS IN A    34100000
.*                                         REGISTER                     34150000
         LAE    1,&EPLV                    TCBTOKEN PARAMETER LIST      34200000
.*                                         ADDRESS                      34250000
         AGO    .CONTINU                   GO CONTINUE EXECUTE FORM     34300000
.*                                                                      34350000
.REGS    ANOP   ,                                                       34400000
         LAE    1,0(0,&EPLV)               TCBTOKEN PARAMETER LIST      34450000
.*                                         ADDRESS                      34500000
.*                                                                      34550000
.CONTINU ANOP   ,                                                       34600000
         XC     0(24,1),0(1)               CLEAR PARAMETER LIST         34650000
.*                                                                      34700000
.********************************************************************   34750000
.*    GENERATE PARAMETER LIST                                       *   34800000
.********************************************************************   34850000
.*                                                                      34900000
         MVC    0(16,1),&TTOKEN            MOVE TTOKEN INTO             34950000
*                                          THE PARAMETER LIST           35000000
.*                                                                      35050000
         MVI    20(1),&TYP                 MOVE TYPE OF REQUEST INTO    35100000
*                                          THE PARAMETER LIST           35150000
.*                                                                      35200000
.********************************************************************   35250000
.*    GENERATE PC LINKAGE TO TCBTOKEN SERVICE ROUTINE.  NOTE - R14  *   35300000
.*    IS USED AS AN INDEX REGISTER TO AVOID SETTING AR14 TO ZERO.   *   35350000
.********************************************************************   35400000
.*                                                                      35450000
         L      14,16(0,0)                 GET ADDRESS OF CVT           35500000
         L      14,772(14,0)               GET ADDRESS OF SFT           35550000
         L      14,212(14,0)               GET LX/EX FOR SERVICE        35600000
*                                          ROUTINE                      35650000
         PC     0(14)                      PC TO TCBTOKEN SERVICE       35700000
.*                                                                      35750000
.********************************************************************   35800000
.*    STORE THE TCB ADDRESS INTO THE USER'S AREA                    *   35850000
.********************************************************************   35900000
.*                                                                      35950000
         AIF    ('&TCB'(1,1) EQ '(').PAR2                               36000000
         LAE    14,&TCB                    GET ADDRESS OF USER'S AREA   36050000
         AGO    .MOVE2                                                  36100000
.PAR2    ANOP   ,                                                       36150000
         LAE    14,0(0,&TCB(1))            GET ADDRESS OF USER'S AREA   36200000
.*                                                                      36250000
.MOVE2   ANOP   ,                                                       36300000
         MVC    0(4,14),12(1)              STORE TCB ADDRESS FROM THE   36350000
*                                          PARM LIST                    36400000
.*                                                                      36402600
.********************************************************************   36405200
.*    IF ASCB KEYWORD IS SPECIFIED, STORE IT INTO THE USER'S AREA   *   36407800
.********************************************************************   36410400
.*                                                                      36413000
         AIF    ('&ASCB' EQ '').DONEEX                             @D1A 36415600
         AIF    ('&ASCB'(1,1) EQ '(').ISREGEX                      @D1A 36418200
         LAE    14,&ASCB                   GET ADDRESS OF USER'S        36420800
*                                          AREA                    @D1A 36423400
         AGO    .MOVEEX                                            @D1A 36426000
.ISREGEX ANOP   ,                                                  @D1A 36428600
         LAE    14,0(0,&ASCB(1))           GET ADDRESS OF USER'S        36431200
*                                          AREA                    @D1A 36433800
.*                                                                      36436400
.MOVEEX  ANOP   ,                                                  @D1A 36439000
         MVC    0(4,14),16(1)              STORE ASCB ADDRESS FROM THE  36441600
*                                          PARM LIST               @D1A 36444200
.DONEEX  ANOP   ,                                                  @D1A 36446800
         MEXIT                                                          36450000
.*                                                                      36450400
.********************************************************************   36450800
.*     TYPE SPECIFIED WAS JOBSTEP, PARENT, OR CURRENT.              *   36451200
.********************************************************************   36451600
.********************************************************************   36452000
.*     TCB, STOKEN, AND ASCB KEYWORDS ARE NOT VALID WITH            *   36452400
.*           TYPE = JOBSTEP, PARENT, OR CURRENT                   *     36452800
.********************************************************************   36453200
.DEPEND6 ANOP   ,                                                  @L1A 36453600
&AWK     SETA   &AWK+1                     INCREMENT THE INDEX TO      X36454000
                                            EXAMINE THE NEXT KEYWORD   X36454400
                                                                   @L1A 36454800
         AIF    (&S1(&AWK) EQ 1).ERR23     PUT OUT ERROR MESSAGE       X36455200
                                            IF KEYWORD WAS NOT         X36455600
                                            SPECIFIED              @L1A 36456000
.DEPEND7 ANOP   ,                                                  @L1A 36456400
         AIF    (&AWK LT 5).DEPEND6        BRANCH IF MORE KEYWORDS     X36456800
                                            TO EXAMINE             @L1A 36457200
         AIF    (&ENDIT EQ 0).GENCDE  IF NO ERRORS GENERATE CODE   @L1A 36457600
         MEXIT                                                     @L1A 36458000
.GENCDE ANOP    ,                                                  @L1A 36458400
         AIF    ('&MFTYPE' EQ 'E').GENMFE3  GO DO EXECUTE FORM     @L1A 36458800
.*                                                                      36459200
.********************************************************************   36459600
.*    STANDARD FORM SPECIFIED                                       *   36460000
.********************************************************************   36460400
.*                                                                      36460800
&GNAME1  SETC   'IHB'.'&SYSNDX'.'K'        SET UP NAMES FOR INLINE     X36461200
                                            PARAMETER LIST         @L1A 36461600
&GNAME2  SETC   'IHB'.'&SYSNDX'.'R'                                @L1A 36462000
.*                                                                      36462400
.*                                                                      36462800
&LABL    DS     0H                         TCBTOKEN SERVICE ROUTINE    X36463200
                                            CALL                   @L1A 36463600
         LAE    1,0(0,0)                   ZERO ACCESS REGISTER 1  @L1A 36464000
         LA     1,&GNAME1                  POINT REG 1 TO PARM         X36464400
                                            LIST                   @L1A 36464800
         MVI    20(1),&TYP                 MOVE TYPE OF REQUEST INTO   X36465200
                                            THE PARAMETER LIST     @L1A 36465600
.*                                                                      36466000
         B      &GNAME2                    BRANCH AROUND PARM LIST @L1A 36466400
         CNOP   0,4                        FORCE PARAMETER LIST TO A   X36466800
                                            WORD BOUNDARY          @L1A 36467200
.*                                                                      36467600
&GNAME1  DC     0CL16'0'                   TCB TOKEN(INPUT/OUTPUT) @L1A 36468000
         DC     XL8'0'                                             @L1A 36468400
         DC     F'0'                                               @L1A 36468800
         DC     A(0)                                               @L1A 36469200
         DC     A(0)                       ASCB ADDRESS (INPUT)    @L1A 36469600
         DC     FL1'0'                     TYPE OF TCBTOKEN            X36470000
                                            REQUEST                @L1A 36470400
         DC     FL3'0'                     RESERVED                @L1A 36470800
.*                                                                      36471200
*                                                                       36471600
&GNAME2  EQU   *                                                   @L1A 36472000
         AGO   .PCLNK                                              @L1A 36472400
.*                                                                      36472800
.GENMFE3 ANOP   ,                                                  @L1A 36473200
.*                                                                      36473600
.********************************************************************   36474000
.*    EXECUTE FORM SPECIFIED                                        *   36474400
.********************************************************************   36474800
.*                                                                      36475200
&LABL    DS     0H                                                 @L1A 36475600
.*                                                                      36476000
.********************************************************************   36476400
.*    PLACE PARAMETER LIST ADDRESS IN AR/GPR 1                      *   36476800
.********************************************************************   36477200
.*                                                                      36477600
         AIF    ('&LTE' EQ 'R').REG1       BRANCH IF ADDRESS IS IN A   X36478000
                                            REGISTER               @L1A 36478400
         LAE    1,&EPLV                    TCBTOKEN PARAMETER LIST     X36478800
                                            ADDRESS                @L1A 36479200
         AGO    .NEXT1                     GO CONTINUE EXECUTE FORM    X36479600
                                                                   @L1A 36480000
.REG1    ANOP   ,                                                  @L1A 36480400
         LAE    1,0(0,&EPLV)               TCBTOKEN PARAMETER LIST     X36480800
                                            ADDRESS                @L1A 36481200
.*                                                                      36481600
.NEXT1   ANOP   ,                                                  @L1A 36482000
         XC     0(24,1),0(1)               CLEAR PARAMETER LIST    @L1A 36482400
.*                                                                      36482800
.********************************************************************   36483200
.*    GENERATE PARAMETER LIST                                       *   36483600
.********************************************************************   36484000
.*                                                                      36484400
         MVI    20(1),&TYP                 MOVE TYPE OF REQUEST INTO   X36484800
                                            THE PARAMETER LIST     @L1A 36485200
.*                                                                      36485600
.********************************************************************   36486000
.*    GENERATE PC LINKAGE TO TCBTOKEN SERVICE ROUTINE.  NOTE - R14  *   36486400
.*    IS USED AS AN INDEX REGISTER TO AVOID SETTING AR14 TO ZERO.   *   36486800
.********************************************************************   36487200
.*                                                                      36487600
.PCLNK   ANOP   ,                                                  @L1A 36488000
         L      14,16(0,0)                 GET ADDRESS OF CVT      @L1A 36488400
         L      14,772(14,0)               GET ADDRESS OF SFT      @L1A 36488800
         L      14,212(14,0)               GET LX/EX FOR SERVICE       X36489200
                                            ROUTINE                @L1A 36489600
         PC     0(14)                      PC TO TCBTOKEN SERVICE  @L1A 36490000
.*                                                                      36490400
.********************************************************************   36490800
.*    STORE THE TTOKEN INTO THE USER'S AREA                         *   36491200
.********************************************************************   36491600
.*                                                                      36492000
         LAE    14,&TTOKEN                 GET ADDRESS OF USER'S AREA  X36492400
                                                                   @L1A 36492800
         MVC    0(16,14),0(1)              STORE TTOKEN FROM THE       X36493200
                                            PARM LIST              @L1A 36493600
         MEXIT                                                     @L1A 36494000
.*                                                                      36500000
.********************************************************************   36550000
.*      MNOTES                                                      *   36600000
.********************************************************************   36650000
.*                                                                      36700000
.ERR01   ANOP   ,                                                       36750000
         MNOTE  8,' EXCESSIVE POSITIONAL PARAMETERS '              @L1C 36800000
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              36850000
         AGO    .NOPOS                                                  36900000
.*                                                                      36950000
.ERR02   ANOP   ,                                                       37000000
         MNOTE  8,' FOR ''TYPE'' KEYWORD - TOO MANY SUBLISTS SPECIFIED'X37033300
                                                                   @L1C 37066600
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              37100000
         AGO    .OKSUBL                                                 37150000
.*                                                                      37200000
.ERR03   ANOP   ,                                                       37250000
         MNOTE  8,' ''&TYPE(1)'' IS AN INVALID VALUE FOR TYPE KEYWORD' X37300000
                                                                   @L1C 37350000
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              37400000
         AGO    .CHKTCB                                                 37450000
.*                                                                      37500000
.ERR04   ANOP   ,                                                       37550000
         MNOTE  8,' FOR ''TCB'' KEYWORD - TOO MANY SUBLISTS SPECIFIED' X37583300
                                                                   @L1C 37616600
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              37650000
         AGO    .CHKTTKN                                                37700000
.*                                                                      37750000
.ERR05   ANOP   ,                                                       37800000
         MNOTE  8,' ''TCB'' KEYWORD -  MUST USE REGISTER 2 THROUGH 12' X37833300
                                                                   @L1C 37866600
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              37900000
         AGO    .CHKTTKN                                                37950000
.*                                                                      38000000
.ERR06   ANOP   ,                                                       38050000
         MNOTE  8,' FOR ''TTOKEN'' KEYWORD - TOO MANY SUBLISTS SPECIFIEX38083300
               D'                                                  @L1C 38116600
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              38150000
         AGO    .CHKSTKN                                                38200000
.*                                                                      38250000
.ERR07   ANOP   ,                                                       38300000
         MNOTE  8,' FOR ''TTOKEN'' KEYWORD - REGISTER DESIGNATION NOT AX38350000
               LLOWED'                                             @L1C 38400000
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              38450000
         AGO    .CHKSTKN                                                38500000
.*                                                                      38550000
.ERR08   ANOP   ,                                                       38600000
         MNOTE  8,' FOR ''STOKEN'' KEYWORD - TOO MANY SUBLISTS SPECIFIEX38633300
               D'                                                  @L1C 38666600
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              38700000
         AGO    .CHKASCB                                                38750000
.*                                                                      38800000
.ERR09   ANOP   ,                                                       38850000
         MNOTE  8,' FOR ''STOKEN'' KEYWORD - REGISTER DESIGNATION NOT AX38900000
               LLOWED'                                             @L1C 38950000
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              39000000
         AGO    .CHKASCB                                                39050000
.*                                                                      39100000
.ERR10   ANOP   ,                                                       39150000
         MNOTE  8,' FOR ''ASCB'' KEYWORD - TOO MANY SUBLISTS SPECIFIED'X39183300
                                                                   @L1C 39216600
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              39250000
         AGO    .CHKMF                                                  39300000
.*                                                                      39350000
.ERR11   ANOP   ,                                                       39400000
         MNOTE  8,' ''ASCB'' KEYWORD - MUST USE REGISTER 2 THROUGH 12 'X39433300
                                                                   @L1C 39466600
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              39500000
         AGO    .CHKMF                                                  39550000
.*                                                                      39600000
.ERR12   ANOP   ,                                                       39650000
         MNOTE  8,' FOR ''MF'' KEYWORD - TOO MANY SUBLISTS WERE SPECIFIX39683300
               ED'                                                 @L1C 39716600
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              39750000
         AGO    .EXITMF                                                 39800000
.*                                                                      39850000
.ERR13   ANOP   ,                                                       39900000
         MNOTE  8,' ''MF'' KEYWORD SHOULD BE EITHER ''E'' OR ''L'' '   X39933300
                                                                   @L1C 39966600
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              40000000
         AGO    .EXITMF                                                 40050000
.*                                                                      40100000
.ERR14   ANOP   ,                                                       40150000
         MNOTE  8,' FOR ''MF'' KEYWORD - NO PARAMETER LIST ADDRESS WAS X40200000
               SPECIFIED'                                          @L1C 40250000
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              40300000
         AGO    .EXITMF                                                 40350000
.*                                                                      40400000
.ERR15   ANOP   ,                                                       40450000
         MNOTE  8,' FOR ''MF'' KEYWORD - MORE THAN ONE REGISTER WAS SPEX40500000
               CIFIED FOR THE PARAMETER LIST ADDRESS -  &MF'       @L1C 40550000
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              40600000
         AGO    .EXITMF                                                 40650000
.*                                                                      40700000
.ERR16   ANOP   ,                                                       40750000
         MNOTE  8,' ''MF'' KEYWORD MUST USE REGISTER 1 THROUGH 12' @L1C 40800000
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              40850000
         AGO    .EXITMF                                                 40900000
.*                                                                      40950000
.ERR17   ANOP   ,                                                       41000000
         MNOTE  8,' ''&KW1(&AWK)'' KEYWORD NOT VALID WITH MF=L REQUEST' 41050000
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              41100000
         AGO    .MFL2                                                   41150000
.*                                                                      41200000
.ERR18   ANOP   ,                                                       41250000
         MNOTE  8,' ''&KW1(&AWK)'' KEYWORD REQUIRED WHEN LIST OPTION NOX41300000
               T REQUESTED'                                        @L1C 41350000
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              41400000
         AGO    .DEPEND2                                           @L1C 41450000
.*                                                                      41500000
.ERR19   ANOP   ,                                                       41550000
         MNOTE  8,' ''STOKEN'' AND ''ASCB'' KEYWORDS ARE MUTUALLY EXCLUX41583300
               SIVE'                                               @L1C 41616600
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              41650000
         AGO    .ITSTCB                                                 41700000
.*                                                                      41750000
.ERR20   ANOP   ,                                                       41800000
         MNOTE  8,' ''STOKEN'' KEYWORD NOT VALID WITH ''TOTCB'' REQUESTX41833300
               '                                                   @L1C 41866600
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED              41900000
         AGO    .NOSTKN                                                 41950000
.ERR21   ANOP   ,                                                       42050000
         MNOTE  8,' ''&KW1(&AWK)'' KEYWORD REQUIRED WITH ''&TYPE(1)'' RX42063300
               EQUEST'                                             @L1A 42076600
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED         @L1A 42089900
         AGO    .DEPEND2                                           @L1A 42103200
.ERR22   ANOP   ,                                                  @L1A 42116500
         MNOTE  8,' ''&KW1(&AWK)'' KEYWORD REQUIRED WITH ''&TYPE(1)'' RX42129800
               EQUEST'                                             @L1A 42143100
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED         @L1A 42156400
         AGO    .DEPEND4                                           @L1A 42169700
.ERR23   ANOP   ,                                                  @L1A 42183000
         MNOTE  8,' ''&KW1(&AWK)'' KEYWORD NOT VALID WITH ''&TYPE(1)'' X42196300
               REQUEST'                                            @L1A 42209600
&ENDIT   SETB   1                  INDICATE ERROR OCCURRED         @L1A 42222900
         AGO    .DEPEND7                                           @L1A 42236200
.*                                                                      42250000
.EXIT    ANOP   ,                                                       42300000
.*                                                                      42350000
         MEND                                                      */   42400000
*%TCBTOKEN:                                                             42450000
*    MACRO KEYS(TYPE,TCB,TTOKEN,STOKEN,ASCB,MF,RELATED                  42483300
*              ,NOVIAONDCL);                                            42516600
*    ANS ('?'||MACLABEL||'TCBTOKNP '||MACLIST||MACKEYS||';');           42550000
*    %END TCBTOKEN;                                                     42600000
