REM WYL.GA.PUB.CODE.GAMES#CHESS, CREATED 07/79/79                          1.
REM         CHESS BASIC                                                  100.
REM COPYRIGHT STEPHEN TENBERG 1977                                       110.
REM  (MODIFIED FOR PERSONAL USE, MARK BARNETT 1978)                      111.
REM  ALL RIGHTS RESERVED                                                 120.
PRINT "----COPYRIGHTED CHESS PROGRAM----"                                121.
PRINT "DO YOU WANT INSTRUCTIONS (Y OR N)";                               130.
R0=-1                                                                    131.
INPUTQ$                                                                  140.
IF Q$="Y" THEN GOSUB 6070                                                150.
H5=8                                                                     160.
I5=4                                                                     170.
DATA-5,-3,-4,-9,-7,-4,-3,-5                                              180.
DIM B$(8)                                                                188.
DATA-1,-1,-1,-1,-1,-1,-1,-1                                              190.
DIMB(8,8),M(8)                                                           200.
REM RANDOMIZE                                                            210.
R=V6=0                                                                   220.
F9=F2=F1=F4=0                                                            230.
S6=S1=S8=0                                                               240.
FORJ=1TO6                                                                250.
FORK=1TO8                                                                260.
B(J,K)=0                                                                 270.
IF J>2 THEN 310                                                          280.
READV                                                                    290.
B(J,K)=V                                                                 300.
NEXTK                                                                    310.
NEXTJ                                                                    320.
RESTORE                                                                  330.
FORJ=8TO7STEP-1                                                          340.
FORK=1TO8                                                                350.
M(K)=0                                                                   360.
READV                                                                    370.
B(J,K)=ABS(V)                                                            380.
NEXTK                                                                    390.
NEXTJ                                                                    400.
B$(1)='A'                                                                410.
B$(2)='B'                                                                411.
B$(3)='C'                                                                412.
B$(4)='D'                                                                413.
B$(5)='E'                                                                414.
B$(6)='F'                                                                415.
B$(7)='G'                                                                416.
B$(8)='H'                                                                417.
PRINT                                                                    460.
GOSUB 2770                                                               470.
GOSUB 750                                                                480.
GOTO 470                                                                 490.
L=ABS(B(X,Y))+1                                                          500.
GOTO 530                                                                 510.
L9=B(C,D)                                                                520.
L=ABS(L9)+1                                                              521.
ON L GOTO 540,570,540,600,630,660,540,690,540,720                        530.
C$="."                                                                   540.
D$="CHARACTER ERROR"                                                     550.
GOTO 740                                                                 560.
C$="P"                                                                   570.
IF L9<0 THEN C$='p'                                                      571.
D$="PAWN"                                                                580.
GOTO 740                                                                 590.
IF L9>0 THEN C$="N"                                                      600.
IF L9<0 THEN C$='n'                                                      601.
D$="KNIGHT"                                                              610.
GO TO 740                                                                620.
IF L9>0 THEN C$="B"                                                      630.
IF L9<0 THEN C$='b'                                                      631.
D$="BISHOP"                                                              640.
GOTO 740                                                                 650.
IF L9>0 THEN C$="R"                                                      660.
IF L9<0 THEN C$='r'                                                      661.
D$="ROOK"                                                                670.
GOTO 740                                                                 680.
IF L9>0 THEN C$="Q"                                                      690.
IF L9<0 THEN C$='q'                                                      691.
D$="QUEEN"                                                               700.
GOTO 740                                                                 710.
IF L9>0 THEN C$="K"                                                      720.
IF L9<0 THEN C$='k'                                                      721.
D$="KING"                                                                730.
RETURN                                                                   740.
GOSUB 5700                                                               750.
IF R<1 THEN 1080                                                         760.
IF V6>-10 THEN 900                                                       770.
C=H2                                                                     780.
D=I2                                                                     790.
X=0                                                                      800.
X=X+1                                                                    801.
Y=0                                                                      810.
Y=Y+1                                                                    811.
IF B(X,Y)<=0 THEN 850                                                    820.
GOSUB 1720                                                               830.
IF Q=1 THEN 1660                                                         840.
IF Y<8 THEN 811                                                          850.
IF X<8 THEN 801                                                          860.
PRINT "AFTER";R;"MOVES, ITS A STALEMATE."                                870.
PRINT "GOOD PLAY!"                                                       880.
STOP                                                                     890.
X=X8-1                                                                   900.
X=X+1                                                                    901.
Y=Y8-1                                                                   910.
Y=Y+1                                                                    911.
IF B(X,Y)<=0 THEN 1020                                                   920.
C=0                                                                      930.
C=C+1                                                                    931.
D=0                                                                      940.
D=D+1                                                                    941.
IF B(C,D)>0 THEN 1000                                                    950.
GOSUB 1720                                                               960.
IF Q=0 THEN 1000                                                         970.
GOSUB 4260                                                               980.
IF Q=1 THEN 1080                                                         990.
IF D<8 THEN 941                                                         1000.
IF C<8 THEN 931                                                         1010.
IF Y<Y9 THEN 911                                                        1020.
IF X<X9 THEN 901                                                        1030.
IF C5=0 THEN 870                                                        1040.
PRINT "THE COMPUTER HAS DEFEATED YOU"                                   1050.
PRINT "IN";R;"MOVES."                                                   1060.
STOP                                                                    1070.
PRINT "WHERE IS THE PIECE YOU WANT TO MOVE? ";                          1080.
INPUT Y$                                                                1090.
X$=LST(Y$,1)                                                            1091.
Y$=RST(Y$,1)                                                            1092.
X=NDX('ABCDEFGH12345678X',X$)                                           1093.
Y=NDX('ABCDEFGH12345678',Y$)                                            1094.
IF X<>17 THEN 1150                                                      1100.
GOSUB 4760                                                              1110.
IF F9=0 THEN 1080                                                       1120.
R=R+1                                                                   1130.
GOTO 1690                                                               1140.
IF X>8 THEN X=X-8                                                       1150.
IF Y>8 THEN Y=Y-8                                                       1151.
IF X=0 THEN 1210                                                        1153.
IF Y=0 THEN 1210                                                        1160.
IF B(X,Y)<=0 THEN 1210                                                  1190.
GOTO 1230                                                               1200.
PRINT "WHAT?....THERES NO SUCH PIECE."                                  1210.
GOTO 1080                                                               1220.
GOSUB 500                                                               1230.
PRINT D$;" MOVES TO WHERE? ";                                           1240.
INPUT Y$                                                                1251.
X$=LST(Y$,1)                                                            1252.
Y$=RST(Y$,1)                                                            1253.
C=NDX('ABCDEFGH12345678N',X$)                                           1254.
D=NDX('ABCDEFGH12345678',Y$)                                            1255.
IF C=17 THEN 1080                                                       1260.
IF C>8 THEN C=C-8                                                       1261.
IF D>8 THEN D=D-8                                                       1262.
IF C=0 THEN 1210                                                        1270.
IF D=0 THEN 1210                                                        1280.
IF B(C,D)<=0 THEN 1340                                                  1310.
PRINT "YOU CANT TAKE YOUR OWN PIECE?"                                   1320.
GOTO 1080                                                               1330.
IF X<>4 THEN 1440                                                       1340.
IF C<>3 THEN 1440                                                       1350.
IF ABS(Y-D)<>1 THEN 1440                                                1360.
IF B(X,Y)<>1 THEN 1440                                                  1370.
IF M(D)<>1 THEN 1440                                                    1380.
GOSUB 4260                                                              1390.
IF Q=0 THEN 1480                                                        1400.
B(X,D)=0                                                                1410.
PRINT "AND YOU TAKE MY PAWN, EN PASSENT"                                1420.
GOTO 1540                                                               1430.
GOSUB 1720                                                              1440.
IF Q=0 THEN 1490                                                        1450.
GOSUB 4260                                                              1460.
IF Q=1 THEN 1510                                                        1470.
PRINT "YOU CANNOT MOVE INTO CHECK."                                     1480.
PRINT "ILLEGAL MOVE."                                                   1490.
GOTO 1080                                                               1500.
IF B(C,D)=0 THEN 1540                                                   1510.
GOSUB 520                                                               1520.
PRINT "AND YOU TAKE MY ";D$                                             1530.
B(C,D)=B(X,Y)                                                           1540.
R=R+1                                                                   1550.
IF B(C,D)=9 THEN F2=1                                                   1560.
IF B(C,D)<>5 THEN 1600                                                  1570.
IF Y=8 THEN F1=1                                                        1580.
IF Y=1 THEN F4=1                                                        1590.
B(X,Y)=0                                                                1600.
IF B(C,D)<>1 THEN 1690                                                  1610.
IF C<>1 THEN 1690                                                       1620.
B(C,D)=7                                                                1630.
PRINT "(PAWN PROMOTED TO QUEEN)"                                        1640.
GOTO 1690                                                               1650.
PRINT "CONGRATULATIONS YOU HAVE"                                        1660.
PRINT "CHECKMATED THE COMPUTER IN";R;"MOVES."                           1670.
STOP                                                                    1680.
REM PRINT "ACCEPTED"                                                    1690.
REM  GOSUB 5700   TO PRINT THE BOARD AFTER PLAYER MOVES                 1700.
RETURN                                                                  1710.
ON ABS(B(X,Y)) GOTO 1730,1950,1950,2230,2010,1950,2570,1950,2600        1720.
IF ABS(Y-D)>1 THEN 2750                                                 1730.
IF ABS(X-C)>2 THEN 2750                                                 1740.
IF B(X,Y)>0 THEN 1850                                                   1750.
IF B(C,D)=0 THEN 1790                                                   1760.
IF C<>X+1 THEN 2750                                                     1770.
GOTO 1870                                                               1780.
IF C=X+1 THEN 1830                                                      1790.
IF C<>4 THEN 2750                                                       1800.
IF X<>2 THEN 2750                                                       1810.
IF B(3,D)<>0 THEN 2750                                                  1820.
IF D<>Y THEN 2750                                                       1830.
GOTO 2730                                                               1840.
IF B(C,D)=0 THEN 1890                                                   1850.
IF C<>X-1 THEN 2750                                                     1860.
IF ABS(D-Y)<>1 THEN 2750                                                1870.
GOTO 2730                                                               1880.
IF C=X-1 THEN 1830                                                      1890.
IF C<>5 THEN 2750                                                       1900.
IF X<>7 THEN 2750                                                       1910.
IF B(6,D)<>0 THEN 2750                                                  1920.
GOTO 1830                                                               1930.
REMKNIGHT                                                               1940.
IF ABS(C-X)>2 THEN 2750                                                 1950.
IF ABS(D-Y)>2 THEN 2750                                                 1960.
IF X=C THEN 2750                                                        1970.
IF Y=D THEN 2750                                                        1980.
IF ABS(C-X)=ABS(D-Y) THEN 2750                                          1990.
GOTO 2730                                                               2000.
IF X=C THEN 2130                                                        2010.
IF Y<>D THEN 2750                                                       2020.
IF ABS(C-X)=1 THEN 2730                                                 2030.
IF X>C THEN 2090                                                        2040.
FORK=X+1TOC-1                                                           2050.
IF B(K,D)<>0 THEN 2750                                                  2060.
NEXTK                                                                   2070.
GOTO 2730                                                               2080.
FORK=C+1TOX-1                                                           2090.
IF B(K,D)<>0 THEN 2750                                                  2100.
NEXTK                                                                   2110.
GOTO 2730                                                               2120.
IF ABS(D-Y)=1 THEN 2730                                                 2130.
IF Y>D THEN 2190                                                        2140.
FORK=Y+1TOD-1                                                           2150.
IF B(X,K)<>0 THEN 2750                                                  2160.
NEXTK                                                                   2170.
GOTO 2730                                                               2180.
FORK=D+1TOY-1                                                           2190.
IF B(X,K)<>0 THEN 2750                                                  2200.
NEXTK                                                                   2210.
GOTO 2730                                                               2220.
IF ABS(C-X)<>ABS(D-Y) THEN 2750                                         2230.
D4=D                                                                    2240.
C4=C                                                                    2250.
IF ABS(C-X)<>1 THEN 2280                                                2260.
IF ABS(D-Y)=1 THEN 2730                                                 2270.
IF C<X THEN 2360                                                        2280.
IF D<Y THEN 2360                                                        2290.
FORL=1TOC-X-1                                                           2300.
D4=D4-1                                                                 2310.
C4=C4-1                                                                 2320.
IF B(C4,D4)<>0 THEN 2750                                                2330.
NEXTL                                                                   2340.
GOTO 2730                                                               2350.
IF C>X THEN 2440                                                        2360.
IF D>Y THEN 2440                                                        2370.
FORL=1TOX-C-1                                                           2380.
C4=C4+1                                                                 2390.
D4=D4+1                                                                 2400.
IF B(C4,D4)<>0 THEN 2750                                                2410.
NEXTL                                                                   2420.
GOTO 2730                                                               2430.
IF X<C THEN 2510                                                        2440.
FORL=1TOX-C-1                                                           2450.
C4=C4+1                                                                 2460.
D4=D4-1                                                                 2470.
IF B(C4,D4)<>0 THEN 2750                                                2480.
NEXTL                                                                   2490.
GOTO 2730                                                               2500.
FORL=1TOC-X-1                                                           2510.
C4=C4-1                                                                 2520.
D4=D4+1                                                                 2530.
IF B(C4,D4)<>0 THEN 2750                                                2540.
NEXTL                                                                   2550.
GOTO 2730                                                               2560.
IF X=C THEN 2010                                                        2570.
IF Y=D THEN 2010                                                        2580.
GOTO 2230                                                               2590.
IF ABS(C-X)>1 THEN 2750                                                 2600.
IF ABS(Y-D)>1 THEN 2750                                                 2610.
IF X<>Y THEN 2640                                                       2620.
IF C=D THEN 2750                                                        2630.
FORX3=C-1TOC+1                                                          2640.
FORY3=D-1TOD+1                                                          2650.
IF X3>8 THEN 2710                                                       2660.
IF Y3>8 THEN 2710                                                       2670.
IF X3<1 THEN 2710                                                       2680.
IF Y3<1 THEN 2710                                                       2690.
IF B(X3,Y3)+B(X,Y)=0 THEN 2750                                          2700.
NEXTY3                                                                  2710.
NEXTX3                                                                  2720.
Q=1                                                                     2730.
RETURN                                                                  2740.
Q=0                                                                     2750.
RETURN                                                                  2760.
X8=Y8=8                                                                 2770.
X9=Y9=C9=D9=1                                                           2780.
FORH=1TO8                                                               2790.
M(H)=0                                                                  2800.
FORI=1TO8                                                               2810.
IF B(H,I)<=0 THEN 2900                                                  2820.
IF H<X8 THEN X8=H                                                       2830.
IF I<Y8 THEN Y8=I                                                       2840.
IF H>X9 THEN X9=H                                                       2850.
IF I>Y9 THEN Y9=I                                                       2860.
IF B(H,I)<>9 THEN 2960                                                  2870.
H5=H                                                                    2880.
I5=I                                                                    2890.
IF B(H,I)=0 THEN 2960                                                   2900.
IF H>C9 THEN C9=H                                                       2910.
IF I>D9 THEN D9=I                                                       2920.
IF B(H,I)<>-9 THEN 2960                                                 2930.
H2=H                                                                    2940.
I2=I                                                                    2950.
NEXTI                                                                   2960.
NEXTH                                                                   2970.
V6=-10                                                                  2980.
P1=C8=0                                                                 2990.
X=0                                                                     3000.
X=X+1                                                                   3001.
Y=0                                                                     3010.
Y=Y+1                                                                   3011.
IF B(X,Y)>=0 THEN 3400                                                  3020.
C=0                                                                     3030.
C=C+1                                                                   3031.
D=0                                                                     3040.
D=D+1                                                                   3041.
IF B(C,D)<0 THEN 3380                                                   3050.
GOSUB 1720                                                              3060.
IF Q=0 THEN 3380                                                        3070.
GOSUB 3820                                                              3080.
IF M8=10 THEN 3380                                                      3090.
IF C8=1 THEN GOSUB 4470                                                 3100.
V4=V4+2.5*RND(R0)/(ABS(C-H5)+ABS(D-I5))                                 3110.
IF S6=1 THEN 3260                                                       3120.
IF X<>1 THEN 3230                                                       3130.
IF Y=4 THEN V4=V4-1                                                     3140.
IF S1=1 THEN 3190                                                       3150.
IF Y>3 THEN 3190                                                        3160.
IF Y=1 THEN V4=V4-1                                                     3170.
IF Y>1 THEN V4=V4+1.2                                                   3180.
IF S8=1 THEN 3260                                                       3190.
IF Y<5 THEN 3230                                                        3200.
IF Y<8 THEN V4=V4+1.2                                                   3210.
IF Y=8 THEN V4=V4-1                                                     3220.
IF X<>2 THEN 3260                                                       3230.
IF Y=2 THEN V4=V4+1                                                     3240.
IF Y=5 THEN V4=V4+1                                                     3250.
V5=B(C,D)+V4                                                            3260.
IF C<>8 THEN 3270                                                       3262.
IF B(X,Y)<>-1 THEN 3270                                                 3264.
V5=V5+3                                                                 3266.
IF V5<V6 THEN 3380                                                      3270.
V6=V5                                                                   3280.
X6=X                                                                    3290.
Y6=Y                                                                    3340.
C5=C8                                                                   3350.
C6=C                                                                    3360.
D6=D                                                                    3370.
IF D<8 THEN 3041                                                        3380.
IF C<8 THEN 3031                                                        3390.
IF Y<D9 THEN 3011                                                       3400.
IF X<C9 THEN 3001                                                       3410.
IF V6=-10 THEN 3740                                                     3420.
IF S6=1 THEN 3510                                                       3430.
IF V6>2 THEN 3510                                                       3440.
IF S1=1 THEN 3480                                                       3450.
GOSUB 5420                                                              3460.
IF S6=1 THEN 3790                                                       3470.
IF S8=1 THEN 4830                                                       3480.
GOSUB 5270                                                              3490.
IF S6=1 THEN 3790                                                       3500.
X=X6                                                                    3510.
Y=Y6                                                                    3520.
C=C6                                                                    3530.
D=D6                                                                    3540.
GOSUB 500                                                               3550.
IF B(X,Y)<>-1 THEN 3580                                                 3560.
IF C=X+2 THEN M(D)=1                                                    3570.
REM PRINT    NO NEED FOR AN EXTRA SPACE                                 3580.
PRINT "AND THE COMPUTER MOVES ";D$;" TO ";B$(C);D                       3590.
IF B(C,D)=0 THEN 3630                                                   3600.
GOSUB 520                                                               3610.
PRINT "AND TAKES YOUR ";D$                                              3620.
B(C,D)=B(X,Y)                                                           3630.
IF C5=1 THEN PRINT  "...CHECK!"                                         3640.
B(X,Y)=0                                                                3650.
IF C<>8 THEN 3690                                                       3660.
IF B(C,D)<>-1 THEN 3690                                                 3662.
PRINT "COMPUTER PROMOTES TO QUEEN"                                      3670.
B(C,D)=-7                                                               3680.
PRINT                                                                   3690.
IF X<>H2 THEN 3740                                                      3700.
IF Y<>I2 THEN 3740                                                      3710.
H2=C                                                                    3720.
I2=D                                                                    3730.
IF B(C,D)=-9 THEN S6=1                                                  3740.
IF B(C,D)<>-5 THEN 3780                                                 3750.
IF Y=1 THEN S1=1                                                        3760.
IF Y=8 THEN S8=8                                                        3770.
RETURN                                                                  3780.
PRINT                                                                   3790.
PRINT "AND THE COMPUTER CASTLES."                                       3800.
GOTO 3780                                                               3810.
X2=X                                                                    3820.
C2=C                                                                    3830.
D2=D                                                                    3840.
Y2=Y                                                                    3850.
P4=B(C,D)                                                               3860.
Z7=C9                                                                   3870.
Z4=D9                                                                   3880.
B(C,D)=B(X,Y)                                                           3890.
C8=M8=V4=B(X,Y)=0                                                       3900.
IF C>C9 THEN C9=C                                                       3910.
IF D>D9 THEN D9=D                                                       3920.
C=0                                                                     3930.
C=C+1                                                                   3931.
D=0                                                                     3940.
D=D+1                                                                   3941.
IF B(C,D)>=-1 THEN 4070                                                 3950.
X=X8-1                                                                  3960.
X=X+1                                                                   3961.
Y=Y8-1                                                                  3970.
Y=Y+1                                                                   3971.
IF B(X,Y)<=0 THEN 4050                                                  3980.
GOSUB 1720                                                              3990.
IF Q=0 THEN 4050                                                        4000.
N4=B(C,D)                                                               4010.
IF N4=-9 THEN M8=10                                                     4020.
IF ABS(N4)<B(X,Y) THEN GOSUB 5830                                       4030.
IF N4<V4 THEN V4=N4                                                     4040.
IF Y<Y9 THEN 3971                                                       4050.
IF X<X9 THEN 3961                                                       4060.
IF D<D9 THEN 3941                                                       4070.
IF C<C9 THEN 3931                                                       4080.
X=C2                                                                    4090.
Y=D2                                                                    4100.
C=H5                                                                    4110.
D=I5                                                                    4120.
IF C>Z7 THEN C9=Z7                                                      4130.
IF D>Z4 THEN D9=Z4                                                      4140.
GOSUB 1720                                                              4150.
IF Q=0 THEN 4190                                                        4160.
C8=1                                                                    4170.
V4=V4+1                                                                 4180.
C=C2                                                                    4190.
D=D2                                                                    4200.
X=X2                                                                    4210.
Y=Y2                                                                    4220.
B(X,Y)=B(C,D)                                                           4230.
B(C,D)=P4                                                               4240.
RETURN                                                                  4250.
X2=X                                                                    4260.
Y2=Y                                                                    4270.
C2=C                                                                    4280.
D2=D                                                                    4290.
P4=B(C,D)                                                               4300.
B(C,D)=B(X,Y)                                                           4310.
B(X,Y)=0                                                                4320.
IF B(C,D)=9 THEN 4360                                                   4330.
C=H5                                                                    4340.
D=I5                                                                    4350.
X=0                                                                     4360.
X=X+1                                                                   4361.
Y=0                                                                     4370.
Y=Y+1                                                                   4371.
IF B(X,Y)>=0 THEN 4410                                                  4380.
GOSUB 1720                                                              4390.
IF Q=1 THEN 4450                                                        4400.
IF Y<8 THEN 4371                                                        4410.
IF X<8 THEN 4361                                                        4420.
Q=1                                                                     4430.
GOTO 4190                                                               4440.
Q=0                                                                     4450.
GOTO 4190                                                               4460.
E5=B(C,D)                                                               4470.
E1=X                                                                    4480.
E2=Y                                                                    4490.
E3=C                                                                    4500.
E4=D                                                                    4510.
B(C,D)=B(X,Y)                                                           4520.
B(X,Y)=0                                                                4530.
X=X8-1                                                                  4540.
X=X+1                                                                   4541.
Y=Y8-1                                                                  4550.
Y=Y+1                                                                   4551.
IF B(X,Y)<=0 THEN 4660                                                  4560.
C=0                                                                     4570.
C=C+1                                                                   4571.
D=0                                                                     4580.
D=D+1                                                                   4581.
IF B(C,D)>0 THEN 4640                                                   4590.
GOSUB 1720                                                              4600.
IF Q=0 THEN 4640                                                        4610.
GOSUB 4260                                                              4620.
IF Q=1 THEN 4690                                                        4630.
IF D<8 THEN 4581                                                        4640.
IF C<8 THEN 4571                                                        4650.
IF Y<Y9 THEN 4551                                                       4660.
IF X<X9 THEN 4541                                                       4670.
V4=100                                                                  4680.
X=E1                                                                    4690.
Y=E2                                                                    4700.
C=E3                                                                    4710.
D=E4                                                                    4720.
B(X,Y)=B(C,D)                                                           4730.
B(C,D)=E5                                                               4740.
RETURN                                                                  4750.
PRINT "(CASTLING)"                                                      4760.
A$=" "                                                                  4770.
IF F9=1 THEN A$="CASTLED PREVIOUSLY"                                    4780.
IF F2=1 THEN A$="PREVIOUSLY MOVED YOUR KING"                            4790.
IF C5=1 THEN A$="MAY NOT CASTLE OUT OF CHECK"                           4800.
IF A$<>" " THEN 4940                                                    4810.
PRINT "KINGS SIDE OR QUEENS (K OR Q)";                                  4820.
INPUTV$                                                                 4830.
IF V$="K" THEN 4900                                                     4840.
IF F1=1 THEN GOSUB 5250                                                 4850.
G1=4                                                                    4860.
G1=G1+1                                                                 4861.
GOSUB 5100                                                              4870.
IF G1<6 THEN 4861                                                       4880.
GOTO 4940                                                               4890.
G1=1                                                                    4900.
G1=G1+1                                                                 4901.
IF F4=1 THEN GOSUB 5250                                                 4910.
GOSUB 5100                                                              4920.
IF G1<3 THEN 4901                                                       4930.
IF A$=" " THEN 4990                                                     4940.
F9=0                                                                    4950.
PRINT "YOU CANNOT CASTLE BECAUSE:"                                      4960.
PRINT "YOU ";A$                                                         4970.
GOTO 5090                                                               4980.
F9=1                                                                    4990.
B(8,4)=0                                                                5000.
IF V$="K" THEN 5060                                                     5010.
B(8,6)=9                                                                5020.
B(8,8)=0                                                                5030.
B(8,5)=5                                                                5040.
GOTO 5090                                                               5050.
B(8,2)=9                                                                5060.
B(8,1)=0                                                                5070.
B(8,3)=5                                                                5080.
RETURN                                                                  5090.
IF B(8,G1)<>0 THEN 5230                                                 5100.
D=G1                                                                    5110.
C=8                                                                     5120.
X=0                                                                     5130.
X=X+1                                                                   5131.
Y=0                                                                     5140.
Y=Y+1                                                                   5141.
IF B(X,Y)>=0 THEN 5180                                                  5150.
GOSUB 1720                                                              5160.
IF Q=1 THEN 5210                                                        5170.
IF Y<8 THEN 5141                                                        5180.
IF X<8 THEN 5131                                                        5190.
GOTO 5240                                                               5200.
A$="HAVE CONTROLLED SQUARES BETWEEN ROOK AND KING"                      5210.
GOTO 5240                                                               5220.
A$="HAVE A PIECE BETWEEN ROOK AND KING"                                 5230.
RETURN                                                                  5240.
A$="PREVIOUSLY MOVED YOUR ROOK"                                         5250.
RETURN                                                                  5260.
C=1                                                                     5270.
D=1                                                                     5280.
D=D+1                                                                   5281.
GOSUB 5570                                                              5290.
IF Q=1 THEN 5410                                                        5300.
IF D<4 THEN 5281                                                        5310.
X=Y=1                                                                   5320.
D=3                                                                     5330.
GOSUB 3820                                                              5340.
IF V4<-2 THEN 5410                                                      5350.
B(1,4)=B(1,1)=0                                                         5360.
B(1,2)=-9                                                               5370.
I2=2                                                                    5380.
B(1,3)=-5                                                               5390.
S6=1                                                                    5400.
RETURN                                                                  5410.
C=1                                                                     5420.
D=3                                                                     5430.
D=D+1                                                                   5431.
GOSUB 5570                                                              5440.
IF Q=1 THEN 5410                                                        5450.
IF D<7 THEN 5431                                                        5460.
X=C=1                                                                   5470.
Y=8                                                                     5480.
D=5                                                                     5490.
GOSUB 3820                                                              5500.
IF V4<-2 THEN 5410                                                      5510.
B(1,4)=B(1,8)=0                                                         5520.
B(1,6)=-9                                                               5530.
I2=6                                                                    5540.
B(1,5)=-5                                                               5550.
GOTO 5400                                                               5560.
Q=0                                                                     5570.
IF B(C,D)=-9 THEN 5600                                                  5580.
IF B(C,D)<>0 THEN 5680                                                  5590.
X=X8-1                                                                  5600.
X=X+1                                                                   5601.
Y=Y8-1                                                                  5610.
Y=Y+1                                                                   5611.
IF B(X,Y)<=0 THEN 5650                                                  5620.
GOSUB 1720                                                              5630.
IF Q=1 THEN 5670                                                        5640.
IF Y<Y9 THEN 5611                                                       5650.
IF X<X9 THEN 5601                                                       5660.
RETURN                                                                  5670.
Q=1                                                                     5680.
GOTO 5670                                                               5690.
C=0                                                                     5700.
PRINT " ------------------------"                                       5705.
C=C+1                                                                   5706.
D=0                                                                     5720.
D=D+1                                                                   5721.
GOSUB 520                                                               5730.
IF D=1 THEN PRINT '|';                                                  5740.
IF D<8 THEN PRINT ' ';C$;' ';                                           5750.
IF D=8 THEN PRINT " ";C$;" | ";B$(C)                                    5760.
IF D<8 THEN 5721                                                        5770.
IF C<8 THEN 5706                                                        5780.
PRINT " ------------------------"                                       5790.
PRINT "  1  2  3  4  5  6  7  8"                                        5800.
PRINT                                                                   5810.
RETURN                                                                  5820.
IF N4<-6 THEN 6060                                                      5830.
X1=X                                                                    5835.
Y1=Y                                                                    5840.
C1=C                                                                    5850.
D1=D                                                                    5860.
P6=N4                                                                   5870.
B(C,D)=B(X,Y)                                                           5880.
B(X,Y)=0                                                                5890.
X=0                                                                     5900.
X=X+1                                                                   5901.
Y=0                                                                     5910.
Y=Y+1                                                                   5911.
IF B(X,Y)>=0 THEN 5960                                                  5920.
GOSUB 1720                                                              5940.
IF Q=1 THEN 5990                                                        5950.
IF Y<D9 THEN 5911                                                       5960.
IF X<C9 THEN 5901                                                       5970.
GOTO 6000                                                               5980.
N4=0                                                                    5990.
B(X1,Y1)=B(C1,D1)                                                       6000.
B(C1,D1)=P6                                                             6010.
X=X1                                                                    6020.
Y=Y1                                                                    6030.
C=C1                                                                    6040.
D=D1                                                                    6050.
RETURN                                                                  6060.
PRINT "AS THE COMPUTER REQUESTS IT,INPUT THE"                           6070.
PRINT "COORDINATES OF YOUR MOVE- FIRST THE"                             6080.
PRINT "LOCATION OF THE PIECE, THEN THE DESTINATION."                    6090.
PRINT "TYPE RC WHERE R IS THE RANK(ROW) LETTER AND C IS"                6100.
PRINT "THE FILE(COLUMN) NUMBER"                                         6110.
PRINT                                                                   6120.
PRINT"SPECIAL RULES"                                                    6130.
PRINT"-------------"                                                    6140.
PRINT "TO CASTLE, TYPE XX"                                              6150.
PRINT "TO START A MOVE ALL OVER, TYPE NO"                               6160.
PRINT"TO MOVE EN PASSENT,GIVE COORDINATES AS USUAL"                     6170.
PRINT                                                                   6240.
RETURN                                                                  6250.
END                                                                     6260.
