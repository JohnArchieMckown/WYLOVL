         MACRO                                                          00050000
&LABEL   CVAFVOL &ACCESS=,&BRANCH=,&IOAREA=,&MF=I,&UCB=                 00100000
.**** START OF SPECIFICATIONS ****************************************  00150000
.*                                                                      00200000
.*$MAC(CVAFVOL) COMP(DM1CV) PROD(DMS-XZ): CVAF - VIB INITIALIZATION     00250000
.*                                                                      00300000
.* DESCRIPTIVE-NAME = CVAF - VIB INITIALIZATION MACRO                   00350000
.*                                                                      00400000
.*PROPRIETARY V3 STATEMENT                                              00412500
.*LICENSED MATERIALS - PROPERTY OF IBM                                  00425000
.*"RESTRICTED MATERIALS OF IBM"                                         00437500
.*5695-DF1                                                              00450000
.*(C) COPYRIGHT 1980,1985  IBM CORP.                                    00462500
.*END PROPRIETARY V3 STATEMENT                                          00481200
.*                                                                      00500000
.* STATUS = RELEASE 2.1.0                                          @L1A 00550000
.*                                                                      00600000
.* FUNCTION = THIS MACRO WILL GENERATE CODE TO SET UP THE CVAF          00650000
.*     PARAMETER LIST TO ALLOW THE CALLER TO INITIALIZE THE VIB         00700000
.*     FOR THE SPECIFIED UCB.                                           00750000
.*                                                                      00800000
.*     THE 'MF' KEYWORD DETERMINES WHETHER THE CVAF PARAMETER LIST      00850000
.*     IS EXPANDED AND/OR EXECUTABLE INSTRUCTIONS ARE GENERATED TO      00900000
.*     INVOKE CVAF.                                                     00950000
.*                                                                      01000000
.*     THE SPECIFICATION OF MF=(E,ADDR), WILL RESULT IN THE             01050000
.*     MODIFICATION OF AN EXISTING CVAF PARAMETER LIST.  THE            01100000
.*     ADDRESS OF THE PARAMETER LIST IS PROVIDED VIA A SECOND           01150000
.*     SUBPARAMETER OF THE 'MF' KEYWORD.  IT ALSO GENERATES CODE        01200000
.*     NECESSARY TO EITHER BRANCH TO CVAF OR ISSUE SVC 139 TO INVOKE    01250000
.*     CVAF TO PERFORM THE REQUESTED FUNCTIONS.  THIS IS CALLED THE     01300000
.*     EXECUTE-FORM OF THE MACRO.                                       01350000
.*                                                                      01400000
.*     WITH A SPECIFICATION OF MF=I, OR NOT SPECIFYING THE 'MF'         01450000
.*     KEYWORD AT ALL, THIS MACRO WILL EXPAND THE CVAF PARAMETER        01500000
.*     LIST AND INITIALIZE IT ACCORDING TO THE OPTIONS SELECTED         01550000
.*     VIA THE ALLOWABLE KEYWORDS.  IT ALSO GENERATES CODE              01600000
.*     NECESSARY TO EITHER BRANCH TO CVAF OR ISSUE SVC 139 TO           01650000
.*     INVOKE CVAF TO PERFORM THE REQUESTED FUNCTIONS.  THIS IS         01700000
.*     CALLED THE INSTRUCTION-FORM (NORMAL-FORM) OF THE MACRO.          01750000
.*                                                                      01800000
.*     THE SPECIFICATION OF MF=L WILL RESULT IN THE EXPANSION OF THE    01850000
.*     PARAMETER LIST AND INITIALIZE IT ACCORDING TO THE SPECIFIED      01900000
.*     KEYWORDS. HOWEVER IT DOES NOT GENERATE THE CODE TO INVOKE        01950000
.*     CVAF.  THIS IS CALLED THE LIST-FORM OF THE MACRO.                02000000
.*                                                                      02050000
.*     KEYWORDS APPLICABLE TO THE CVAFVOL MACRO ARE:                    02100000
.*                                                                      02150000
.*       ACCESS  - WILL SET THE "CVFCTN" FIELD OF THE CVAF PARAMETER    02200000
.*                 LIST TO X'0B' FOR VIBBLD.  THIS KEYWORD IS           02250000
.*                 REQUIRED FOR THE MF=I FORM AND IS OPTIONAL           02300000
.*                 FOR THE MF=L OR MF=(E,ADDR) FORM.                    02350000
.*                                                                      02400000
.*                 VALID ENTRY  :  ACCESS=VIBBLD                        02450000
.*                                                                      02500000
.*       BRANCH  - WILL SET THE FLAG, CV1PGM, TO 1 IF (YES,PGM)         02550000
.*                 IS CODED OR RESET IT TO 0 IF (YES,SUP) IS CODED.     02600000
.*                 IF BRANCH=YES OR NO IS CODED, OR IN THE ABSENCE      02650000
.*                 OF THIS KEYWORD, THE FLAG, CV1PGM, WILL NOT BE       02700000
.*                 CHANGED FOR THE MF=(E,ADDR) FORM.                    02750000
.*                                                                      02800000
.*                 FOR MF=I OR MF=(E,ADDR) AND BRANCH=NO IS             02850000
.*                 CODED, OR OMITTED, CODE WILL BE GENERATED TO         02900000
.*                 INVOKE CVAF VIA SVC 139.                             02950000
.*                                                                      03000000
.*                 FOR MF=I OR MF=(E,ADDR) AND YES IS CODED, THE        03050000
.*                 CODE IS GENERATED TO INVOKE CVAF VIA A BRANCH.       03100000
.*                                                                      03150000
.*                 FOR MF=L, ONLY THE FLAG WILL BE INITIALIZED          03200000
.*                 AND NO EXECUTABLE CODED WILL BE GENERATED.           03250000
.*                                                                      03300000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE           03350000
.*                 AN MNOTE, SINCE NO IS THE DEFAULT FOR ALL            03400000
.*                 FORMS OF THIS MACRO.                                 03450000
.*                                                                      03500000
.*                 VALID ENTRIES:  BRANCH=NO        DEFAULT FOR MF=I    03550000
.*                                 BRANCH=YES       (DEFAULT FOR YES    03600000
.*                                 BRANCH=(YES,SUP)  IS (YES,SUP))      03650000
.*                                 BRANCH=(YES,PGM)                     03700000
.*                                                                      03750000
.*       IOAREA  - THE FLAG, CV1IOAR, WILL BE SET TO 1 IF KEEP IS       03800000
.*                 CODED AND RESET TO 0 IF NOKEEP IS CODED.             03950000
.*                                                                      04000000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN MNOTE, 04050000
.*                 SINCE NOKEEP IS THE DEFAULT FOR MF=L AND MF=I.       04100000
.*                 THE FLAG WILL NOT BE CHANGED IN THE ABSENCE OF THE   04150000
.*                 IOAREA KEYWORD FOR MF=(E,ADDR) FORM.                 04200000
.*                                                                      04250000
.*                 VALID ENTRIES:  IOAREA=NOKEEP    DEFAULT FOR MF=I    04300000
.*                                 IOAREA=KEEP                          04350000
.*                                                                      04500000
.*       MF      - SEE THE OPENING PARAGRAPHS ABOVE.  IF THE MF KEYWORD 04550000
.*                 IS NOT SPECIFIED, THE DEFAULT, MF=I, WILL BE IN      04600000
.*                 EFFECT.                                              04650000
.*                                                                      04700000
.*                 FOR THE INSTRUCTION-FORM (MF=I), THE                 04750000
.*                 FOLLOWING VALIDITY CHECKS WILL BE MADE:              04800000
.*                   1. ACCESS IS REQUIRED.                             04850000
.*                   2. UCB IS REQUIRED.                                04900000
.*                                                                      04950000
.*                 FOR ALL FORMS OF THE MACRO, THE FOLLOWING            05000000
.*                 VALIDITY CHECKS WILL BE MADE:                        05050000
.*                   1. INVALID KEYWORD OPERANDS.                       05100000
.*                                                                      05150000
.*                 VALID ENTRIES:  MF=I             DEFAULT             05200000
.*                                 MF=L                                 05250000
.*                                 MF=(E,ADDR)                          05300000
.*                                                                      05350000
.*       UCB     - WILL SET THE ADDRESS OF THE UCB, SPECIFIED BY        05400000
.*                 THE 'ADDR', INTO THE FIELD: CVUCB.  THIS KEYWORD     05450000
.*                 IS REQUIRED FOR THE MF=I FORM OF THIS MACRO.         05500000
.*                                                                      05700000
.* NOTES = N/A                                                          05750000
.*                                                                      05800000
.* MODULE-TYPE = MACRO                                                  05850000
.*                                                                      05900000
.*   PROCESSOR = ASSEMBLER LANGUAGE                                     05950000
.*                                                                      06000000
.*   ATTRIBUTES = EXECUTABLE MACRO                                      06050000
.*                                                                      06100000
.* ENTRY-POINT = MACRO STATEMENT.                                       06150000
.*                                                                      06200000
.* INPUT = SEE DESCRIPTION OF KEYWORDS UNDER "FUNCTION".                06250000
.*                                                                      06300000
.* OUTPUT = CVAF PARAMETER LIST WITH THE FLAGS AND THE ADDRESSES        06350000
.*           SET DEPENDING UPON THE KEYWORDS SPECIFIED AS DEFINED       06400000
.*           UNDER "KEYWORDS" ABOVE.                                    06450000
.*                                                                      06500000
.* EXIT-NORMAL = MEND STATEMENT.                                        06550000
.*                                                                      06600000
.* EXIT-ERROR = MNOTE AND MEND STATEMENT.  AN MNOTE WILL BE             06650000
.*              GENERATED FOR ANY OF THE FOLLOWING ERRORS ENCOUNTERED:  06700000
.*                                                                      06750000
.*                 FOR THE INSTRUCTION-FORM (MF=I):                     06800000
.*                   1. ACCESS IS REQUIRED AND IS NOT SUPPLIED.         06850000
.*                   2. UCB WAS NOT SUPPLIED.                           06900000
.*                                                                      06950000
.*                 FOR ALL FORMS OF THE MACRO:                          07000000
.*                   1. INVALID KEYWORD OPERANDS.                       07050000
.*                                                                      07100000
.* EXTERNAL-REFERENCES = NONE                                           07150000
.*                                                                      07200000
.* TABLES = NONE                                                        07250000
.*                                                                      07300000
.* MACROS = IHBINNRA                                                    07350000
.*                                                                      07400000
.* CHANGE-ACTIVITY = NONE                                               07450000
.*                                                                      07500000
.*$L0=IXVTOC,JDM1134,T790225,STLBS: INDEXED VTOC SUPPORT           @L0A 07511000
.*$L1=VSCR,HDP2210,T840401,STLMDB: CVAF VSCR                       @L1A 07522000
.*                                                                      07533200
.**** END OF SPECIFICATIONS ******************************************* 07550000
         LCLA  &K                       LENGTH OF PARM                  07600000
         LCLA  &NO                      BRANCH INDEX NUMBER             07650000
         LCLB  &BIOO                    IOAREA OR BIT FLAG1             07700000
         LCLB  &BPGO                    BRANCH OR BIT FLAG1             07750000
         LCLB  &BION                    IOAREA AND BIT FLAG1            07800000
         LCLB  &BPGN                    BRANCH AND BIT FLAG1            07850000
         LCLB  &ERRSW                   AN ERROR WAS DETECTED           07900000
         LCLB  &SWIOA                   IOAREA PARM PRESENT SWITCH      07950000
         LCLB  &SWUCB                   UCB PARM PRESENT SWITCH         08000000
         LCLB  &UCBNCOR                 UCB IN STORAGE SWITCH           08050000
         LCLC  &UCBNREG                 UCB IN REGISTER VALUE           08200000
         LCLC  &L                       LOCAL LABEL VARIABLE            08250000
         LCLC  &FM                      MF=FORM CHARACTER VARIABLE      08300000
         LCLC  &FLAG1                   DEFINE LOCAL CHAR VARIABLE      08350000
         LCLC  &FLAG1N                  DEFINE LOCAL CHAR VARIABLE      08400000
         LCLC  &FUNCT                   FUNCTION CODE FOR ACCESS=       08450000
&NO      SETA  &SYSNDX                  INITIALIZE BRANCH INDEX NUM     08500000
&BION    SETB  1                        INITIALIZE 'AND' BIT            08550000
&BPGN    SETB  1                        INITIALIZE 'AND' BIT            08600000
.*                                                                      08650000
.* ******************************************************************** 08700000
.* *     MF=' ' VERIFICATION                                            08750000
.* ******************************************************************** 08800000
.*                                                                      08850000
         AIF   (N'&MF GT 2).ER          MF= HAS ONLY 2 PARMS            08900000
         AIF   ('&MF(1)' EQ 'E').E1     TEST FOR E FORM                 08950000
         AIF   (N'&MF NE 1).ER          MF=L OR I HAS ONLY 1 PARM       09000000
         AIF   ('&MF(1)' EQ 'I').I1     TEST FOR I FORM                 09050000
         AIF   ('&MF(1)' EQ 'L').L1     TEST FOR L FORM                 09100000
.ER      ANOP                                                           09150000
         SPACE 1                                                        09200000
         MNOTE 16,'***  IHB001 INVALID OPERAND - MF=&MF'                09250000
&ERRSW   SETB  1                        SET ERROR SWITCH ON             09300000
         AGO   .CKERR                   GO TO ERROR IN CHECK ROUTINE    09350000
.*                                                                      09400000
.* ******************************************************************** 09450000
.* *     EXECUTE FORM, MF=(E,' ') VERIFICATION                          09500000
.* ******************************************************************** 09550000
.*                                                                      09600000
.E1      ANOP                           EXECUTE FORM OF MACRO           09650000
&FM      SETC  'E'                      SET THE MACRO FORM SWITCH       09700000
         AIF   (N'&MF EQ 2).CK1         MF=E MUST HAVE 2 PARMS          09750000
         SPACE 1                                                        09800000
         MNOTE 16,'***  IHB002 MF=(E,ADDR) FORM: PARAMETER LIST ADDRESSX09850000
                IS REQUIRED'                                            09900000
&ERRSW   SETB  1                        SET ERROR SWITCH ON             09950000
         AGO   .CK1                     GO CHECK NEXT KEYWORD           10000000
.*                                                                      10050000
.* ******************************************************************** 10100000
.* *     LIST FORM OF CVAFVOL                                           10150000
.* ******************************************************************** 10200000
.*                                                                      10250000
.L1      ANOP                           LIST FORM OF MACRO              10300000
&FM      SETC  'L'                      SET THE MACRO FORM SWITCH       10350000
         AGO   .CK1                     GO CHECK NEXT KEYWORD           10400000
.*                                                                      10450000
.* ******************************************************************** 10500000
.* *     INSTRUCTION FORM OF CVAFVOL                                    10550000
.* ******************************************************************** 10600000
.*                                                                      10650000
.I1      ANOP                           INSTRUCTION FORM OF MACRO       10700000
&FM      SETC  'I'                      SET THE MACRO FORM SWITCH       10750000
.*                                                                      10800000
.* ******************************************************************** 10850000
.* *     INSTRUCTION FORM REQUIRES THE 'ACCESS' KEYWORD                 10900000
.* ******************************************************************** 10950000
.*                                                                      11000000
         AIF   ('&ACCESS' NE '').CK1    OK IF ACCESS IS CODED           11050000
         SPACE 1                                                        11100000
         MNOTE 12,'***  IHB003 MF=I FORM: ACCESS KEYWORD IS REQUIRED'   11150000
&ERRSW   SETB  1                         SET ERROR IN CHECK SWITCH      11200000
         AGO   .CK2                      BYPASS NEXT CHECK              11250000
.*                                                                      11300000
.* ******************************************************************** 11350000
.* *     VALIDATE 'ACCESS' KEYWORD                                      11400000
.* ******************************************************************** 11450000
.*                                                                      11500000
.CK1     ANOP                                                           11550000
         AIF   ('&ACCESS' EQ '' AND '&FM' EQ 'L').CK1A                  11600000
         AIF   ('&ACCESS' EQ '').CK2                                    11650000
         AIF   ('&ACCESS' NE 'VIBBLD').ER1                              11700000
&FUNCT   SETC  '0B'                       CVAFVOL ACCESS=VIBBLD         11750000
         AGO   .CK2                                                     11800000
.CK1A    ANOP                                                           11850000
&FUNCT   SETC  '00'                       ACCESS=VIBBLD,MF=L CODED      11900000
         AGO   .CK2                                                     11950000
.ER1     ANOP                             ACCESS= **** ERROR ****       12000000
         SPACE 1                                                        12050000
         MNOTE 12,'***  IHB001 INVALID OPERAND - ACCESS=&ACCESS'        12100000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       12150000
.*                                                                      12200000
.* ******************************************************************** 12250000
.* *     IF UCB IS PRESENT, CHECK IF IN REG OR NOT                      12300000
.* ******************************************************************** 12350000
.*                                                                      12400000
.CK2     ANOP                                                           12450000
         AIF   ('&UCB' EQ '').ER2       NO UCB, CHECK FOR MF=I.         12500000
         AIF   (N'&UCB NE 1).ER2A       ONLY 1 UCB PARM ALLOWED         12550000
&SWUCB   SETB  1                        SET UCB SWITCH ON               12600000
         AIF   ('&UCB'(1,1) EQ '(').UCBNREG                             12650000
&UCBNCOR SETB  1                        UCB IS IN CORE                  12700000
         AGO   .CK3                                                     12750000
.UCBNREG ANOP                                                           12800000
&K       SETA  K'&UCB                   STORE NO. OF CHARS IN UCB       12850000
&UCBNREG SETC  '&UCB'(2,&K-2)           GET REGISTER OF UCB             12900000
         AGO   .CK3                                                     12950000
.ER2     ANOP                           UCB= **** ERROR ****            13000000
         AIF   ('&FM' NE 'I').CK3       NOT  MF=I, ISSUE MNOTE.         13007100
         SPACE 1                                                        13014200
         MNOTE 12,'***  IHB004 MF=I FORM: UCB IS REQUIRED'              13021300
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       13028400
         AGO   .CK3                                                     13035500
.ER2A    ANOP                           UCB= **** ERROR ****            13042600
         SPACE 1                                                        13050000
         MNOTE 12,'***  IHB001 INVALID OPERAND - UCB=&UCB'              13100000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       13150000
.*                                                                      13200000
.* ******************************************************************** 13250000
.* *     VALIDITY CHECK IOAREA PARM                                     13300000
.* ******************************************************************** 13350000
.*                                                                      13400000
.CK3     ANOP                                                           13450000
         AIF   ('&IOAREA' EQ '').CK5    IF IOAREA NOT SPECIFIED, SKIP.  13500000
         AIF   (N'&IOAREA NE 1).ER3     IF MORE THAN 1 PARM, ERROR.     13550000
         AIF   ('&IOAREA' NE 'KEEP').CK4                                13600000
&BIOO    SETB  1                        SET IOAREA=KEEP SWITCH          13650000
         AGO   .CK5                                                     13700000
.CK4     ANOP                                                           13750000
         AIF   ('&IOAREA' NE 'NOKEEP').ER3                              13800000
&BION    SETB  0                        SET IOAREA=NOKEEP SWITCH        13850000
         AGO   .CK5                                                     13900000
.ER3     ANOP                           IOAREA= **** ERROR ****         14650000
         SPACE 1                                                        14700000
         MNOTE 12,'***  IHB001 INVALID OPERAND - IOAREA=&IOAREA'        14750000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       14800000
.*                                                                      14850000
.* ******************************************************************** 14900000
.* *     VALIDITY CHECK THE BRANCH OPERANDS                             14950000
.* ******************************************************************** 15000000
.*                                                                      15050000
.CK5     ANOP                                                           15100000
         AIF   ('&BRANCH' EQ '').CKERR      NO BRANCH KEYWORD           15800000
         AIF   ('&BRANCH(1)' EQ 'NO').CKERR BRANCH=NO, GO ON            15850000
         AIF   ('&BRANCH(1)' NE 'YES').ER4  BAD BRANCH=                 15900000
         AIF   (N'&BRANCH EQ 1).CKERR       NO 2ND OPERAND              15950000
         AIF   (N'&BRANCH GT 2).ER4         BAD OPERAND                 16000000
         AIF   ('&BRANCH(2)' NE 'PGM').BR1  CHECK FOR PGM               16050000
&BPGO    SETB  1                        SET BRANCH=(YES,PGM) SWITCH     16100000
         AGO   .CKERR                                                   16150000
.BR1     ANOP                                                           16200000
         AIF   ('&BRANCH(2)' NE 'SUP').ER4  BAD 2ND OPERAND             16250000
&BPGN    SETB  0                        SET BRANCH=(YES,SUP) SWITCH     16300000
         AGO   .CKERR                                                   16350000
.ER4     ANOP                           BRANCH= **** ERROR ****         16400000
         SPACE 1                                                        16450000
         MNOTE 12,'***  IHB001 INVALID OPERAND - BRANCH=&BRANCH'        16500000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       16550000
.*                                                                      16600000
.* ******************************************************************** 16650000
.* *     CHECK ERRORS: IF ANY PRESENT, SET A 'LABEL DS 0F' AND GET OUT  16700000
.* ******************************************************************** 16750000
.*                                                                      16800000
.CKERR   ANOP                                                           16850000
         AIF   ('&ERRSW' EQ '0').EXEC                                   16900000
&LABEL   DS    0F                                                       16950000
         AGO   .FINISH                                                  17000000
.*                                                                      17050000
.* ******************************************************************** 17100000
.* *     ALL PARAMETERS ARE GOOD - BUILD LIST OF DEFINED CONSTANTS.     17150000
.* ******************************************************************** 17200000
.*                                                                      17250000
.EXEC    ANOP                                                           17300000
&FLAG1   SETC  '0&BIOO&BPGO.00000'                                      17350000
&L       SETC  '&LABEL'                                                 17400000
         AIF   ('&L' NE '').TSTI                                        17450000
&L       SETC  'ICV&NO.S'                                               17500000
.TSTI    ANOP                                                           17550000
         AIF   ('&FM' EQ 'I').STNDRD                                    17600000
         AIF   ('&FM' EQ 'L').LIST                                      17650000
.*                                                                      17700000
.* ******************************************************************** 17750000
.* *     BEGIN BUILD FOR EXECUTE FORM OF MACRO                          17800000
.* ******************************************************************** 17850000
.*                                                                      17900000
         AIF   ('&LABEL' EQ '').OVER   SKIP OVER LABEL                  17950000
&L       EQU   *                                                        18000000
.OVER    ANOP                                                           18050000
         IHBINNRA &MF(2)                PARM LIST INTO REG 1            18100000
         AIF   ('&ACCESS' EQ '').E2     NO ACCESS=, SKIP                18150000
         MVI   6(1),X'&FUNCT'           SET FUNCTION CODE               18200000
         AGO   .E2                      GO TO COMMON ROUTINE            18250000
.*                                                                      18300000
.* ******************************************************************** 18350000
.* *     BEGIN BUILD FOR LIST FORM OF MACRO                             18400000
.* ******************************************************************** 18450000
.*                                                                      18500000
.LIST    ANOP                                                           18550000
         CNOP  0,4                                                      18600000
&L       EQU   *                                                        18650000
         AGO   .COMMON                  GO TO COMMON ROUTINE            18700000
.*                                                                      18750000
.* ******************************************************************** 18800000
.* *     BEGIN BUILD FOR STANDARD FORM OF MACRO                         18850000
.* ******************************************************************** 18900000
.*                                                                      18950000
.STNDRD  ANOP                                                           19000000
         CNOP  0,4                                                      19050000
&LABEL   BAL   1,ICV&NO.E               LOAD CVPL LIST ADDRESS          19100000
&L       SETC  'ICV&NO.S'               SET START OF CVPL               19150000
&L       EQU   *                        START OF CVPL                   19200000
.*                                                                      19250000
.* ******************************************************************** 19300000
.* *     COMMON BUILD CODE FOR MF=I AND L FORMS                         19350000
.* ******************************************************************** 19400000
.*                                                                      19450000
.COMMON  ANOP                                                           19500000
         DC    CL4'CVPL'                EBCDIC 'CVPL'                   19550000
         DC    AL2(ICV&NO.E-&L)         LENGTH OF CVPL                  19600000
         DC    XL1'&FUNCT'              FUNCTION CODE                   19650000
         DC    XL1'00'                  STATUS INFORMATION              19700000
         DC    B'&FLAG1'                FIRST FLAG BYTE                 19750000
         DC    XL1'00'                  SECOND FLAG BYTE                19800000
         DC    H'0'                     RESERVED                        19850000
.*                                                                      19900000
.* ******************************************************************** 19950000
.* *     UCB PROCESSING                                                 20000000
.* ******************************************************************** 20050000
.*                                                                      20100000
         AIF   ('&SWUCB' EQ '0').U3     NO UCB PRESENT, SKIP            20150000
         AIF   ('&UCBNCOR' EQ '0').U3   UCB IN REG, SKIP                20200000
         DC    A(&UCB)                  UCB ADDRESS                     20250000
         AGO   .D3                      GO ON TO DSN                    20300000
.U3      ANOP                                                           20350000
         DC    A(0)                     UCB ADDRESS                     20400000
.D3      ANOP                                                           20450000
         DC    A(0)                     DATA SET NAME ADDRESS           20500000
         DC    A(0)                     BUFFER LIST ADDRESS             20550000
         DC    A(0)                     INDEX VIR'S BUFFER LIST ADDRESS 20600000
         DC    A(0)                     MAP VIR'S BUFFER LIST ADDRESS   20650000
         DC    A(0)                     I/O AREA ADDRESS                20700000
         DC    A(0)                     DEB ADDRESS                     21300000
         DC    A(0)                     ARGUMENT ADDRESS                21350000
         DC    A(0)                     SPACE PARAMETER LIST ADDRESS    21400000
         DC    A(0)                     EXTENT TABLE ADDRESS            21450000
         DC    A(0)                     NEW VRF VIXM BUFFER LIST ADDR   21500000
         DC    A(0)                     VRF DATA ADDRESS                21550000
         DC    A(0)                     COUNT AREA ADDRESS              21600000
ICV&NO.E EQU   *                        END OF CVPL                     21650000
         AIF   ('&FM' EQ 'L').FINISH    LIST FORM IS DONE               21700000
.*                                                                      21750000
.* ******************************************************************** 21800000
.* *     COMMON BUILD CODE FOR MF=I AND (E,ADDR) FORMS                  21850000
.* ******************************************************************** 21900000
.*                                                                      21950000
.E2      ANOP                                                           22000000
         AIF   ('&FM' EQ 'I').UCB1                                      22050000
&FLAG1N  SETC  '1&BION&BPGN.11111'                                      22100000
         AIF   ('&FLAG1N' EQ '11111111').OF1                            22150000
         NI    8(1),B'&FLAG1N'          RESET CVAF FLAGS OFF            22200000
.OF1     ANOP                                                           22250000
         AIF   ('&FLAG1' EQ '00000000').UCB1                            22300000
         OI    8(1),B'&FLAG1'           SET CVAF FLAGS ON               22350000
.*                                                                      22400000
.* ******************************************************************** 22450000
.* *     UCB PROCESSING                                                 22500000
.* ******************************************************************** 22550000
.*                                                                      22600000
.UCB1    ANOP                                                           22650000
         AIF   ('&SWUCB' EQ '0').BRANCH NO UCB TO PROCESS               22700000
         AIF   ('&UCBNCOR' EQ '1').UNC  UCB IN CORE, SKIP               22750000
         ST    &UCBNREG,12(,1)          STORE UCB PTR IN PARM LIST      22800000
         AGO   .BRANCH                                                  22850000
.UNC     ANOP                                                           22900000
         AIF   ('&FM' EQ 'I').BRANCH    MF=I, ALREADY THERE, SKIP       22950000
         LA    15,&UCB                  GET UCB ADDRESS AND             23000000
         ST    15,12(,1)                STORE UCB PTR IN PARM LIST      23050000
.*                                                                      23100000
.* ******************************************************************** 23150000
.* *     BRANCH PROCESSING -                                            23900000
.* *     LOAD THE CVT, THE VS1/VS2 COMMON EXTENTION 2 POINTER,          23950000
.* *     THE CVTCVAF PTR, THE CVAF POINTER AND BRANCH TO CVAF           23970000
.* *     COMMON ICVCMM00                                                23990000
.* ******************************************************************** 24050000
.*                                                                      24100000
.BRANCH  ANOP                                                           24150000
         AIF   ('&BRANCH' EQ '' OR '&BRANCH(1)' EQ 'NO').SVC139         24200000
         L     15,16                    LOAD THE CVT                    24250000
         L     15,328(,15)              LOAD VS1/VS2 COMMON EXTENTION2  24270000
         L     15,12(,15)               LOAD THE CVT CVAF TABLE         24290000
         CLI   14(15),X'81'             WHAT SYSTEM?               @L1A 24304500
         BNL   ICV&NO.B                 BRANCH IF X/A              @L1A 24319000
         L     15,0(,15)                LOAD THE CVAF ADDRESS      @L1A 24333500
         BALR  14,15                    BRANCH AND LINK TO         @L1A 24348000
*                                       GLUE MODULE ICVCMM01       @L1A 24362500
         B     ICV&NO.C                                            @L1A 24377000
ICV&NO.B EQU   *                        MUST SET MODE (BASSM)      @L1A 24391500
         L     15,28(,15)               LOAD THE CVAF ADDRESS      @L1A 24406000
         DC    X'0CEF'                  BR, SAVE & SET MODE TO     @L1A 24420500
*                                       MODULE ICVCMM00            @L1A 24435000
ICV&NO.C DS    0H                                                  @L1A 24442500
         AGO   .FINISH                                                  24450000
.* ******************************************************************** 24500000
.* *     SVC139 PROCESSING                                              24550000
.* ******************************************************************** 24600000
.*                                                                      24650000
.SVC139  ANOP                                                           24700000
         SVC   139                                                      24750000
.FINISH  ANOP                                                           24800000
         MEND                                                           24850000
