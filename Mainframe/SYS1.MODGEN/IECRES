         MACRO                                                          00100000
&NAME    IECRES &FUNC,&IDTTR,&BCODE,&STM=,&LV=,&A=,&SP=,&KEY=,   Y02080*00150000
               &STMBASE=,                                          @13C*00175000
               &ID=,&PREFIX=,&EXTPR=,&MODID=,&MODNM=,&BRCODE=,   Y02080*00200000
               &EXITAD=,&REG0=,&REG1=,                           Y02082*00250000
               &DEB=,                                            Y02134*00300000
               &DCBCOPY=,                                        Y02082*00350000
               &BRANCH=,&EPA=,&REUSE=,                           Y02080*00400000
               &SVA=,&AREA=,&SERVREG=,&BLK=,                      @L10C*00450000
               &DSNAD=,&DISKAD=,&DSCBA=,&FULL=,&CVLST=,&AVT=,      @02C*00500000
               &DQLST=,&VCR=,&LOC=,&EXIT=,&SECID=,&UNCOND=,       @L13C*00533300
               &SMF42=,&TPSERV=                                   @L21C 00566600
.*                                                                 @L1A 00600000
.*    ADDED THE STMBASE PARAMETER SO THAT PLX PROGRAMS CAN SNEEK   @13A 00612500
.*    A BASE REGISTER ONTO THE LOAD INSTRUCTION.  PLX DOES EACH    @13A 00625000
.*    LABEL LIKE WTGPREFX AS "WTGPREFX EQU 16".  THE INSTRUCTION   @13A 00637500
.*    " L 15,WTGPRFEX " COMES OUT AS X'58F00010' -- NO BASE REG.   @13A 00650000
.*    TO FIX THIS, ADD "STMBASE=(,6)" TO THE IECRES INVOCATION     @13A 00662500
.*    SO THAT THE GENERATED INSTRUCTION IS " L 15,WTGPREFX(,6)".   @13A 00675000
.*                                                                 @13A 00687500
.********************************************************************** 00700000
.*                                                                      00750000
.*$MAC(IECRES) : O/C/E/DADSM COMMON SERVICE ROUTINE MACRO               00800000
.*                                                                      00850000
.*PROPRIETARY V3 STATEMENT                                              00862500
.*LICENSED MATERIALS - PROPERTY OF IBM                                  00875000
.*"RESTRICTED MATERIALS OF IBM"                                         00887500
.*5647-A01                                                              00902000
.*(C) COPYRIGHT 1982,2000  IBM CORP.                                    00916500
.*END PROPRIETARY V3 STATEMENT                                          00931200
.*                                                                      00950000
.*  STATUS = DFSMS/MVS RELEASE 1.6.0                              @L22C 01000000
.*                                                                      01050000
.* FUNCTION = THERE ARE MANY FUNCTIONS WHICH CAN BE SPECIFIED FOR  @L4C 01100000
.*            THE IECRES MACRO.  SOME OF THESE FUNCTIONS SET UP THE     01150000
.*            VARIOUS INTERFACES TO THE OPEN/CLOSE/EOV/DADSM SERVICE    01220000
.*            ROUTINE (IFG019RA):                                       01250000
.*                                                                      01350000
.*            IFG019RA+0  - ENTRY FOR WAIT FACILITY                     01400000
.*            IFG019RA+4  - ENTRY FOR SELECT-LOAD FACILITY              01450000
.*            IFG019RA+8  - ENTRY FOR DCB SYNCHRONIZATION FACILITY      01500000
.*            IFG019RA+12 - ENTRY FOR RJFCB                        @L7C 01530000
.*            IFG019RA+16 - ENTRY FOR GET WORK AREA FACILITY TO    @L2A 01560000
.*                          SUPPORT 24 BIT AND 31 BIT CALLERS      @L2A 01590000
.*            IFG019RA+20 - ENTRY FOR LOAD AND BRANCH FACILITY     @L4C 01620000
.*            IFG019RA+24 - ENTRY FOR LOAD AND RETURN FACILITY          01650000
.*            IFG019RA+28 - ENTRY FOR GET WORK AREA FACILITY (NOTE @L2C 01683300
.*                          THIS ENTRY IS NO LONGER GENERATED)     @L2A 01716600
.*            IFG019RA+32 - ENTRY FOR GET WTG/EOV WORK AREA FACILITY    01750000
.*            IFG019RA+36 - ENTRY FOR GET FIRST WORK AREA FACILITY      01800000
.*            IFG019RA+40 - ENTRY TO INITIALIZE PREFIX=FIRST WKAREA     01850000
.*            IFG019RA+44 - ENTRY TO INITIALIZE AND/OR COPY THE DCB     01900000
.*            IFG019RA+48 - ENTRY FOR FREE WORK AREA FACILITY      @L4C 01933300
.*                                                                 @L4D 01966600
.*            IFG019RA+52 - ENTRY FOR FREE FIRST OR WTG/EOV FACILITY    02000000
.*            IFG019RA+56 - ENTRY FOR UEXIT FACILITY                    02050000
.*            IFG019RA+60 - ENTRY FOR VALIDATE                     @L1A 02050500
.*            IFG019RA+64 - ENTRY FOR FILEACC                      @L1A 02051000
.*            IFG019RA+68 - ENTRY FOR XLATE                        @L1A 02051500
.*            IFG019RA+72 - ENTRY FOR DSN                          @L1A 02052000
.*            IFG019RA+76 - ENTRY FOR VOLACC AND VALSUP            @L1A 02052500
.*            IFG019RA+88 - ENTRY FOR CAF SMS SSI                  @LBA 02053000
.*            IFG019RA+92 - ENTRY FOR CAF READ TAPE VOL RECORD     @03C 02053500
.*            IFG019RA+96 - ENTRY FOR CAF UPDATE TAPE VOL RECORD   @03A 02054000
.*                                                                2@L4D 02054500
.*            IFG019RA+104 - ENTRY FOR DSCB ENQ/DEQ FACILITY       @L9A 02055000
.*            IFG019RA+108 - ENTRY FOR WJFCB MOVE MODE             @L7A 02055500
.*            IFG019RA+112 - ENTRY FOR WJFCB LOCATE MODE           @L7A 02056000
.*            IFG019RA+116 - ENTRY FOR ENQTIOT                     @L8A 02056500
.*            IFG019RA+120 - ENTRY FOR DEQTIOT                     @L8A 02057000
.*            IFG019RA+124 - ENTRY FOR GETTING ULTRA TEMP STORAGE  @L9A 02057500
.*            IFG019RA+128 - ENTRY FOR CVAF/CP-REBUILD            @L10A 02058000
.*            IFG019RA+132 - ENTRY FOR GET  SAM REQUEST            @01A 02058500
.*            IFG019RA+136 - ENTRY FOR FREE SAM REQUEST            @01A 02059000
.*                                                                      02060000
.*            THE OTHER FUNCTIONS (IECRES BRANCH, IECRES EXIT,     @L4C 02068000
.*            IECRES MODE31 AND IECRES MODE24)                     @L4C 02076000
.*            DO NOT SET UP AN INTERFACE TO                        @L4C 02084000
.*            IFG019RA, BUT MERELY GENERATE EXECUTABLE CODE.       @L4C 02092000
.*                                                                      02100000
.* NOTES = SEE BELOW                                                    02150000
.*                                                                      02200000
.*      DEPENDENCIES = THE USE OF IECRES XCTL,&IDTTR,&BCODE USES        02250000
.*                     THE BRT=NO EXPANSION OF THE XCTLTABL MACRO.      02300000
.*                                                                      02350000
.*                     SOME OF THE MACRO FUNCTIONS USE SYMBOLS WHICH    02400000
.*                     MUST BE EQUATED SOMEHOW IN THE CALLING MODULE.   02450000
.*                                                                      02500000
.*                     SYMBOL     FUNCTION USING THE SYMBOL             02550000
.*                                                                      02600000
.*                     EOVSIZE    IECRES GET,PREFIX=EOV                 02650000
.*                     RES        IECRES LOAD,BRANCH=QUEUED             02850000
.*                                IECRES SYNCH                          02900000
.*                                IECRES WAIT                           02950000
.*                                IECRES XCTL                           03000000
.*                     RESSYNCH   IECRES SYNCH                          03050000
.*                     RESXCTL    IECRES LOAD,BRANCH=QUEUED             03100000
.*                                IECRES XCTL                           03150000
.*                     RWTGC      IECRES LOAD,BRANCH=QUEUED             03200000
.*                                IECRES XCTL                           03250000
.*                                                                      03300000
.*                     ADDITIONALLY, ALMOST ALL OF THE EIGHTEEN    @L1A 03350000
.*                     FUNCTIONS REFERENCE FIELDS DEFINED IN THE        03400000
.*                     PREFIX, EXTENDED PREFIX, OR WTG TABLE PORTIONS   03450000
.*                     OF THE OPEN/CLOSE/EOV OR DADSM WORK AREAS.       03500000
.*                                                                @L12A 03506200
.*              IECRES IFG055ZZ AND IECRES CAFLCDB EXPAND TO GET  @L12A 03512400
.*               AUTO DATA AREAS FOR THE PLAS MODULES WHICH WILL  @L12A 03518600
.*               BE CALLED. IF THE SIZE OF THE AUTO DATA AREA IN  @L12A 03524800
.*               EITHER OF THESE MODULES INCREASES, THE SIZE OF   @L12A 03531000
.*               THE AUTO DATA AREA (WHICH IS HARD CODED) MUST BE @L12A 03537200
.*               INCREASED ACCORDINGLY.                           @L12A 03543400
.*                                                                      03550000
.*      RESTRICTIONS = ONLY THE OPEN, CLOSE, AND EOV ROUTINES           03600000
.*                     (INCLUDING RDJFCB) USE THE WAIT,                 03613600
.*                     SELECT-LOAD, SYNCH DCB, QMNGRIO, GET             03627200
.*                     WTG/EOV, INIT/COPY, VALIDATE, FILEACC,      @L1C 03640800
.*                     VOLACC, VALSUP AND FACILITIES.  ONLY UEXIT, @L1C 03654400
.*                     DADSM ROUTINES, TASK CLOSE, AND THE              03668000
.*                     RECOVERY ROUTINES USE THE GET FIRST              03681600
.*                     AND INITIALIZE PREFIX=FIRST                      03695200
.*                     FACILITIES.                                      03708800
.*                                                                      03722400
.*                     THE FOLLOWING FUNCTIONS CAN BE CALLED IN    @L7C 03736000
.*                     24-BIT OR 31-BIT MODE.  OTHERS CAN BE       @L7C 03749600
.*                     CALLED ONLY IN 24-BIT MODE.                 @L7C 03763200
.*                        EXIT.                                    @L7A 03776800
.*                        LOAD WITH BRANCH=QUEUED.                 @L4A 03790400
.*                        LOAD WITH BRANCH=DIRECT.                 @L4A 03804000
.*                        INIT/COPY FUNCTION.                      @L4A 03817600
.*                        GET AND FREE ROUTINES (PREFIX NOT        @L4A 03831200
.*                           EQUAL TO WTG OR EOV).                 @L4A 03844800
.*                        UEXIT.                                   @L7A 03858400
.*                        RJFCB,WJFCB                              @L8A 03872000
.*                        UGET.                                    @L9A 03885600
.*                                                                      03900000
.*      REGISTER CONVENTIONS = NOT APPLICABLE                           03950000
.*                                                                      04000000
.* PATCH LABEL = NOT APPLICABLE                                         04050000
.*                                                                      04100000
.* MODULE TYPE = MACRO                                                  04150000
.*                                                                      04200000
.*      PROCESSOR = ASSEMBLER H VERSION 2.                              04250000
.*                                                                      04300000
.*      MODULE SIZE = NOT APPLICABLE                                    04350000
.*                                                                      04400000
.*      ATTRIBUTES = NOT APPLICABLE                                     04450000
.*                                                                      04500000
.* ENTRY POINT = NOT APPLICABLE                                         04550000
.*                                                                      04600000
.*      PURPOSE = SEE FUNCTION                                          04650000
.*                                                                      04700000
.*      LINKAGE = LABEL IECRES &FUNC,&IDTTR,&BCODE,KEYWORDS=            04750000
.*                                                                      04800000
.*      INPUT =   OPTIONAL LABEL SPECIFIED AS AN ACCEPTABLE ASSEMBLER   05050000
.*                LABEL WHICH CAN BE USED BY THE CALLING CSECT.         05100000
.*                                                                      05150000
.*                                                                      05200000
.*                &FUNC IS THE FIRST POSITIONAL PARAMETER.  THE         05250000
.*                FUNCTIONS WHICH CAN BE SPECIFIED FOR IECRES ARE:      05300000
.*                                                                      05350000
.*                BRANCH   - GENERATES CODE TO BRANCH ON THE CONTENTS   05400000
.*                           OF A REGISTER                              05450000
.*                DSCBNQDQ - GENERATES CODE TO BRANCH TO DSCB      @L9A 05466600
.*                           ENQ/DEQ SUBROUTINE                    @L9A 05483200
.*                EXIT     - GENERATES CODE TO LOAD REGISTERS AND       05500000
.*                           RETURN                                     05550000
.*                FREE     - BUILDS THE INTERFACE FOR BOTH OF THE       05600000
.*                           FREE WORK AREA FACILITIES                  05610000
.*                GET      - BUILDS THE INTERFACE FOR ALL THREE GET     05620000
.*                           WORK AREA FACILITIES                       05630000
.*                INIT     - BUILDS THE INTERFACE FOR THE INITIALIZE-   05650000
.*                           DCB COPY FACILITY                          05700000
.*                LOAD     - BUILDS THE INTERFACE FOR ALL THREE LOAD    05750000
.*                           FACILITIES                                 05800000
.*                MODE31   - GENERATES CODE TO CHANGE TO 31-BIT ADDR    05825000
.*                           MODE                                 @L4A  05850000
.*                MODE24   - GENERATES CODE TO CHANGE TO 24-BIT ADDR    05875000
.*                           MODE                                 @L4A  05900000
.*                RJFCB    - READS A SWA CONTROL BLOCK.           @L7A  05925000
.*                SYNCHDCB - BUILDS THE INTERFACE FOR THE DCB SYNCHRO-  05950000
.*                           NIZATION FACILITY                          06000000
.*                UEXIT    - BUILDS THE INTERFACE FOR THE USER EXIT     06050000
.*                           FACILITY                                   06100000
.*                WAIT     - BUILDS THE INTERFACE FOR THE WAIT FACILITY 06150000
.*                WJFCB    - WRITES (UPDATES) A SWA CONTROL BLOCK. @L7C 06200000
.*                XCTL     - BUILDS THE INTERFACE FOR THE SELECT-LOAD   06300000
.*                           FACILITY                                   06350000
.*                VALIDATE - VALIDATES THE CONTENTS OF AN ANSI     @L1A 06351500
.*                           VERSION 3 LABEL.                      @L1A 06353000
.*                FILEACC  - PROCESSES THE FILE ACCESSIBILITY CODE @L1A 06354500
.*                           FROM AN ANSI VERSION 3 FILE 1 LABEL   @L1A 06356000
.*                           (HDR1, EOF1, EOV1).  SEE FILEACC      @L1A 06357500
.*                           FUNCTION OF IFG019RA FOR MORE DETAIL. @L1A 06359000
.*                XLATE    - TESTS EBCDIC DATA FOR VALID ANSI-78   @L1A 06360500
.*                           EQUIVALENTS                           @L1A 06362000
.*                DSN      - GET DATASET NAME FROM JFCB AND STRIP  @L1A 06363500
.*                           THE 'GNNNNVNN'.  ALSO COMPARES FILE   @L1A 06365000
.*                           NAME IN JFCBDSNM TO THAT ON TAPE      @L1A 06366500
.*                           (CKECK PARAMETER) AND MOVES THE FILE  @L1A 06368000
.*                           NAME FROM THE JFCBDSNM TO THE FILE    @L1A 06369500
.*                           LABEL (CREATE PARAMETER).             @L1A 06371000
.*                VOLACC   - PROCESSES THE VOLUME ACCESSIBILITY    @L1A 06372500
.*                           CODE FROM AN ANSI VERSION 3 VOLUME    @L1A 06374000
.*                VALSUP   - GIVE IMMEDIATE CONTROL TO THE VOLUME  @L1A 06375500
.*                           ACCESS EXIT TO DETERMINE IF LABEL     @L1A 06377000
.*                           VALIDATION SUPPRESSION SHOULD BE      @L1A 06378500
.*                           SET.                                  @L1A 06380000
.*                ENQTIOT    LINKS TO EXISTING CODE TO ENQUEUE     @L8A 06381500
.*                           SYSZTIOT                              @L8A 06383000
.*                DEQTIOT    LINKS TO CODE TO DEQUEUE SYSZTIOT.    @L8A 06384500
.*                           SUPPORTS EARLY DEQUEUE OF SYSZTIOT.   @L8A 06386000
.*            CVAFU/CVAFR,   INVOKE CVAF TO READ OR UPDATE A DSCB @L10A 06387500
.*                CPRBLD     REBUILD A CHANNEL PROGRAM            @L10A 06389000
.*                CPRBUL     REBUILD A USER LABEL CHANNEL PROGRAM @L10A 06390500
.*                CAFSMSVR   UPDATES A CAF VOLUME INVENTORY RECORD@L11A 06392000
.*                CAFLCDB    READ/UPDAT LCDB VCR CHECKPOINT STATUS@L11A 06393500
.*                IFG055ZZ   INVOKE MODULE IFG055ZZ TO EXTEND A   @L12A 06395000
.*                            STRIPED DATA SET.                         06396500
.*                                                                      06400000
.*                                                                      06450000
.*                &IDTTR, THE SECOND POSITIONAL PARAMETER, IS OPTIONAL. 06500000
.*                IT CAN BE USED WITH FOUR OF THE IECRES FUNCTIONS.     06550000
.*                                                                      06600000
.*                FOR IECRES GET/FREE, IF &IDTTR IS SPECIFIED (AS THE   06650000
.*                CHARACTERS 'WLH' WHICH STAND FOR 'WITH LOCK HELD'),   06700000
.*                THEN IFG019RA DOES NOT ACQUIRE THE LOCAL LOCK.        06750000
.*                                                                      06800000
.*                FOR IECRES XCTL, IF &IDTTR IS SPECIFIED, IT MUST      07210000
.*                POINT TO THE ID AND TTR OF A MODULE TO WHICH CONTROL  07220000
.*                SHOULD BE GIVEN BY IFG019RA.                          07230000
.*                                                                      07250000
.*                                                                      07300000
.*                &BCODE, THE THIRD POSITIONAL PARAMETER IS OPTIONAL.   07350000
.*                IT CAN BE USED WITH ONE IECRES FUNCTION.         @L7C 07400000
.*                                                                      07600000
.*                FOR IECRES XCTL, IF &BCODE IS SPECIFIED, IT IS THE    07650000
.*                NAME OF A REGISTER WHICH CONTAINS THE BRANCH TABLE    07700000
.*                OFFSET.                                               07750000
.*                                                                      07800000
.*                                                                      07850000
.*                THE OPTIONAL KEYWORD PARAMETERS ARE:                  07900000
.*                                                                      07950000
.*                A=                                                    08000000
.*                AREA=                                                 08025000
.*                BRANCH=                                               08050000
.*                BRCODE=                                               08100000
.*                DCBCOPY=                                              08150000
.*                DEB=                                                  08200000
.*                EPA=                                                  08250000
.*                EXITAD=                                               08300000
.*                EXTPR=                                                08350000
.*                ID=                                                   08400000
.*                KEY=                                                  08450000
.*                LOADSERV=                                             08475000
.*                LV=                                                   08500000
.*                MODID=                                                08550000
.*                MODNM=                                                08600000
.*                PREFIX=                                               08650000
.*                REG0=                                                 08700000
.*                REG1=                                                 08750000
.*                REUSE=                                                08800000
.*                SP=                                                   08850000
.*                STM=                                                  08900000
.*                SVA=                                                  08950000
.*                DQLST=                                                09000000
.*                VCR=                                                  09050000
.*                                                                      10250000
.*                                                                      10300000
.*      OUTPUT = INTERFACE TO IFG019RA                                  10350000
.*                                                                      10400000
.* EXIT-NORMAL = MEXIT OR MEND STATEMENT                                10950000
.*                                                                      11000000
.* EXIT-ERROR = ERROR MESSAGES:                                         11050000
.*                                                                      11100000
.*      MNOTE 8,***** INVALID FUNCTION - &FUNC                          11150000
.*      MNOTE 4,WAIT CAN HAVE NO PARAMETERS                             11200000
.*      MNOTE 4,XCTL CAN HAVE ONLY 2 PARAMETERS                         11250000
.*      MNOTE 4,SYNCHDCB CAN HAVE NO PARAMETERS                         11300000
.*      MNOTE 4,LV ONLY ON FREE WITH PREFIX=NO OR PREFIX=WA        @01A 11350000
.*      MNOTE 4,SP ONLY ON FREE WITH PREFIX=NO OR PREFIX=WA        @01A 11400000
.*      MNOTE 4,KEY ONLY ON FREE WITH PREFIX=NO OR PREFIX=WA       @01A 11450000
.*      MNOTE 4,ID= INVALID FOR FREE                                    11500000
.* MNOTE 8,'INVALID INPUT TO &SYSLIST(1):TOO MANY PARAMETERS SPECD'@L1A 11512500
.* MNOTE 8,'INVALID INPUT TO &SYSLIST(1): BAD PARAMETER SPECIFIED' @L1A 11525000
.* MNOTE 8,'INVALID INPUT TO &SYSLIST(1): MUTUALLY EXCLUSIVE PARMS'@L1A 11537500
.*      MNOTE 8,CODE PREFIX OR EXTPR WITH GET OR FREE                   11550000
.*      MNOTE 8,STM ON LAST FREE INVALID                                11600000
.*      MNOTE 8,STM MUST HAVE 3 PARAMETERS                              11650000
.*      MNOTE 8,STM ERROR - GET RETURNS ADDR OF AREA IN R1              11700000
.*      MNOTE 8,A= ADDR OF DCB PARAM LIST                               11750000
.*      MNOTE 8,A= ADDR TO FREE OR GET PREFIX ADDR MISSING              11800000
.*      MNOTE 8,LV= LENGTH MISSING                                      11850000
.*      MNOTE 8,PREFIX=&PREFIX INCOMPATIBLE WITH GET REQUEST            11900000
.*      MNOTE 8,PREFIX OR EXTPR PARAMETER REQUIRED FOR LOAD UNLESS      11950000
.*            BRANCH=QUEUED                                             12000000
.*      MNOTE 8,BRANCH PARAMETER INVALID                                12100000
.*      MNOTE 8,BRANCH PARAMETER REQUIRED FOR LOAD                      12150000
.*      MNOTE 8,DEB= OR DCBCOPY= MUST BE CODED                          12200000
.*      MNOTE 8,INITIAL CALL ALWAYS TOWKAR                              12250000
.*      MNOTE 12,***  IHB002 INVALID DEB OPERAND SPECIFIED-&DEB         12300000
.*      MNOTE 12,***  IHB002 INVALID DCBCOPY OPERAND SPECIFIED-&DCBCOPY 12350000
.*                                                                      12400000
.* EXTERNAL REFERENCES = NONE                                           12550000
.*                                                                      12600000
.*      ROUTINES = NONE                                                 12800000
.*                                                                      12850000
.*      DATA AREAS = NONE                                               12900000
.*                                                                      12950000
.*      CONTROL BLOCKS = CVT                                            13150000
.*                                                                      13200000
.* TABLES = EOV WORK AREA                                               13400000
.*          OPEN/CLOSE WORK AREA                                        13450000
.*          OPEN/CLOSE WTG TABLE                                        13500000
.*          VARIOUS DADSM WORK AREAS                                    13550000
.*                                                                      13600000
.* MACROS = IHBERMAC                                                    13800000
.*          MODESET                                                     13850000
.*          RETURN                                                      13900000
.*                                                                      13950000
.* CHANGE ACTIVITY -                                                    13959000
.*                                                                      13968000
.*     CHANGES FOR MVS/XA DFP 1.1                                       13977000
.*                                                                      13986000
.*$L1=ANSI,JDP1111,,STLLRU: ANSI-78 TAPE LABEL SUPPORT             @L1A 13995000
.*                                                                      14004000
.*     CHANGES FOR MVS/XA DFP 2.1.0                                     14013000
.*                                                                      14022000
.*$L2=VSCR,HDP2102,,STLJAK: CHECKPOINT/RESTART VSCR                @L2A 14031000
.*$L3=HDQ2210,,STLSS:NEW COPYRIGHT STATEMENTS                      @L3A 14040000
.*$L4=ACB31BIT,HDP2230,STLSS:  O/C/E SUPPORT OF 31-BIT VSAM        @L4A 14049000
.*$L7=SWA,HDP2230,850507,STLWER: SWA ABOVE THE LINE                @L7A 14058000
.*$L8=OZ85432,HDP2230,850924,STLCMS: SHORTEN TIOT ENQ              @L8A 14067000
.*$L9=OY07766,HDP2230,871116,STLCMS: PDS INTEGRITY                 @L9A 14076000
.*$L10=NSYNC,JDP3311,,880916,STLPD: INVOKE CVAF/REBUILD CHANL PROG@L10A 14085000
.*$01=OY32791,HDP3330,910427,SJPLJAA: ADD WA  KEYWORD TO PREFIX    @01A 14094000
.*$02=OY45560,HDP3330,910716,SJPLMV:  DSCBNQDQ DSNAME ENHANCEMENT  @02A 14103000
.*$L11=TAPELIB,HDP4410,901214,SJPLMV: FLAGSTAFF SUPPORT           @L11A 14112000
.*$P1=KMM2500,JDZ1110,920612,SJPLMV: ERROR W/REG RESTORING         @P1A 14121000
.*$L12=STRIPES,JDZ1110,920618,SJPLREB: STRIPED DATA SET SUPPORT   @L12A 14130000
.*$03=OY58424,JDZ1110,920716,SJPLMV:  ATL BIG3  SUPPORT            @03A 14139000
.*$04=OY60008,JDZ1110,921030,SJPLJAL: RMMEXIT SUPPORT              @04A 14144500
.*$05=OY60414,JDZ1110,921228,SJPLMV:  2ND DEB EXT NOT ABOVE 16 LINE@05A 14144600
.*$L13,K131547,HDZ11C0,931230,SJPLJAL: STORAGE SEGMENT SUPPORT    @L13A 14145900
.*$L14=K130398,HDZ11C0,941230,SJPLJAL: RMM EXIT CHANGES           @L14A 14147200
.*$L15=K130891,HDZ11C0,950224,SJPLJAL: EXCP DCB XTIOT SUPPORT     @L15A 14148600
.*$16=OW20622,HDZ11C0,960530,SJPLJAL: DEB2X OBTAINED BELOW LINE    @16A 14149300
.*$L16=SMFT422,HDZ11D0,9601030,SJPLJAL: SMF42 SUBTYP9 SUPPORT     @L16A 14149600
.*$L17=SERVICE,HDZ11D0,960923,SJPLGEC: SSSA SIZE CHANGE           @L17A 14149800
.*$L18=RAVSCR,HDZ11D0,9601030,SJPLJAL: EXCP DCB XTIOT RTN IN 19RA @L18A 14162300
.*                                MOVED ABOVE LINE FOR VSCR       @L18A 14174800
.*$L19=ANSIV4,HDZ11E0,971231,SJPLJAL: ANSI V4 SUPPORT             @L19A 14181000
.*$L20=ANSIV4,HDZ11E0,971231,SJPLJAL: ANSI V4 CCSID SUPPORT       @L20A 14184100
.*$L21=OW38717,HDZ11E0,990630,SJPLJAL: BLYTHE2 SUPPORT            @L21A 14185700
.*$L22=NEWGET,HDZ11F0,990630,SJPLJAL: SUPPORT LOC=(BELOW,ANY)     @L22A 14186500
.*                                                                      14187300
.********************************************************************** 14200000
.*                                                                      14250000
         LCLA  &IECPRFX,&CODE                                    Y02080 14300000
         LCLC  &PREFX                                            Y02080 14350000
         LCLC  &SR          VALUE FOR SERVREG                      @L7A 14357100
.*                                                                 @L7A 14364200
&SR      SETC  'RES'        SET DEFAULT FOR NAME OF REGISTER 5     @L7A 14371300
         AIF   ('&SERVREG' EQ '').NOSERV                           @L7A 14378400
&SR      SETC  '&SERVREG'   GET NAME OF REGISTER 5                 @L7A 14385500
.NOSERV  ANOP                                                      @L7A 14392600
.*                                                                      14400000
         AIF   ('&FUNC' EQ 'WAIT').WAIT  WAITS ON DXECB IN WORK AREA    14450000
         AIF   ('&FUNC' EQ 'XCTL').XCTL  XCTL TO NEXT MODULE            14500000
         AIF   ('&FUNC' EQ 'SYNCHDCB').SYNCHDC ALL DCB'S TO SAME POINT  14550000
         AIF   ('&FUNC' EQ 'UEXIT').IECE000 USER EXIT EXPANSION  Y02082 14600000
         AIF   ('&FUNC' EQ 'LOAD').LOAD GET MODULE EPA           Y02080 14650000
         AIF   ('&FUNC' EQ 'BRANCH').BRANCH BRANCH TO MODULE     Y02080 14700000
         AIF   ('&FUNC' EQ 'GET').IECA000 LINK TO GETMAIN        Y02080 14750000
         AIF   ('&FUNC' EQ 'FREE').IECA000 LINK TO FREEMAIN      Y02080 14800000
         AIF   ('&FUNC' EQ 'RJFCB').IECB000     READ JFCB          @L7C 14850000
         AIF   ('&FUNC' EQ 'WJFCB').IECB000     WRITE JFCB         @L7C 14900000
         AIF   ('&FUNC' EQ 'INIT').IECA000 LINK TO INITIALIZE    Y02134 14950000
         AIF   ('&FUNC' EQ 'EXIT').IECD000 SET UP CALLER RETURN  Y02134 15000000
         AIF   ('&FUNC' EQ 'VALIDATE').IECV000  LINK TO VALIDATE   @L1A 15002600
         AIF   ('&FUNC' EQ 'FILEACC').IECF000   LINK TO FILEACC    @L1A 15005200
         AIF   ('&FUNC' EQ 'XLATE').IECX000     LINK TO XLATE      @L1A 15007800
         AIF   ('&FUNC' EQ 'XLATE4').IECJ000    LINK TO XLATE     @L19A 15009100
         AIF   ('&FUNC' EQ 'DSN').IECG000       LINK TO DSN        @L1A 15010400
         AIF   ('&FUNC' EQ 'VOLACC').IECU000    LINK TO VOLACC     @L1A 15013000
         AIF   ('&FUNC' EQ 'VALSUP').IECW000    LINK TO VALSUP     @L1A 15015600
         AIF   ('&FUNC' EQ 'MODE31').IECM000 GO TO CHG ADDR MODE   @L4A 15018200
         AIF   ('&FUNC' EQ 'MODE24').IECN000 GO TO CHG ADDR MODE   @L4A 15020800
         AIF   ('&FUNC' EQ 'ENQTIOT').IECNQ00 LINK TO ENQTIOT      @L8A 15023400
         AIF   ('&FUNC' EQ 'DEQTIOT').IECDQ00 LINK TO DEQTIOT      @L8A 15026000
         AIF   ('&FUNC' EQ 'DSCBNQDQ').IECC000  DSCB ENQ/DEQ       @L9A 15028600
         AIF   ('&FUNC' EQ 'UGET').IECY000 ULTRA TEMP'RY STRGE     @L9A 15031200
         AIF   ('&FUNC' EQ 'CPRBLD' OR '&FUNC' EQ 'CPRBUL' OR          X15033800
               '&FUNC' EQ 'CVAFR' OR                                   X15036400
               '&FUNC' EQ 'CVAFU').IECZ000  INVOKE CVAF/REBUILD   @L10A 15039000
         AIF   ('&FUNC' EQ 'CAFSMSVR').IECS000 UPDATE CAF VOL REC @L11A 15041600
         AIF   ('&FUNC' EQ 'CAFLCDB').IECP000 READ/UPDATE CAF VCR @L11A 15044200
         AIF   ('&FUNC' EQ 'RMM').IECE100 LINK TO RMM ROUTINES     @04A 15045500
         AIF   ('&FUNC' EQ 'IFG055ZZ').IECT000 EXTEND A STRIPED DS@L12A 15046800
         AIF   ('&FUNC' EQ 'FIND').IECH000 FIND SEGMENT AREA      @L13A 15047600
         AIF   ('&FUNC' EQ 'FREESEGS').IECI000 FREE ALL SEGMENTS  @L13A 15048400
         AIF   ('&FUNC' EQ 'COPYTIOT').IECK000 COPY XTIOT ENTRY   @L15A 15048800
         AIF   ('&FUNC' EQ 'DDSRV').IECQ000 IEFDDSRV FOR XTIOT    @L15A 15049200
         AIF   ('&FUNC' EQ 'UNCAP').IECL000 UNCAPTURE XTIOT UCBS  @L15A 15049600
         AIF   ('&FUNC' EQ 'SMF42').IECR000 LINK TO IFGSMF42      @L16A 15049800
         AIF   ('&FUNC' EQ 'TAPESERV').IECR010 LINK TO IFG019RM   @L21A 15074900
         MNOTE 8,'***** INVALID FUNCTION - &FUNC'                Y02080 15100000
&NAME    DC    H'0'                     DEFINE NAME, HALT EXECUTION     15150000
         MEXIT                                                          15200000
.********************************************************************** 15250000
.*       FUNCTION = WAIT                                                15300000
.********************************************************************** 15350000
.WAIT    AIF   (N'&SYSLIST EQ 1).WAIT1                                  15400000
         MNOTE 4,'WAIT CAN HAVE NO PARAMETERS'                          15450000
.WAIT1   ANOP                                                           15500000
&NAME    BASR  14,RES                   BRANCH TO WAIT SUBROUTINE @L4C  15550000
         MEXIT                                                          15600000
.********************************************************************** 15650000
.*       FUNCTION = XCTL                                                15700000
.********************************************************************** 15750000
.XCTL    AIF   (N'&SYSLIST LE 3).XCTL1                                  15800000
         MNOTE 4,'XCTL CAN HAVE ONLY 2 PARAMETERS'                      15850000
.XCTL1   AIF   ('&IDTTR' EQ '').XCTL6                                   15900000
.*                                                                      15950000
         AIF   ('&IDTTR'(1,1) EQ '(').XCTL2                             16000000
&NAME    MVC   0(5,RWTGC),&IDTTR        MOVE ID & TTR INTO WTG TABLE    16050000
         AGO   .XCTL3                                                   16100000
.XCTL2   ANOP                                                           16150000
&NAME    MVC   0(5,RWTGC),0&IDTTR       MOVE ID & TTR INTO WTG TABLE    16200000
.XCTL3   AIF   ('&BCODE' EQ '').XCTL4A                                  16250000
         AIF   ('&BCODE'(1,1) EQ '(').XCTL4                             16300000
         LA    14,&BCODE.(,0)           LOAD BRANCH TABLE OFFSET/INDR   16350000
         AGO   .XCTL4A                                                  16400000
.XCTL4   AIF   ('&BCODE' EQ '(14)').XCTL4A                              16450000
         LR    14,&BCODE(1)             LOAD BRANCH TABLE OFFSET/INDR   16550000
.XCTL4A  AIF   ('&IDTTR'(1,1) EQ '(').XCTL4B                            16600000
         ICM   14,8,&IDTTR+5            INSERT LENGTH IN HI ORDER BYTE  16650000
         AGO   .XCTL5                                                   16700000
.XCTL4B  ICM   14,8,5&IDTTR             INSERT LENGTH IN HI ORDER BYTE  16750000
.XCTL5   B     RESXCTL(,RES)            BRANCH TO IFG019RA TO XCTL      16800000
         MEXIT                                                          16850000
.*                                                                      16900000
.XCTL6   AIF   ('&BCODE' EQ '').XCTL9                                   16950000
         AIF   ('&BCODE'(1,1) EQ '(').XCTL7                             17000000
&NAME    LA    14,&BCODE.(,0)           LOAD BRANCH TABLE OFFSET/INDR   17050000
         AGO   .XCTL8                                                   17100000
.XCTL7   AIF   ('&BCODE' EQ '(14)').XCTL9                               17150000
&NAME    LR    14,&BCODE(1)             LOAD BRANCH TABLE OFFSET/INDR   17250000
.XCTL8   B     RESXCTL(,RES)            BRANCH TO IFG019RA TO XCTL      17300000
         MEXIT                                                          17350000
.*                                                                      17400000
.XCTL9   ANOP                                                           17450000
&NAME    B     RESXCTL(,RES)            BRANCH TO IFG019RA TO XCTL      17500000
         MEXIT                                                          17550000
.********************************************************************** 17600000
.*       FUNCTION = SYNCHDCB                                            17650000
.********************************************************************** 17700000
.SYNCHDC AIF   (N'&SYSLIST EQ 1).SYNCHD1                                17750000
         MNOTE 4,'SYNCHDCB CAN HAVE NO PARAMETERS'                      17800000
.SYNCHD1 ANOP                                                           17850000
&NAME    BAS   14,RESSYNCH(,RES)       BRANCH TO SYNCH DCB SUBR    @L4C 17900000
         MEXIT                                                   Y02080 17950000
.********************************************************************** 18000000
.*       FUNCTION = GET, FREE, OR INIT                                  18050000
.********************************************************************** 18100000
.IECA000 AIF   ('&NAME' EQ '').IECA010  IF NAME OMITTED          Y02080 18150000
&NAME    DS    0H                       LABEL AND ALIGN                 18200000
.***                                                             Y02080 18250000
.*       CHECK IF VALID CALL                                     Y02080 18300000
.***                                                             Y02080 18350000
.IECA010 ANOP                                                    Y02080 18400000
&PREFX   SETC  '&PREFIX'                SET TO SPECIFIED VALUE   Y02080 18450000
&CODE    SETA  0                        SET RECOVERY CODE TO 0   Y02134 18500000
         AIF   ('&PREFX' NE '').IECA015 TEST IF SPECIFIED        Y02080 18550000
         AIF   (T'&EXTPR EQ 'O').IECA014  TEST IF SPECIFIED      YM1410 18600000
&PREFX   SETC  'YES'                    INDICATE PREFIX EXISTS   YM1410 18650000
         AGO   .IECA015                                          YM1410 18700000
.IECA014 ANOP                                                    YM1410 18750000
&PREFX   SETC  'NO'                     SET TO DEFAULT           Y02080 18800000
.IECA015 AIF   ('&PREFX'(1,1) NE 'R').IECA016 CHECK FOR RECOVERY Y02080 18850000
         AIF   ('&FUNC' EQ 'GET').IECA930 GET RWTG INVALID       Y02134 18900000
&PREFX   SETC  '&PREFX'(2,K'&PREFX-1)   INDICATE PROPER ENTRY    Y02080 18950000
&CODE    SETA  1                        SET RECOVERY CODE TO 1   Y02134 19000000
.IECA016 AIF   ('&FUNC' NE 'INIT' AND T'&EXTPR EQ 'O' AND              *19050000
               '&PREFIX' EQ '').IECA900                          Y02080 19100000
         AIF   (T'&STM EQ 'O').IECA100 NO STM                    Y02080 19150000
         AIF   (('&FUNC' EQ 'GET' OR '&FUNC' EQ 'FREE') AND            *19166600
               '&PREFX' EQ 'YES' AND '&LOC' EQ 'ANY').IECA950     @L13A 19183200
.***                                                             Y02080 19200000
.*       STM PROCESSING                                          Y02080 19250000
.***                                                             Y02080 19300000
         AIF   ('&FUNC' NE 'FREE').IECA020 STM ALWAYS ALLOWED GETY02080 19350000
         AIF   ('&PREFX' EQ 'WTG' OR '&PREFX' EQ 'EOV' OR              *19400000
               '&PREFX' EQ 'FIRST').IECA905 NO STM FOR LAST      Y02080 19450000
.IECA020 AIF   (N'&STM NE 3).IECA910    STM CODED BAD            Y02080 19500000
         AIF   ('&FUNC' NE 'GET').IECA040 GO TO INIT RESTRICTIONSY02080 19550000
         AIF   ('&STM(1)' EQ '0' OR '&STM(1)' EQ '1' OR                *19600000
               '&STM(1)' EQ '(R0)' OR '&STM(1)' EQ '(R1)').IECA913     *19650000
                                        GET RTNS ADDR AREA IN R1 Y02080 19700000
.***                                                                    19750000
.*       STM GEN                                                        19800000
.***                                                                    19850000
.IECA040 AIF   ('&PREFX' EQ 'WTG' OR '&PREFX' EQ 'EOV' OR              *19900000
               '&PREFX' EQ 'FIRST' OR '&PREFX' EQ 'EXTPR').IECA050     *19950000
                                        FIRST TIMERS             Y02080 20000000
         AIF   ('&STM(3)' EQ 'DXXPREFX' OR '&STM(3)' EQ 'WTGPREFX').IEC*20050000
               A060                     CHECK FOR STD SAVE AREA  Y02080 20100000
.IECA050 ANOP                                                    Y02080 20150000
         STM   &STM(1),&STM(2),&STM(3)&STMBASE SAVE REGISTERS      @13C 20200000
         LA    15,&STM(3)&STMBASE       ADDR OF REGISTER SAVE AREA @13C 20250000
         AGO   .IECA100                 PROC A=                  Y02080 20300000
.IECA060 ANOP                                                    Y02080 20350000
         L     15,&STM(3)&STMBASE       GET ADDRESS OF PREFIX      @13C 20400000
         LA    15,IECREGSV-IECPREFX(,15) ADDR OF REGISTER SAVE AREA     20450000
         STM   &STM(1),&STM(2),0(15)    SAVE REGISTERS                  20500000
.***                                                             Y02080 20550000
.*       A = ADDRESS OF WORK AREA FOR GET,PREFIX=YES OR                 20600000
.*           ADDRESS OF PREFIX FOR GET WITH DEFAULT OF PREFIX=NO OR     20650000
.*           ADDRESS OF A DCB PARAMETER LIST FOR GET,PREFIX=WTG/EOV     20700000
.***                                                             Y02080 20750000
.IECA100 AIF   ('&FUNC' EQ 'INIT').INIT100 INIT PROC             Y02080 20800000
         AIF   (T'&EXTPR NE 'O').IECA105 EXTPR= ADDR OF W/A      Y02080 20850000
         AIF   ('&FUNC' EQ 'FREE').IECA140 FREE PROC             Y02080 20900000
         AIF   ('&PREFX' EQ 'FIRST').IECA135 1ST GET EXPANSION   Y02080 20950000
         AIF   ('&PREFX' EQ 'WTG' OR '&PREFX' EQ 'EOV').IECA125        *21000000
                                        WTG, EOV ADDR OF PARMS   Y02080 21050000
         AIF   ('&PREFX' EQ 'YES').IECA120 GET YES EXPAN         Y02080 21100000
         AIF   ('&PREFX' EQ 'NO').IECA200 NO PREFIX IN R1        Y02080 21150000
         AIF   ('&PREFX' EQ 'WA').IECA200 SAM CALL PREFX ASSUME NO @01A 21175000
.***                                                                    21200000
.*       GET EXTPR PROCESSING                                           21250000
.***                                                                    21300000
.IECA105 AIF   ('&EXTPR'(1,1) EQ '(').IECA110 REG FORM           Y02080 21350000
         LA    1,&EXTPR                 ADDRESS OF EXTENDED PREFIX      21400000
         AGO   .IECA200                 CONTINUE                 Y02080 21450000
.IECA110 AIF   ('&EXTPR' EQ '(1)' OR '&EXTPR' EQ '(R1)').IECA200 Y02080*21500000
                                        RIGHT REGISTER ALREADY   Y02080 21550000
         LR    1,&EXTPR(1)              ADDRESS OF EXTENDED PREFIX      21600000
         AGO   .IECA200                 CONTINUE                 Y02080 21650000
.***                                                                    21700000
.*       GET PREFIX=YES                                                 21750000
.***                                                                    21800000
.IECA120 ANOP                                                    Y02080 21850000
         AIF   (T'&STM EQ 'O').IECA140  CHECK A=                 Y02080 21900000
         AIF   ('&STM(3)' EQ 'WTGPREFX' OR '&STM(3)' EQ 'DXXPREFX').IEC*21950000
               A122                     CHECK FOR A=             Y02080 22000000
         AIF   ('&STM(3)'(1,8) NE 'IECREGSV').IECA140 BASE NOT   Y02080*22050000
                                        IMPLIED BY SAVE          Y02080 22100000
.IECA122 ANOP                                                    Y02080 22150000
         LR    1,15                     GET PREFIX ADDRESS              22200000
         AGO   .IECA200                 CONTINUE                 Y02080 22250000
.IECA125 AIF   (T'&A EQ 'O').IECA917    NO ADDR OF DCBLIST       Y02080 22300000
         AIF   ('&A' EQ '(1)').IECA200  RIGHT REG                Y02080 22350000
         LR    1,&A(1)                  ADDRESS OF DCB PARAMETER LIST   22400000
         AGO   .IECA200                 CONTINUE                 Y02080 22450000
.***                                                                    22500000
.*       GET FIRST PREFIX                                               22550000
.***                                                                    22600000
.IECA135 ANOP                                                    Y02080 22650000
         SR    1,1                      NO PREVIOUS PREFIX              22700000
         AGO   .IECA200                 CONTINUE                 Y02080 22750000
.***                                                                    22800000
.*       FREE                                                           22850000
.***                                                                    22900000
.IECA140 AIF   ('&LOC' NE 'ANY' OR '&PREFX' NE 'YES').IECA145     @L13A*22907100
                                     BR IF NOT SEGMENT GET/FREE   @L13A 22914200
         AIF   ('&FUNC' EQ 'FREE').IECA141                        @L13A 22921300
         LA    14,IECRES_GETSEG_&SYSNDX PT TO RETURN ADDRESS      @L13A 22928400
         AGO   .IECA142                                           @L13A 22935500
.IECA141 ANOP                                                     @L13A 22942600
         LA    14,IECRES_FREESEG_&SYSNDX PT TO RETURN ADDRESS     @L13A 22949700
.IECA142 ANOP                                                     @L13A 22956800
         BSM   14,0                     SAVE ADDRESSING MODE      @L13A 22963900
         BAKR  14,0                     STACK REGS/PSW ETC.       @L13A 22971000
         AIF   ('&FUNC' EQ 'FREE').IECA145                        @L13A 22978100
         AGO   .IECA200                 MUST BE GET               @L13A 22985200
.IECA145 AIF   (T'&A EQ 'O').IECA920    NO ADD FOR FREE OR GET HAS@L13C*22992300
                                        NO ADDRESSABILITY TO PREFIX     23000000
         AIF   ('&PREFX' EQ 'WTG').IECA160 A PTS TO THE WTG TABL Y02080 23050000
         AIF   ('&PREFX' EQ 'EOV').IECA170 A PTS TO THE WTG TABL Y02080 23100000
         AIF   ('&A'(1,1) EQ '(').IECA150 REG FORM               Y02080 23150000
         LA    1,&A                     ADDRESS OF WORK AREA            23200000
         AGO   .IECA200                 CONTINUE                 Y02080 23250000
.IECA150 AIF   ('&A' EQ '(1)' OR '&A' EQ '(R1)').IECA200  REG OK Y02080 23300000
         LR    1,&A(1)                  ADDRESS OF WORK AREA            23350000
         AGO   .IECA200                 CONTINUE                 Y02080 23400000
.***                                                                    23450000
.*       A = ADDRESS OF WTG TABLE                                       23500000
.***                                                                    23550000
.IECA160 AIF   ('&A'(1,1) EQ '(').IECA165 REG FORM               Y02080 23600000
         L     1,WTGPREFX-WTG+&A        ADDRESS OF BASE PREFIX          23650000
         AGO   .IECA180                 INCR PAST BASE           Y02080 23700000
.IECA165 ANOP                                                    Y02080 23750000
         L     1,WTGPREFX-WTG&A         ADDRESS OF BASE PREFIX          23800000
         AGO   .IECA180                 INCR PAST BASE           Y02080 23850000
.***                                                                    23900000
.*       A = ADDRESS OF EOV WORK AREA                                   23950000
.***                                                                    24000000
.IECA170 AIF   ('&A'(1,1) EQ '(').IECA175 REG FORM               Y02080 24050000
         L     1,DXXPREFX-FORCORE+&A    ADDRESS OF BASE PREFIX          24100000
         AGO   .IECA180                 INCR PAST BASE           Y02080 24150000
.IECA175 ANOP                                                    Y02080 24200000
         L     1,DXXPREFX-FORCORE&A     ADDRESS OF BASE PREFIX          24250000
.IECA180 ANOP                                                    Y02080 24300000
         LA    1,IECSTART-IECPREFX(,1)  INCREMENT PAST BASE PREFIX      24350000
.***                                                             Y02080 24400000
.*       LV = LENGTH OF WORK AREA                                Y02080 24450000
.***                                                             Y02080 24500000
.IECA200 AIF   ('&FUNC' EQ 'FREE' AND '&PREFX' EQ 'NO').IECA210  Y02080 24550000
         AIF   ('&FUNC' EQ 'FREE' AND '&PREFX' EQ 'WA').IECA210    @01A 24575000
         AIF   ('&FUNC' EQ 'GET').IECA210 GET MUST HAVE LV       Y02080 24600000
         AIF   (T'&LV EQ 'O').IECA300   OK NO LENGTH             Y02080 24650000
.* THE FOLLOWING MESSAGE APPLIES TO FREE ON PREFIX=WA ALSO         @01A 24683300
         MNOTE 4,'CODE LV ONLY ON FREE WITH PREFIX=NO OR WA'       @01A 24716600
         AGO   .IECA300                 CONTINUE                 Y02080 24750000
.IECA210 AIF   ('&PREFX' EQ 'WTG').IECA240  OPEN OR CLOSE WTG TABLE     24800000
         AIF   ('&PREFX' EQ 'EOV').IECA230  EOV WORK AREA        Y02080 24850000
         AIF   (T'&LV EQ 'O').IECA925   LV ON GET FREE NO        Y02080 24900000
         AIF   ('&LV'(1,1) EQ '(').IECA220 REG FORM              Y02080 24950000
         LA    0,&LV.(,0)               LENGTH OF WORK AREA             25000000
         AGO   .IECA300                 CONTINUE                 Y02080 25050000
.IECA220 AIF   ('&LV' EQ '(0)' OR '&LV' EQ '(R0)').IECA300 REG OKY02080 25250000
         LR    0,&LV(1)                 LENGTH OF WORK AREA             25300000
         AGO   .IECA300                 CONTINUE                 Y02080 25350000
.IECA230 ANOP                                                    Y02080 25400000
         LA    0,EOVSIZE(,0)            EOV WORK AREA SIZE              25450000
         AGO   .IECA300                 CONTINUE                 Y02080 25500000
.IECA240 ANOP                                                    Y02080 25550000
         SR    0,0                      LENGTH COMPUTED IN IFG019RA     25600000
.***                                                             Y02080 25650000
.*       SP = SUBPOOL OF WORK AREA                               Y02080 25700000
.***                                                             Y02080 25750000
.IECA300 AIF   ('&FUNC' EQ 'FREE' AND '&PREFX' EQ 'NO').IECA310  Y02080 25800000
         AIF   ('&FUNC' EQ 'FREE' AND '&PREFX' EQ 'WA').IECA310    @01A 25825000
         AIF   ('&FUNC' EQ 'GET').IECA310 CHECK GET              Y02080 25850000
         AIF   ('&FUNC' NE 'FREE' OR '&PREFX' NE 'YES' OR              *25856400
               '&LOC' NE 'ANY').IECA305                           @L13A 25862800
         AIF   (T'&SP NE 'O').IECA955   SP PARM NOT ALLOWED       @L13A 25869200
         LA    4,8(,0)                  FREE SEG FUNCTION CODE    @L13A 25875600
         L     15,CVTPTR(,0)            POINT TO CVT              @L13A 25882000
         L     15,CVTDFA-CVT(,15)       POINT TO DFA              @L13A 25888400
         L     14,DFADFVAD-DFA(,15)     POINT TO DFVT             @L13A 25894800
         LA    15,8                     GET IFG019RB OFFSET       @L13A 25901200
         AL    15,DFVOPN31-DFVT(,14)    ADDR ROUTER IFG019RB      @L13A 25907600
         BASSM 14,15                    BR TO IFG019RB/IFG019RI   @L13A 25914000
         AGO   .IECA500                                           @L13A 25920400
.IECA305 AIF   (T'&SP EQ 'O').IECA400   NO SP ON FREE             @L13C 25926800
.* THE FOLLOWING MESSAGE APPLIES TO FREE ON PREFIX=WA ALSO         @01A 25933300
         MNOTE 4,'CODE SP ONLY ON FREE WITH PREFIX=NO OR WA'       @01A 25966600
         AGO   .IECA400                 CONTINUE                 Y02080 26000000
.IECA310 AIF   ('&PREFX' NE 'YES' OR '&LOC' NE 'ANY').IECA317     @L13A 26004300
         AIF   ('&FUNC' NE 'GET').IECA317                         @L13A 26008600
         AIF   (T'&SP NE 'O').IECA955                             @L13A 26012900
         LA    4,4(,0)                  GET SEG FUNCTION CODE     @L13A 26017200
         L     15,CVTPTR(,0)            POINT TO CVT              @L13A 26021500
         L     15,CVTDFA-CVT(,15)       POINT TO DFA              @L13A 26025800
         L     14,DFADFVAD-DFA(,15)     POINT TO DFVT             @L13A 26030100
         LA    15,8                     GET IFG019RB OFFSET       @L13A 26034400
         AL    15,DFVOPN31-DFVT(,14)    ADDR ROUTER IFG019RB      @L13A 26038700
         AIF   (T'&SECID EQ 'O').IECA315                          XXX   26043000
         AIF   ('&SECID'(1,1) NE '(').IECA313                     XXX   26047300
         LR    2,&SECID(1)                                        XXX   26051600
         AGO   .IECA316                                           XXX   26055900
.IECA313 ANOP                                                     XXX   26060200
         LA    2,IECRES_GETSEG_RS_&SYSNDX                         XXX   26064500
         AGO   .IECA316                                           XXX   26068800
.IECA315 ANOP                                                     XXX   26073100
         LA    2,IECRES_GETSEG_NULL_&SYSNDX                       XXX   26077400
.IECA316 ANOP                                                     XXX   26081700
         BASSM 14,15                    BR TO IFG019RB/IFG019RI   @L13A 26086000
         AGO   .IECA500                                           @L13A 26090300
.IECA317 AIF   ('&PREFX' EQ 'WTG' OR '&PREFX' EQ 'EOV').IECA400   @L13C*26094600
                                        SP DEFAULT               Y02080 26100000
         AIF   (T'&SP EQ 'O').IECA330   DEFAULT SP               Y02080 26150000
         AIF   ('&SP'(1,1) EQ '(').IECA320 REG FORM              Y02080 26200000
         LA    2,&SP.(,0)               SUBPOOL                         26250000
         AGO   .IECA400                 CONTINUE                 Y02080 26300000
.IECA320 AIF   ('&SP' EQ '(2)' OR '&SP' EQ '(R2)').IECA400 REG OKY02080 26350000
         LR    2,&SP(1)                 SUBPOOL                         26400000
         AGO   .IECA400                 CONTINUE                 Y02080 26450000
.IECA330 ANOP                                                    Y02080 26500000
         LA    2,230(,0)                DEFAULT SUBPOOL 230             26550000
.***                                                             Y02080 26600000
.*       KEY = KEY OF WORK AREA                                  Y02080 26650000
.***                                                             Y02080 26700000
.IECA400 AIF   ('&FUNC' EQ 'FREE' AND '&PREFX' EQ 'NO').IECA410  Y02080 26750000
         AIF   ('&FUNC' EQ 'FREE' AND '&PREFX' EQ 'WA').IECA410    @01A 26775000
         AIF   ('&FUNC' EQ 'GET').IECA410 GET PROC               Y02080 26800000
         AIF   (T'&KEY EQ 'O').IECA500  OK NO KEY FOR FREE       Y02080 26850000
.* THE FOLLOWING MESSAGE APPLIES TO FREE ON PREFIX=WA ALSO         @01A 26883300
         MNOTE 4,'CODE KEY ONLY ON FREE WITH PREFIX=NO OR WA'      @01A 26916600
         AGO   .IECA500                 CONTINUE                 Y02080 26950000
.IECA410 AIF   ('&PREFX' EQ 'WTG' OR '&PREFX' EQ 'EOV').IECA500        *27000000
                                        DEFAULT KEY              Y02080 27050000
         AIF   (T'&KEY EQ 'O').IECA440  DEFAULT KEY              Y02080 27100000
         AIF   ('&KEY' EQ 'USER').IECA430 USER ENTRY KEY         Y02080 27150000
         AIF   ('&KEY'(1,1) EQ '(').IECA420 REG FORM             Y02080 27200000
         LA    3,&KEY.(,0)              KEY OF AREA                     27250000
         AGO   .IECA500                 CONTINUE                 Y02080 27300000
.IECA420 AIF   ('&KEY' EQ '(3)' OR '&KEY' EQ '(R3)').IECA500 R OKY02080 27350000
         LR    3,&KEY(1)                KEY OF AREA                     27400000
         AGO   .IECA500                 CONTINUE                 Y02080 27450000
.IECA430 ANOP                           USER KEY                 Y02080 27500000
         SR    3,3                      CLEAR REGISTER                  27550000
         IC    3,DXUKEY                 GET USER'S KEY                  27600000
         SRL   3,4(0)                   PLACE IN LOW BYTE               27650000
         AGO   .IECA500                 CONTINUE                 Y02080 27700000
.IECA440 ANOP                           DEFAULT KEY              Y02080 27750000
         LA    3,5(,0)                  DEFAULT KEY 5                   27800000
.***                                                             Y02080 27850000
.*       OPTIONS INDEX                                           Y02080 27900000
.***                                                             Y02080 27950000
.IECA500 AIF   ('&PREFX' EQ 'WTG').IECA540 CODE ALREADY SET      Y02080 28000000
&CODE    SETA  &CODE+2                  SET EOV FREEMAIN CODE    Y02080 28050000
         AIF   ('&PREFX' EQ 'EOV').IECA540                       Y02080 28100000
&CODE    SETA  &CODE+2                  SET FIRST FREEMAIN CODE  Y02080 28150000
         AIF   ('&PREFX' EQ 'FIRST').IECA540                     Y02080 28200000
         AIF   ('&PREFX' NE 'WA' OR '&IDTTR' NE 'WLH').IECA504    @L13A 28204100
&CODE    SETA  0                                                  @L13A 28208200
         LA    4,3+&CODE.(,0)           NO PREFIX/LOCK HELD       @L13A 28212300
.IECA504 AIF   ('&PREFX' EQ 'WA').IECA547                          @16C 28216500
&CODE    SETA  0                                                   @05C 28220700
         AIF   ('&LOC' NE 'ANY').IECA506                           @05A 28224800
         AIF   ('&PREFX' EQ 'YES').IECA600                        @L13C 28228900
&CODE    SETA  &CODE+4                                             @05A 28233000
.IECA506 AIF   ('&LOC' EQ '').IECA508                              @05A 28237100
         AIF   ('&LOC' NE 'ANY' AND '&LOC' NE 'BELOW').IECA945     @05A 28241200
.IECA508 ANOP                                                      @05A 28245300
         AIF   ('&PREFX' EQ 'NO' AND '&IDTTR' NE 'WLH').IECA510  Y02080 28250000
         AIF   ('&PREFX' NE 'NO' AND '&IDTTR' NE 'WLH').IECA515  Y02080 28300000
         AIF   ('&PREFX' NE 'NO' AND '&IDTTR' EQ 'WLH').IECA520  Y02080 28350000
         AIF   ('&PREFX' EQ 'NO' AND '&IDTTR' EQ 'WLH').IECA525  Y02080 28400000
.IECA510 LA    4,&CODE.(,0)             NO PREFIX/NO LOCK          @05C 28450000
         AGO   .IECA550                 CONTINUE                 Y02080 28500000
.IECA515 LA    4,1+&CODE.(,0)           PREFIX/NO LOCK             @05C 28550000
         AGO   .IECA550                 CONTINUE                 Y02080 28600000
.IECA520 LA    4,2+&CODE.(,0)           PREFIX/LOCK HELD           @05C 28650000
         AGO   .IECA550                 CONTINUE                 Y02080 28700000
.IECA525 LA    4,3+&CODE.(,0)           NO PREFIX/LOCK HELD        @05C 28750000
         AGO   .IECA550                 CONTINUE                 Y02080 28800000
.IECA540 AIF   ('&FUNC' EQ 'FREE').IECA545 CHECK FOR FREEMAIN    Y02134 28900000
&CODE    SETA  0                        SET CODE TO ZERO         Y02134 28950000
         AIF   ('&PREFX' EQ 'WTG').IECA545 CHECK FOR GET WTG     Y02134 29000000
&CODE    SETA  1                        SET EOV/FIRST ENTRY CODE Y02134 29050000
.IECA545 LA    4,&CODE.(,0)             ENTRY INDICATOR                 29100000
         AGO   .IECA550                 CONTINUE                   @16A 29105000
.IECA547 ANOP                           PREFIX=WA ON GET/FREE      @16A 29110000
         AIF   ('&FUNC' EQ 'FREE').IECA550                         @16A 29115000
         LR    6,4                      PREFIX=WA/SAVE WA ADDRESS  @16A 29120000
         AIF   ('&LOC' EQ 'ANY' AND '&FUNC' EQ 'GET').IECA548      @16A 29125000
         AIF   ('&LOC' EQ 'BELOWANY' AND '&FUNC' EQ 'GET').IECA549      29126600
         ANOP                                                     @L22A 29128200
         AGO   .IECA550                 CONTINUE                   @16A 29130000
.IECA548 ANOP                                                      @16A 29135000
&CODE    SETA  0                                                   @16A 29140000
         LA    4,4+&CODE.(,0)           PREFIX=WA/LOC=ANY/NO LOCK  @16A 29145000
         AGO   .IECA550                 CONTINUE                  @L22A 29146000
.IECA549 ANOP                                                     @L22A 29147000
&CODE    SETA  0                                                  @L22A 29148000
         LA    4,5+&CODE.(,0)           PRFX=WA/LOC=BELOWANY/NOLK @L22A 29149000
.***                                                             Y02080 29150000
.*       BRANCH ENTRY                                            Y02080 29200000
.***                                                             Y02080 29250000
.IECA550 ANOP                                                    Y02080 29300000
         L     5,CVTPTR(,0)             LOAD CVT ADDRESS                29350000
         ICM   5,B'0111',CVTDMSRA-CVT(5)  MOVE IFG019RA ADDRESS    @L4C 29375000
         AIF   ('&FUNC' EQ 'GET' AND '&PREFX' EQ 'WA').IECA625     @01A 29400000
         AIF   ('&FUNC' EQ 'FREE' AND '&PREFX' EQ 'WA').IECA628    @01A 29425000
         AIF   ('&FUNC' EQ 'FREE').IECA590 FREE                  Y02080 29450000
         AIF   ('&PREFX' EQ 'WTG').IECA580 WTG ENTRY             Y02080 29500000
         AIF   ('&PREFX' EQ 'EOV').IECA580 EOV ENTRY             Y02080 29550000
         AIF   ('&PREFX' EQ 'FIRST').IECA560 FIRST ENTRY         Y02080 29600000
         BAS   14,16(,5)                LINK TO GETMAIN            @L2C 29650000
         AGO   .IECA600                 CONTINUE                 Y02080 29700000
.IECA560 ANOP                                                    Y02080 29750000
         BAS   14,36(,5)                LINK TO GETMAIN FIRST           29800000
         AGO   .IECA600                 CONTINUE                 Y02080 29850000
.IECA580 ANOP                                                    Y02080 29900000
         BAS   14,32(,5)                LINK TO GETMAIN EOV/WTG    @L4C 29950000
         AGO   .IECA600                 CONTINUE                 Y02080 30000000
.IECA590 AIF   ('&PREFX' EQ 'WTG').IECA595 WTG ENTRY             Y02080 30050000
         AIF   ('&PREFX' EQ 'EOV').IECA595 EOV ENTRY             Y02080 30100000
         AIF   ('&PREFX' EQ 'FIRST').IECA595 FIRST ENTRY         Y02080 30150000
         BAS   14,48(,5)                LINK TO FREEMAIN           @L2C 30200000
         AGO   .IECA600                 CONTINUE                 Y02080 30250000
.IECA595 ANOP                                                    Y02080 30300000
         BAS   14,52(,5)            LINK TO FREEMAIN FIRST,WTG,EOV @L4C 30350000
.***                                                             Y02080 30400000
.*       ID = ID OF CONTROL BLOCK                                Y02080 30450000
.***                                                             Y02080 30500000
.IECA600 AIF   ('&FUNC' EQ 'FREE').IECA620                       Y02080 30550000
         AIF   ('&PREFX' EQ 'NO').IECA650 NO PREFIX - NO ID      Y02080 30600000
         AIF   ('&PREFX' EQ 'WTG' OR '&PREFX' EQ 'EOV').IECA650        *30650000
                                        STD ID IN 19RA           Y02080 30700000
         AIF   ('&LOC' NE 'ANY').IECA609 ALREADY KNOW PRFX REQ'D  @L13A 30701700
         AIF   (T'&ID EQ 'O').IECA603                             @L13A 30703400
         DC    CL4'&ID'                 WORK AREA ID              @L13A 30705100
         AGO   .IECA604                                           @L13A 30706800
.IECA603 ANOP                                                     @L13A 30708500
         DC    CL4' '                   BLANK ID OF WA            @L13A 30710200
.IECA604 AIF   (T'&SECID EQ 'O').IECA605                          @L13A 30711900
         AIF   ('&SECID'(1,1) EQ '(').IECA60A REG FORM            @L13A 30713600
IECRES_GETSEG_RS_&SYSNDX  DS  0H                                  XXX   30715300
         DC    CL4'&SECID'              SECONDARY WORK AREA ID    @L13A 30717000
         AGO   .IECA606                                           @L13A 30718700
.IECA60A ANOP                                                     @L13A 30720400
         DC    CL4' '                                             @L13A 30722100
         AGO   .IECA606                                           @L13A 30723800
.IECA605 ANOP                                                     @L13A 30725500
IECRES_GETSEG_NULL_&SYSNDX  DS  0H                                XXX   30727200
         DC    CL4' '                                             @L13A 30728900
.IECA606 AIF   ('&IDTTR' NE 'WLH').IECA607                        @L13A 30730600
         DC    B'10000000'              LOCK HELD FLAG            @L13A 30732300
         AGO   .IECA608                                           @L13A 30734000
.IECA607 ANOP                                                     @L13A 30735700
         DC    B'00000000'              LOCK NOT HELD FLAG        @L13A 30737400
.IECA608 ANOP                                                     @L13A 30739100
IECRES_GETSEG_&SYSNDX  DS  0H                                     @L13A 30740800
         MEXIT                                                    @L13A 30742500
.*****************************************************************@L13A 30744200
.IECA609 ANOP                                                     @L13A 30745900
         AIF   (T'&ID EQ 'O').IECA610   NO ID                    Y02080 30750000
         DC    CL4'&ID'                 ID OF WORK AREA                 30800000
         AGO   .IECA630                 CONTINUE                 Y02080 30850000
.IECA610 ANOP                                                    Y02080 30900000
         DC    CL4' '                   BLANK ID OF WORK AREA           30950000
         AGO   .IECA630                 CONTINUE                 Y02080 31000000
.IECA620 AIF   (T'&ID EQ 'O').IECA650   OK NO ID FOR FREE        Y02080 31050000
         MNOTE 4,'ID= INVALID FOR FREE'                          Y02080 31100000
         AGO   .IECA650                 CONTINUE                 Y02080 31150000
.IECA625 ANOP                                                      @01A 31157100
         BAS   14,132(,5)               SAM GET ENTRY              @01A 31164200
         AGO   .IECA650                 CONTINUE                   @01A 31171300
.IECA628 ANOP                                                      @01A 31178400
         BAS   14,136(,5)               SAM FREE ENTRY             @01A 31185500
         AGO   .IECA650                 CONTINUE                   @01A 31192600
.IECA630 AIF   ('&PREFX' NE 'FIRST').IECA650                     Y02080 31200000
         BAS   14,40(,5)                INITIALIZE WORK AREA       @L4C 31250000
.***                                                             Y02080 31300000
.*       STM = DO LM ON RETURN                                   Y02080 31350000
.***                                                             Y02080 31400000
.IECA650 AIF   ('&PREFX' NE 'YES' OR '&LOC' NE 'ANY').IECA680     @L13A 31412500
         AIF   (T'&ID EQ 'O' AND T'&SECID EQ 'O').IECA660         @L13A 31425000
         MNOTE 4,'ID= OR SECID= INVALID FOR FREE'                 @L13A 31437500
.IECA660 ANOP                                                     @L13A 31450000
IECRES_FREESEG_&SYSNDX  DS  0H                                    @L13A 31462500
         MEXIT                                                    @L13A 31475000
.IECA680 AIF   (T'&STM EQ 'O').IECA700 NO STM                     @L13C 31487500
         LM    &STM(1),&STM(2),0(15)    RESTORE REGISTERS               31500000
         AIF   ('&FUNC' EQ 'INIT').IECA710 NO REG COMMENT        Y02080 31550000
.IECA700 AIF   ('&FUNC' EQ 'FREE').IECA705 REG COMMENT           Y02080 31600000
         AIF   ('&PREFX' EQ 'WTG' OR '&PREFX' EQ 'EOV').IECA710  Y02080 31650000
.IECA705 ANOP                                                    Y02080 31750000
*  IECRES GET/FREE PRESERVES THE CONTENTS OF REGISTERS 8-10.            31800000
.IECA710 MEXIT                                                   Y02080 31850000
.***                                                                    31900000
.*       GET/FREE ERRORS                                         Y02080 31950000
.***                                                             Y02080 32000000
.IECA900 MNOTE 8,'CODE PREFIX OR EXTPR WITH GET OR FREE'         Y02080 32050000
         MEXIT                                                   Y02080 32100000
.IECA905 MNOTE 8,'STM ON LAST FREE INVALID'                      Y02080 32150000
         MEXIT                                                   Y02080 32200000
.IECA910 MNOTE 8,'STM MUST HAVE 3 PARAMETERS'                    Y02080 32250000
         MEXIT                                                   Y02080 32300000
.IECA913 MNOTE 8,'STM ERROR - GET RETURNS ADDR OF AREA IN R1'    Y02080 32350000
         MEXIT                                                   Y02080 32400000
.IECA917 MNOTE 8,'A= ADDR OF DCB PARAM LIST'                     Y02080 32450000
         MEXIT                                                          32500000
.IECA920 MNOTE 8,'A= ADDR TO FREE OR GET PREFIX ADDR MISSING'    Y02080 32550000
         MEXIT                                                   Y02080 32600000
.IECA925 MNOTE 8,'LV= LENGTH MISSING'                            Y02080 32650000
         MEXIT                                                   Y02080 32700000
.IECA930 MNOTE 8,'PREFIX=&PREFIX INCOMPATIBLE WITH GET REQUEST'  Y02080 32750000
         MEXIT                                                   Y02080 32800000
.IECA940 MNOTE 8,'WITH LOC EQUAL ANY, PREFIX MUST EQUAL NO'        @05C 32810000
         MEXIT                                                     @05A 32820000
.IECA945 MNOTE 8,'LOC MUST BE ANY OR BELOW'                        @05C 32830000
         MEXIT                                                     @05A 32840000
.IECA950 MNOTE 8,'STM INVALID WITH PREFIX=YES AND LOC=ANY'        @L13A 32842000
         MEXIT                                                    @L13A 32844000
.IECA955 MNOTE 8,'SP INVALID WITH PREFIX=YES AND LOC=ANY'         @L13A 32846000
         MEXIT                                                    @L13A 32848000
.********************************************************************** 32850000
.*       FUNCTION = LOAD                                                32900000
.********************************************************************** 32950000
.LOAD    ANOP                                                    Y02080 33000000
         AIF   ('&NAME' EQ '').LOAD001  IF NAME MISSING          Y02080 33050000
&NAME    DS    0H                       LABEL AND ALIGN                 33100000
.LOAD001 AIF   ('&BRANCH' EQ 'QUEUED').LOAD008 BYPASS REG SAVE   Y02080 33150000
         AIF   ('&PREFIX' EQ '').LOAD004 NO PREFIX PARAMETER     Y02080 33200000
         AIF   ('&PREFIX' EQ 'NO').LOAD004 NO PREFIX PARAMETER   Y02080 33250000
         AIF   ('&PREFIX'(1,1) EQ '(').LOAD003 REG CONTAINS PTR  Y02080 33300000
         L     15,&PREFIX               GET POINTER TO A PREFIX         33350000
.LOAD002 STM   0,14,IECREGSV-IECPREFX(15) SAVE REGISTERS                33400000
         AGO   .LOAD008                 GO CHECK MODID           Y02080 33450000
.LOAD003 AIF   ('&PREFIX' EQ '(15)').LOAD002 REG 15 ALREADY SET  Y02080 33500000
         AIF   ('&PREFIX' EQ '(15)').LOAD002                     Y02080 33550000
         LR    15,&PREFIX(1)            GET POINTER TO A PREFIX         33600000
         AGO   .LOAD002                                          Y02080 33650000
.LOAD004 AIF   ('&EXTPR' EQ '').LOAD007 NEED PREFIX PARAMETER    Y02080 33700000
         AIF   ('&EXTPR'(1,1) EQ '(').LOAD006 REG CONTAINS PTR   Y02080 33750000
         L     15,&EXTPR                GET PTR TO EXTENDED PREFIX      33800000
.LOAD005 STM   0,14,IECREGSV-IECEXTPR(15) SAVE REGISTERS                33850000
         LA    1,IECEXTPR-IECPREFX(0,0) BACK UP REGISTER 15 TO          33900000
         SR    15,1                     POINT TO START OF PREFIX        33950000
         AGO   .LOAD008                                          Y02080 34000000
.LOAD006 AIF   ('&EXTPR' EQ '(15)').LOAD005 REG 15 ALREADY SET   Y02080 34050000
         LR    15,&EXTPR(1)             GET PTR TO EXTENDED PREFIX      34100000
         AGO   .LOAD005                                          Y02080 34150000
.LOAD007 MNOTE 8,'PREFIX OR EXTPR PARAMETER REQUIRED FOR LOAD UNLESS BR*34200000
               ANCH=QUEUED'                                      Y02080 34250000
         AGO   .LOAD099                 GENERATE INVALID OP CODE Y02080 34300000
.*                                                               Y02080 34350000
.LOAD008 AIF   ('&PREFIX' NE 'DXXPREFX').LOAD08A                 Y02080 34400000
         LA    6,DXXMODNM               LOAD PTR TO WTG MODULE NAME     34450000
.LOAD08A AIF   ('&MODID' EQ '').LOAD010 IF MODID NOT CODED       Y02080 34500000
         AIF   ('&BRANCH' EQ 'QUEUED').LOAD11A                   Y02080 34550000
         AIF   ('&MODID'(1,1) EQ '(').LOAD009 IF PTR IN REGISTER Y02080 34600000
.*                                                               Y02080 34650000
         MVC   WTGMODNM+6(2),&MODID     MOVE ID TO LIST                 34700000
         MVC   WTGMODEP+1(3),&MODID+2   MOVE EPA TO LIST                34750000
         AGO   .LOAD012                                          Y02080 34800000
.*                                                               Y02080 34850000
.LOAD009 MVC   WTGMODNM+6(2),0&MODID    MOVE ID TO LIST                 34900000
         MVC   WTGMODEP+1(3),2&MODID    MOVE EPA TO LIST                34950000
         AGO   .LOAD012                                          Y02080 35000000
.*                                                               Y02080 35050000
.LOAD010 AIF   ('&MODNM' EQ '').LOAD012 IF MODNM NOT CODED       Y02080 35100000
         AIF   ('&BRANCH' EQ 'QUEUED').LOAD11C                   Y02080 35150000
         AIF   ('&MODNM'(1,1) EQ '(').LOAD011 IF PTR IN REGISTER Y02080 35200000
.*                                                               Y02080 35250000
         MVC   WTGMODNM(12),&MODNM      MOVE MODULE NAME & EPA          35300000
         AGO   .LOAD012                                          Y02080 35350000
.*                                                               Y02080 35400000
.LOAD011 MVC   WTGMODNM(12),0&MODNM     MOVE MODULE NAME & EPA          35450000
         AGO   .LOAD012                                          Y02080 35500000
.*                                                               Y02080 35550000
.LOAD11A AIF   ('&MODID'(1,1) EQ '(').LOAD11B                    Y02080 35600000
         MVC   0(5,RWTGC),&MODID        MOVE ID & EPA TO WTG TABLE      35650000
         AGO   .LOAD012                                          Y02080 35700000
.*                                                               Y02080 35750000
.LOAD11B MVC   0(5,RWTGC),0&MODID       MOVE ID & EPA TO WTG TABLE      35800000
         AGO   .LOAD012                                          Y02080 35850000
.*                                                               Y02080 35900000
.LOAD11C AIF   ('&MODNM'(1,1) EQ '(').LOAD11D IF PTR IN REGISTER Y02080 35950000
         MVC   0(2,RWTGC),&MODNM+6      MOVE ID TO WTG TABLE            36000000
         MVC   2(3,RWTGC),&MODNM+9      MOVE V-CON TO WTG TABLE         36050000
         AGO   .LOAD012                                          Y02080 36100000
.*                                                               Y02080 36150000
.LOAD11D MVC   0(2,RWTGC),6&MODNM       MOVE ID TO WTG TABLE            36200000
         MVC   2(3,RWTGC),9&MODNM       MOVE V-CON TO WTG TABLE         36250000
.*                                                               Y02080 36300000
.LOAD012 AIF   ('&BRANCH' EQ 'QUEUED').LOAD015 REG 5 & 6 LOADED  Y02080 36350000
         AIF   ('&PREFIX' EQ 'DXXPREFX').LOAD014                 Y02080 36400000
         LA    6,WTGMODNM               LOAD PTR TO WTG MODULE NAME     36450000
.LOAD014 L     5,CVTPTR(,0)             LOAD ADDRESS OF CVT             36500000
         ICM   5,B'0111',CVTDMSRA-CVT(5)  MOVE IFG019RA ADDRESS    @L4C 36550000
         AIF   ('&BRANCH' EQ 'NO').LOAD021 RETURN TO CALLER      Y02080 36600000
.*                                                               Y02080 36650000
.LOAD015 AIF   ('&BRCODE' EQ '').LOAD017 BRANCH OFFSET NOT CODED Y02080 36700000
         AIF   ('&BRANCH' EQ 'NO').LOAD017 REG 14 USED TO RETURN Y02080 36750000
         AIF   ('&BRCODE'(1,1) EQ '(').LOAD016 BRNCH CODE IN REG Y02080 36800000
         LA    14,&BRCODE               LOAD BRANCH TABLE OFFSET        36850000
         AGO   .LOAD017                                          Y02080 36900000
.LOAD016 AIF   ('&BRCODE' EQ '(14)').LOAD017 REG 14 ALREADY SET  Y02080 36950000
         AIF   ('&BRCODE' EQ '(14)').LOAD017                     Y02080 37000000
         LR    14,&BRCODE(1)            LOAD BRANCH TABLE OFFSET        37050000
.*                                                               Y02080 37100000
.LOAD017 AIF   ('&BRANCH' EQ 'QUEUED').LOAD019 IF QUEUED BRANCH  Y02080 37150000
         AIF   ('&BRANCH' EQ 'DIRECT').LOAD020 LOAD AND BRANCH   Y02080 37200000
         AIF   ('&BRANCH' EQ 'NO').LOAD021 LOAD AND RETURN       Y02080 37250000
         AIF   ('&BRANCH' EQ '').LOAD018 BRANCH PARM OMMITTED    Y02080 37300000
         MNOTE 8,'BRANCH PARAMETER INVALID'                      Y02080 37350000
         AGO   .LOAD099                 GENERATE INVALID OP CODE Y02080 37400000
.LOAD018 MNOTE 8,'BRANCH PARAMETER REQUIRED FOR LOAD'            Y02080 37450000
         AGO   .LOAD099                 GENERATE INVALID OP CODE Y02080 37500000
.LOAD019 B     RESXCTL(,RES)            SELECTIVE LOAD AND BRANCH       37550000
         MEXIT                                                   Y02080 37600000
.LOAD020 B     20(,5)                   LOAD AND BRANCH DIRECT          37650000
         MEXIT                                                   Y02080 37700000
.LOAD021 BAS   14,24(,5)                 LOAD AND RETURN           @L4C 37750000
         LM    0,14,IECREGSV-IECPREFX(15) RESTORE REGISTERS             37800000
         MEXIT                                                   Y02080 37850000
.LOAD099 DC    H'0'                     HALT EXECUTION           Y02080 37900000
         MEXIT                                                   Y02080 37950000
.********************************************************************** 38000000
.*       FUNCTION = BRANCH                                              38050000
.********************************************************************** 38100000
.BRANCH  ANOP                                                    Y02080 38150000
         AIF   ('&NAME' EQ '').BRANCH1  IF NAME OMITTED          Y02080 38200000
&NAME    DS    0H                       LABEL AND ALIGN                 38250000
.BRANCH1 AIF   ('&EPA' EQ '').BRANCH2   NO EPA PARAMETER         Y02080 38300000
         AIF   ('&EPA'(1,1) EQ '(').BRANCH3 EPA IN A REGISTER    Y02080 38350000
         L     15,&EPA                  LOAD CSECT EPA                  38400000
         AIF   ('&REUSE' EQ 'YES').BRANCH2 DO NOT CLEAR EPA      Y02080 38450000
         XC    &EPA,&EPA                ZERO EPA FOR REUSE              38500000
.BRANCH2 BR    15                       TRANSFER TO NEXT CSECT          38550000
         MEXIT                                                   Y02080 38600000
.BRANCH3 AIF   ('&EPA' EQ '(15)').BRANCH2 REG 15 ALREADY SET     Y02080 38650000
         LR    15,&EPA(1)               LOAD CSECT EPA                  38700000
         AGO   .BRANCH2                                          Y02080 38750000
.********************************************************************** 38800000
.*       FUNCTION = MODE31                                         @L4A 38850000
.********************************************************************** 38900000
.IECM000 ANOP                           CHANGE TO ADDR MODE = 31   @L4A 38941600
&NAME    LA    &IDTTR,*+10              LOAD BRANCH ADDRESS             38983200
         O     &IDTTR,=X'80000000'      SET BIT 0 TO 1 (31 BIT MODE)    39024800
         BSM   0,&IDTTR                 CHANGE ADDRESSING MODE          39066400
         MEXIT                                                     @L4A 39108000
.********************************************************************** 39150000
.*       FUNCTION = MODE24                                         @L4A 39200000
.********************************************************************** 39250000
.IECN000 ANOP                           CHANGE TO ADDR MODE = 24   @L4A 39253900
&NAME    LA    &IDTTR,*+6               LOAD BRANCH ADDRESS AND         39257800
*                                       SET BIT 0 TO 0 (24 BIT MODE)    39261700
         BSM   0,&IDTTR                 CHANGE ADDRESSING MODE          39265600
         MEXIT                                                     @L4A 39269500
.********************************************************************** 39273400
.*       FUNCTION = RJFCB AND WJFCB                                @L7C 39277300
.********************************************************************** 39281200
.IECB000 ANOP                      READ OR WRITE SWA BLOCK         @L7C 39285100
         AIF   (N'&SYSLIST NE 1).JFCB900  IF TOO MANY POSITIONALS  @L7C 39289000
         AIF   ('&SVA' NE '').JFCB110  GO IF SVA SPECIFIED         @L7C 39292900
         MNOTE 8,'SVA IS A REQUIRED PARAMETER.  IT MAY BE (0).'    @L7C 39296800
         MEXIT                                                     @L7C 39300700
.JFCB110 AIF   ('&SVA'(1,1) EQ '(').JFCB120  GO IF SVA ADDR IN REG @L7C 39304600
&NAME    LA    R0,&SVA             GET ADDR OF THREE-BYTE SVA           39308500
         AGO   .JFCB140                                            @L7A 39312400
.JFCB120 AIF   ('&SVA' EQ '(0)').JFCB130   GO IF SVA ADDR IN REG 0 @L7A 39316300
         AIF   ('&SVA' EQ '(1)').JFCB910   GO IF SVA ADDR IN REG 1 @L7A 39320200
&NAME    LR    R0,&SVA(1)          GET ADDR OF THREE-BYTE SVA           39324100
         AGO   .JFCB140                                            @L7A 39328000
.JFCB130 MNOTE '*        REGISTER 0 ALREADY POINTS TO THREE-BYTE SVA'   39331900
         AIF   ('&NAME' EQ '').JFCB140 GO IF NO LABEL ON MACRO     @L7A 39335800
&NAME    DS    0H                                                       39339700
.*                                                                 @L7A 39343600
.JFCB140 AIF   ('&AREA' NE '').JFCB150  GO IF AREA SPECIFIED       @L7A 39347500
         AIF   ('&FUNC' EQ 'RJFCB').JFCB145                        @L7A 39351400
         AIF   ('&BLK' NE '').JFCB141  GO IF BLK SPECIFIED         @L7C 39355300
         MNOTE 8,'BLK IS A REQUIRED PARAMETER.  IT MAY BE (1).'    @L7C 39359200
         MEXIT                                                     @L7C 39363100
.JFCB141 AIF   ('&BLK' EQ '(1)').JFCB800   GO IF BLK ADDR IN REG 1 @L7A 39367000
         AIF   ('&BLK' EQ '(0)').JFCB930   GO IF BLK ADDR IN REG 0 @L7A 39370900
         AIF   ('&BLK'(1,1) EQ '(').JFCB142  GO IF BLK ADDR IN REG      39374800
         L     R1,&BLK             GET ADDRESS OF BLK                   39378700
         AGO   .JFCB800                                            @L7A 39382600
.JFCB142 LR    R1,&BLK(1)          GET 31 BIT ADDR OF BLK               39386500
         AGO   .JFCB800                                            @L7A 39390400
.JFCB145 SR    R1,R1               SWA BLOCK ADDRESS TO BE RETURNED     39394300
         AGO   .JFCB800                                            @L7A 39398200
.JFCB150 MNOTE '*        ''MOVE'' MODE IS REQUESTED.'              @L7A 39402100
         AIF   ('&BLK' NE '').JFCB940  GO IF BLK SPECIFIED         @L7C 39406000
         AIF   ('&AREA'(1,1) EQ '(').JFCB160  GO IF AREA ADDR IN REG    39409900
         LA    R1,&AREA            GET ADDRESS OF AREA                  39413800
         AGO   .JFCB800                                            @L7A 39417700
.JFCB160 AIF   ('&AREA' EQ '(1)').JFCB800  GO - AREA ADDR IN REG 1 @L7A 39421600
         AIF   ('&AREA' EQ '(0)').JFCB920  GO - AREA ADDR IN REG 0 @L7A 39425500
&NAME    LR    R1,&AREA(1)         GET ADDRESS OF AREA                  39429400
.*                                                                      39433300
.JFCB800 AIF   ('&SERVREG' EQ '*').JFCB810   GO IF NOT TO LOAD R5  @L7A 39437200
         L     &SR,CVTPTR(,0) POINT REGISTER 5 TO CVT                   39441100
         ICM   5,B'0111',CVTDMSRA-CVT(&SR)  POINT TO SERVICE ROUTINE    39445000
.JFCB810 AIF   ('&FUNC' EQ 'WJFCB').JFCB850                        @L7A 39448900
.*   GENERATE CALLING SEQUENCE FOR RJFCB.                          @L7A 39452800
         BAS   RET,RESRJFCB(,RES)  CALL OPEN/CLOSE/EOV SERVICE ROUTINE  39456700
         AIF   ('&AREA' EQ '').JFCB840                             @L7A 39460600
         AIF   ('&AREA'(1,1) EQ '(').JFCB830  GO IF AREA IN REG    @L7A 39464500
         MNOTE '*        BLOCK READ INTO &AREA..'                  @L7A 39468400
         MNOTE '*        ALL REGS BUT 15 SAVED/RESTORED BY SERVICE ROUT*39472300
               INE'                                            '   @L7A 39476200
         MEXIT                                                     @L7A 39480100
.JFCB830 MNOTE '*        BLOCK READ TO WHERE REG &AREA(1) POINTS.' @L7A 39484000
         MNOTE '*        ALL REGS BUT 15 SAVED/RESTORED BY SERVICE ROUT*39487900
               INE'                                            '   @L7A 39491800
         MEXIT                                                     @L7A 39495700
.*   IT IS READ LOCATE MODE BECAUSE AREA WAS OMITTED.              @L7A 39499600
.JFCB840 MNOTE '*        ALL REGS BUT 1,15 SAVED/RESTORED BY SERVICE RO*39503500
               UTINE'                                          '   @L7A 39507400
         MNOTE '*        REGISTER 1 POINTS TO THE BLOCK ON RETURN' @L7A 39511300
         MEXIT                                                     @L7A 39515200
.JFCB850 AIF   ('&BLK' NE '').JFCB860  GO IF BLK SPECIFIED         @L7C 39519100
         BAS   RET,REWMJFCB(,RES)  CALL OPEN/CLOSE/EOV SERVICE ROUTINE  39523000
         AIF   ('&AREA' EQ '').JFCB856                             @L7A 39526900
         AIF   ('&AREA'(1,1) EQ '(').JFCB855  GO IF AREA IN REG    @L7A 39530800
         MNOTE '*        BLOCK WRITE FROM &AREA..'                 @L7A 39534700
         MNOTE '*        ALL REGS BUT 15 SAVED/RESTORED BY SERVICE ROUT*39538600
               INE'                                            '   @L7A 39542500
         MEXIT                                                     @L7A 39546400
.JFCB855 MNOTE '*        BLOCK WRITE FROM WHERE REG &AREA(1) ->'   @L7A 39550300
         MNOTE '*        ALL REGS BUT 15 SAVED/RESTORED BY SERVICE ROUT*39554200
               INE'                                            '   @L7A 39558100
         MEXIT                                                     @L7A 39562000
.*                                                                 @L7A 39565900
.JFCB856 MNOTE '*        REGISTER 1 POINTS TO THE BUFFER.'         @L7A 39569800
         MNOTE '*        ALL REGS BUT 15 SAVED/RESTORED BY SERVICE ROUT*39573700
               INE'                                            '   @L7A 39577600
         MEXIT                                                     @L7A 39581500
.JFCB860 BAS   RET,REWLJFCB(,RES)  CALL OPEN/CLOSE/EOV SERVICE ROUTINE  39585400
         AIF   ('&AREA' EQ '').JFCB866                             @L7A 39589300
         AIF   ('&AREA'(1,1) EQ '(').JFCB865  GO IF AREA IN REG    @L7A 39593200
         MNOTE '*        BLOCK WRITE TO &BLK..'                    @L7A 39597100
         MNOTE '*        ALL REGS BUT 15 SAVED/RESTORED BY SERVICE ROUT*39601000
               INE'                                            '   @L7A 39604900
         MEXIT                                                     @L7A 39608800
.JFCB865 MNOTE '*        BLOCK WRITE TO WHERE REG &BLK(1) POINTS'  @L7A 39612700
         MNOTE '*        ALL REGS BUT 15 SAVED/RESTORED BY SERVICE ROUT*39616600
               INE'                                            '   @L7A 39620500
         MEXIT                                                     @L7A 39624400
.*                                                                 @L7A 39628300
.JFCB866 MNOTE '*        REGISTER 1 POINTS TO THE BLOCK IN SWA.'   @L7A 39632200
         MNOTE '*        ALL REGS BUT 15 SAVED/RESTORED BY SERVICE ROUT*39636100
               INE'                                            '   @L7A 39640000
         MEXIT                                                   Y02134 39650000
.JFCB900 MNOTE 8,'NO OTHER POSITIONAL PARAMETERS ALLOWED WITH &FUNC.'   39654500
         MEXIT                                                     @L7A 39659000
.JFCB910 MNOTE 8,'SVA VALUE CANNOT BE IN REGISTER 1'               @L7A 39663500
         MEXIT                                                     @L7A 39668000
.JFCB920 MNOTE 8,'AREA VALUE CANNOT BE IN REGISTER 0'              @L7A 39672500
         MEXIT                                                     @L7A 39677000
.JFCB930 MNOTE 8,'BLK VALUE CANNOT BE IN REGISTER 0'               @L7A 39681500
         MEXIT                                                     @L7A 39686000
.JFCB940 MNOTE 8,'BLK CANNOT BE SPECIFIED WITH AREA'               @L7A 39690500
         MEXIT                                                     @L7A 39695000
.********************************************************************** 39700000
.*       FUNCTION = INIT                                                39750000
.********************************************************************** 39800000
.INIT100 ANOP                                                    Y02134 39850000
         AIF   (T'&DEB EQ 'O' AND T'&DCBCOPY EQ 'O').INIT950     Y02134 39900000
         AIF   (T'&DEB NE 'O').INIT200  WAS &DEB OMITTED?        Y02134 39950000
.* DEB= WAS OMITTED.                                               @L7A 39975000
         SR    0,0                      DO NOT INIT WORK AREA FIELDS    40000000
         AIF   (T'&PREFIX EQ 'O').INIT150  NO PREFIX PARAMETER   YM3810 40010000
.* DEB= WAS OMITTED AND PREFIX= WAS SPECIFIED.                     @L7A 40015000
         L     6,&PREFIX                R6 POINTS TO BASE PREFIX        40020000
         AGO   .INIT500                                          Y02134 40030000
.INIT150 ANOP                                                    YM3810 40040000
         AIF   (T'&STM EQ 'O').INIT170  STM OMITTED              YM3810 40050000
         AIF   ('&STM(3)' NE 'DXXPREFX' AND '&STM(3)' NE 'WTGPREFX').IN*40060000
               IT170                    CHECK FOR STD SAVE AREA  YM3810 40070000
         L     6,&STM(3)&STMBASE        R6 POINTS TO BASE PREFIX   @13C 40080000
         AGO   .INIT500                                          YM3810 40090000
.INIT170 ANOP                           DEFAULT TO WTGPREFX      YM3810 40100000
         L     6,WTGPREFX               R6 POINTS TO BASE PREFIX        40110000
         AGO   .INIT500                                          YM3810 40120000
.* DEB= WAS SPECIFIED.                                             @L7A 40160000
.INIT200 ANOP                                                    Y02134 40200000
         AIF   (T'&PREFIX EQ 'O').INIT250                        Y02134 40250000
.*   DEB= AND PREFIX= WERE SPECIFIED.                              @L7A 40275000
         L     6,&PREFIX                R6 POINTS TO BASE PREFIX        40300000
         AGO   .INIT260                 CONTINUE                 Y02134 40350000
.INIT250 ANOP                                                    Y02134 40400000
.*   DEB= WAS SPECIFIED AND PREFIX= WAS OMITTED.                   @L7A 40425000
         L     6,WTGPREFX               R6 POINTS TO BASE PREFIX        40450000
.INIT260 ANOP                                                    Y02134 40500000
         AIF   ('&DEB' NE 'YES').INIT300                         Y02134 40550000
         LA    0,4(,0)                  INDICATE DEB PRESENT            40600000
         AGO   .INIT500                                          Y02134 40650000
.INIT300 ANOP                                                    Y02134 40700000
         AIF   ('&DEB' NE 'NO').INIT400 BRANCH IF INVALID &DEB   Y02134 40750000
         LA    0,8(,0)                  INDICATE DEB ABSENT             40800000
         AGO   .INIT500                                          Y02134 40850000
.INIT400 ANOP                           INVALID &DEB VALUE       Y02134 40900000
         IHBERMAC 1001,DEB,&DEB                                  Y02134 40950000
.INIT500 ANOP                                                    Y02134 41000000
         AIF   (T'&DCBCOPY NE 'O').INIT640 BRANCH IF NOT OMITTED Y02134 41050000
         SR    1,1                      DCB NOT TO BE COPIED            41100000
         AGO   .INIT900                                          Y02134 41150000
.INIT640 ANOP                                                    Y02134 41200000
         AIF   ('&DCBCOPY' NE 'TOWKAR').INIT700                  Y02134 41250000
         LA    1,4(,0)                  COPY USER DCB TO WORK AREA DCB  41300000
         AGO   .INIT900                                          Y02134 41350000
.INIT700 ANOP                                                    Y02134 41400000
         AIF   ('&DCBCOPY' NE 'FRWKAR').INIT800                  Y02134 41450000
         AIF   (T'&DEB NE 'O').INIT960  IMPOSSIBLE               Y02134 41500000
         LA    1,8(,0)                  COPY WORK AREA DCB TO USER DCB  41550000
         AGO   .INIT900                                          Y02134 41600000
.INIT800 ANOP                                                    Y02134 41650000
         IHBERMAC 1001,DCBCOPY,&DCBCOPY INVALID DCBCOPY VALUE    Y02134 41700000
.INIT900 ANOP                                                    Y02134 41750000
         L     5,CVTPTR(,0)             LOAD ADDRESS OF CVT             41800000
         ICM   5,B'0111',CVTDMSRA-CVT(5)  MOVE IFG019RA ADDRESS    @L4C 41850000
         BAS   14,44(,5)                LINK TO IFG019RA           @L4C 41900000
         AGO   .IECA650                 GO TO RELOAD REGISTERS   Y02134 41950000
.INIT950 MNOTE 8,'DEB= OR DCBCOPY= MUST BE CODED'                Y02134 42000000
         AGO   .IECA650                 DO LM                    Y02134 42050000
.INIT960 MNOTE 8,'INITIAL CALL ALWAYS TOWKAR'                    Y02134 42100000
         AGO   .IECA650                 DO LM                    Y02134 42150000
.********************************************************************** 42200000
.*       FUNCTION = EXIT                                                42250000
.********************************************************************** 42300000
.IECD000 ANOP                                                    Y02080 42350000
&NAME    L     14,CVTPTR(0,0)           LOAD CVT ADDRESS                42400000
         L     14,CVTEXPRO-CVT(0,14)    LOAD EXIT PROLOGUE ADDRESS      42450000
*        MODESET EXTKEY=SUPR            GO TO SUPERVISOR KEY            42500000
         MODESET EXTKEY=SUPR            GO TO SUPERVISOR KEY            42550000
*        RETURN ,                       RETURN TO CALLER                42600000
         RETURN ,                       RETURN TO CALLER                42650000
         MEXIT                                                          42700000
.********************************************************************** 42750000
.*       FUNCTION = UEXIT                                               42800000
.********************************************************************** 42850000
.IECE000 ANOP                                                    Y02082 42900000
         AIF   ('&NAME' EQ '').IECE010  BRANCH IF NAME OMITTED   Y02082 42950000
&NAME    DS    0H                                                       43000000
.IECE010 ANOP                                                    Y02082 43050000
         AIF   (T'&REG0 EQ 'O').IECE020 BRANCH IF &REG 0 OMITTED Y02082 43100000
         AIF   ('&REG0'(1,1) EQ '(').IECE015 BR IF REG FORMAT    Y02082 43150000
         L     0,&REG0                  REG 0 PARAMETER TO EXIT         43200000
         AGO   .IECE020                 TEST &REG1 PARM          Y02082 43250000
.IECE015 ANOP                                                    Y02082 43300000
         LR    0,&REG0(1)               REG 0 PARAMETER TO EXIT         43350000
.IECE020 ANOP                                                    Y02082 43400000
         AIF   (T'&REG1 EQ 'O').IECE030 BRANCH IF &REG 1 OMITTED Y02082 43450000
         AIF   ('&REG1'(1,1) EQ '(').IECE025 BR IF REG FORMAT    Y02082 43500000
         L     1,&REG1                  REG 1 PARAMETER TO EXIT         43550000
         AGO   .IECE030                 TEST &EXITAD PARM        Y02082 43600000
.IECE025 ANOP                                                    Y02082 43650000
         LR    1,&REG1(1)               REG 1 PARAMETER TO EXIT         43700000
.IECE030 ANOP                                                    Y02082 43750000
         AIF   (T'&EXITAD EQ 'O').IECE040 BRANCH IF &EXITAD OMIT Y02082 43800000
         AIF   ('&EXITAD'(1,1) EQ '(').IECE035 BR IF REG FORMAT  Y02082 43850000
         L     15,&EXITAD               EXIT ENTRY POINT                43900000
         AGO   .IECE040                 SAVE REGISTERS           Y02082 43950000
.IECE035 ANOP                                                    Y02082 44000000
         LR    15,&EXITAD(1)            EXIT ENTRY POINT                44050000
.IECE040 ANOP                                                    Y02082 44100000
         AIF   (T'&STM EQ 'O').IECE060  BRANCH IF &STM OMITTED   Y02082 44150000
         AIF   ('&STM(3)' EQ 'DXXPREFX' OR                             *44200000
               '&STM(3)' EQ 'WTGPREFX').IECE050 BR IF REGS SAVED Y02082 44250000
.*                                      IN WORKAREA PREFIX       Y02082 44300000
         STM   &STM(1),&STM(2),&STM(3)&STMBASE SAVE REGISTERS      @13C 44350000
         LA    2,&STM(3)&STMBASE        SAVE ADDRESS OF SAVE AREA  @13C 44400000
         AGO   .IECE060                                          Y02082 44450000
.IECE050 ANOP                                                    Y02082 44500000
         L     14,&STM(3)&STMBASE       GET ADDRESS OF PREFIX      @13C 44550000
         STM   &STM(1),&STM(2),IECREGSV-IECPREFX(14) SAVE REGISTERS     44600000
         LA    2,IECREGSV-IECPREFX(,14) SAVE ADDRESS OF SAVE AREA       44650000
.IECE060 ANOP                                                    Y02082 44700000
         L     5,CVTPTR(,0)             LOAD CVT ADDRESS                44750000
         ICM   5,B'0111',CVTDMSRA-CVT(5)  MOVE IFG019RA ADDRESS    @L4C 44800000
         BAS   14,56(,5)                LINK TO UEXIT ROUTINE      @L4C 44850000
         AIF   (T'&STM EQ 'O').IECA710  EXIT IF &STM OMITTED     Y02082 44900000
         LM    &STM(1),&STM(2),0(2)     RESTORE REGISTERS               44950000
         MEXIT                                                     @L1C 44950100
.*                                                                 @L1A 44950200
.**********************************                                @L1A 44950300
.* DECLARE LOCAL VARIABLES FOR                                     @L1A 44950400
.* ANSI-78 FUNCTION INVOCATIONS                                    @L1A 44950500
.**********************************                                @L1A 44950600
.*                                                                 @L1A 44950700
         LCLA  &N                       NUMBER OF PARMS IN SYSLIST @L1A 44950800
         LCLA  &I                       COUNTER                    @L1A 44950900
         LCLB  &FLAG(4)                 PARAMETER FLAGS            @L1A 44951000
.*                                                                 @L1A 44951100
.***************************************************************** @L1A 44951200
.*                                                                 @L1A 44951300
.*  FUNCTION ................. VALIDATE                            @L1A 44951400
.*  PARAMETERS ............... ABEND OR NOABEND                    @L1A 44951500
.*  DEFAULT ................. ABEND                                @L1A 44951600
.*                                                                 @L1A 44951700
.*  OUTPUT IN LOW ORDER BYTE OF REGISTER 15:                       @L1A 44951800
.*                                                                 @L1A 44951900
.*            BIT 31: ABEND/NOABND                                 @L1A 44952000
.*                    0 -> ABEND SPECIFIED                         @L1A 44952100
.*                    1 -> NOABEND SPECIFIED                       @L1A 44952200
.*                                                                 @L1A 44952300
.*            POSSIBLE REGISTER SETTINGS:                          @L1A 44952400
.*              '00 00 00 00'X -> ABEND                            @L1A 44952500
.*              '00 00 00 01'X -> NOABND                           @L1A 44952600
.*                                                                 @L1A 44952700
.***************************************************************** @L1A 44952800
.*                                                                 @L1A 44952900
.IECV000 ANOP                                                      @L1A 44953000
&N       SETA  N'&SYSLIST               NUMBER OF PARMS PASSED     @L1A 44953100
         AIF   (&N EQ 1).IECV002        BR, TO SET OPTION REG (15) @L1A 44953200
         AIF   (&N LE 2).IECV001        BR TO CHECK PARMS          @L1A 44953300
 MNOTE 8,'INVALID INPUT TO &SYSLIST(1): TOO MANY PARAMETERS SPECD' @L1A 44953400
         MEXIT                                                     @L1A 44953500
.*                                                                 @L1A 44953600
.IECV001 AIF   ('&SYSLIST(2)' NE 'ABEND').IECV003 BR,CK FOR NOABND @L1A 44953700
.IECV002 ANOP                                                      @L1A 44953800
         SLR   15,15                    INDICATE ABEND SPECD       @L1A 44953900
         AGO   .IECV004                                            @L1A 44954000
.*                                                                 @L1A 44954100
.IECV003 AIF   ('&SYSLIST(2)' NE 'NOABND').IECV005 BR,CK FOR NULL  @L1A 44954200
         LA    15,1                     INDICATE NOABND SPECD      @L1A 44954300
.*                                                                 @L1A 44954400
.IECV004 ANOP                                                      @L1A 44954500
         BAS   14,60(,5)                BR TO IFG019RA(VALIDATE)   @L4C 44954600
         MEXIT                                                     @L1A 44954700
.*                                                                 @L1A 44954800
.IECV005 AIF   ('&SYSLIST(2)' EQ '').IECV002 DEFAULT TO ABEND      @L1A 44954900
 MNOTE 8,'INVALID INPUT TO &SYSLIST(1): BAD PARAMETER SPECIFIED'   @L1A 44955000
         MEXIT                                                     @L1A 44955100
.*                                                                 @L1A 44955200
.***************************************************************** @L1A 44955300
.*                                                                 @L1A 44955400
.*  FUNCTION: ................. FILEACC                            @L1A 44955500
.*  PARAMETERS ................ ABEND OR NOABND, LABEL OR USER     @L1A 44955600
.*  DEFAULTS: ................. ABEND, LABEL                       @L1A 44955700
.*                                                                 @L1A 44955800
.*         THE PARAMETERS MAY BE SPECIFIED IN ANY ORDER.           @L1A 44955900
.*                                                                 @L1A 44956000
.*  OUTPUT IN LOW ORDER BYTE OF REGISTER 15:                       @L1A 44956100
.*                                                                 @L1A 44956200
.*            BIT 31: ABEND/NOABND                                 @L1A 44956300
.*                    0 -> ABEND SPECIFIED                         @L1A 44956400
.*                    1 -> NOABEND SPECIFIED                       @L1A 44956500
.*                                                                 @L1A 44956600
.*            BIT 30: LABEL/USER                                   @L1A 44956700
.*                    0 -> LABEL SPECIFIED                         @L1A 44956800
.*                    1 -> USER SPECIFIED                          @L1A 44956900
.*                                                                 @L1A 44957000
.*            POSSIBLE REGISTER SETTINGS:                          @L1A 44957100
.*              '00 00 00 00'X -> ABEND,LABEL                      @L1A 44957200
.*              '00 00 00 01'X -> NOABND,LABEL                     @L1A 44957300
.*              '00 00 00 02'X -> ABEND,USER                       @L1A 44957400
.*              '00 00 00 03'X -> NOABND,USER                      @L1A 44957500
.*                                                                 @L1A 44957600
.***************************************************************** @L1A 44957700
.*                                                                 @L1A 44957800
.*                                                                 @L1A 44957900
.*********************************************                     @L1A 44958000
.* TEST FOR NUMBER OF INPUT PARAMETERS PASSED                      @L1A 44958100
.* AND SET DEFAULTS IF NONE WERE PASSED                            @L1A 44958200
.*********************************************                     @L1A 44958300
.*                                                                 @L1A 44958400
.IECF000 ANOP                                                      @L1A 44958500
&N       SETA  N'&SYSLIST               NUMBER OF PARMS IN SYSLIST @L1A 44958600
         AIF   (&N LE 3).IECF001        BR TO CHECK PARMS          @L1A 44958700
 MNOTE 8,'INVALID INPUT TO &SYSLIST(1): TOO MANY PARAMETERS SPECD' @L1A 44958800
         MEXIT                                                     @L1A 44958900
.*                                                                 @L1A 44959000
.IECF001 AIF   (&N NE 1).IECF002        BR TO DET WHICH PRMS PASD  @L1A 44959100
&FLAG(1) SETB  1                        DEFAULT TO ABEND           @L1A 44959200
&FLAG(3) SETB  1                        DEFAULT TO LABEL           @L1A 44959300
         AGO   .IECF009                 BR TO SET INPUT REG (15)   @L1A 44959400
.*                                                                 @L1A 44959500
.**********************************                                @L1A 44959600
.* CHECK THE PARAMETER LIST FOR                                    @L1A 44959700
.* VALID OPTIONS SEPCIFIED                                         @L1A 44959800
.**********************************                                @L1A 44959900
.*                                                                 @L1A 44960000
.IECF002 ANOP                                                      @L1A 44960100
&I       SETA  2                        INIT THE SYSLIST COUNTER   @L1A 44960200
.IECF003 AIF   ('&SYSLIST(&I)' NE 'ABEND').IECF004 BR, CK NOABND   @L1A 44960300
&FLAG(1) SETB  1                        SET ABEND SPECD FLAG       @L1A 44960400
         AGO   .IECF008                 BR TO INCREMENT COUNTER    @L1A 44960500
.*                                                                 @L1A 44960600
.IECF004 AIF   ('&SYSLIST(&I)' NE 'NOABND').IECF005 BR, CK LABEL   @L1A 44960700
&FLAG(2) SETB  1                        SET NOABND SPECD FLAG      @L1A 44960800
         AGO   .IECF008                 BR TO INCREMENT COUNTER    @L1A 44960900
.*                                                                 @L1A 44961000
.IECF005 AIF   ('&SYSLIST(&I)' NE 'LABEL').IECF006 BR, CK USER     @L1A 44961100
&FLAG(3) SETB  1                        SET LABEL SPECD FLAG       @L1A 44961200
         AGO   .IECF008                 BR TO INCREMENT COUNTER    @L1A 44961300
.*                                                                 @L1A 44961400
.IECF006 AIF   ('&SYSLIST(&I)' NE 'USER').IECF007 BR TO CK NULL    @L1A 44961500
&FLAG(4) SETB  1                        SET USER FLAG              @L1A 44961600
         AGO   .IECF008                 BR TO INCREMENT COUNTER    @L1A 44961700
.*                                                                 @L1A 44961800
.IECF007 AIF   ('&SYSLIST(&I)' EQ '').IECF008 BR TO INCREMENT CTR  @L1A 44961900
 MNOTE 8,'INVALID INPUT TO &SYSLIST(1): BAD PARAMETER SPECIFIED'   @L1A 44962000
         MEXIT                                                     @L1A 44962100
.*                                                                 @L1A 44962200
.IECF008 ANOP                                                      @L1A 44962300
&I       SETA  &I+1                     INCREMENT COUNTER          @L1A 44962400
         AIF   (&I LE &N).IECF003       BR IF MORE PARMS TO CHECK  @L1A 44962500
.*                                                                 @L1A 44962600
.*******************************************************           @L1A 44962700
.* TEST THE FLAG BITS SET ABOVE FOR INVALID INVOCATIONS            @L1A 44962800
.* AND SET THE INPUT OPTION REGISTER (REG 15) TO:                  @L1A 44962900
.*   0: ABEND,LABEL (EITHER SPECIFIED OR DEFAULTED)                @L1A 44963000
.*   1: NOABND,LABEL                                               @L1A 44963100
.*   2: ABEND,USER                                                 @L1A 44963200
.*   3: NOABND,USER                                                @L1A 44963300
.*******************************************************           @L1A 44963400
.*                                                                 @L1A 44963500
.IECF009 AIF   (&FLAG(4)).IECF010       BR, CK IF USER ALSO SPECD  @L1A 44963600
         SLR   15,15                    BIT 30=0 -> LABEL SPECD    @L1A 44963700
         AGO   .IECF012                 BR TO CHECK ABEND/NOABND   @L1A 44963800
.*                                                                 @L1A 44963900
.IECF010 AIF   (NOT &FLAG(3)).IECF011   BR, TO SET USER SPECD      @L1A 44964000
 MNOTE 8,'INVALID INPUT TO &SYSLIST(1): MUTUALLY EXCLUSIVE PARMS'  @L1A 44964100
         MEXIT                                                     @L1A 44964200
.*                                                                 @L1A 44964300
.IECF011 ANOP                                                      @L1A 44964400
         LA    15,2                     BIT 30=1 -> USER SPECD     @L1A 44964500
.*                                                                 @L1A 44964600
.IECF012 AIF   (NOT &FLAG(2)).IECF014   BR TO SET DEFAULT (ABEND)  @L1A 44964700
         AIF   (NOT &FLAG(1)).IECF013   BR TO IND NOABND SPECD     @L1A 44964800
 MNOTE 8,'INVALID INPUT TO &SYSLIST(1): MUTUALLY EXCLUSIVE PARM'   @L1A 44964900
         MEXIT                                                     @L1A 44965000
.IECF013 ANOP                                                      @L1A 44965100
         LA    15,1(,15)                BIT 31=1 -> NOABND SPECD   @L1A 44965200
.IECF014 ANOP                                                      @L1A 44965300
         LA    14,FILEACC_RTNADDR_&SYSNDX  POINT TO RETURN ADDR   @L20A 44965400
         BSM   14,0                     SAVE ADDRESSING MODE      @L20A 44965500
         L     R1,WTGPREFX              ADDRESS WTG PREFIX        @L20A 44965600
         STM   R2,RF,IECREGSV-IECPREFX(R1) SAVE REGS 2-15         @L20A 44965700
         L     15,FILEACC_NXTADDR_&SYSNDX  NEXT ADDR FOR MODE SW  @L20A 44965800
         BSM   0,15           SWITCH TO 31BIT ADDRESSING MODE     @L20A 44965900
FILEACC_NXTADDR_&SYSNDX   DC A(X'80000000'+FILEACC_NXT_&SYSNDX)   @L20A 44966000
FILEACC_NXT_&SYSNDX    DS    0H       FOR SWITCHING ADDR MODE     @L20A 44966100
         L     15,CVTPTR(,0)            CVT ADDRESS               @L20C 44966200
         L     15,CVTDFA-CVT(,15)     POINT TO DFA                @L20A 44966300
         L     14,DFADFVAD-DFA(,15)   POINT TO DFVT               @L20A 44966400
         LA    15,32                  GET IFG019RB OFFSET         @L20A 44966500
         AL    15,DFVOPN31-DFVT(,14)   ADDR ROUTER IFG019RB       @L20A 44966600
         BASSM 14,15                  BR TO IFG019RB/IFG019RK     @L20A 44966700
FILEACC_RTNADDR_&SYSNDX  DS  0H                                   @L20A 44966800
         MEXIT                                                     @L1A 44966900
.*                                                                 @L1A 44967000
.***************************************************************** @L1A 44967100
.*                                                                 @L1A 44967200
.*  FUNCTION ................. XLATE                               @L1A 44967300
.*  PARAMETERS ............... NONE                                @L1A 44967400
.*  DEFAULTS ................. NONE                                @L1A 44967500
.*                                                                 @L1A 44967600
.***************************************************************** @L1A 44967700
.IECX000 ANOP                                                      @L1A 44967800
         L     15,CVTPTR(,0)            LOAD ADDRESS OF CVT        @L1A 44967900
         ICM   15,B'0111',CVTDMSRA-CVT(15)  MOVE IFG019RA ADDRESS  @L4C 44968000
         BAS   14,68(,15)               BR TO IFG019RA(XLATE)      @L4C 44968100
         MEXIT                                                     @L1A 44968200
.*                                                                 @L1A 44968300
.*****************************************************************@L19A 44968400
.*                                                                @L19A 44968500
.*  FUNCTION ................. XLATE4                             @L19A 44968600
.*  PARAMETERS ............... NONE                               @L19A 44968700
.*  DEFAULTS ................. NONE                               @L19A 44968800
.*                                                                @L19A 44968900
.**************************************************************** @L19A 44969000
.IECJ000 ANOP                                                     @L19A 44969100
         O     2,=X'80000000'           SET V4 XLATE INDICATOR    @L19A 44969200
         L     15,CVTPTR(,0)            LOAD ADDRESS OF CVT       @L19A 44969300
         ICM   15,B'0111',CVTDMSRA-CVT(15)  MOVE IFG019RA ADDRESS @L19A 44969400
         BAS   14,68(,15)               BR TO IFG019RA(XLATE)     @L19A 44969500
         MEXIT                                                    @L19A 44969600
.*                                                                @L19A 44969700
.***************************************************************** @L1A 44969800
.*                                                                 @L1A 44969900
.*  FUNCTION ................. DSN                                 @L1A 44970000
.*  PARAMETERS ............... GET, CHECK OR CREATE                @L1A 44970100
.*  DEFAULTS ................. GET                                 @L1A 44970200
.*                                                                 @L1A 44970300
.*  OUTPUT IN LOW ORDER BYTE OF REGISTER 15:                       @L1A 44970400
.*                                                                 @L1A 44970500
.*            BIT 30: CHECK                                        @L1A 44970600
.*                    0 -> CHECK NOT SPECIFIED                     @L1A 44970700
.*                    1 -> CHECK SPECIFIED                         @L1A 44970800
.*                                                                 @L1A 44970900
.*            BIT 29: CREATE                                       @L1A 44971000
.*                    0 -> CREATE NOT SPECIFIED                    @L1A 44971100
.*                    1 -> CREATE SPECIFIED                        @L1A 44971200
.*                                                                 @L1A 44971300
.*            POSSIBLE REGISTER SETTINGS:                          @L1A 44971400
.*              '00 00 00 00'X -> GET                              @L1A 44971500
.*              '00 00 00 02'X -> GET,CHECK                        @L1A 44971600
.*              '00 00 00 04'X -> GET,CREATE                       @L1A 44971700
.*                                                                 @L1A 44971800
.***************************************************************** @L1A 44971900
.*                                                                 @L1A 44972000
.*                                                                 @L1A 44972100
.*                                                                 @L1A 44972200
.**********************************                                @L1A 44972300
.* DETERMINE THE NUMBER OF                                         @L1A 44972400
.* PARAMETERS PASSED                                               @L1A 44972500
.**********************************                                @L1A 44972600
.*                                                                 @L1A 44972700
.IECG000 ANOP                                                      @L1A 44972800
&N       SETA  N'&SYSLIST               # OF PARMS PASSED          @L1A 44972900
         AIF   (&N GT 3).IECG009        TO MANY PARMS PASSED       @L1A 44973000
         AIF   (&N EQ 1).IECG005        DEFAULT IS GET             @L1A 44973100
.*                                                                 @L1A 44973200
.**********************************                                @L1A 44973300
.* CHECK FOR VALID PARAMETERS                                      @L1A 44973400
.**********************************                                @L1A 44973500
.*                                                                 @L1A 44973600
&I       SETA  2                        INITIALIZE THE LOOP CNTR   @L1A 44973700
.IECG001 AIF   ('&SYSLIST(&I)' EQ 'GET').IECG004 BR TO INCREMENT   @L1A 44973800
         AIF   ('&SYSLIST(&I)' NE 'CHECK').IECG002 CK FOR CREATE   @L1A 44973900
&FLAG(1) SETB  1                        INDICATE CHECK SPECIFIED   @L1A 44974000
         AGO   .IECG004                 BRANCH TO INCREMENT        @L1A 44974100
.IECG002 AIF   ('&SYSLIST(&I)' NE 'CREATE').IECG003 CK FOR NULL    @L1A 44974200
&FLAG(2) SETB  1                        INDICATE CREATE SPECIFIED  @L1A 44974300
         AGO   .IECG004                 BRANCH TO INCREMENT        @L1A 44974400
.IECG003 AIF   ('&SYSLIST(&I)' EQ '').IECG004 NULL OK, BR TO INCRE @L1A 44974500
 MNOTE 8,'INVALID INPUT TO &SYSLIST(1): BAD PARAMETER SPECIFIED'   @L1A 44974600
         MEXIT                                                     @L1A 44974700
.IECG004 ANOP                                                      @L1A 44974800
&I       SETA  &I+1                     INCREMENT LOOP COUNTER     @L1A 44974900
         AIF   (&I LE &N).IECG001       CONTINUE IN LOOP           @L1A 44975000
.*                                                                 @L1A 44975100
.*************************************************                 @L1A 44975200
.* INSPECT FLAG SETTINGS TO DETERMINE IF MUTUALLY                  @L1A 44975300
.* EXCLUSIVE PARAMETERS WERE SPECIFIED                             @L1A 44975400
.*************************************************                 @L1A 44975500
.*                                                                 @L1A 44975600
         AIF   (&FLAG(1)).IECG006       BR, CH IF CREATE SPECD TOO @L1A 44975700
         AIF   (NOT &FLAG(2)).IECG005   BR, SET DEFAULT OF GET     @L1A 44975800
         LA    15,4                     INDICATE CREATE SPECIFIED  @L1A 44975900
         AGO   .IECG007                                            @L1A 44976000
.*                                                                 @L1A 44976100
.IECG005 ANOP                                                      @L1A 44976200
         SLR   15,15                    INDICATE GET SPECIFIED     @L1A 44976300
         AGO   .IECG007                                            @L1A 44976400
.*                                                                 @L1A 44976500
.IECG006 AIF   (&FLAG(2)).IECG008       BR, MUTUALLY EXCL PARMS    @L1A 44976600
         LA    15,2                     INDICATE CHECK SPECD       @L1A 44976700
.IECG007 ANOP                                                      @L1A 44976800
         BAS   14,72(,5)                BRANCH TO IFG019RA(DSN)    @L4C 44976900
         MEXIT                                                     @L1A 44977000
.*                                                                 @L1A 44977100
.IECG008 ANOP                                                      @L1A 44977200
 MNOTE 8,'INVALID INPUT TO &SYSLIST(1): MUTUALLY EXCLUSIVE PARMS'  @L1A 44977300
         MEXIT                                                     @L1A 44977400
.*                                                                 @L1A 44977500
.IECG009 ANOP                                                      @L1A 44977600
 MNOTE 8,'INVALID INPUT TO &SYSLIST(1): TOO MANY PARAMETERS SPECD' @L1A 44977700
         MEXIT                                                     @L1A 44977800
.*                                                                 @L1A 44977900
.***************************************************************** @L1A 44978000
.*                                                                 @L1A 44978100
.*  FUNCTION ................. VOLACC                              @L1A 44978200
.*  PARAMETERS ............... ABEND OR NOABEND                    @L1A 44978300
.*  DEFAULT .................. ABEND                               @L1A 44978400
.*                                                                 @L1A 44978500
.*  OUTPUT IN LOW ORDER BYTE OF REGISTER 15:                       @L1A 44978600
.*                                                                 @L1A 44978700
.*            BIT 31: ABEND/NOABND                                 @L1A 44978800
.*                    0 -> ABEND SPECIFIED                         @L1A 44978900
.*                    1 -> NOABEND SPECIFIED                       @L1A 44979000
.*                                                                 @L1A 44979100
.*            POSSIBLE REGISTER SETTINGS:                          @L1A 44979200
.*              '00 00 00 00'X -> ABEND                            @L1A 44979300
.*              '00 00 00 01'X -> NOABND                           @L1A 44979400
.*                                                                 @L1A 44979500
.***************************************************************** @L1A 44979600
.IECU000 ANOP                                                      @L1A 44979700
&N       SETA  N'&SYSLIST               NUMBER OF PARMS PASSED     @L1A 44979800
         AIF   (&N EQ 1).IECU002        BR, TO SET OPTION REG (15) @L1A 44979900
         AIF   (&N LE 2).IECU001        BR TO CHECK PARMS          @L1A 44980000
 MNOTE 8,'INVALID INPUT TO &SYSLIST(1): TOO MANY PARAMETERS SPECD' @L1A 44980100
         MEXIT                                                     @L1A 44980200
.*                                                                 @L1A 44980300
.IECU001 AIF   ('&SYSLIST(2)' NE 'ABEND').IECU003 BR,CK FOR NOABND @L1A 44980400
.IECU002 ANOP                                                      @L1A 44980500
         SLR   15,15                    INDICATE ABEND SPECD       @L1A 44980600
         AGO   .IECU004                                            @L1A 44980700
.*                                                                 @L1A 44980800
.IECU003 AIF   ('&SYSLIST(2)' NE 'NOABND').IECU005 BR,CK FOR NULL  @L1A 44980900
         LA    15,1                     INDICATE NOABND SPECD      @L1A 44981000
.*                                                                 @L1A 44981100
.IECU004 ANOP                                                      @L1A 44981200
         BAS   14,76(,5)                BR TO IFG019RA(VOLACC)     @L4C 44981300
         MEXIT                                                     @L1A 44981400
.*                                                                 @L1A 44981500
.IECU005 AIF   ('&SYSLIST(2)' EQ '').IECU002 DEFAULT TO ABEND      @L1A 44981600
 MNOTE 8,'INVALID INPUT TO &SYSLIST(1): BAD PARAMETER SPECIFIED'   @L1A 44981700
         MEXIT                                                     @L1A 44981800
.*                                                                 @L1A 44981900
.***************************************************************** @L1A 44982000
.*                                                                 @L1A 44982100
.*       FUNCTION = VALSUP                                         @L1A 44982200
.*                                                                 @L1A 44982300
.***************************************************************** @L1A 44982400
.IECW000 ANOP                                                      @L1A 44982500
         LA    15,8                     VALSUP ENTRY CODE          @L1A 44982600
         BAS   14,76(,5)                ENTER VALD'N SUPRS PROC    @L4C 44982700
         MEXIT                                                     @L1A 44982800
.***************************************************************** @L8A 44982900
.*                                                                 @L8A 44983000
.*       FUNCTION = ENQTIOT OR DEQTIOT                             @L8A 44983100
.*                                                                 @L8A 44983200
.***************************************************************** @L8A 44983300
.IECNQ00 ANOP                                                      @L8A 44983400
&OFFSET  SETA  116                        ENQ ENTRY IFG019RA       @L8A 44983500
         AGO   .IECNQ05                                            @L8A 44983600
.IECDQ00 ANOP                                                      @L8A 44983700
&OFFSET  SETA  120                        DEQ ENTRY IFG019RA       @L8A 44983800
.IECNQ05 ANOP                                                      @L8A 44983900
*        REGS 0,1,14,15 NOT PRESERVED                              @L8A 44984000
*        IECREGSV USED AS WORK AREA FOR THIS MACRO                 @L8A 44984100
&NAME    L     5,CVTPTR(,0)                                        @L8A 44984200
         ICM   5,B'0111',CVTDMSRA-CVT(5)                           @L8A 44984300
         BAS   14,&OFFSET.(,5)             CALL SERVICE ROUTINE    @L8A 44984400
         MEXIT                                                     @L8A 44984500
.***************************************************************** @L8A 44984600
.*                                                                 @L9A 44984700
.*       FUNCTION = DSCBNQDQ                                       @L9A 44984800
.*                                                                 @L9A 44984900
.*       ISSUES ENQUEUE OR DEQUEUE OF PDS RELATED RESOURCES        @L9A 44985000
.*       AIMED AT PROTECTING DS1LSTAR. PLEASE SEE IFG019RD.        @L9A 44985100
.*                                                                 @L9A 44985200
.*       SYNTAX: IECRES DSCBNQDQ(,LOAD) WHERE THE OPTIONAL         @L9A 44985300
.*       LOAD PARAMETER TRIGGERS RELOAD OF REG 5                   @L9A 44985400
.*                                                                 @L9A 44985500
.***************************************************************** @L9A 44985600
.IECC000 ANOP                                                      @L9A 44985700
         AIF   ('&NAME' EQ '').IECC005                             @02C 44985800
&NAME    EQU   *                                                   @L9A 44985900
.IECC005 ANOP                                                      @02A 44986000
         AIF   ('&DQLST' NE '').IECC010  PARM LIST PTR REQUIRED    @02A 44986100
         MNOTE 8,'DQLST PARAMETER REQUIRED FOR DSCBNQDQ'           @02A 44986200
         MEXIT                                                     @02A 44986300
.IECC010 ANOP                                                      @L9A 44986400
         L     15,WTGPREFX             LOAD POINTER TO PREFIX      @02C 44986500
         LA    15,IECREGSV-IECPREFX(,15) LOAD ADDR OF SAVE AREA    @02C 44986600
         STM   0,14,0(15)              SAVE REGISTERS              @02C 44986700
         AIF   ('&DQLST' NE '').IECC015  PARMLIST AREA REQUIRED    @02A 44986800
         MNOTE 8,'PARMLIST AREA REQUIRED BY DSCBNQDQ'              @02A 44986900
         MEXIT                                                     @02A 44987000
.IECC015 ANOP                                                      @02A 44987100
         AIF   ('&DQLST'(1,1) NE '(').IECC020  REG FORM ?          @02A 44987200
         LR    14,&DQLST(14)           GET DSCBNQDQ PARMS ADDRESS  @02A 44987300
         LA    14,0(14)                CLEAR HIGH ORDER BYTE       @02A 44987400
         AGO   .IECC025                                            @02A 44987500
.IECC020 ANOP                                                      @02A 44987600
         LA    14,&DQLST                                           @02A 44987700
.IECC025 ANOP                                                      @02A 44987800
         XC    0(12,14),0(14)          CLEAR 3 WORDS TO ZERO       @02A 44987900
         ST    0,0(,14)                STORE DSCB ENQ/DEQ OPTIONS  @02A 44988000
         ST    15,8(,14)               STORE SAVE AREA ADDRESS     @02A 44988100
         AIF   ('&DSNAD' NE '').IECC030  DSNAME REQUIRED           @02A 44988200
         MNOTE 8,'DATA SET NAME IS REQUIRED FOR DSCBNQDQ'          @02A 44988300
         MEXIT                                                     @02A 44988400
.IECC030 ANOP                                                      @02A 44988500
         AIF   ('&DSNAD'(1,1) NE '(').IECC035  REG FORM ?          @02A 44988600
         LR    1,&DSNAD(1)             GET DSNAME ADDRESS          @02A 44988700
         LA    1,0(1)                  CLEAR HIGH ORDER BYTE       @02A 44988800
         AGO   .IECC040                                            @02A 44988900
.IECC035 ANOP                                                      @02A 44989000
         LA    1,&DSNAD                                            @02A 44989100
.IECC040 ANOP                                                      @02A 44989200
         ST    1,4(,14)                STORE DSNAME ADDRESS        @02A 44989300
         LR    1,14                    PARMLIST                    @02A 44989400
         L     RES,CVTPTR(,0)           LOAD ADDRESS OF CVT        @L9A 44989500
         ICM   RES,B'0111',CVTDMSRA-CVT(RES) A(IFG019RA)           @L9A 44989600
         BAS   14,104(,RES)             LINK TO IFG019RA           @L9A 44989700
*        REG 15 CONTAINS RETURN CODE                               @L9A 44989800
         L     R1,WTGPREFX              LOAD POINTER TO PREFIX     @L9A 44989900
         LA    R1,IECREGSV-IECPREFX(,R1) LOAD ADDR OF SAVE AREA    @L9A 44990000
         LM    R0,RET,0(R1)             RESTORE REGISTERS          @L9A 44990100
         MEXIT                                                     @L9A 44990200
.***************************************************************** @L9A 44990300
.*                                                                 @L9A 44990400
.*       FUNCTION = UGET                                           @L9A 44990500
.*       PROVIDES AN IECRES ACCESS TO THE ULTRAGET                 @L9A 44990600
.*       SUBROUTINE OF IFG019RA. PLEASE SEE THE WRITEUP IN         @L9A 44990700
.*       IFG019RA FOR DETAILS OF THE FUNCTION. THE IECRES          @L9A 44990800
.*       CALL IS IDENTICAL TO GET, EXCEPT THE FUNCTION IS CALLED   @L9A 44990900
.*       UGET. HOWEVER, ONLY STM, ID, AND LV ARE USED OR           @L9A 44991000
.*       SYNTAX CHECKED                                            @L9A 44991100
.*                                                                 @L9A 44991200
.********************************************************************** 45000000
.IECY000 ANOP                                                      @L9A 45000200
         AIF   ('&NAME' EQ '').IECY010                                  45000400
&NAME    DS    0H                       LABEL AND ALIGN            @L9A 45000600
.IECY010 AIF   (T'&STM EQ 'O').IECY200  NO STM                     @L9A 45000800
         AIF   (N'&STM NE 3).IECA910    STM CODED BAD              @L9A 45001000
.*       BORROW MNOTE FROM GET PROCESSING ABOVE                    @L9A 45001200
         AIF   ('&STM(1)' EQ '0' OR '&STM(1)' EQ '1' OR                *45001400
               '&STM(1)' EQ '(R0)' OR '&STM(1)' EQ '(R1)').IECA913     *45001600
                                        GET RTNS ADDR AREA IN R1   @L9A 45001800
.*       BORROW MNOTE FROM GET PROCESSING ABOVE                    @L9A 45002000
         AIF   ('&STM(3)' EQ 'DXXPREFX' OR '&STM(3)' EQ 'WTGPREFX').IEC*45002200
               Y060                     CHECK FOR STD SAVE AREA    @L9A 45002400
         STM   &STM(1),&STM(2),&STM(3)&STMBASE SAVE REGISTERS      @13C 45002600
         LA    15,&STM(3)&STMBASE       ADDRESS OF REG SAVE AREA   @13C 45002800
         AGO   .IECY200                 PROC LV=                   @L9A 45003000
.IECY060 ANOP                                                      @L9A 45003200
         L     15,&STM(3)&STMBASE       GET ADDRESS OF PREFIX      @13C 45003400
         LA    15,IECREGSV-IECPREFX(,15) ADDR OF REG SAVE AREA     @L9A 45003600
         STM   &STM(1),&STM(2),0(15)    SAVE REGISTERS             @L9A 45003800
.IECY200 ANOP                                                      @L9A 45004000
         AIF   (T'&LV EQ 'O').IECA925   LV ON GET FREE NO          @L9A 45004200
.*       BORROW MNOTE FROM GET PROCESSING ABOVE                    @L9A 45004400
         AIF   ('&LV'(1,1) EQ '(').IECY220 REG FORM                @L9A 45004600
         LA    0,&LV.(,0)               LENGTH OF WORK AREA        @L9A 45004800
         AGO   .IECY550                 CONTINUE                   @L9A 45005000
.IECY220 AIF   ('&LV' EQ '(0)' OR '&LV' EQ '(R0)').IECY550 REG OK  @L9A 45005200
         LR    0,&LV(1)                 LENGTH OF WORK AREA        @L9A 45005400
.IECY550 ANOP                                                      @L9A 45005600
         BAS   14,124(,RES)             RES ASSUMED CORRECT        @L9A 45005800
         AIF   (T'&ID EQ 'O').IECY610   NO ID                      @L9A 45006000
         DC    CL4'&ID'                 ID OF WORK AREA            @L9A 45006200
         AGO   .IECY620                                            @L9A 45006400
         MEXIT                                                     @L9A 45006600
.IECY610 DC    CL4' '                   BLANK ID OF WORK AREA      @L9A 45006800
.IECY620 AIF   (T'&STM EQ 'O').IECY630  NO LM                      @L9A 45007000
         LM    &STM(1),&STM(2),0(15)    RESTORE REGISTERS          @L9A 45007200
         MEXIT                                                     @L9A 45007400
.IECY630 ANOP                                                      @L9A 45007600
*        MOST REGS ARE CHANGED; STM NOT REQUESTED                  @L9A 45007800
         MEXIT                                                     @L9A 45008000
.*****************************************************************@L10A 45008200
.*                                                                @L10A 45008400
.*       INVOKE CVAF OR REBUILD CHANNEL PROGRAM                   @L10A 45008600
.*                                                                @L10A 45008800
.*            CVAFU/CVAFR READ OR UPDATE A DSCB                   @L10A 45009000
.*            CPRBLD REBUILD CHANNEL PROGRAM ADDING RPS/ECKD      @L10A 45009200
.*                   CHANNEL COMMANDS                             @L10A 45009400
.*            CPRBUL REBUILD USER LABEL CHANNEL PROGRAMS ADDING   @L10A 45009600
.*                   RPS/ECKD CHANNEL COMMANDS                    @L10A 45009800
.*                                                                @L10A 45010000
.*****************************************************************@L10A 45010200
.IECZ000 ANOP                                                     @L10A 45010400
         L     5,CVTPTR(,0)             LOAD CVT ADDRESS          @L10A 45010600
         ICM   5,B'0111',CVTDMSRA-CVT(5)  MOVE IFG019RA ADDRESS   @L10A 45010800
         AIF   ('&FUNC' EQ 'CPRBLD').IECZ058  CPRBLD - NO OPTIONS @L10A 45011000
         AIF   ('&FUNC' EQ 'CPRBUL').IECZ062  CPRBLD - NO OPTIONS @L10A 45011200
         AIF   ('&CVLST' NE '').IECZ005  PARM LIST PTR REQUIRED   @L10A 45011400
         MNOTE 8,'CVLST PARAMETER REQUIRED FOR CVAF'              @L10A 45011600
         MEXIT                                                    @L10A 45011800
.IECZ005 ANOP                                                     @L10A 45012000
         AIF   ('&CVLST'(1,1) NE '(').IECZ010  REG FORM ?         @L10A 45012200
         LR    1,&CVLST(1)             GET CVAF PARMS ADDRESS     @L10A 45012400
         LA    1,0(1)                  CLEAR HIGH ORDER BYTE      @L10A 45012600
         AGO   .IECZ015                                           @L10A 45012800
.IECZ010 ANOP                                                     @L10A 45013000
         LA    1,&CVLST                                           @L10A 45013200
.IECZ015 ANOP                                                     @L10A 45013400
         XC    0(12,1),0(1)            CLEAR 3 WORDS TO ZERO      @L10A 45013600
         AIF   ('&DISKAD' EQ '').IECZ028 DISKAD BLANK,GO CHECK DSN@L10A 45013800
         AIF   ('&DISKAD'(1,1) NE '(').IECZ024 NOT REG,GO CHECK RX@L10A 45014000
         ST    &DISKAD(1),8(1)         3RD ENTRY = DSCB DISK ADDR @L10A 45014200
         AGO   .IECZ028                                           @L10A 45014400
.IECZ024 ANOP                                                     @L10A 45014600
         LA    0,&DISKAD               GET DISK ADDRESS           @L10A 45014800
         ST    0,8(1)                  3RD ENTRY = DSCB DISK ADDR @L10A 45015000
.IECZ028 ANOP                          DO DSNAD PARM              @L10A 45015200
.* IF BOTH DSNAD AND DISKAD BLANK MAKE NO ASSUMPTIONS             @L10A 45015400
         AIF   ('&DSNAD' EQ '' AND '&DISKAD' EQ '').IECZ092 ERROR @L10A 45015600
         AIF   ('&DSNAD' EQ '').IECZ038                           @L10A 45015800
         AIF   ('&DSNAD'(1,1) NE '(').IECZ034                     @L10A 45016000
         ST    &DSNAD(1),4(1)          2ND ENTRY = DSNAME ADDR    @L10A 45016200
         AGO   .IECZ038                                           @L10A 45016400
.IECZ034 ANOP                                                     @L10A 45016600
         LA    0,&DSNAD                GET DSNAD                  @L10A 45016800
         ST    0,4(1)                  2ND ENTRY = DSNAME ADDR    @L10A 45017000
.IECZ038 ANOP                                                     @L10A 45017200
         AIF   ('&DSCBA' EQ '').IECZ090 MUST NOT BE BLANK         @L10A 45017400
         AIF   ('&DSCBA'(1,1) NE '(').IECZ044 NOT REG,GO CHECK RX @L10A 45017600
         ST    &DSCBA(1),0(1)          1ST ENTRY = DSCB BUFFER    @L10A 45017800
         AGO   .IECZ048                                           @L10A 45018000
.IECZ044 ANOP                                                     @L10A 45018200
         LA    0,&DSCBA                GET DSCB ADDRESS           @L10A 45018400
         ST    0,0(1)                  1ST ENTRY = DSCB BUFFER    @L10A 45018600
.IECZ048 ANOP                                                     @L10A 45018800
         AIF   ('&FULL' NE 'Y').IECZ050 FULL DSCB - KEY AND DATA? @L10A 45019000
         OI    0(1),X'80'               INDICATE KEY AND DATA     @L10A 45019200
.IECZ050 ANOP                                                     @L10A 45019400
         AIF   ('&AVT' NE 'Y').IECZ052 APPENDAGE VECTOR TABLE REQ?@L10A 45019600
         OI    0(1),X'40'              YES,TELL CVAF TO USE AN AVT@L10A 45019800
.IECZ052 ANOP                                                     @L10A 45020000
         AIF   ('&FUNC' EQ 'CVAFR').IECZ064                       @L10A 45020200
         AIF   ('&FUNC' EQ 'CVAFU').IECZ068                       @L10A 45020400
.* REBUILD CHANNEL PROGRAM                                        @L10A 45020600
.IECZ058 ANOP                           REBUILD CHANNEL PROGRAM   @L10A 45020800
         LA    0,0                      0 = REBUILD FUNCTION CODE @L10A 45021000
         SR    1,1                      REG 1 NOT USED FOR REBUILD@L10A 45021200
         AGO   .IECZ074                                           @L10A 45021400
.IECZ062 ANOP                           REBUILD CP FOR USER LABELS@L10A 45021600
         LA    0,12                     12= USER LABEL CP REBUILD @L10A 45021800
         SR    1,1                      REG 1 NOT USED FOR REBUILD@L10A 45022000
         AGO   .IECZ074                                           @L10A 45022200
.IECZ064 ANOP                           PREPARE TO READ DSCB      @L10A 45022400
         LA    0,4                      4 = CVAF READ FUNCTION CDE@L10A 45022600
         AGO   .IECZ074                                           @L10A 45022800
.IECZ068 ANOP                                                     @L10A 45023000
         LA    0,8                                                @L10A 45023200
.IECZ074 ANOP                                                     @L10A 45023400
         BAS   14,128(,RES)             GO TO COMMON SERVICES     @L10A 45023600
         MEXIT                                                    @L10A 45023800
.IECZ090 ANOP                                                     @L10A 45024000
         MNOTE 8,'DSCBA PARAMETER REQUIRED '                      @L10A 45024200
         MEXIT                                                    @L10A 45024400
.IECZ092 ANOP                                                     @L10A 45024600
         MNOTE 8,'DSNAD AND DISKAD CANNOT BOTH BE UNSPECIFIED'    @L10A 45024800
         MEXIT                                                    @L10A 45025000
.*****************************************************************@L11A 45025200
.*                                                                @L11A 45025400
.*       FUNCTION = CAFSMSVR                                      @L11A 45025600
.*         A SMS SUBSYSTEM REQUEST IS ISSUED TO UPDATE A          @L11A 45025800
.*         CARTRIDGE AUTOMATED FACILITY VOLUME'S INVENTORY        @L11A 45026000
.*         RECORD.                                                @L11A 45026200
.*                                                                @L11A 45026400
.*****************************************************************@L11A 45026600
.IECS000 ANOP                                                     @L11A 45026800
         L     15,WTGPREFX              ADDRESS OF PREFIX         @L11A 45027000
         LA    15,IECREGSV-IECPREFX(,15) ADDR OF REG SAVE AREA    @L11A 45027200
         STM   0,14,0(15)               SAVE REGISTERS            @L11A 45027400
.*****************************************************************@L11A 45027600
.*     CURRENTLY THE LENGTH OF THE WORK IS EQUAL TO THE:          @L11A 45027800
.*       SSOB     =  28                                            @03A 45028000
.*       SSSA     =  48                                            @03A 45028200
.*       SSSAJ    = 320                                           @L17C 45028400
.*       IEFSSREQ =  80                                            @03A 45028600
.*       MISC     =  66                                            @03A 45028800
.*       TOTAL    = 542                                           @L17C 45029000
.*     IF THE TOTAL IS CHANGED A CORRESPONDING CHANGE MUST BE     @L11A 45029200
.*     MADE TO MODULE IFG019RF(AUTODATA AND STORAGE_SIZE)         @L17C 45029400
.*     TWO INSTRUCTIONS MUST BE CHANGED HERE THE ARE:             @L17C 45029500
.*        LA   0,XXX  AND   LA 1,XXX  (CURRENTLY XXX = 542)       @L17C 45029600
.*****************************************************************@L1BA 45029700
         LA    0,542                    WORK AREA LENGTH TO GET   @L17C 45029800
         L     5,CVTPTR(,0)             LOAD CVT ADDRESS          @L11A 45030000
         ICM   5,B'0111',CVTDMSRA-CVT(5)  MOVE IFG019RA ADDRESS   @L11A 45030200
         BAS   14,124(,5)               GETULTRA STORAGE          @L11A 45030400
         DC    CL4'SSOB'                ID OF WORK AREA           @L11A 45030600
         LM    2,14,8(15)               RESTORE REGISTERS         @L11A 45030800
         LR    3,1                      ADDR. OF WORK AREA        @L11A 45031000
         LA    1,542                    WORK AREA LENGHT          @L17C 45031200
         ST    1,0(,3)                  SAVE FOR COMPARSION        @03A 45031400
         L     5,CVTPTR(,0)             LOAD CVT ADDRESS          @L11A 45031600
         ICM   5,B'0111',CVTDMSRA-CVT(5)  MOVE IFG019RA ADDRESS   @L11A 45031800
         BAS   14,88(,5)                UPDATE CAF VOLUME RECORD  @L11A 45032000
         L     1,WTGPREFX               ADDRESS OF PREFIX         @L11A 45032200
         LA    1,IECREGSV-IECPREFX(,1)  ADDR OF REG SAVE AREA     @L11A 45032400
         LM    2,14,8(1)                RESTORE REGISTERS         @L11A 45032600
         MEXIT                                                    @L11A 45032800
.*****************************************************************@L12A 45033000
.*                                                                @L12A 45033200
.*       FUNCTION = IFG055ZZ                                      @L12A 45033400
.*         EXTEND A STRIPED DATA SET.                             @L12A 45033600
.*          1) SAVE REGS AND GET AUTO DATA STORAGE FOR IFG055ZZ,  @L12A 45033800
.*          2) CALL IFG055ZZ, 3) RESTORE REGISTERS                @L12A 45034000
.*                                                                @L12A 45034200
.*****************************************************************@L12A 45034400
.IECT000 ANOP                                                     @L12A 45034600
.*****************************************************************@L12A 45034800
.*       CURRENTLY THE LENGTH OF THE WORK IS DEFINED BY WASZ55ZZ. @L12A 45035000
.*       IF THE SIZE IS CHANGED A CORRESPONDING CHANGE            @L12A 45035200
.*       MUST BE MADE TO MODULE IFG019RG.                         @L12A 45035400
.*****************************************************************@L12A 45035600
WASZ55ZZ EQU   300                      WORK AREA SIZE            @L12A 45035800
         LA    0,WASZ55ZZ(,0)           WORK AREA LENGTH TO GET   @L12A 45036000
         L     15,WTGPREFX              GET ADDRESS OF PREFIX     @L12A 45036200
         LA    15,IECREGSV-IECPREFX(,15) ADDR OF REGISTER SAVEAREA@L12A 45036400
         STM   2,14,8(15)               SAVE REGISTERS            @L12A 45036600
         ST    0,0(,15)                 PASS WORK AREA SIZE       @L12A 45036800
         LR    1,15                     GET PREFIX ADDRESS        @L12A 45037000
         LA    2,230(,0)                DEFAULT SUBPOOL 230       @L12A 45037200
         LA    3,5(,0)                  DEFAULT KEY 5             @L12A 45037400
         LA    4,1(,0)                  PREFIX/NO LOCK            @L12A 45037600
         L     5,CVTPTR(,0)             LOAD CVT ADDRESS          @L12A 45037800
         ICM   5,B'0111',CVTDMSRA-CVT(5)  MOVE IFG019RA ADDRESS   @L12A 45038000
         BAS   14,16(,5)                LINK TO GETMAIN           @L12A 45038200
         DC    CL4'55ZZ'                ID OF WORK AREA           @L12A 45038400
         LM    2,14,8(15)               RESTORE REGISTERS         @L12A 45038600
         ST    1,4(15)                  PASS WORK AREA ADDR       @L12A 45038800
         L     5,CVTPTR(,0)             LOAD CVT ADDRESS          @L12A 45039000
         ICM   5,B'0111',CVTDMSRA-CVT(5)  MOVE IFG019RA ADDRESS   @L12A 45039200
         BAS   14,140(,5)               GO EXTEND STRIPED DATA SET@L12A 45039400
         AGO   .IECP200                                           @L12A 45039600
.*****************************************************************@L11A 45039800
.*                                                                @L11A 45040000
.*       FUNCTION = CAFLCDB                                       @L11A 45040200
.*         A CARTRIDGE AUTOMATED FACILITY VOLUME CONTROL          @L11A 45040400
.*         RECORD CHECKPOINT INDICATION WILL EITHER BE READ       @L11A 45040600
.*         OR UPDATED.                                            @L11A 45040800
.*                                                                @L11A 45041000
.*****************************************************************@L11A 45041200
.IECP000 ANOP                                                     @L11A 45041400
         L     15,WTGPREFX              ADDRESS OF PREFIX         @L11A 45041600
         LA    15,IECREGSV-IECPREFX(,15) ADDR OF REG SAVE AREA    @L11A 45041800
         STM   0,14,0(15)               SAVE REGISTERS            @L11A 45042000
.*****************************************************************@L11A 45042200
.*       CURRENTLY THE LENGHT OF THE WORK IS EQUAL TO THE CVPL +  @L11A 45042400
.*       VCR  (196) PLUS WHAT THE MACRO CBRXVOL REQUIRES (80)     @L11A 45042600
.*       AN ADDITIONAL FOUR BYTES ARE REQUIRE TO SAVE REGISTER    @L11A 45042800
.*       R14. IF THE SIZE IS CHANGED A CORRESPONDING CHANGE       @L11A 45043000
.*       MUST BE MADE TO MODULE IFG019RG.                         @L11A 45043200
.*****************************************************************@L11A 45043400
         LA    0,578                    WORK AREA LENGTH TO GET   @L11A 45043600
         L     5,CVTPTR(,0)             LOAD CVT ADDRESS          @L11A 45043800
         ICM   5,B'0111',CVTDMSRA-CVT(5)  MOVE IFG019RA ADDRESS   @L11A 45044000
         BAS   14,124(,5)               GETULTRA STORAGE          @L11A 45044200
         DC    CL4'CVPL'                ID OF WORK AREA           @L11A 45044400
         LM    2,14,8(15)               RESTORE REGISTERS         @L11A 45044600
         LR    3,1                      ADDR. OF WORK AREA        @L11A 45044800
.*                                                                @L11A 45045000
         AIF   ('&VCR' NE 'RETRIEVE').IECP100  RETRIEVE VCR ?     @L11A 45045200
.*                                                                @L11A 45045400
         L     5,CVTPTR(,0)             LOAD CVT ADDRESS          @L11A 45045600
         ICM   5,B'0111',CVTDMSRA-CVT(5)  MOVE IFG019RA ADDRESS   @L11A 45045800
         BAS   14,92(,5)                UPDATE CAF VOLUME RECORD  @L11A 45046000
         AGO   .IECP200                                           @L11A 45046200
.*                                                                @L11A 45046400
.IECP100 ANOP                           VCR UPDATE                @L11A 45046600
.*                                                                @L11A 45046800
         AIF   ('&VCR' NE 'UPDATE').IECP300  RETRIEVE VCR ?       @L11A 45047000
.*                                                                @L11A 45047200
         L     5,CVTPTR(,0)             LOAD CVT ADDRESS          @L11A 45047400
         ICM   5,B'0111',CVTDMSRA-CVT(5)  MOVE IFG019RA ADDRESS   @L11A 45047600
         BAS   14,96(,5)                UPDATE CAF VOLUME RECORD  @L11A 45047800
.*                                                                @L11A 45048000
.IECP200 ANOP                                                     @L11A 45048200
.*                                                                @L11A 45048400
         L     1,WTGPREFX               ADDRESS OF PREFIX         @L11A 45048600
         LA    1,IECREGSV-IECPREFX(,1)  ADDR OF REG SAVE AREA     @L11A 45048800
         LM    2,14,8(1)                RESTORE REGISTERS         @L11A 45049000
         MEXIT                                                    @L11A 45049200
.IECP300 ANOP                                                     @L11A 45049400
         MNOTE 8,'ONLY RETREIVE OR UPDATE CAN BE SPECIFIED'       @L11A 45049600
         MEXIT                                                    @L11A 45049800
.******************************************************************@04A 45099800
.*    FUNCTION = RMM                                               @04A 45149800
.*       ONE OF 5 RMM ROUTINES WILL RECEIVE CONTROL 1) LABEL       @04A 45199800
.*       ANOMOLY (LABAN). 2) VOLUME MOUNT (VOLM. 3) FILE           @04A 45249800
.*       VERIFICATION (FILEV). 4) FILE START (FILES).              @04A 45299800
.*       5) FILE END (FILEE).                                      @04A 45349800
.*       ROUTER MODULE IFG019RB WILL RECEIVE CONTROL WITH THE      @04A 45399800
.*       FOLLOWING REGISTERS INITIALIZED:                          @04A 45449800
.*       REG0 - OFFSET INTO TABLE OF RMM EXIT ADDRESSES RESIDING   @04A 45499800
.*              IN AND NEEDED BY IFG019RH.                         @04A 45549800
.*       REG1 - LENGTH FOR IECRES UGET TO BE ISSUED IN IFG019RH    @04A 45599800
.*              (LENGTH OF MAIN & FUNCTION SPECIFIC PARAMETER LST) @04A 45649800
.*       REG13- ADDRESS OF REGISTER SAVE AREA IN EXTENDED PREFIX   @04A 45699800
.*              NEEDED BY IFG019RH.                                @04A 45749800
.*       REG15- ADDRESS OF OFFSET 00 ENTRY POINT IN IFG019RB       @04A 45799800
.*              (ENTRY + 4 IS VCON FOR IFG019RH).                  @04A 45849800
.*       IFG019RB WILL PASS CONTROL TO IFG019RH WHICH IN TURN      @04A 45899800
.*       WILL PASS CONTROL TO THE REQUESTED RMM FUNCTION           @04A 45949800
.******************************************************************@04A 45999800
.IECE100 ANOP                                                      @04A 46049800
         L     15,CVTPTR(,0)            CVT ADDRESS                @04A 46099800
         L     15,CVTDFA-CVT(,15)       ADDRESS OF DFA             @04A 46149800
         L     15,DFADFVAD-DFA(,15)     ADDRESS OF DFVT            @04A 46199800
         AIF   ('&EXIT' EQ 'LABAN').IECE110                        @04A 46249800
         AIF   ('&EXIT' EQ 'VOLM').IECE120                         @04A 46299800
         AIF   ('&EXIT' EQ 'FILEV').IECE130                        @04A 46349800
         AIF   ('&EXIT' EQ 'FILES').IECE140                        @04A 46399800
         AIF   ('&EXIT' EQ 'FILEE').IECE150                        @04A 46449800
         AGO   .IECE170                                            @04A 46499800
.IECE110 ANOP                                                      @04A 46549800
         LA    1,TEPAEND-TEPA           LENGTH OF LABAN PL         @04A 46599800
         LA    0,0                      OFFSET TO LABAN FUNCTION   @04A 46649800
         AGO   .IECE160                                            @04A 46699800
.IECE120 ANOP                                                      @04A 46749800
         LA    1,TEPOEND-TEPO           LENGTH OF VOLM PL          @04A 46799800
         LA    0,4                      OFFSET TO VOLM FUNCTION    @04A 46849800
         AGO   .IECE160                                            @04A 46899800
.IECE130 ANOP                                                      @04A 46949800
         LA    1,TEPVEND-TEPV           LENGTH OF FILEV PL         @04A 46999800
         LA    0,8                      OFFSET TO FILEV FUNCTION   @04A 47049800
         AGO   .IECE160                                            @04A 47099800
.IECE140 ANOP                                                      @04A 47149800
         LA    1,TEPSEND-TEPS           LENGTH OF FILES PL         @04A 47199800
         LA    0,12                     OFFSET TO FILES FUNCTION   @04A 47249800
         AGO   .IECE160                                            @04A 47299800
.IECE150 ANOP                                                      @04A 47349800
         LA    1,TEPEEND-TEPE           LENGTH OF FILEE PL        @L14C 47399800
         LA    0,16                     OFFSET TO FILEE FUNCTION   @04A 47449800
.IECE160 ANOP                                                      @04A 47499800
         L     15,DFVOPN31-DFVT(,15)    ADDR ROUTER IFG0199B       @04A 47549800
         BASSM 14,15                    LINK TO IFG019RB/IFG019RH  @04A 47599800
         MEXIT                                                     @04A 47649800
.IECE170 ANOP                                                      @04A 47699800
         MNOTE 8,'VALID FUNCTIONS: LABAN,VOLM,FILEV,FILES,FILEE'   @04A 47749800
         MEXIT                                                     @04A 47799800
.*****************************************************************@L13A 47800300
.*    FUNCTION = FIND                                             @L13A 47800800
.*       FIND WILL LOCATE A RESERVED AREA WITHIN ABOVE THE LINE   @L13A 47801300
.*       SEGMENT STORAGE AND OPTIONALLY RESERVE OR ALLOCATE       @L13A 47801800
.*       SEGMENT STORAGE IF WORK AREA ID CAN'T BE LOCATED         @L13A 47802300
.*****************************************************************@L13A 47802800
.IECH000 ANOP                                                     @L13A 47803300
         LA    14,IECRES_FINDRTN_&SYSNDX POINT TO RETURN ADDRESS  @L13A 47803800
         BSM   14,0                     SAVE ADDRESSING MODE      @L13A 47804300
         BAKR  14,0                     STACK REGS/PSW ETC.       @L13A 47804800
         SR    0,0                      INITIAL UNCOND LEN TO 0   @L13A 47805300
         AIF   (T'&UNCOND EQ 'O').IECH100                         @L13A 47805800
         AIF   ('&UNCOND'(1,1) EQ '(').IECH030 REG FORM           @L13A 47806300
         LA    0,&UNCOND.(,0)           LENGTH FOR UNCOND PARM    @L13A 47806800
         AGO   .IECH100                                           @L13A 47807300
.IECH030 ANOP                                                     @L13A 47807800
         AIF   ('&UNCOND' EQ '(0)' OR '&UNCOND' EQ '(R0)').IECH100 L13A*47808300
                                         REG OK                         47808800
         LR    0,&UNCOND(1)             LENGTH FOR UNCOND PARM    @L13A 47809300
.IECH100 ANOP                                                     @L13A 47809800
         LA    4,12(,0)                 FIND SEGMENT FUNC CODE    @L13A 47810300
         L     15,CVTPTR(,0)            POINT TO CVT              @L13A 47810800
         L     15,CVTDFA-CVT(,15)       POINT TO DFA              @L13A 47811300
         L     14,DFADFVAD-DFA(,15)     POINT TO DFVT             @L13A 47811800
         LA    15,8                     GET IFG019RB OFFSET       @L13A 47812300
         AL    15,DFVOPN31-DFVT(,14)    ADDR ROUTER IFG019RB      @L13A 47812800
         AIF   (T'&SECID EQ 'O').IECH105                                47813300
         AIF   ('&SECID'(1,1) NE '(').IECH110 REG FORM                  47813800
         LR    2,&SECID(1)                                              47814300
         AGO   .IECH115                                                 47814800
.IECH110 ANOP                                                           47815300
         LA    2,IECRES_FINDRTN_SECID_RS_&SYSNDX                        47815800
         AGO   .IECH115                                                 47816300
.IECH105 ANOP                                                           47816800
         LA    2,IECRES_FINDRTN_SECID_NULL_&SYSNDX                      47817300
.IECH115 ANOP                                                           47817800
         BASSM 14,15                    BR TO IFG019RB/IFG019RI   @L13A 47818300
         AIF   (T'&ID NE 'O').IECH120                             @L13A 47818800
         MNOTE 8,'ID= MISSING ON IECRES FIND'                     @L13A 47819300
         MEXIT                                                    @L13A 47819800
.IECH120 ANOP                                                     @L13A 47820300
         DC    CL4'&ID'                 WORK AREA ID              @L13A 47820800
         AIF   (T'&SECID EQ 'O').IECH130                          @L13A 47821300
         AIF   ('&SECID'(1,1) EQ '(').IECH125 REG FORM            @L13A 47821800
IECRES_FINDRTN_SECID_RS_&SYSNDX  DS  0H                                 47822300
         DC    CL4'&SECID'              SECONDARY WORK AREA ID    @L13A 47822800
         AGO   .IECH140                                           @L13A 47823300
.IECH125 ANOP                                                     @L13A 47823800
         DC    CL4' '                                             @L13A 47824300
         AGO   .IECH140                                           @L13A 47824800
.IECH130 ANOP                                                     @L13A 47825300
IECRES_FINDRTN_SECID_NULL_&SYSNDX  DS  0H                               47825800
         DC    CL4' '                                             @L13A 47826300
.IECH140 AIF   ('&IDTTR' NE 'WLH').IECH200                        @L13A 47826800
         DC    B'10000000'              LOCK HELD FLAG            @L13A 47827300
         AGO   .IECH300                                           @L13A 47827800
.IECH200 ANOP                                                     @L13A 47828300
         DC    B'00000000'              LOCK NOT HELD FLAG        @L13A 47828800
IECRES_FINDRTN_&SYSNDX  DS  0H                                    @L13A 47829300
.IECH300 ANOP                                                     @L13A 47829800
         MEXIT                                                    @L13A 47830300
.*****************************************************************@L13A 47830800
.*    FUNCTION = FREESEGS                                         @L13A 47831300
.*       FREESEGS IS CALLED AT THE TIME PREFIXED STORAGE BELOW    @L13A 47831800
.*       THE LINE IS FREED. ALL STORAGE GETMAINED FOR ALL         @L13A 47832300
.*       SEGMENTS WILL BE FREED.                                  @L13A 47832800
.*****************************************************************@L13A 47833300
.IECI000 ANOP                                                     @L13A 47833800
         LA    14,IECRES_FREESEGS_&SYSNDX POINT TO RETURN ADDRESS @L13A 47834300
         BSM   14,0                     SAVE ADDRESSING MODE      @L13A 47834800
         BAKR  14,0                     STACK REGS/PSW ETC.       @L13A 47835300
         LA    4,16(,0)                 FREESEGS FUNC CODE        @L13A 47835800
         L     15,CVTPTR(,0)            POINT TO CVT              @L13A 47836300
         L     15,CVTDFA-CVT(,15)       POINT TO DFA              @L13A 47836800
         L     14,DFADFVAD-DFA(,15)     POINT TO DFVT             @L13A 47837300
         LA    15,8                     GET IFG019RB OFFSET       @L13A 47837800
         AL    15,DFVOPN31-DFVT(,14)    ADDR ROUTER IFG019RB      @L13A 47838300
         BASSM 14,15                    BR TO IFG019RB/IFG019RI   @L13A 47838800
IECRES_FREESEGS_&SYSNDX  DS  0H                                   @L13A 47839300
         MEXIT                                                    @L13A 47839800
.*****************************************************************@L15A 47839900
.*    FUNCTION = COPYTIOT                                         @L15A 47840000
.*       CPYTIOT SUBROUTINE IN IFG019RA IS CALLED FOR EXCP DCBS   @L15A 47840100
.*       WITH ASSOCIATED XTIOT ENTRIES TO CONSTRUCT A BELOW THE   @L15A 47840200
.*       LINE TIOT                                                @L15A 47840300
.*****************************************************************@L15A 47840400
.IECK000 ANOP                                                     @L15A 47840500
         LA    14,TIOTCPY_RTNADDR_&SYSNDX  POINT TO RETURN ADDR   @L15A 47840600
         BSM   14,0                     SAVE ADDRESSING MODE      @L15A 47840700
         BAKR  14,0                     STACK REGS/PSW ETC.       @L15A 47840800
         L     15,TIOTCPY_NXTADDR_&SYSNDX  NEXT ADDR FOR MODE SW  @L15A 47840900
         BSM   0,15           SWITCH TO 31BIT ADDRESSING MODE     @L15A 47841000
TIOTCPY_NXTADDR_&SYSNDX   DC A(X'80000000'+TIOTCPY_NXT_&SYSNDX)   @L15A 47841100
TIOTCPY_NXT_&SYSNDX    DS    0H       FOR SWITCHING ADDR MODE     @L15A 47841200
         L     15,CVTPTR(,0)            CVT ADDRESS               @L18C 47841300
         L     15,CVTDFA-CVT(,15)     POINT TO DFA                @L18A 47841400
         L     14,DFADFVAD-DFA(,15)   POINT TO DFVT               @L18A 47841500
         LA    15,24                  GET IFG019RB OFFSET         @L18A 47841600
         LA    1,0                    BR TBL OFFSET IN IFG019RJ   @L18A 47841700
         AL    15,DFVOPN31-DFVT(,14)   ADDR ROUTER IFG019RB       @L18A 47841800
         BASSM 14,15                  BR TO IFG019RB/IFG019RJ     @L18A 47841900
TIOTCPY_RTNADDR_&SYSNDX  DS  0H                                   @L15A 47842000
         MEXIT                                                    @L15A 47842100
.*****************************************************************@L15A 47842200
.*    FUNCTION = DDSRV                                            @L15A 47842300
.*       DDSRV SUBROUTINE IN IFG019RA IS CALLED FOR EXCP DCBS     @L15A 47842400
.*       WITH ASSOCIATED XTIOT ENTRIES TO ISSUE IEFDDSRV SERVICE  @L15A 47842500
.*       TO OBTAIN A UCB LIST OF DEVICES ALLOCATED TO THE DD STMT.@L15A 47842600
.*****************************************************************@L15A 47842700
.IECQ000 ANOP                                                     @L15A 47842800
         LA    14,DDSRV_RTNADDR_&SYSNDX  POINT TO RETURN ADDR     @L15A 47842900
         BSM   14,0                     SAVE ADDRESSING MODE      @L15A 47843000
         BAKR  14,0                     STACK REGS/PSW ETC.       @L15A 47843100
         L     15,DDSRV_NXTADDR_&SYSNDX  NEXT ADDR FOR MODE SW    @L15A 47843200
         BSM   0,15           SWITCH TO 31BIT ADDRESSING MODE     @L15A 47843300
DDSRV_NXTADDR_&SYSNDX   DC A(X'80000000'+DDSRV_NXT_&SYSNDX)       @L15A 47843400
DDSRV_NXT_&SYSNDX    DS    0H       FOR SWITCHING ADDR MODE       @L15A 47843500
         L     15,CVTPTR(,0)            CVT ADDRESS               @L18C 47843600
         L     15,CVTDFA-CVT(,15)     POINT TO DFA                @L18A 47843700
         L     14,DFADFVAD-DFA(,15)   POINT TO DFVT               @L18A 47843800
         LA    15,24                  GET IFG019RB OFFSET         @L18A 47843900
         LA    1,8                    BR TBL OFFSET IN IFG019RJ   @L18A 47844000
         AL    15,DFVOPN31-DFVT(,14)   ADDR ROUTER IFG019RB       @L18A 47844100
         BASSM 14,15                  BR TO IFG019RB/IFG019RJ     @L18A 47844200
DDSRV_RTNADDR_&SYSNDX  DS  0H                                     @L15A 47844300
         MEXIT                                                    @L15A 47844400
.*****************************************************************@L15A 47844500
.*    FUNCTION = UNCAPTURE UCBS IN XTIOT COPY ENTRY               @L15A 47844600
.*       UNCAP SUBROUTINE IN IFG019RA IS CALLED FOR EXCP DCBS     @L15A 47844700
.*       WITH ASSOCIATED XTIOT ENTRIES TO ISSUE IOSCAPU SERVICE   @L15A 47844800
.*       TO UNCAPTURE UCBS CAPTURED BY OCE                        @L15A 47844900
.*****************************************************************@L15A 47845000
.IECL000 ANOP                                                     @L15A 47845100
         LA    14,UNCAP_RTNADDR_&SYSNDX  POINT TO RETURN ADDR     @L15A 47845200
         BSM   14,0                     SAVE ADDRESSING MODE      @L15A 47845300
         BAKR  14,0                     STACK REGS/PSW ETC.       @L15A 47845400
         L     15,UNCAP_NXTADDR_&SYSNDX  NEXT ADDR FOR MODE SW    @L15A 47845500
         BSM   0,15           SWITCH TO 31BIT ADDRESSING MODE     @L15A 47845600
UNCAP_NXTADDR_&SYSNDX   DC A(X'80000000'+UNCAP_NXT_&SYSNDX)       @L15A 47845700
UNCAP_NXT_&SYSNDX    DS    0H       FOR SWITCHING ADDR MODE       @L15A 47845800
         L      15,CVTPTR(,0)            CVT ADDRESS              @L18C 47845900
         L      15,CVTDFA-CVT(,15)     POINT TO DFA               @L18A 47846000
         L      14,DFADFVAD-DFA(,15)   POINT TO DFVT              @L18A 47846100
         LA     15,24                  GET IFG019RB OFFSET        @L18A 47846200
         LA     1,4                    BR TBL OFFSET IN IFG019RJ  @L18A 47846300
         AL     15,DFVOPN31-DFVT(,14)   ADDR ROUTER IFG019RB      @L18A 47846400
         BASSM 14,15                   BR TO IFG019RB/IFG019RJ    @L18A 47846500
UNCAP_RTNADDR_&SYSNDX  DS  0H                                     @L15A 47846600
         MEXIT                                                    @L15A 47846700
.*****************************************************************@L16A 47846800
.*    FUNCTION = SMF42                                            @L16A 47846900
.*       SMF42 WILL PASS CONTROL TO IFGSMF42 TO CREATE A SMF      @L16A 47847000
.*       TYPE42 SUBTYPE9 RECORD FOR X37 ABENDS. ROUTER MODULE     @L16A 47847100
.*       IFG019RB WILL RECEIVE CONTROL AND ROUTE TO IFGSMF42      @L16A 47847200
.*       WHICH RESIDES ABOVE THE LINE                             @L16A 47847300
.*****************************************************************@L16A 47847400
.IECR000 ANOP                                                     @L16A 47847500
         LA    14,IECRES_SMFTP42_&SYSNDX POINT TO RETURN ADDRESS  @L16A 47847600
         BSM   14,0                     SAVE ADDRESSING MODE      @L16A 47847700
         BAKR  14,0                     STACK REGS/PSW ETC.       @L16A 47847800
         L     15,CVTPTR(,0)            POINT TO CVT              @L16A 47847900
         L     15,CVTDFA-CVT(,15)       POINT TO DFA              @L16A 47848100
         L     14,DFADFVAD-DFA(,15)     POINT TO DFVT             @L16A 47848300
         LA    15,16                    GET IFG019RB OFFSET       @L16A 47848500
         AL    15,DFVOPN31-DFVT(,14)    ADDR ROUTER IFG019RB      @L16A 47848700
         BASSM 14,15                    BR TO IFG019RB/IFGSMF42   @L16A 47848900
IECRES_SMFTP42_&SYSNDX  DS  0H                                    @L16A 47849100
         MEXIT                                                    @L16A 47849300
.*****************************************************************@L21A 47899300
.*    FUNCTION = TAPESERV                                         @L21A 47949300
.*       TAPESERV WILL PASS CONTROL TO IFG019RM TO ISSUE EITHER   @L21A 47999300
.*       MEDIUM SENSE COMMAND OR RBL LOG COMMAND DEPENDING        @L21A 48049300
.*       ON SERVICE REQUESTED. IFG019RB WILL RECEIVE CONTROL      @L21A 48099300
.*       AND ROUTE TO IFG019RM WHICH RESIDES ABOVE THE LINE       @L21A 48149300
.*****************************************************************@L21A 48199300
.IECR010 ANOP                                                     @L21A 48249300
         AIF   ('&TPSERV' EQ 'MEDINFO').IECR011                   @L21A 48299300
         AIF   ('&TPSERV' EQ 'RBL').IECR012                       @L21A 48349300
         AIF   ('&TPSERV' EQ 'MSNS').IECR013                      @L21A 48399300
         MNOTE 8,'VALID FUNCTIONS: RBL,MSNS'                      @L21A 48449300
         MEXIT                                                    @L21A 48499300
.IECR011 ANOP                                                     @L21A 48549300
         LA    1,8                      ISSUE LIBSERV             @L21A 48599300
         AGO   .IECR015                                           @L21A 48649300
.IECR012 ANOP                                                     @L21A 48699300
         LA    1,4                      ISSUE RBL                 @L21A 48749300
         AGO   .IECR015                                           @L21A 48799300
.IECR013 ANOP                                                     @L21A 48849300
         LA    1,0                      ISSUE MSNS                @L21A 48899300
.IECR015 ANOP                                                     @L21A 48949300
         LA    14,IECRES_TAPSRV_&SYSNDX POINT TO RETURN ADDRESS   @L21A 48999300
         BSM   14,0                     SAVE ADDRESSING MODE      @L21A 49049300
         BAKR  14,0                     STACK REGS/PSW ETC.       @L21A 49099300
         L     15,CVTPTR(,0)            POINT TO CVT              @L21A 49149300
         L     15,CVTDFA-CVT(,15)       POINT TO DFA              @L21A 49199300
         L     14,DFADFVAD-DFA(,15)     POINT TO DFVT             @L21A 49249300
         LA    15,40                    GET IFG019RB OFFSET       @L21A 49299300
         AL    15,DFVOPN31-DFVT(,14)    ADDR ROUTER IFG019RB      @L21A 49349300
         BASSM 14,15                    BR TO IFG019RB/IFG019RM   @L21A 49399300
IECRES_TAPSRV_&SYSNDX  DS  0H                                     @L21A 49449300
         MEXIT                                                    @L21A 49499300
         MEND                                                           49549300
