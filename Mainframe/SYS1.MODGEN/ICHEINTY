*%/*                                                                    00010400
*/* FIRST LINE INDICATES BILINGUAL                               @M8A*  00020800
*/* START OF SPECIFICATIONS ******************************************  00031200
*                                                                    *  00062400
*   $MAC(ICHEINTY) COMP(XXH00) PROD(RACF):                           *  00093600
*                                                                    *  00124800
*   DESCRIPTIVE NAME = Locates or updates the profile                *  00156000
*                                                                @M8A*  00187200
* *01* PROPRIETARY STATEMENT=                                         * 00234600
*  **PROPRIETARY_STATEMENT********************************************* 00282000
*                                                                     * 00329400
*                                                                     * 00376800
*   LICENSED MATERIALS - PROPERTY OF IBM                              * 00424200
*   THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                       * 00471600
*   5647-A01 (C) COPYRIGHT IBM CORP. 1981, 2000                       * 00519000
*                                                                     * 00566400
*   STATUS= HRF7703                                                   * 00613800
*                                                                     * 00661200
*  **END_OF_PROPRIETARY_STATEMENT************************************** 00708600
*********************************************************************** 00756600
*                                                                       00760000
*/*01* EXTERNAL CLASSIFICATION:                                  @M7A   00770000
*/*02* GUPI:                                                     @M7A   00780000
*/*01* END OF EXTERNAL CLASSIFICATION:                           @M7A   00790000
*                                                                       00800000
*   FUNCTION:   RACF manager interface for managing the RACF            00850000
*               data set.  Adds entries to or deletes entries from      00900000
*               the RACF data set.  Also retrieves or alters field      00950000
*               values in an existing entry.                            01000000
*                                                                       01050000
*   NOTES:      Any change in usage of third byte in the parameter list 01100000
*               must be reflected in ICHRSV00.                     @L5A 01150000
*                                                                       01200000
*   CHANGE ACTIVITY:                                                    01250000
*               A 000000-999999                              @S1001PA   01300000
*               $L4=HRF1402,RACF/140,810701,SJRDSD:                @L4A 01350000
*               OZ59076                                      @ZA59076   01400000
*               OZ61787                                      @ZA61787   01450000
*               $L5=HRF1502,RACF/150,820430,CNTDSD:                @L5A 01500000
*               OZ87145                                      @ZA87145   01550000
*               $L8=HRF1802,RACF/180,860331,CNTDSD:                @L8A 01600000
*               $P1=HRF1802,RACF/180,870721,CNTDSD:  PEQ0156       @P1A 01650000
*               $P2=HRF1802,RACF/180,870721,VSZ:     PEQ0237       @P2A 01700000
*               $P3=HRF1802,RACF/181,870721,JAD:     PTM0030       @P3A 01750000
* $M1= RDS      HRF1902 880803 PDALF1: Support ENTRYX parameter    @M1A 01800000
* $M2= RDS      HRF1902 881012 PDALF1: Support NEWNAMX parameter   @M2A 01850000
* $P4= RDS      HRF1902 890201 PDALF1: Correction for PGU0282      @P4A 01900000
* $01= OY23127  HRF1902 890922 PDALF1: APAR OY23127                @01A 01950000
* $02= OY25383  HRF1902 891222 PDALF1: Same as fix for PGU0282     @02A 02000000
* $M3= RELID    JRF1922  900904 PDAHW1: Support for RACF 1.9.2     @M3A 02050000
* $M4= RELID    HRF2210  930427 PDKAF1: Support for RACF 2.1       @M4A 02100000
* $M5= RELID    HRF2220  940509 PDJMV1: Support for RACF 2.2       @M5A 02150000
* $M6= RELID    HRF2230  960411 PDJMV1: Support for RACF 2.3       @M6A 02175000
* $M7= RELID    HRF2240  960903 PDJMV1: Support for RACF 2.4       @M7A 02187500
* $03= OW24640  HRF2240  970831 PDAWC1: APAR OW24640               @03A 02196800
* $M8= RELID    HRF2260  970728 PDCAM1: Support RACF FMID HRF2260  @M8A 02198400
* $M9= RELID    HRF2608  980624 PDRDS2: Support RACF FMID HRF2608  @M9A 02199200
* $MA= RELID    HRF7703  980624 PDRDS2: Support RACF FMID HRF7703  @MAA 02199600
*                                                                       02200000
* CHANGE DESCRIPTION =                                                  02250000
*   A - ADD SUPPORT FOR RACF RELEASES 1.9 AND 1.9.2                @M3A 02300000
*   A - ADD SUPPORT FOR RACF RELEASE 2.1                           @M4A 02350000
*   A - ADD SUPPORT FOR RACF RELEASE 2.2                           @M5A 02400000
*   A - ADD SUPPORT FOR RACF FMID HRF2230                          @M6A 02425000
*   A - ADD SUPPORT FOR RACF FMID HRF2240                          @M7A 02437500
*   A - ADD DATEFMT KEYWORD TO SUPPORT THE YR2000                  @03A 02446800
*   A - ADD SUPPORT FOR RACF FMID HRF2260                          @M8A 02448400
*   A - ADD SUPPORT FOR RACF FMID HRF2608                          @M9A 02449200
*   A - ADD SUPPORT FOR RACF FMID HRF7703                          @MAA 02449600
*********************************************************************** 02450000
         MACRO                                                          02500000
&NAME    ICHEINTY &OPTION,&ENTRY=,&WKAREA=,&ACTIONS=,&TESTS=,          *02550000
               &RBA=,&NEWNAME=,&TYPE=,                                 *02600000
               &OPTIONS=,&MF=I,                                        *02650000
               &CLASS=,&VOLUME=,                               @PC0026U*02700000
               &SMC=,                                              @L5A*02750000
               &GENERIC=,                                          @L5A*02800000
               &FLDEF=,                                        @ZA87145X02850000
               &INDEX=,                                        @ZA87145+02900000
               &ACEE=,&CHAIN=,&FLDACC=,&RELEASE=,&SEGMENT=,        @P1C+02950000
               &DATAMAP=,&WKSP=,&RUN=,&ENTRYX=,&NEWNAMX=,          @03C+02983300
               &DATEFMT=                                           @03A 03016600
.*       OPTIONS SUBLIST LEGAL ITEMS:                                   03050000
.*             NOPRO                    - NO PROLOGUE CODE TO BE        03100000
.*                                         GENERATED.                   03150000
.*             FLDEF                    - GENERATE RELOCATION CODE      03200000
.*                                         FOR FLDEF PTR IN L-FORM.     03250000
.*             ACTION                   - SET ACTION COUNT IN FLDEF     03300000
.*                                         WORD OF L-FORM.              03350000
.*             TESTC                    - SET CURRENT TEST COUNT IN     03400000
.*                                         FLDEF WORD IN L-FORM.        03450000
.*             TESTM                    - SET MAXIMUM TEST COUNT IN     03500000
.*                                         FLDEF WORD IN L-FORM.        03550000
.*             NOEXEC                   - BYPASS ISSUING OF SVC.        03600000
.* * * * *  NOTE ABOVE ITEMS ARE LEGAL IN E-FORM EXPANSION ONLY...      03650000
         LCLB  &F(24)                    FLAGS FOR MAIN OPTION     @L4A 03700000
         LCLA  &DIMF                     DIMENSION OF &F       @PC0026U 03750000
         LCLB  &INOPRO,&IFLDEF,&IACTION,&ITESTC,&ITESTM                 03800000
         LCLB  &IACCESS,&ISET,&ICREATE,&ICANCEL                         03850000
         LCLB  &INOEXEC                                                 03900000
         LCLB  &T(5)                    TYPE FLAGS.                     03950000
         LCLA  &DIMT                    DIMENSION OF &T        @PC0026U 04000000
         LCLB  &MSG(5)                  MESSAGE PENDING ARRAY.          04050000
         LCLB  &EN,&WK,&AC,&TE,&EL,&TY,&OP,&NN,&FD                      04100000
         LCLC  &NAM                                                     04150000
         LCLC  &GENREG                  EXPANSION REGISTER.             04200000
         LCLC  &FLDPTR               FLDEF PTR VALUES.                  04250000
         LCLC  &KEYWORD               VARIABLE FOR KEYWORD ERRORS  @P2A 04300000
         LCLA  &AAND(8),&AOR(8)    IPLOPT3 VALUES                  @L5A 04350000
         LCLA  &INVSVC                  SVC NUMBER.                     04400000
         LCLA  &FG(5)                                              @03C 04475000
         LCLA  &ET,&NA,&NT,&I,&J,&K                                     04500000
         LCLA  &LOCST,&LOCRBA,&LOCEN,&LOCFDP,&LOCWK                     04550000
         LCLA  &LOCTST,&LOCAC,&LOCFDF                                   04600000
         LCLA  &LOCVOL,&LOCCLS                                 @PC0026U 04650000
         LCLA  &LOCVER,&LOCWSP                                     @L8A 04700000
         LCLA  &LOCXFLG,&LOCACEE,&LOCSEGN,&LOCNIPL                 @L8A 04750000
         LCLA  &LOCRC,&LOCSR,&LOCXWA                               @L8A 04800000
         LCLA  &RLVL                                               @L8A 04850000
         LCLA  &INVFG                                              @L8A 04900000
         LCLB  &RLVLCHK                                            @L8A 04950000
         LCLB  &XF(32),&XND(16)         XTENDED FLAGS              @03C 05000000
         LCLC  &SUBPOOL                                            @L8A 05050000
         LCLC  &ICHERLV                                            @L8A 05100000
         LCLB  &ENX                     EXTENDED ENTRY FLAG        @M1A 05150000
         LCLB  &NNX                     EXTENDED NEWNAME FLAG      @M2A 05200000
&DIMF    SETA  10                       SET DIMENSION OF &F    @PC0026U 05250000
&DIMT    SETA  5                        SET DIMENSION OF &T    @PC0026U 05300000
&INVSVC  SETA  132                      INVENTORY SVC CODE.             05350000
&XF(1)   SETB  0                        DEFALT BITS TO ZERO        @L8A 05400000
&XF(2)   SETB  0                        DEFALT BITS TO ZERO        @L8A 05450000
&XF(3)   SETB  0                        DEFALT BITS TO ZERO        @L8A 05500000
&XF(4)   SETB  0                        DEFALT BITS TO ZERO        @L8A 05550000
&XF(5)   SETB  0                        DEFALT BITS TO ZERO        @L8A 05600000
&XF(6)   SETB  0                        DEFALT BITS TO ZERO        @L8A 05650000
&XF(7)   SETB  0                        DEFALT BITS TO ZERO        @L8A 05700000
&XF(8)   SETB  0                        DEFALT BITS TO ZERO        @L8A 05750000
&XF(9)   SETB  0                        DEFALT BITS TO ZERO        @L8A 05800000
&XF(10)  SETB  0                        DEFALT BITS TO ZERO        @P2A 05850000
&XF(11)  SETB  0                        DEFALT BITS TO ZERO        @P2A 05900000
&XF(12)  SETB  0                        DEFALT BITS TO ZERO        @P2A 05950000
&XF(13)  SETB  0                        DEFALT BITS TO ZERO        @L8A 06000000
&XF(14)  SETB  0                        DEFALT BITS TO ZERO        @L8A 06050000
&XF(15)  SETB  0                        DEFALT BITS TO ZERO        @L8A 06100000
&XF(16)  SETB  0                        DEFALT BITS TO ZERO        @L8A 06150000
&XF(17)  SETB  0                        DEFALT BITS TO ZERO        @L8A 06200000
&XF(18)  SETB  0                        DEFALT BITS TO ZERO        @P2A 06250000
&XF(19)  SETB  0                        DEFALT BITS TO ZERO        @P2A 06300000
&XF(20)  SETB  0                        DEFALT BITS TO ZERO        @P2A 06350000
&XF(21)  SETB  0                        DEFALT BITS TO ZERO        @P2A 06400000
&XF(22)  SETB  0                        DEFALT BITS TO ZERO        @P2A 06450000
&XF(23)  SETB  0                        DEFALT BITS TO ZERO        @P2A 06500000
&XF(24)  SETB  0                        DEFALT BITS TO ZERO        @P2A 06550000
&XF(25)  SETB  0                        DEFALT BITS TO ZERO        @P2A 06600000
&XND(1)  SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @P2A 06650000
&XND(2)  SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @P2A 06700000
&XND(3)  SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @P2A 06750000
&XND(4)  SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @P2A 06800000
&XND(5)  SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @P2A 06850000
&XND(6)  SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @P2A 06900000
&XND(7)  SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @P2A 06950000
&XND(8)  SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @P2A 07000000
&XND(9)  SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @03A 07005500
&XND(10) SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @03A 07011000
&XND(11) SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @03A 07016500
&XND(12) SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @03A 07022000
&XND(13) SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @03A 07027500
&XND(14) SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @03A 07033000
&XND(15) SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @03A 07038500
&XND(16) SETB  1                    DEFAULT IS KEEP LFORM FLAGS    @03A 07044000
.*                                                                 @L8A 07050000
.PRLS001 ANOP                                                      @L8A 07100000
&RLVL    SETA  1                    DEFAULT TO NOT SPECIFIED       @L8A 07150000
         AIF   (T'&RELEASE EQ 'O').NORLVL                          @P2C 07200000
         AIF   (N'&RELEASE GT 2).ERLVL1                            @P2C 07250000
         AIF   ('&RELEASE(1)' EQ '1.7').RL17                       @P2C 07300000
         AIF   ('&RELEASE(1)' EQ '1.8').RL18                       @P2C 07350000
         AIF   ('&RELEASE(1)' EQ '1.8.1').RL18                     @P3A 07400000
         AIF   ('&RELEASE(1)' EQ '1.9').RL19                       @M1A 07450000
         AIF   ('&RELEASE(1)' EQ '1.9.2').RL192                    @M3A 07500000
         AIF   ('&RELEASE(1)' EQ '2.1').RL21                       @M4A 07550000
         AIF   ('&RELEASE(1)' EQ '2.2').RL22                       @M5A 07600000
         AIF   ('&RELEASE(1)' EQ '2.3').RL23                       @M6A 07625000
         AIF   ('&RELEASE(1)' EQ '2.4').RL24                       @M7A 07637500
         AIF   ('&RELEASE(1)' EQ '2.6').RL26                       @M8A 07643700
         AIF   ('&RELEASE(1)' EQ '2608').RL2608                    @M9A 07646800
         AIF   ('&RELEASE(1)' EQ '7703').RL7703                    @MAA 07648400
         AGO   .ERLVL1                                             @L8A 07650000
.RL17    ANOP  ,                                                   @L8A 07700000
&RLVL    SETA  3                    RELEASE 1.7 SPECIFIED          @L8A 07750000
         AGO   .PRLS002                                            @L8A 07800000
.RL18    ANOP                                                      @L8A 07850000
&RLVL    SETA  4                    RELEASE 1.8 SPECIFIED          @L8A 07900000
         AGO   .PRLS002                                            @01C 07950000
.RL19    ANOP                                                      @M1A 08000000
&RLVL    SETA  5                    RELEASE 1.9 SPECIFIED          @M1A 08050000
         AGO   .PRLS002                                            @M3A 08100000
.RL192   ANOP                                                      @M3A 08150000
&RLVL    SETA  6                    RELEASE 1.9.2 SPECIFIED        @M3A 08200000
         AGO   .PRLS002                                            @M4A 08250000
.RL21    ANOP                                                      @M4A 08300000
&RLVL    SETA  7                    RELEASE 2.1 SPECIFIED          @M4A 08350000
         AGO   .PRLS002                                            @M5A 08400000
.RL22    ANOP                                                      @M5A 08450000
&RLVL    SETA  7                    RELEASE 2.2 SPECIFIED          @M5A 08500000
         AGO   .PRLS002                                            @M6A 08512500
.RL23    ANOP                                                      @M6A 08525000
&RLVL    SETA  7                    RELEASE 2.3 SPECIFIED          @M6A 08537500
         AGO   .PRLS002                                            @M7A 08540600
.RL24    ANOP                                                      @M7A 08543700
&RLVL    SETA  7                    RELEASE 2.4 SPECIFIED          @M7A 08546800
.RL26    ANOP                                                      @M8A 08547800
&RLVL    SETA  7                    RELEASE 2.6 SPECIFIED          @M8A 08548800
.RL2608  ANOP                                                      @M9A 08549200
&RLVL    SETA  7                    RELEASE 2608 SPECIFIED         @M9A 08549600
.RL7703  ANOP                                                      @MAA 08549700
&RLVL    SETA  7                    RELEASE 7703 SPECIFIED         @MAA 08549800
.*                                                                 @L8A 08550000
.PRLS002 ANOP                                                      @L8A 08600000
&RLVLCHK SETB  0                    DEFAULT TO NOT SPECIFIED       @L8A 08650000
         AIF   (N'&RELEASE EQ 1).NORLVLC,                          @L8A*08700000
               ('&RELEASE(2)' EQ 'CHECK').RLCHECK                  @L8A 08750000
         AGO   .ERLVL1                                             @L8A 08800000
.RLCHECK ANOP  ,                                                   @L8A 08850000
&RLVLCHK SETB  1                    CHECK SPECIFIED                @L8A 08900000
.NORLVL  ANOP                                                      @L8A 08950000
.NORLVLC ANOP                                                      @L8A 09000000
.ERLVL1R ANOP                                                      @L8A 09050000
.* CHECK  PARMS INCONSISTENSIES                                    @L8A 09100000
&KEYWORD SETC  'ACEE'                                              @P2A 09150000
         AIF   ((  &RLVL    LT 4)           AND                        *09200000
               (T'&ACEE     NE 'O')).INC0000                       @P2A 09250000
&KEYWORD SETC  'CHAIN'                                             @P2A 09300000
         AIF   ((  &RLVL    LT 4)           AND                        *09350000
               (T'&CHAIN    NE 'O')).INC0000                       @P2A 09400000
&KEYWORD SETC  'FLDACC'                                            @P2A 09450000
         AIF   ((  &RLVL    LT 4)           AND                        *09500000
               (T'&FLDACC   NE 'O')).INC0000                       @P2A 09550000
&KEYWORD SETC  'SEGMENT'                                           @P2A 09600000
         AIF   ((  &RLVL    LT 4)           AND                        *09650000
               (T'&SEGMENT  NE 'O')).INC0000                       @P2A 09700000
&KEYWORD SETC  'WKSP'                                              @P2A 09750000
         AIF   ((  &RLVL    LT 4)           AND                        *09800000
               (T'&WKSP     NE 'O')).INC0000                       @P2A 09850000
&KEYWORD SETC  'ENTRYX'                 NOTE KEYWORD FOR ERROR MSG @M1A 09900000
.*             ENTRYX INVALID BEFORE RELEASE 1.9                   @M1A 09950000
         AIF   ((  &RLVL    LT 5)           AND                        *10000000
               (T'&ENTRYX   NE 'O')).INC0000                       @M1A 10050000
&KEYWORD SETC  'NEWNAMX'                NOTE KEYWORD FOR ERROR MSG @M2A 10100000
.*             NEWNAMX INVALID BEFORE RELEASE 1.9                  @M2A 10150000
         AIF   ((  &RLVL    LT 5)           AND                        *10200000
               (T'&NEWNAMX  NE 'O')).INC0000                       @M2A 10250000
&KEYWORD SETC  'DATEFMT'                NOTE KEYWORD FOR ERROR MSG @03A 10260000
.*             DATEFMT INVALID BEFORE RELEASE 1.9.2                @03A 10270000
         AIF   ((  &RLVL    LT 6)           AND                        *10280000
               (T'&DATEFMT  NE 'O')).INC0000                       @03A 10290000
.INC000R ANOP  ,                                                   @L8A 10300000
         AIF   ((T'&CHAIN   NE 'O')         AND                        *10350000
               (('&OPTION'  EQ 'RENAME')    OR                         *10400000
               (('&OPTION'  EQ 'DELETE')    AND                        *10450000
               (T'&SEGMENT  EQ 'O')))).INC0001                     @P2C 10500000
.*             ENTRY AND ENTRYX ARE MUTUALLY EXCLUSIVE             @M1A 10550000
         AIF   ((T'&ENTRY   NE 'O')         AND                        *10600000
               (T'&ENTRYX   NE 'O')).INC0001                       @M1A 10650000
.*             NEWNAME AND NEWNAMX ARE MUTUALLY EXCLUSIVE          @M2A 10700000
         AIF   ((T'&NEWNAME NE 'O')         AND                        *10750000
               (T'&NEWNAMX  NE 'O')).INC0001                       @M2A 10800000
         AIF   ((T'&SEGMENT NE 'O')         AND                        *10850000
               (('&OPTION'  EQ 'ADD')       OR                         *10900000
               ('&OPTION'   EQ 'RENAME')    OR                         *10950000
               ('&OPTION'   EQ 'DELETEA'))).INC0001                @P2C 11000000
.*             SET OFFSETS TO FIELDS IN PARM LIST                       11050000
&LOCST   SETA  0                        START OF EXPANSION.    @PC0026U 11100000
&LOCEN   SETA  &LOCST+4                 OFFSET TO ENTRY PTR    @PC0026U 11150000
&LOCFDP  SETA  &LOCEN+4                 OFFSET TO FLDEF PTR    @PC0026U 11200000
&LOCRBA  SETA  &LOCFDP+4                OFFSET TO RBA PTR      @PC0026U 11250000
&LOCCLS  SETA  &LOCRBA+4                OFFSET TO CLASS PTR    @PC0026U 11300000
&LOCWK   SETA  &LOCCLS+4                OFFSET TO WKAREA PTR   @PC0026U 11350000
&LOCVOL  SETA  &LOCWK+4                 OFFSET TO VOLUME PTR   @PC0026U 11400000
&LOCFDF  SETA  &LOCVOL+4                OFFSET TO FLDEF-OLD FORMAT @L8A 11450000
         AIF   (&RLVL LT 4).PEXT001                                @L8A 11500000
&LOCVER  SETA  &LOCVOL+4                OFFSET TO VERSION #        @L8A 11550000
&LOCWSP  SETA  &LOCVER+1                OFFSET TO SUBPOOL #        @L8A 11600000
&LOCXFLG SETA  &LOCWSP+1+2              OFFSET TO XTENDED FLAG     @L8A 11650000
&LOCACEE SETA  &LOCXFLG+4               OFFSET TO ACEE PTR         @L8A 11700000
&LOCSEGN SETA  &LOCACEE+4               OFFSET TO SEGMENT NAME     @L8A 11750000
&LOCNIPL SETA  &LOCSEGN+8               OFFSET TO NEXT IPL PTR     @L8A 11800000
&LOCRC   SETA  &LOCNIPL+4               OFFSET TO RETUEN CODE      @L8A 11850000
&LOCSR   SETA  &LOCRC+4                 OFFSET TO REASON CODE      @L8A 11900000
&LOCXWA  SETA  &LOCSR+4                 OFFSET TO DYN AREA PTR     @L8A 11950000
&LOCFDF  SETA  &LOCXWA+4+16             OFFSET TO FLDEF WORD   @PC0026U 12000000
.PEXT001 ANOP  ,                                                   @L8A 12050000
&F(18)   SETB  (&RLVL GE 4)                                        @L8A 12100000
         AIF   ('&INDEX' EQ 'ONLY').IND00                      @ZA87145 12150000
         AIF   ('&INDEX' EQ 'ASIS' OR '&INDEX' EQ '').IND01    @ZA87145 12200000
         AGO   .INDERR                                         @ZA87145 12250000
.IND00   ANOP                                                  @ZA87145 12300000
&F(17)   SETB  1                                               @ZA87145 12350000
.IND01   ANOP                                                  @ZA87145 12400000
         AIF   ('&GENERIC' EQ 'NO' OR '&GENERIC' EQ '').GEN01      @L5A 12450000
         AIF   ('&GENERIC' EQ 'YES').GEN00                         @L5A 12500000
         AIF   ('&GENERIC' NE 'UNCOND').GENERR                     @L5A 12550000
&F(21)   SETB  1                        SET GENERIC=UNCOND FLAG    @L5A 12600000
.GEN00   ANOP                                                      @L5A 12650000
&F(22)   SETB  1                        SET GENERIC=YES/UNCOND FLG @L5A 12700000
.GEN01   ANOP                                                      @L5A 12750000
&F(23)   SETB  0                        *** DO NOT CHANGE - THIS IS THE*12800000
                                        *** RACLIST FLAG           @L5A 12850000
&F(24)   SETB  1                        ASSUME SMC=YES.            @L4A 12900000
         AIF   ('&SMC' EQ 'YES' OR '&SMC' EQ '').SMC01             @L5A 12950000
         AIF   ('&SMC' NE 'NO').SMCERR                             @L4A 13000000
&F(24)   SETB  0                                                   @L4A 13050000
.SMC01   ANOP  ,                                                   @L4A 13100000
         AIF   (T'&OPTION EQ 'O' AND '&MF(1)' NE 'E').NOOPT             13150000
         AIF   (T'&OPTION EQ 'O' AND '&MF(1)' EQ 'E').OPOK              13200000
&F(1)    SETB  ('&OPTION' EQ 'LOCATE')                                  13250000
&F(2)    SETB  ('&OPTION' EQ 'NEXTC')   BYPASS QUAL CK ON NEXT @PC0026U 13300000
&F(3)    SETB  ('&OPTION' EQ 'NEXT' OR '&OPTION' EQ 'NEXTC')   @PC0026U 13350000
&F(4)    SETB  ('&OPTION' EQ 'ADD')                                     13400000
&F(5)    SETB  ('&OPTION' EQ 'RENAME')                                  13450000
&F(6)    SETB  ('&OPTION' EQ 'DELETE' OR '&OPTION' EQ 'DELETEA')        13500000
&F(7)    SETB  ('&OPTION' EQ 'ALTER' OR '&OPTION' EQ 'ALTERI')          13550000
&F(8)    SETB  ('&OPTION' EQ 'FLDEF')                                   13600000
&F(9)    SETB  ('&OPTION' EQ 'ALTERI')                                  13650000
&F(10)   SETB  ('&OPTION' EQ 'DELETEA') DELETE ALL IN TAPE SET @PC0026U 13700000
&I       SETA  1                                                        13750000
.CKOP    ANOP                                                           13800000
         AIF   (&F(&I)).OPOK                                            13850000
         AIF   (&I EQ &DIMF).INVOPT     ALL OPTIONS CHECKED?   @PC0026U 13900000
&I       SETA  &I+1                     INCREMENT OPTION INDEX @PC0026U 13950000
         AGO   .CKOP                                                    14000000
.OPOK    ANOP                                                           14050000
&OP      SETB  (T'&OPTIONS NE 'O')                                      14100000
         AIF   (NOT &OP).SKIPOPS                                        14150000
&I       SETA  1                                                        14200000
.CKOPS   ANOP                                                           14250000
         AIF   ('&OPTIONS(&I)' NE 'NOPRO').CKOP1                        14300000
&INOPRO  SETB  1                                                        14350000
         AGO   .CKNXTOP                                                 14400000
.CKOP1   ANOP                                                           14450000
         AIF   ('&OPTIONS(&I)' NE 'FLDEF').CKOP2                        14500000
&IFLDEF  SETB  1                                                        14550000
         AGO   .CKNXTOP                                                 14600000
.CKOP2   ANOP                                                           14650000
         AIF   ('&OPTIONS(&I)' NE 'ACTION').CKOP3                       14700000
&IACTION SETB  1                                                        14750000
         AGO   .CKNXTOP                                                 14800000
.CKOP3   ANOP                                                           14850000
         AIF   ('&OPTIONS(&I)' NE 'TESTC').CKOP4                        14900000
&ITESTC  SETB  1                                                        14950000
         AGO   .CKNXTOP                                                 15000000
.CKOP4   ANOP                                                           15050000
         AIF   ('&OPTIONS(&I)' NE 'TESTM').CKOP5                        15100000
&ITESTM  SETB  1                                                        15150000
         AGO   .CKNXTOP                                                 15200000
.CKOP5   ANOP                                                           15250000
         AIF   ('&OPTIONS(&I)' NE 'NOEXEC').CKOP6                       15300000
&INOEXEC SETB  1                                                        15350000
         AGO   .CKNXTOP                                                 15400000
.CKOP6   ANOP                                                           15450000
         AGO   .CKNXTOP                                                 15500000
.OPSERR  ANOP                                                           15550000
&MSG(4)  SETB  1                                                        15600000
         AGO   .EXIT                                                    15650000
.CKNXTOP ANOP                                                           15700000
&I       SETA  &I+1                                                     15750000
         AIF   (&I LE N'&OPTIONS).CKOPS                                 15800000
.SKIPOPS ANOP                                                           15850000
&NAM     SETC  'IHB&SYSNDX'                                             15900000
.PENT001 ANOP  ,                                                   @L8A 15950000
&EN      SETB  (T'&ENTRY NE 'O')                                        16000000
&ENX     SETB  (T'&ENTRYX NE 'O')        ENTRYX KEYWORD CODED?     @M1A 16050000
&WK      SETB  (T'&WKAREA NE 'O')                                       16100000
&AC      SETB  (T'&ACTIONS NE 'O')                                      16150000
&TE      SETB  (T'&TESTS NE 'O')                                        16200000
&TY      SETB  (T'&TYPE NE 'O')                                         16250000
&FD      SETB  (T'&FLDEF NE 'O')                                        16300000
&NN      SETB  (T'&NEWNAME NE 'O')                                      16350000
&NNX     SETB  (T'&NEWNAMX NE 'O')       NEWNAMX KEYWORD CODED?    @M2A 16400000
         AIF   (NOT &TY).NOTYPE         TYPE PRESENT?                   16450000
&T(1)    SETB  ('&TYPE' EQ '''GRP''')                                   16500000
&T(2)    SETB  ('&TYPE' EQ '''USR''')                                   16550000
&T(3)    SETB  ('&TYPE' EQ '''CON''')                                   16600000
&T(4)    SETB  ('&TYPE' EQ '''DS''')                                    16650000
&T(5)    SETB  ('&TYPE' EQ '''GEN''')                                   16700000
&I       SETA  1                                                        16750000
.LBL001  ANOP                                                           16800000
&ET      SETA  &ET+&I*&T(&I)                                            16850000
&I       SETA  &I+1                                                     16900000
         AIF   (&I LE &DIMT).LBL001      ALL TYPES CHECKED?    @PC0026U 16950000
         AIF   (&ET EQ 0 AND '&TYPE' NE '''ANY''').INVTYP               17000000
.NOTYPE  ANOP                                                           17050000
&FG(1)   SETA  (64*&F(1)+32*&F(2)+16*&F(3)+8*&F(4)+4*&F(5))    @PC0026U 17100000
&FG(2)   SETA  (128*&F(6)+64*&F(10)+8*&F(7)+4*&F(9))           @PC0026U 17150000
&FG(3)   SETA  128*&F(17)+64*&F(18)+32*&F(19)+16*&F(20)+8*&F(21)+4*&F(2*17200000
               2)+0*&F(23)+1*&F(24)  NOTE THE "0" MULTIPLIER       @L5A 17250000
&NA      SETA  N'&ACTIONS               NO. OF ACTIONS.                 17300000
&NT      SETA  (N'&TESTS+1)/2           NO. OF TESTS.                   17350000
         AIF   (&NT EQ 0).LF00                                          17400000
&I       SETA  (&NT*2)-1                                                17450000
         AIF   (&I NE N'&TESTS).TSTERR                                  17500000
.LF00    ANOP                                                           17550000
         AIF   (&WK AND &NN).MUTUAL    BOTH WKAREA AND NEWNAME @PC0026U 17600000
         AIF   (&WK AND &NNX).MUTUAL   BOTH WKAREA AND NEWNAMX     @M2A 17650000
         AIF   (T'&WKAREA EQ 'O' AND T'&NEWNAME EQ 'O').LF00A    @L4A   17700000
         AIF   (T'&OPTION EQ 'O').LF00A                          @L4A   17750000
         AIF   ('&OPTION' EQ 'LOCATE' OR '&OPTION' EQ 'NEXT' OR        *17800000
               '&OPTION' EQ 'NEXTC' OR '&OPTION' EQ 'RENAME').LF00A     17850000
         AGO   .CONFLIC                                          @L4A   17900000
.LF00A   ANOP  ,                                                 @L4A   17950000
         AIF   (&RLVL LT 4).PMF0001                                @L8A 18000000
.*       EXTENDED FORM PARAMETERS                                  @L8A 18050000
&XF(1)   SETB  (T'&ENTRYX NE 'O')      EXTENDED FORMAT ENTRY       @M1A 18100000
&XND(1)  SETB  (NOT (T'&ENTRY NE 'O'))                             @L8A 18150000
         AIF   (T'&FLDACC EQ 'O').PDMP000,                         @P1C*18200000
               ('&FLDACC' EQ 'NO').PFLC001,                        @P1C*18250000
               ('&FLDACC' EQ 'YES').PFLC001                        @P1C 18300000
         AGO   .FLACERR                                            @L8A 18350000
.PFLC001 ANOP  ,                                                   @L8A 18400000
&XF(2)   SETB  ('&FLDACC' EQ 'YES') FLAG=YES                       @P1C 18450000
&XND(2)  SETB  (NOT ('&FLDACC' EQ 'NO'))                           @P1C 18500000
.PDMP000 ANOP  ,                                                   @L8A 18550000
         AIF   (T'&DATAMAP EQ 'O').PWSP000,                            *18600000
               ('&DATAMAP' EQ 'OLD').PDMP001,                          *18650000
               ('&DATAMAP' EQ 'NEW').PDMP001                            18700000
         AGO   .DMPERR                                             @L8A 18750000
.PDMP001 ANOP  ,                                                   @L8A 18800000
&XF(3)   SETB  ('&DATAMAP' EQ 'OLD')                               @P4C 18850000
&XND(3)  SETB  (NOT ('&DATAMAP' EQ 'NEW'))                         @L8A 18900000
.PWSP000 ANOP  ,                                                   @L8A 18950000
&XF(4)   SETB  (T'&WKSP NE 'O' AND '&WKSP' NE '''NONE''')          @L8A 19000000
&XND(4)  SETB  (NOT ('&WKSP'  EQ '''NONE'''))                      @L8A 19050000
         AIF   (T'&RUN     EQ 'O').PXNN001,                            *19100000
               ('&RUN'     EQ 'NO').PRUN001,                           *19150000
               ('&RUN'     EQ 'YES').PRUN001                       @M2C 19200000
         AGO   .RUNERR                                             @L8A 19250000
.PRUN001 ANOP  ,                                                   @L8A 19300000
&XF(5)   SETB  ('&RUN' EQ 'NO')      RUN=NO                        @L8A 19350000
&XND(5)  SETB  (NOT ('&RUN'   EQ 'YES'))                           @L8A 19400000
.PXNN001 ANOP  ,                                                   @M2A 19450000
&XF(6)   SETB  (T'&NEWNAMX NE 'O')     EXTENDED FORMAT NEWNAME     @M2A 19500000
&XND(6)  SETB  (NOT (T'&NEWNAME NE 'O'))                           @M2A 19550000
         AIF   (T'&DATEFMT EQ 'O').SETFG01,                            *19560000
               ('&DATEFMT'  EQ 'YYDDDF').SETFG01,                      *19570000
               ('&DATEFMT'  NE 'YYYYDDDF').DATERR                  @03A 19580000
&XF(16)  SETB  1                                                   @03A 19590000
.SETFG01 ANOP  ,                                                   @L8A 19600000
&FG(4)   SETA  128*&XF(1)+64*&XF(2)+32*&XF(3)+16*&XF(4)+8*&XF(5)+4*&XF(*19650000
               6)                                                  @M2C 19700000
&FG(5)   SETA  128*&XF(9)+64*&XF(10)+32*&XF(11)+16*&XF(12)+8*&XF(13)+4*X19716600
               &XF(14)+2*&XF(15)+&XF(16)                           @03A 19733200
&SUBPOOL SETC  '0'                  DEFAULT SUBPOOL TO ZERO        @L8A 19750000
         AIF   (T'&WKSP EQ 'O' OR '&WKSP' EQ '''NONE''').PMF0001   @L8A 19800000
&SUBPOOL SETC '&WKSP'                                              @L8A 19850000
.PMF0001 ANOP  ,                                                   @L8A 19900000
.*       I-FORM NOT ALLOWED WITH FLDEF OPTION.....                      19950000
         AIF   (&F(8) AND ('&MF' EQ 'I')).FLDF1                         20000000
         AIF   ('&MF(1)' EQ 'E').EFORM                                  20050000
         AIF   ('&MF' EQ 'L').LFORM                                     20100000
&GENREG  SETC  '1'                      USE REG 1 AS DEFAULT REGISTER.  20150000
.*                                                                      20200000
.*                                                                      20250000
.*       ENTRY OR ENTRYX REQUIRED FOR I-FORM.                      @M1C 20300000
         AIF   ((NOT &EN) AND (NOT &ENX)).ENMISS                   @M1C 20350000
         AIF   (NOT &F(5)).CK00         RENAME?                         20400000
.*       NEW NAME AND EITHER ENTRY OR ENTRYX SUPPLIED?             @M1A 20450000
         AIF   ((&NN OR &NNX) AND (&EN OR &ENX)).CK01              @M2C 20500000
         AGO   .RENAM1                  QUIT IF NO.                     20550000
.CK00    ANOP  ,                        WORKAREA REQUIRED FOR NEXT,LC.  20600000
         AIF   (NOT &F(3) AND NOT &F(1)).CK01                           20650000
         AIF   (NOT &WK).WKMISS                                         20700000
.CK01    ANOP                                                           20750000
         CNOP  0,4                                                      20800000
&NAME    BAL   &GENREG,&NAM.B                                           20850000
         AGO   .LFORM1                                                  20900000
.LFORM   ANOP  ,                        CODE COMMON TO L AND I FORMS.   20950000
&NAME    DS    0F                                                       21000000
         AIF   (&F(8)).LF20             FLDEF OPTION?                   21050000
.LFORM1  ANOP                                                           21100000
         ICHEIN &FG(1),LEN=1,FM=&MF,OPCODE=DC,                         *21150000
               CMT='IPLOPT1.'                                           21200000
         ICHEIN &FG(2),LEN=1,FM=&MF,OPCODE=DC,                         *21250000
               CMT='IPLOPT2.'                                           21300000
         ICHEIN &FG(3),LEN=1,FM=&MF,OPCODE=DC,                         *21350000
               CMT='IPLOPT3.'                                      @L4A 21400000
         ICHEIN &ET,LEN=1,FM=&MF,OPCODE=DC,                            *21450000
               CMT='ENTRY TYPE.'                                        21500000
         ICHEIN &ENTRY&ENTRYX,LEN=4,FM=&MF,OPCODE=DC,              @M1C*21550000
               CMT='ENTRY.'                                        @L8A 21600000
         AIF   (T'&FLDEF NE 'O').LF15                          @ZA61787 21650000
         ICHEIN &NAM.C,LEN=4,FM=&MF,OPCODE=DC,                         *21700000
               CMT='FLDEF PTR.'                                @PC0026U 21750000
         AGO   .LF17                                           @ZA61787 21800000
.LF15    ANOP                                                  @ZA61787 21850000
         ICHEIN &FLDEF,LEN=4,FM=&MF,OPCODE=DC,                         *21900000
               CMT='FLDEF PTR.'                                @ZA61787 21950000
.LF17    ANOP                                                  @ZA61787 22000000
         ICHEIN &RBA,LEN=4,FM=&MF,OPCODE=DC,                           *22050000
               CMT='POINTER TO RBA'                            @PC0026U 22100000
         ICHEIN &CLASS,LEN=4,FM=&MF,OPCODE=DC,                         *22150000
               CMT='ADDR OF ENTITY CLASS'                      @PC0026U 22200000
         ICHEIN &WKAREA&NEWNAME&NEWNAMX,LEN=4,FM=&MF,OPCODE=DC,        *22250000
               CMT='WORK AREA OR NEWNAME'                          @M2C 22300000
         ICHEIN &VOLUME,LEN=4,FM=&MF,OPCODE=DC,                        *22350000
               CMT='POINTER TO VOLUME'                         @PC0026U 22400000
         AIF   (&RLVL LT 4).DFLD001     SKIP ON XTENDED DEFINITION @L8A 22450000
         ICHEIN 1,LEN=1,FM=&MF,OPCODE=DC,                              *22500000
               CMT='VERSION NUMBER'                                @L8A 22550000
         ICHEIN &SUBPOOL,LEN=1,FM=&MF,OPCODE=DC,                       *22600000
               CMT='SUBPOOL NUMBER'                                @L8A 22650000
         ICHEIN 0,LEN=2,FM=&MF,OPCODE=DC,                              *22700000
               CMT='RESERVED'                                      @L8A 22750000
         ICHEIN &FG(4),LEN=1,FM=&MF,OPCODE=DC,                         *22800000
               CMT='FLAGS'                                         @L8A 22850000
         ICHEIN &FG(5),LEN=1,FM=&MF,OPCODE=DC,                         *22880000
               CMT='FLAGS'                                         @03A 22910000
         ICHEIN 0,LEN=2,FM=&MF,OPCODE=DC,                              *22940000
               CMT='FLAGS'                                         @03C 22970000
         ICHEIN &ACEE,LEN=4,FM=&MF,OPCODE=DC,                          *23000000
               CMT='ACEE'                                          @L8A 23050000
         ICHEIN &SEGMENT,LEN=8,FM=&MF,OPCODE=DC,TYPE=C,                *23100000
               CMT='SEGMENT'                                       @L8A 23150000
         ICHEIN &CHAIN,LEN=4,FM=&MF,OPCODE=DC,                         *23200000
               CMT='NEXT IPL'                                      @L8A 23250000
         ICHEIN 0,LEN=4,FM=&MF,OPCODE=DC,                              *23300000
               CMT='RETURN CODE'                                   @L8A 23350000
         ICHEIN 0,LEN=4,FM=&MF,OPCODE=DC,                              *23400000
               CMT='REASON CODE'                                   @L8A 23450000
         ICHEIN 0,LEN=4,FM=&MF,OPCODE=DC,                              *23500000
               CMT='DYNAMIC AREA ADDRESS'                          @L8A 23550000
         ICHEIN 0,LEN=4,FM=&MF,OPCODE=DC,                              *23600000
               CMT='RESERVED'                                      @L8A 23650000
         ICHEIN 0,LEN=4,FM=&MF,OPCODE=DC,                              *23700000
               CMT='RESERVED'                                      @L8A 23750000
         ICHEIN 0,LEN=4,FM=&MF,OPCODE=DC,                              *23800000
               CMT='RESERVED'                                      @L8A 23850000
         ICHEIN 0,LEN=4,FM=&MF,OPCODE=DC,                              *23900000
               CMT='RESERVED'                                      @L8A 23950000
.DFLD001 ANOP  ,                        START FLFEF SECTION        @L8A 24000000
&NAM.C   EQU   *                        END OF FIXED LENGTH LIST        24050000
.LF20    ANOP                                                           24100000
.*       IGNORE TESTS AND ACTIONS IF REMOTE FLDEF SPECIFIED.            24150000
         AIF   (T'&FLDEF NE 'O').LF23                                   24200000
         ICHEIN 0,LEN=1,FM=&MF,OPCODE=DC,CMT='RESERVED.'                24250000
         ICHEIN &NT,LEN=1,FM=&MF,OPCODE=DC,                            *24300000
               CMT='MAX NO. TESTS.'                                     24350000
.*                                      MAXIMUM NO. OF TESTS.           24400000
         ICHEIN &NT,LEN=1,FM=&MF,OPCODE=DC,                            *24450000
               CMT='CURRENT NO. TESTS.'                                 24500000
.*                                      CURRENT NO. OF TESTS.           24550000
         ICHEIN &NA,LEN=1,FM=&MF,OPCODE=DC,                            *24600000
               CMT='NO. ACTIONS.'                                       24650000
.*                                      NUMBER OF ACTIONS.              24700000
         AIF   (&NT EQ 0).LF21          TESTS?                          24750000
&LOCTST  SETA  &LOCFDF+4                OFFSET TO START OF TESTS.       24800000
&I       SETA  1                                                        24850000
.LF22    ANOP  ,                        PROCESS TESTS.                  24900000
         AIF   (&I GT N'&TESTS).LF21                                    24950000
         ICHEIN &TESTS(&I),LEN=4,FM=&MF,OPCODE=DC,                     *25000000
               CMT='TEST.'                                              25050000
&I       SETA  &I+2                                                     25100000
         AGO   .LF22                                                    25150000
.LF21    ANOP  ,                        PROCESS ACTIONS.                25200000
&LOCAC   SETA  &LOCFDF+4+&NT*4                                          25250000
         AIF   (&NA EQ 0).LF23          ACTIONS?                        25300000
&I       SETA  1                                                        25350000
.LF24    ANOP  ,                                                        25400000
         AIF   (&I GT N'&ACTIONS).LF23                                  25450000
         ICHEIN &ACTIONS(&I),LEN=4,FM=&MF,OPCODE=DC,                   *25500000
               CMT='ACTION.'                                            25550000
&I       SETA  &I+1                                                     25600000
         AGO   .LF24                                                    25650000
.LF23    ANOP  ,                                                        25700000
         AIF   ('&MF' NE 'L').LF25                                      25750000
         AGO   .EXIT                    CLEANUP PROCESSING.             25800000
.*                                                                      25850000
.*                                                                      25900000
.LF25    ANOP  ,                        PROCESS I-FORM.                 25950000
&NAM.B   DS    0H                                                       26000000
.LF26    ANOP  ,                                                        26050000
.*                                      GENERATE ENTRY KEYWORD.         26100000
         ICHEIN &ENTRY&ENTRYX,LEN=4,FM=&MF,OPCODE=ST,OFFSET=&LOCEN,    *26150000
               CMT='ENTRY.',                                           *26200000
               REG=&GENREG                                         @M1C 26250000
.*                                      GENERATE FLDEF PTR.             26300000
         ICHEIN &FLDEF,LEN=4,FM=&MF,OPCODE=ST,OFFSET=&LOCFDP,          *26350000
               CMT='FLDEF PTR.',                                       *26400000
               REG=&GENREG                                              26450000
.*                                      GENERATE RBA KEYWORD.           26500000
         ICHEIN &RBA,LEN=4,FM=&MF,OPCODE=ST,OFFSET=&LOCRBA,            *26550000
               CMT='RBA PTR.',                                         *26600000
               REG=&GENREG                                              26650000
.*                                      GENERATE CLASS KEYWORD.         26700000
         ICHEIN &CLASS,LEN=4,FM=&MF,OPCODE=ST,OFFSET=&LOCCLS,          *26750000
               CMT='CLASS.',REG=&GENREG                        @PC0026U 26800000
.*                                      GENERATE WKAREA PTR.            26850000
         ICHEIN &WKAREA&NEWNAME&NEWNAMX,LEN=4,FM=&MF,OPCODE=ST,        *26900000
               OFFSET=&LOCWK,CMT='WORK AREA OR NEWNAME.',              *26950000
               REG=&GENREG                                         @M2C 27000000
.*                                      GENERATE VOLUME KEYWORD.        27050000
         ICHEIN &VOLUME,LEN=4,FM=&MF,OPCODE=ST,OFFSET=&LOCVOL,         *27100000
               CMT='VOLUME POINTER.',REG=&GENREG               @PC0026U 27150000
         AIF   (&RLVL LT 4).UFLD001                                @L8A 27200000
.*                                                                      27250000
         AIF    ((T'&WKSP EQ 'O') OR ('&MF(1)' NE 'E')).UACE001         27300000
         ICHEIN &SUBPOOL,LEN=1,FM=&MF,OPCODE=MVI,OFFSET=&LOCWSP,       *27350000
               CMT='SUBPOOL NUMBER'                                @L8A 27400000
.UACE001 ANOP   ,                                                  @L8A 27450000
         ICHEIN &ACEE,LEN=4,FM=&MF,OPCODE=ST,OFFSET=&LOCACEE,          *27500000
               CMT='ACEE   POINTER.',REG=&GENREG                   @L8A 27550000
         ICHEIN &SEGMENT,LEN=8,FM=&MF,OPCODE=MVC,OFFSET=&LOCSEGN,      *27600000
               CMT='SEGMENT NAME',TYPE=C                           @L8A 27650000
         ICHEIN &CHAIN,LEN=4,FM=&MF,OPCODE=ST,OFFSET=&LOCNIPL,         *27700000
               CMT='NEXT IPL PTR',REG=&GENREG                      @L8A 27750000
.*                                                                 @L8A 27800000
.UFLD001 ANOP  ,                                                   @L8A 27850000
         AIF   (NOT &IFLDEF).LF51       FLDEF RELOCATION?        @L4A   27900000
         ICHEIN &LOCFDF.(&GENREG),LEN=4,FM=&MF,OPCODE=ST,              *27950000
               CMT='FLDEF RELOCATION.',                                *28000000
               OFFSET=&LOCFDP,REG=&GENREG                               28050000
.LF51    ANOP  ,                        EP FOR FLDEF E-FORM PRECESS.    28100000
         AIF   (NOT &ITESTM).LF75       SET MAX NO. TESTS?              28150000
         ICHEIN &NT,LEN=1,FM=&MF,OPCODE=MVI,OFFSET=&LOCFDF+1,          *28200000
               CMT='MAX NO. TESTS.',                                   *28250000
               REG=&GENREG                                              28300000
         AGO   .LF76                                                    28350000
.LF75    ANOP                                                           28400000
         AIF   (NOT &ITESTC).LF77       SET NO. CURRENT NO OF TESTS?    28450000
.LF76    ANOP  ,                        TESTM REQUEST ALSO ENTERS HERE. 28500000
         ICHEIN &NT,LEN=1,FM=&MF,OPCODE=MVI,OFFSET=&LOCFDF+2,          *28550000
               CMT='CURRENT NO. TESTS.',                               *28600000
               REG=&GENREG                                              28650000
.LF77    ANOP                                                           28700000
         AIF   (&NT EQ 0).LF27          TESTS?                          28750000
&I       SETA  1                                                        28800000
&J       SETA  0                        OFFSET FROM LOCTST              28850000
.LF28    ANOP  ,                        PROCESS TEST.                   28900000
         AIF   (&I GT N'&TESTS).LF27                                    28950000
         ICHEIN &TESTS(&I),LEN=4,FM=&MF,OPCODE=ST,OFFSET=&LOCTST+&J,   *29000000
               CMT='TEST.',                                            *29050000
               REG=&GENREG                                              29100000
&J       SETA  &J+4                     NEXT OFFSET.                    29150000
&I       SETA  &I+2                     NEXT TEST.                      29200000
         AGO   .LF28                                                    29250000
.LF27    ANOP  ,                        PROCESS ACTIONS.                29300000
         AIF   (NOT &IACTION).LF74      SET ACTION COUNT?               29350000
         ICHEIN &NA,LEN=1,FM=&MF,OPCODE=MVI,OFFSET=&LOCFDF+3,          *29400000
               CMT='NO. ACTIONS.',                                     *29450000
               REG=&GENREG                                              29500000
.LF74    ANOP                                                           29550000
         AIF   (&NA EQ 0).LF29          ACTIONS?                        29600000
&I       SETA  1                                                        29650000
&J       SETA  0                                                        29700000
.LF30    ANOP                                                           29750000
         AIF   (&I GT N'&ACTIONS).LF29                                  29800000
         ICHEIN &ACTIONS(&I),LEN=4,FM=&MF,OPCODE=ST,OFFSET=&LOCAC+&J,  *29850000
               CMT='ACTION.',                                          *29900000
               REG=&GENREG                                              29950000
&J       SETA  &J+4                     NEXT OFFSET.                    30000000
&I       SETA  &I+1                     NEXT ACTION.                    30050000
         AGO   .LF30                                                    30100000
.LF29    ANOP                                                           30150000
         AIF   (&F(8)).EXIT             QUIT IF FLDEF OPTION.           30200000
         AIF   (&INOEXEC).EXIT                                          30250000
         SVC   &INVSVC                                                  30300000
         AIF   ((NOT &RLVLCHK) OR ('&MF(1)' NE 'E')).EXIT          @L8A 30350000
&ICHERLV DS    0H                                                  @L8A 30400000
         AGO   .EXIT                                               @L8A 30450000
.LF40    ANOP                                                           30500000
.*                                                                      30550000
.*                                                                      30600000
.EFORM   ANOP  ,                                                        30650000
.*                                      BEGIN E-FORM PROCESSING.        30700000
         AIF   ('&NAME' EQ '').EFORM1                                   30750000
&NAME    CNOP  0,4                                                      30800000
.EFORM1  ANOP                                                           30850000
         AIF   (N'&MF LE 1).INVMF                                       30900000
         AIF   ('&MF(2)'(1,1) NE '(').LF46                              30950000
&I       SETA  K'&MF(2)                                                 31000000
         AIF   (&I LE 2).INVMF                                          31050000
&I       SETA  &I-2                                                     31100000
&GENREG  SETC '&MF(2)'(2,&I)                                            31150000
         AIF   ('&GENREG' EQ '1').LF42                                  31200000
         LR    1,&MF(2)                                                 31250000
         AGO   .LF42                                                    31300000
.LF46    ANOP                                                           31350000
&GENREG  SETC '1'                       REGISTER 1 DEFAULT.             31400000
         LA    &GENREG,&MF(2)                                           31450000
.LF42    ANOP  ,                                                        31500000
         AIF   ((NOT &RLVLCHK) OR                                      *31550000
               (&RLVL LT 4)    OR                                      *31600000
               (&INOEXEC)      OR                                      *31650000
               ('&OPTION' EQ 'FLDEF')).UFDF001                     @L8A 31700000
&ICHERLV SETC  'ICHE&SYSNDX'                                       @L8A 31750000
         TM    2(1),X'40'               LIST FORM XTENDED FORMAT?  @L8A 31800000
         BO    *+12                     YES, GO ON                 @01C 31850000
         LA    15,100                   INCOMPATIBLE RELEASE       @L8A 31900000
         B     &ICHERLV                 SKIP SVC INVOKATION        @L8A 31950000
.UFDF001 ANOP  ,                                                   @L8A 32000000
         AIF   (NOT &F(8)).LF50         FLDEF OPTION?                   32050000
&LOCFDF  SETA  0                        OFFSET TO FLDEF WORD.           32100000
.LF50    ANOP  ,                                                        32150000
&LOCTST  SETA  &LOCFDF+4                OFFSET TO START OF TESTS.       32200000
&LOCAC   SETA  &LOCFDF+4+&NT*4          OFFSET TO START OF ACTIONS.     32250000
.LF81    ANOP  ,                        EP FROM FLDEF OPTION.           32300000
         AIF   (&F(8)).LF51             GO HANDLE ACTIONS AND TESTS.    32350000
         AIF   (NOT &OP).LF7303         OPTIONS CODED?                  32400000
.*       FLDEF KEYWORD AND SUBLIST ITEM ARE CONFLICTING.                32450000
         AIF   (&FD AND &IFLDEF).FLDF2                                  32500000
         AIF   (&INOPRO).NOSETOP        PROLOGUE CODE REQUIRED?         32550000
.LF7303  ANOP  ,                                                        32600000
         AIF   (T'&OPTION EQ 'O').NOSETOP                          @L5A 32650000
         ICHEIN &FG(1),FM=&MF,OPCODE=MVI,OFFSET=0,LEN=1,               *32700000
               CMT='SET IPLOPT1.',                                     *32750000
               REG=&GENREG                                              32800000
         ICHEIN &FG(2),LEN=1,FM=&MF,OPCODE=MVI,OFFSET=1,               *32850000
               CMT='SET IPLOPT2.',                                     *32900000
               REG=&GENREG                                              32950000
.NOSETOP ANOP  ,                                                   @L5A 33000000
&AAND(1) SETA  1                                               @ZA87145 33050000
&AAND(2) SETA  1                                               @ZA87145 33100000
&AAND(3) SETA  1                                               @ZA87145 33150000
&AAND(4) SETA  1                                               @ZA87145 33200000
&AAND(5) SETA  1                                               @ZA87145 33250000
&AAND(6) SETA  1                                               @ZA87145 33300000
&AAND(7) SETA  1                                               @ZA87145 33350000
&AAND(8) SETA  1                                               @ZA87145 33400000
.* BUILD MASKS FOR 'AND' AND 'OR' OF IPLOPT3                       @L5A 33450000
         AIF   ('&INDEX' NE 'ONLY').X01                        @ZA87145 33500000
&AOR(1)  SETA  1                                               @ZA87145 33550000
.X01     AIF   ('&INDEX' NE 'ASIS').X02                        @ZA87145 33600000
&AAND(1) SETA  0                                               @ZA87145 33650000
.X02     ANOP                                                  @ZA87145 33700000
         AIF   ('&RELEASE(1)' NE '1.7').X02G                       @L8A 33750000
&AAND(2) SETA  0                                                   @L8A 33800000
.X02G    ANOP  ,                                                   @L8A 33850000
&AOR(2)  SETA  0                                                   @L8A 33900000
         AIF   ('&GENERIC' NE 'UNCOND').X05                        @L5A 33950000
&AOR(5)  SETA  1                                                   @L5A 34000000
&AOR(6)  SETA  1                                                   @L5A 34050000
.X05     AIF   ('&GENERIC' NE 'YES').X10                       @ZA87145 34100000
&AAND(5) SETA  0                                               @ZA87145 34150000
&AOR(6)  SETA  1                                                   @L5A 34200000
.X10     AIF   ('&GENERIC' NE 'NO').X20                            @L5A 34250000
&AAND(5) SETA  0                                               @ZA87145 34300000
&AAND(6) SETA  0                                               @ZA87145 34350000
.X20     AIF   ('&SMC' NE 'YES').X30                               @L5A 34400000
&AOR(8)  SETA  1                                                   @L5A 34450000
.X30     AIF   ('&SMC' NE 'NO').X40                                @L5A 34500000
&AAND(8) SETA  0                                               @ZA87145 34550000
.X40     ANOP                                                      @L5A 34600000
.* IF NECESSARY, ISSUE 'AND' INSTRUCTION TO RESET FLAGS IN IPLOPT3 @L5A 34650000
&FG(3)   SETA  128*&AAND(1)+64*&AAND(2)+32*&AAND(3)+16*&AAND(4)+8*&AANDX34700000
               (5)+4*&AAND(6)+2*&AAND(7)+&AAND(8)              @ZA87145 34750000
         AIF   (&FG(3) EQ 255).X1000                               @L5A 34800000
         ICHEIN &FG(3),LEN=1,FM=&MF,OPCODE=NI,OFFSET=2,                *34850000
               CMT='SET IPLOPT3.',                                     *34900000
               REG=&GENREG                                         @L5A 34950000
.X1000   ANOP                                                      @L5A 35000000
.* IF NECESSARY, ISSUE 'OR' INSTRUCTION TO RESET FLAGS IN IPLOPT3  @L5A 35050000
&FG(3)   SETA  128*&AOR(1)+64*&AOR(2)+32*&AOR(3)+16*&AOR(4)+8*&AOR(5)+4X35100000
               *&AOR(6)+2*&AOR(7)+&AOR(8)                          @L5A 35150000
         AIF   (&FG(3) EQ 0).X2000                                 @L5A 35200000
         ICHEIN &FG(3),LEN=1,FM=&MF,OPCODE=OI,OFFSET=2,                *35250000
               CMT='SET IPLOPT3.',                                     *35300000
               REG=&GENREG                                         @L5A 35350000
.X2000   ANOP                                                      @L5A 35400000
.NOSETO3 ANOP ,                                                    @L5A 35450000
         AIF   (NOT &TY).LF7301                                         35500000
         ICHEIN &ET,LEN=1,FM=&MF,OPCODE=MVI,OFFSET=3,                  *35550000
               CMT='SET ENTRY CODE.',                                  *35600000
               REG=&GENREG                                              35650000
.LF7301  ANOP  ,                                                        35700000
         AIF   (&RLVL LT 4).LF26                                   @L8A 35750000
&INVFG   SETA  128*&XND(1)+64*&XND(2)+32*&XND(3)+16*&XND(4)+8*&XND(5)+4X35800000
               *&XND(6)+2*&XND(7)+&XND(8)                          @L8A 35850000
         AIF   (&INVFG EQ 255).PFG4001  NO NI REQUIERED            @L8A 35900000
         ICHEIN &INVFG,LEN=1,FM=&MF,OPCODE=NI,OFFSET=&LOCXFLG,         *35950000
               CMT='SET XTENDED FLAG-1',                               *36000000
               REG=&GENREG                                         @L8A 36050000
.PFG4001 ANOP  ,                                                   @L8A 36100000
         AIF   (&FG(4) EQ 0).PFG4002  NO OI REQUIERED              @L8A 36150000
         ICHEIN &FG(4),LEN=1,FM=&MF,OPCODE=OI,OFFSET=&LOCXFLG,         *36200000
               CMT='SET XTENDED FLAG-1',                               *36250000
               REG=&GENREG                                         @L8A 36300000
.PFG4002 ANOP  ,                                                   @L8A 36350000
         AIF   ('&DATEFMT' NE 'YYDDDF').PDFMT01                    @03A 36352700
&XND(16) SETB  0                                                   @03A 36355400
.PDFMT01 ANOP  ,                                                   @03A 36358100
&FG(5)   SETA  128*&XF(9)+64*&XF(10)+32*&XF(11)+16*&XF(12)+8*&XF(13)+4*X36360800
               &XF(14)+2*&XF(15)+&XF(16)                           @03A 36363500
         AIF   (&FG(5) EQ 0).PDFMT03  NO OI REQUIRED               @03A 36366200
         ICHEIN &FG(5),LEN=1,FM=&MF,OPCODE=OI,OFFSET=&LOCXFLG+1,       *36368900
                CMT='SET DATEFMT FLAG',                                *36371600
                REG=&GENREG                                        @03A 36374300
.PDFMT03 ANOP  ,                                                   @03A 36377000
&FG(5)   SETA  128*&XND(9)+64*&XND(10)+32*&XND(11)+16*&XND(12)+8*&XND(1X36379700
               3)+4*&XND(14)+2*&XND(15)+&XND(16)                   @03A 36382400
         AIF   (&FG(5) EQ 255).PFG4003  NO NI REQUIRED             @03A 36385100
         ICHEIN &FG(5),LEN=1,FM=&MF,OPCODE=NI,OFFSET=&LOCXFLG+1,       *36387800
               CMT='SET DATEFMT FLAG',                                 *36390500
               REG=&GENREG                                         @03A 36393200
.PFG4003 ANOP  ,                                                   @03A 36395900
         AGO   .LF26                    GENERATE REMAINDER OF CODE.     36400000
.*                                                                      36450000
.*                                                                      36500000
.CONFLIC MNOTE 12,'WKAREA OR NEWNAME CONFLICT WITH REQUEST TYPE.' @L4A  36550000
         MEXIT                                                          36600000
.RENAM1  MNOTE 12,'RENAME REQUIRES ENTRY AND NEWNAME OPTIONS.'          36650000
         MEXIT                                                          36700000
.MUTUAL  MNOTE 12,'KEYWORDS WORKAREA AND NEWNAME OR NEWNAMX BOTH SPECIF*36750000
               IED.'                                               @M2C 36800000
         MEXIT                                                          36850000
.INVTYP  MNOTE 12,'* INVALID TYPE PARAMETER.'                           36900000
         MEXIT                                                          36950000
.INVMF   MNOTE 12,'* INVALID MF PARAMETER -- &MF.'                      37000000
         MEXIT                                                          37050000
.ENMISS  MNOTE 12,'* ENTRY OR ENTRYX PARAMETER REQUIRED.'          @M1C 37100000
         MEXIT                                                          37150000
.INVOPT  MNOTE 12,'* INVALID OPTION -- &OPTION.'                        37200000
         MEXIT                                                          37250000
.WKMISS  MNOTE 12,'* WKAREA PARAMETER REQUIRED.'                        37300000
         MEXIT                                                          37350000
.TSTERR  MNOTE 12,'TEST KEYWORD CONTAINS INVALID NUMBER OF ITEMS.'      37400000
         MEXIT                                                          37450000
.FLDF1   MNOTE 12,'I-FORM NOT SUPPORTED FOR FLDEF OPTION.'              37500000
         MEXIT                                                          37550000
.FLDF2   MNOTE 12,'FLDEF KEYWORD AND FLDEF ITEM ARE CONFLICTING.'       37600000
         MEXIT                                                          37650000
.FLDF3   MNOTE 12,'FLDEF ITEM ONLY LEGAL WITH LOCATE,NEXT OR RENAME.'   37700000
         MEXIT                                                          37750000
.NOOPT   MNOTE     12,'OPTION POSITIONAL PARAMETER REQUIRED.'           37800000
         MEXIT                                                          37850000
.SMCERR  MNOTE 12,'SMC KEYWORD MUST HAVE A VALUE OF ''YES'' OR ''NO'''  37900000
         MEXIT                                                     @L4A 37950000
.GENERR  MNOTE 12,'GENERIC KEYWORD MUST HAVE A VALUE OF ''NO'', ''YES''*38000000
               , OR ''UNCOND'''                                    @L5A 38050000
         MEXIT                                                     @L5A 38100000
.INDERR  MNOTE 12,'INDEX KEYWORD MUST HAVE A VALUE OF ''ONLY'' OR ''ASIX38150000
               S'''                                            @ZA87145 38200000
         MEXIT                                                 @ZA87145 38250000
.FLACERR MNOTE 12,'FLDACC KEYWORD MUST HAVE A VALUE OF ''YES'' OR ''NO'*38300000
               ''                                                  @P1C 38350000
         MEXIT                                                     @L8A 38400000
.DMPERR  MNOTE 12,'DATAMAP KEYWORD MUST HAVE A VALUE OF ''OLD'' OR ''NE*38450000
               W'''                                                @L8A 38500000
         MEXIT                                                     @L8A 38550000
.RUNERR  MNOTE 12,'RUN KEYWORD MUST HAVE A VALUE OF ''YES'' OR ''NO'''  38600000
         MEXIT                                                     @L8A 38650000
.DATERR  MNOTE 12,'DATEFMT KEYWORD MUST HAVE A VALUE OF ''YYDDDF'' OR '*38662500
               'YYYYDDDF'''                                        @03A 38675000
         MEXIT                                                     @03A 38687500
.EXIT    ANOP  ,                        WARNINGS, IF ANY.               38700000
         AIF   (&MSG(4) EQ 0).CKMSG5                                    38750000
.M04     MNOTE 12,'ILLEGAL ITEM IN OPTIONS LIST - &OPTIONS .'           38800000
.CKMSG5  ANOP                                                           38850000
         AIF   (&MSG(5) EQ 0).EXITE                                     38900000
.M05     MNOTE 12,'OPTIONS KEYWORD REQUIRED.'                           38950000
         AGO   .EXITE                                              @L8A 39000000
.ERLVL1  MNOTE 8,'*** INCORRECT SPECIFICATION OF ''RELEASE'' ***'  @L8A 39050000
         AGO   .ERLVL1R                                            @L8A 39100000
.INC000  MNOTE 4,'*** ''RELEASE'' INCOMPATIBLE WITH SPECIFIED KEYWORD(S*39150000
               ) ***'                                              @L8A 39200000
&RLVL    SETA  4                                                        39250000
         AGO   .INC000R                                            @L8A 39300000
.INC0001 MNOTE 12,'INCONSISTENT OR MUTUALLY EXLUSIVE PARAMETERS SPECIFI*39350000
               ED'                                                 @L8A 39400000
         AGO   .EXITE                                              @P2A 39450000
.INC0000 MNOTE 12,'&KEYWORD  KEYWORD NOT SUPPORTED FOR THIS RELEASE'    39500000
*                                                                  @P2A 39550000
.EXITE   ANOP                                                           39600000
         MEXIT                                                          39650000
         MEND                                                           39700000
*                                                                @L8A*/ 39750000
* ICHEINTY: MACRO                                             /* @L8A*/ 39800000
*    KEYS(TYPE,ENTRY,CLASS,VOLUME,WKAREA,NEWNAME,RBA,FLDEF,             39850000
*         INDX,SMC,GENERIC,BRANCH,ID,RELATED,MF,                        39900000
*         ACTIONS,TESTS,MAXACTN,MAXTEST,OPTIONS,NOINIT,                 39950000
*         ACEE,CHAIN,FLDACC,RELEASE,SEGMENT,                  /* @P1C*/ 40000000
*         DATAMAP,WKSP,RUN,ENTRYX,NEWNAMX,DATEFMT);           /* @03C*/ 40050000
*    ANS('?'||MACLABEL||'IRREINTY '||MACLIST||MACKEYS||';');  /* @L8A*/ 40100000
* %END ICHEINTY;                                              /* @L8A*/ 40150000
