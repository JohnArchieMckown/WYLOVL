         MACRO                                                          00050000
&LABEL   CVAFDIR &ACCESS=,&BRANCH=,&BUFLIST=,&DEB=,&DSN=,&IOAREA=,     C00100000
               &IXRCDS=,&MAPRCDS=,&MF=I,&UCB=,&VERIFY=                  00150000
.**** START OF SPECIFICATIONS ****************************************  00200000
.*                                                                      00250000
.*$MAC(CVAFDIR) COMP(DM1CV) PROD(DMS-XZ): CVAF-DIRECT ACCESS            00300000
.*                                                                      00350000
.* DESCRIPTIVE-NAME = CVAF - DIRECT ACCESS TO THE VTOC AND VTOC INDEX   00400000
.*                                                                      00450000
.*PROPRIETARY V3 STATEMENT                                              00462500
.*LICENSED MATERIALS - PROPERTY OF IBM                                  00475000
.*"RESTRICTED MATERIALS OF IBM"                                         00487500
.*5695-DF1                                                              00500000
.*(C) COPYRIGHT 1980,1985  IBM CORP.                                    00512500
.*END PROPRIETARY V3 STATEMENT                                          00531200
.*                                                                      00550000
.*$STATUS = RELEASE 2.1.0                                          @L1A 00600000
.*                                                                      00650000
.* FUNCTION = THIS MACRO WILL SET UP THE CVAF PARAMETER LIST TO ALLOW   00700000
.*     THE CALLER TO:                                                   00750000
.*       1. READ OR UPDATE WRITE A SINGLE DSCB BY DATA SET NAME OR      00800000
.*          BY ITS ARGUMENT.                                            00850000
.*       2. READ OR WRITE VTOC INDEX MAP RECORDS.                       00900000
.*       3. KEEP VTOC INDEX MAP RECORDS IN VIRTUAL STORAGE.             00950000
.*       4. READ THE FIRST HIGH LEVEL VIER AND KEEP IT IN STORAGE.      01000000
.*       5. READ AND KEEP VIERS IN VIRTUAL STORAGE.                     01050000
.*       6. FREE BUFFERS AND/OR BUFFER LISTS.                           01100000
.*       7. KEEP OR FREE THE CVAF I/O AREA.                             01150000
.*                                                                      01200000
.*   KEYWORDS =                                                         01250000
.*                                                                      01300000
.*     THE 'MF' KEYWORD DETERMINES WHETHER THE CVAF PARAMETER LIST      01350000
.*     IS EXPANDED AND/OR EXECUTABLE INSTRUCTIONS ARE GENERATED TO      01400000
.*     INVOKE CVAF.                                                     01450000
.*                                                                      01500000
.*     THE SPECIFICATION OF MF=(E,ADDR), WILL RESULT IN THE             01550000
.*     MODIFICATION OF AN EXISTING CVAF PARAMETER LIST.  THE            01600000
.*     ADDRESS OF THE PARAMETER LIST IS PROVIDED VIA A SECOND           01650000
.*     SUBPARAMETER OF THE 'MF' KEYWORD.  IT ALSO GENERATES CODE        01700000
.*     NECESSARY TO EITHER BRANCH TO CVAF OR ISSUE SVC 139 TO INVOKE    01750000
.*     CVAF TO PERFORM THE REQUESTED FUNCTIONS.  THIS IS CALLED THE     01800000
.*     EXECUTE-FORM OF THE MACRO.                                       01850000
.*                                                                      01900000
.*     WITH A SPECIFICATION OF MF=I, OR NOT SPECIFYING THE 'MF'         01950000
.*     KEYWORD AT ALL, THIS MACRO WILL EXPAND THE CVAF PARAMETER        02000000
.*     LIST AND INITIALIZE IT ACCORDING TO THE OPTIONS SELECTED         02050000
.*     VIA THE ALLOWABLE KEYWORDS.  IT ALSO GENERATES CODE              02100000
.*     NECESSARY TO EITHER BRANCH TO CVAF OR ISSUE SVC 139 TO           02150000
.*     INVOKE CVAF TO PERFORM THE REQUESTED FUNCTIONS.  THIS IS         02200000
.*     CALLED THE INSTRUCTION-FORM (NORMAL-FORM) OF THE MACRO.          02250000
.*                                                                      02300000
.*     THE SPECIFICATION OF MF=L WILL RESULT IN THE EXPANSION OF THE    02350000
.*     PARAMETER LIST AND INITIALIZE IT ACCORDING TO THE SPECIFIED      02400000
.*     KEYWORDS. HOWEVER IT DOES NOT GENERATE THE CODE TO INVOKE        02450000
.*     CVAF.  THIS IS CALLED THE LIST-FORM OF THE MACRO.                02500000
.*                                                                      02550000
.*     KEYWORDS APPLICABLE TO THE CVAFDIR MACRO ARE:                    02600000
.*                                                                      02650000
.*       ACCESS  - WILL SET THE CVFCTN FIELD OF THE CVAF PARAMETER      02700000
.*                 LIST TO X'01' FOR READ, X'02' FOR WRITE, OR X'03'    02750000
.*                 FOR RLSE.  THIS KEYWORD IS REQUIRED FOR THE MF=I     02800000
.*                 FORM AND IS OPTIONAL FOR THE MF=L OR MF=(E,ADDR)     02850000
.*                 FORM.                                                02900000
.*                                                                      02950000
.*                 VALID ENTRIES:  ACCESS=READ                          03000000
.*                                 ACCESS=WRITE                         03050000
.*                                 ACCESS=RLSE                          03100000
.*                                                                      03150000
.*       BRANCH  - WILL SET THE FLAG, CV1PGM, TO 1 IF (YES,PGM)         03200000
.*                 IS CODED OR RESET IT TO 0 IF (YES,SUP) IS CODED.     03250000
.*                 IF BRANCH=YES OR NO IS CODED, OR IN THE ABSENCE      03300000
.*                 OF THIS KEYWORD, THE FLAG, CV1PGM, WILL NOT BE       03350000
.*                 CHANGED FOR THE MF=(E,ADDR) FORM.                    03400000
.*                                                                      03450000
.*                 FOR MF=I OR MF=(E,ADDR) AND BRANCH=NO IS             03500000
.*                 CODED, OR OMITTED, CODE WILL BE GENERATED TO         03550000
.*                 INVOKE CVAF VIA SVC 139.                             03600000
.*                                                                      03650000
.*                 FOR MF=I OR MF=(E,ADDR) AND YES IS CODED, THE        03700000
.*                 CODE IS GENERATED TO INVOKE CVAF VIA A BRANCH,  @L1A 03725000
.*                 VIA A BASSM IF THE RESIDENT SYSTEM IS X/A       @L1A 03750000
.*                 2.1.0 OR LATER.                                 @L1A 03775000
.*                                                                      03800000
.*                 FOR MF=L, ONLY THE FLAG WILL BE INITIALIZED          03850000
.*                 AND NO EXECUTABLE CODED WILL BE GENERATED.           03900000
.*                                                                      03950000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE           04000000
.*                 AN MNOTE, SINCE NO IS THE DEFAULT FOR ALL            04050000
.*                 FORMS OF THIS MACRO.                                 04100000
.*                                                                      04150000
.*                 VALID ENTRIES:  BRANCH=NO        DEFAULT FOR MF=I    04200000
.*                                 BRANCH=YES       (DEFAULT FOR YES    04250000
.*                                 BRANCH=(YES,SUP)  IS (YES,SUP))      04300000
.*                                 BRANCH=(YES,PGM)                     04350000
.*                                                                      04400000
.*       BUFLIST - WILL SET THE ADDRESS OF THE BUFFER LIST, SPECIFIED   04450000
.*                 BY THE 'ADDR', INTO THE FIELD: CVBUFL.               04500000
.*                                                                      04550000
.*                 THE ABSENCE OF THIS KEYWORD WILL CAUSE AN MNOTE      04600000
.*                 TO BE ISSUED WHEN ACCESS=WRITE OR ACCESS=READ,       04650000
.*                 MAPRCDS=NO OR ACCESS=READ,IXRCDS=NOKEEP IS CODED     04670000
.*                 FOR THE MF=I FORM OF THIS MACRO.                     04690000
.*                                                                      04750000
.*       DEB     - WILL SET THE ADDRESS OF A DEB, SPECIFIED BY THE      04800000
.*                 'ADDR', INTO THE FIELD: CVDEB.  THIS KEYWORD         04850000
.*                 IS MUTUALLY EXCLUSIVE WITH UCB.  EITHER DEB OR       04900000
.*                 UCB IS REQUIRED UNLESS IOAREA=(,ADDR) IS             04950000
.*                 SPECIFIED FOR THE MF=I FORM OF THIS MACRO.           05000000
.*                                                                      05050000
.*       DSN     - WILL SET THE ADDRESS OF A DATA SET NAME OF THE       05100000
.*                 DSCB, SPECIFIED BY THE 'ADDR', INTO THE FIELD:       05150000
.*                 CVDSN.                                               05200000
.*                                                                      05250000
.*       IOAREA  - WILL SET THE ADDRESS OF THE I/O AREA, SPECIFIED      05500000
.*                 BY THE 'ADDR', INTO THE FIELD: CVIOAR.  ALSO,        05550000
.*                 THE FLAG, CV1IOAR, WILL BE SET TO 1 IF KEEP IS       05600000
.*                 CODED AND RESET TO 0 IF NOKEEP IS CODED.             05650000
.*                                                                      05700000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN MNOTE, 05750000
.*                 SINCE NOKEEP IS THE DEFAULT FOR MF=L AND MF=I.       05800000
.*                 THE FLAG WILL NOT BE CHANGED IN THE ABSENCE OF THE   05850000
.*                 IOAREA KEYWORD FOR MF=(E,ADDR) FORM.                 05900000
.*                                                                      05950000
.*                 VALID ENTRIES:  IOAREA=NOKEEP    DEFAULT FOR MF=I    06000000
.*                                 IOAREA=(NOKEEP,ADDR)                 06050000
.*                                 IOAREA=KEEP                          06100000
.*                                 IOAREA=(KEEP,ADDR)                   06150000
.*                                                                      06200000
.*       IXRCDS  - WILL SET THE ADDRESS OF THE VIERS BUFFER LIST,       06250000
.*                 SPECIFIED BY THE 'ADDR', INTO THE FIELD: CVIRCDS.    06300000
.*                 ALSO, THE FLAG, CV1IRCDS, WILL BE SET TO 1 IF KEEP   06350000
.*                 IS CODED AND RESET TO 0 IF NOKEEP IS CODED.          06400000
.*                                                                      06450000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN MNOTE, 06500000
.*                 SINCE NOKEEP IS THE DEFAULT FOR MF=L AND MF=I.       06550000
.*                 THE FLAG WILL NOT BE CHANGED IN THE ABSENCE OF THE   06600000
.*                 IXRCDS KEYWORD FOR MF=(E,ADDR) FORM.                 06650000
.*                                                                      06700000
.*                 VALID ENTRIES:  IXRCDS=NOKEEP    DEFAULT FOR MF=I    06750000
.*                                 IXRCDS=(NOKEEP,ADDR)                 06800000
.*                                 IXRCDS=KEEP                          06850000
.*                                 IXRCDS=(KEEP,ADDR)                   06900000
.*                                                                      06950000
.*       MAPRCDS - WILL SET THE ADDRESS OF THE MAP RECORDS BUFFER LIST, 07000000
.*                 SPECIFIED BY THE 'ADDR', INTO THE FIELD: CVMRCDS.    07050000
.*                 ALSO, THE FLAG, CV1MRCDS, WILL BE SET TO 1 IF YES    07100000
.*                 IS CODED AND RESET TO 0 IF NO IS CODED.              07150000
.*                                                                      07200000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN MNOTE, 07250000
.*                 SINCE NO IS THE DEFAULT FOR MF=L AND MF=I.           07300000
.*                 THE FLAG WILL NOT BE CHANGED IN THE ABSENCE OF THE   07350000
.*                 MAPRCDS KEYWORD FOR MF=(E,ADDR) FORM.                07400000
.*                                                                      07450000
.*                 VALID ENTRIES:  MAPRCDS=NO       DEFAULT FOR MF=I    07500000
.*                                 MAPRCDS=(NO,ADDR)                    07550000
.*                                 MAPRCDS=YES                          07600000
.*                                 MAPRCDS=(YES,ADDR)                   07650000
.*                                                                      07700000
.*                                                                      07750000
.*       MF      - SEE THE OPENING PARAGRAPHS ABOVE.  IF THE MF KEYWORD 07800000
.*                 IS NOT SPECIFIED, THE DEFAULT, MF=I, WILL BE IN      07850000
.*                 EFFECT.                                              07900000
.*                                                                      07950000
.*                 FOR THE INSTRUCTION-FORM (MF=I), THE                 08000000
.*                 FOLLOWING VALIDITY CHECKS WILL BE MADE:              08050000
.*                   1. ACCESS IS REQUIRED.                             08100000
.*                   2. BUFLIST IS REQUIRED WHEN ACCESS=WRITE OR        08150000
.*                      ACCESS=READ,MAPRCDS=NO OR ACCESS=READ,          08180000
.*                      IXRCDS=NOKEEP IS CODED.                         08210000
.*                   3. DEB OR UCB IS REQUIRED WHEN IOAREA=(,ADDR)      08240000
.*                      HAS NOT BEEN SPECIFIED.                         08270000
.*                                                                      08350000
.*                 FOR ALL FORMS OF THE MACRO, THE FOLLOWING            08400000
.*                 VALIDITY CHECKS WILL BE MADE:                        08450000
.*                   1. VALID KEYWORD OPERANDS.                         08500000
.*                   2. DEB AND UCB ARE MUTUALLY EXCLUSIVE.             08550000
.*                   3. VERIFY=YES IS INVALID WHEN ACCESS=READ OR       08600000
.*                      RLSE IS SPECIFIED.                              08650000
.*                                                                      08700000
.*                 VALID ENTRIES:  MF=I             DEFAULT             08750000
.*                                 MF=L                                 08800000
.*                                 MF=(E,ADDR)                          08850000
.*                                                                      08900000
.*       UCB     - WILL SET THE ADDRESS OF THE UCB, SPECIFIED BY        08950000
.*                 THE 'ADDR', INTO THE FIELD: CVUCB.  THIS KEYWORD     09000000
.*                 IS MUTUALLY EXCLUSIVE WITH DEB.  EITHER DEB OR       09050000
.*                 UCB IS REQUIRED UNLESS IOAREA=(,ADDR) IS             09100000
.*                 SPECIFIED FOR THE MF=I FORM OF THIS MACRO.           09150000
.*                                                                      09200000
.*       VERIFY  - WILL SET A FLAG, CV2VER, TO 1 IF VERIFY=YES          09250000
.*                 IS CODED. IF VERIFY=NO IS CODED, THE FLAG WILL       09300000
.*                 BE RESET TO ZERO.  VERIFY=YES IS INVALID WHEN        09350000
.*                 ACCESS=READ OR RLSE IS CODED.                        09400000
.*                                                                      09450000
.*                 THE FLAG, CV2VER, WILL NOT BE CHANGED IN THE         09500000
.*                 ABSENCE OF THIS KEYWORD FOR MF=(E,ADDR).  NO         09550000
.*                 IS THE DEFAULT IN THE ABSENCE OF THE THIS KEYWORD    09600000
.*                 FOR THE MF=I AND MF=L FORMS OF THIS MACRO.           09650000
.*                                                                      09700000
.*                 VALID ENTRIES:  VERIFY=NO        DEFAULT FOR MF=I    09750000
.*                                 VERIFY=YES                           09800000
.*                                                                      09850000
.* NOTES = N/A                                                          09900000
.*                                                                      09950000
.* MODULE-TYPE = MACRO                                                  10000000
.*                                                                      10050000
.*   PROCESSOR = ASSEMBLER LANGUAGE                                     10100000
.*                                                                      10150000
.*   ATTRIBUTES = EXECUTABLE MACRO                                      10200000
.*                                                                      10250000
.* ENTRY-POINT = MACRO STATEMENT.                                       10300000
.*                                                                      10350000
.* INPUT = SEE DESCRIPTION OF KEYWORDS UNDER 'FUNCTION'.                10400000
.*                                                                      10450000
.* OUTPUT = CVAF PARAMETER LIST WITH THE FLAGS AND THE ADDRESSES        10500000
.*           SET DEPENDING UPON THE KEYWORDS SPECIFIED AS DEFINED       10550000
.*           UNDER 'KEYWORDS' ABOVE.                                    10600000
.*                                                                      10650000
.* EXIT-NORMAL = MEND STATEMENT.                                        10700000
.*                                                                      10750000
.*  EXIT-ERROR = MNOTE AND MEND STATEMENT.  MNOTES WILL BE GENERATED    10800000
.*               FOR ANY OF THE FOLLOWING ERRORS ENCOUNTERED:           10850000
.*                                                                      10900000
.*                 FOR THE MF=I FORM OF THE MACRO:                      10950000
.*                   1. ACCESS IS NOT SUPPLIED.                         11000000
.*                   2. BUFLIST IS NOT SUPPLIED WHEN ACCESS=WRITE OR    11050000
.*                      ACCESS=READ,MAPRCDS=NO OR ACCESS=READ,          11100000
.*                      IXRCDS=NOKEEP IS CODED.                         11150000
.*                   3. EITHER DEB OR UCB IS NOT SUPPLIED,              11200000
.*                      AND IOAREA=(,ADDR) WAS NOT SPECIFIED.           11300000
.*                                                                      11350000
.*                 FOR ALL FORMS OF THE MACRO:                          11400000
.*                   1. INVALID KEYWORD OPERAND.                        11450000
.*                   2. DEB AND UCB ARE MUTUALLY EXCLUSIVE.             11500000
.*                   3. VERIFY=YES IS INVALID WHEN ACCESS=READ          11550000
.*                      OR RLSE WAS SPECIFIED.                          11600000
.*                                                                      11650000
.* EXTERNAL-REFERENCES = NONE                                           11700000
.*                                                                      11750000
.* TABLES = NONE                                                        11800000
.*                                                                      11850000
.* MACROS = NONE                                                        11900000
.*                                                                      11950000
.* CHANGE-ACTIVITY = NEW MACRO                                          12000000
.*                                                                      12016600
.*$L0=IXVTOC,JDM1134,T790225,STLBS: INDEXED VTOC SUPPORT                12033200
.*$L1=VSCR,HDP2210,T840401,STLMDB: CVAF VSCR                       @L1A 12041600
.*                                                                      12050000
.**** END OF SPECIFICATIONS ******************************************* 12100000
         LCLA  &K                       LENGTH OF PARM                  12150000
         LCLA  &NO                      BRANCH INDEX NUMBER             12200000
         LCLB  &BION                    IOAREA AND BIT FLAG1            12250000
         LCLB  &BIOO                    IOAREA OR BIT FLAG1             12300000
         LCLB  &BIRN                    IXRCDS AND BIT FLAG1            12350000
         LCLB  &BIRO                    IXRCDS OR BIT FLAG1             12400000
         LCLB  &BMRN                    MAPRCDS AND BIT FLAG1           12450000
         LCLB  &BMRO                    MAPRCDS OR BIT FLAG1            12500000
         LCLB  &BPGN                    PGM AND BIT FLAG1               12550000
         LCLB  &BPGO                    PGM OR BIT FLAG1                12600000
         LCLB  &BVRN                    VERIFY AND BIT FLAG2            12650000
         LCLB  &BVRO                    VERIFY OR BIT FLAG2             12700000
         LCLB  &ERRSW                   AN ERROR WAS DETECTED           12750000
         LCLB  &SWBUF                   BUFLIST PARM PRESENT SWITCH     12800000
         LCLB  &SWDEB                   DEB PARM PRESENT SWITCH         12850000
         LCLB  &SWDSN                   DSN PARM PRESENT SWITCH         12900000
         LCLB  &SWIOA                   IOAREA PARM PRESENT SWITCH      12950000
         LCLB  &SWIXR                   IXRCDS PARM PRESENT SWITCH      13000000
         LCLB  &SWMPR                   MAPRCDS PARM PRESENT SWITCH     13050000
         LCLB  &SWUCB                   UCB PARM PRESENT SWITCH         13100000
         LCLB  &BUFNCOR                 BUFLIST IN STORAGE SWITCH       13150000
         LCLB  &DEBNCOR                 DEB IN STORAGE SWITCH           13200000
         LCLB  &DSNNCOR                 DSN IN STORAGE SWITCH           13250000
         LCLB  &IOANCOR                 IOAREA IN STORAGE SWITCH        13300000
         LCLB  &IXRNCOR                 IXRCDS IN STORAGE SWITCH        13350000
         LCLB  &MPRNCOR                 MAPRCDS IN STORAGE SWITCH       13400000
         LCLB  &UCBNCOR                 UCB IN STORAGE SWITCH           13450000
         LCLC  &BUFNREG                 BUFLIST IN REG VALUE            13500000
         LCLC  &DEBNREG                 DEB IN REGISTER VALUE           13550000
         LCLC  &DSNNREG                 DSN IN REG VALUE                13600000
         LCLC  &IOANREG                 IOAREA IN REGISTER VALUE        13650000
         LCLC  &IXRNREG                 IXRCDS IN REG VALUE             13700000
         LCLC  &MPRNREG                 MAPRCDS IN REG VALUE            13750000
         LCLC  &UCBNREG                 UCB IN REGISTER VALUE           13800000
         LCLC  &L                       LOCAL LABEL VARIABLE            13850000
         LCLC  &FM                      MF=FORM CHARACTER VARIABLE      13900000
         LCLC  &FLAG1                   DEFINE LOCAL CHAR VARIABLE      13950000
         LCLC  &FLAG2                   DEFINE LOCAL CHAR VARIABLE      14000000
         LCLC  &FLAG1N                  DEFINE LOCAL CHAR VARIABLE      14050000
         LCLC  &FLAG2N                  DEFINE LOCAL CHAR VARIABLE      14100000
         LCLC  &FUNCT                   FUNCTION CODE FOR ACCESS=       14150000
&NO      SETA  &SYSNDX                  SET BRANCH INDEX NUMBER         14200000
&BION    SETB  1                        INITIALIZE 'AND' BIT            14250000
&BIRN    SETB  1                        INITIALIZE 'AND' BIT            14300000
&BMRN    SETB  1                        INITIALIZE 'AND' BIT            14350000
&BPGN    SETB  1                        INITIALIZE 'AND' BIT            14400000
&BVRN    SETB  1                        INITIALIZE 'AND' BIT            14450000
.*                                                                      14500000
.* ******************************************************************** 14550000
.* *     MF=' ' VERIFICATION                                            14600000
.* ******************************************************************** 14650000
.*                                                                      14700000
         AIF   (N'&MF GT 2).ER          MF= HAS ONLY 2 PARMS            14750000
         AIF   ('&MF(1)' EQ 'E').E1     TEST FOR E FORM                 14800000
         AIF   (N'&MF NE 1).ER          MF=L OR I HAS ONLY 1 PARM       14850000
         AIF   ('&MF(1)' EQ 'I').I1     TEST FOR I FORM                 14900000
         AIF   ('&MF(1)' EQ 'L').L1     TEST FOR L FORM                 14950000
.ER      ANOP                                                           15000000
         SPACE 1                                                        15050000
         MNOTE 16,'***  IHB001 INVALID OPERAND - MF=&MF'                15100000
&ERRSW   SETB  1                        SET ERROR SWITCH ON             15150000
         AGO   .CKERR                   GO TO ERROR IN CHECK ROUTINE    15200000
.*                                                                      15250000
.* ******************************************************************** 15300000
.* *     EXECUTE FORM, MF=(E,' ') VERIFICATION                          15350000
.* ******************************************************************** 15400000
.*                                                                      15450000
.E1      ANOP                           EXECUTE FORM OF MACRO           15500000
&FM      SETC  'E'                      SET THE MACRO FORM SWITCH       15550000
         AIF   (N'&MF EQ 2).CK1         MF=E MUST HAVE 2 PARMS          15600000
         SPACE 1                                                        15650000
         MNOTE 16,'***  IHB002 MF=(E,ADDR) FORM: PARAMETER LIST ADDRESSX15700000
                IS REQUIRED'                                            15750000
&ERRSW   SETB  1                        SET ERROR SWITCH ON             15800000
         AGO   .CK1                     GO CHECK NEXT KEYWORD           15850000
.*                                                                      15900000
.* ******************************************************************** 15950000
.* *     LIST FORM OF CVAFDIR                                           16000000
.* ******************************************************************** 16050000
.*                                                                      16100000
.L1      ANOP                           LIST FORM OF MACRO              16150000
&FM      SETC  'L'                      SET THE MACRO FORM SWITCH       16200000
         AGO   .CK1                     GO CHECK NEXT KEYWORD           16250000
.*                                                                      16300000
.* ******************************************************************** 16350000
.* *     INSTRUCTION FORM OF CVAFDIR                                    16400000
.* ******************************************************************** 16450000
.*                                                                      16500000
.I1      ANOP                           INSTRUCTION FORM OF MACRO       16550000
&FM      SETC  'I'                      SET THE MACRO FORM SWITCH       16600000
.*                                                                      16650000
.* ******************************************************************** 16700000
.* *     INSTRUCTION FORM REQUIRES THE 'ACCESS' KEYWORD                 16750000
.* ******************************************************************** 16800000
.*                                                                      16850000
         AIF   ('&ACCESS' NE '').CK1    OK IF ACCESS IS CODED           16900000
         SPACE 1                                                        16950000
         MNOTE 12,'***  IHB003 MF=I FORM: ACCESS KEYWORD IS REQUIRED'   17000000
&ERRSW   SETB  1                         SET ERROR IN CHECK SWITCH      17050000
         AGO   .CK2                      BYPASS NEXT CHECK              17100000
.*                                                                      17150000
.* ******************************************************************** 17200000
.* *     VERIFY 'ACCESS' KEYWORD                                        17250000
.* ******************************************************************** 17300000
.*                                                                      17350000
.CK1     ANOP                                                           17400000
         AIF   ('&ACCESS' NE 'READ').AC1                                17450000
&FUNCT   SETC  '01'                       CVAFDIR ACCESS=READ           17500000
         AGO   .CK2                                                     17550000
.AC1     ANOP                                                           17600000
         AIF   ('&ACCESS' NE 'WRITE').AC2 NOT WRITE, GO ON              17650000
&FUNCT   SETC  '02'                       CVAFDIR ACCESS=WRITE          17700000
         AGO   .CK2                                                     17750000
.AC2     ANOP                             MUST BE RELEASE               17800000
         AIF   ('&ACCESS' NE 'RLSE').AC3  NOT RLSE, GO ON               17850000
&FUNCT   SETC  '03'                       CVAFDIR ACCESS=RLSE           17900000
         AGO   .CK2                                                     17950000
.AC3     ANOP                                                           18000000
         AIF   ('&ACCESS' EQ '' AND '&FM' EQ 'E').CK2                   18050000
&FUNCT   SETC  '00'                       ACCESS= NOT CODED             18100000
         AIF   ('&ACCESS' EQ '' AND '&FM' NE 'I').CK2 MF~=I, SKIP       18150000
         SPACE 1                                                        18200000
         MNOTE 12,'***  IHB001 INVALID OPERAND - ACCESS=&ACCESS'        18250000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       18300000
.*                                                                      18350000
.* ******************************************************************** 18400000
.* *     IF DSN IS PRESENT, CHECK IF IN REG OR NOT                      18450000
.* ******************************************************************** 18500000
.*                                                                      18550000
.CK2     ANOP                                                           18600000
         AIF   ('&DSN' EQ '').CK3       NO DSN, CHECK DEB               18650000
         AIF   (N'&DSN NE 1).ER2        ONLY 1 DSN PARM ALLOWED         18700000
&SWDSN   SETB  1                        SET DSN SWITCH ON               18750000
         AIF   ('&DSN'(1,1) EQ '(').DSNNREG                             18800000
&DSNNCOR SETB  1                        DSN IS IN CORE                  18850000
         AGO   .CK3                                                     18900000
.DSNNREG ANOP                                                           18950000
&K       SETA  K'&DSN                   STORE NO. OF CHARS IN DSN       19000000
&DSNNREG SETC  '&DSN'(2,&K-2)           GET REGISTER OF DSN             19050000
         AGO   .CK3                                                     19100000
.ER2     ANOP                           DSN= **** ERROR ****            19150000
         SPACE 1                                                        19200000
         MNOTE 12,'***  IHB001 INVALID OPERAND - DSN=&DSN'              19250000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       19300000
.*                                                                      19350000
.* ******************************************************************** 19400000
.* *     IF DEB IS PRESENT, CHECK IF IN REG OR NOT                      20050000
.* ******************************************************************** 20100000
.*                                                                      20150000
.CK3     ANOP                                                           20200000
         AIF   ('&DEB' EQ '').U1        NO DEB, GO CHECK UCB            20250000
         AIF   (N'&DEB NE 1).ER3        ONLY 1 DEB PARM ALLOWED         20300000
&SWDEB   SETB  1                        SET DEB SWITCH ON               20350000
         AIF   ('&DEB'(1,1) EQ '(').DEBNREG                             20400000
&DEBNCOR SETB  1                        DEB IS IN CORE                  20450000
         AGO   .U1                                                      20500000
.DEBNREG ANOP                                                           20550000
&K       SETA  K'&DEB                   STORE NO. OF CHARS IN DEB       20600000
&DEBNREG SETC  '&DEB'(2,&K-2)           GET REGISTER OF DEB             20650000
         AGO   .U1                                                      20700000
.ER3     ANOP                           DEB= **** ERROR ****            20750000
         SPACE 1                                                        20800000
         MNOTE 12,'***  IHB001 INVALID OPERAND - DEB=&DEB'              20850000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       20900000
.*                                                                      20950000
.* ******************************************************************** 21000000
.* *     IF UCB IS PRESENT, CHECK IF IN REG OR NOT                      21050000
.* ******************************************************************** 21100000
.*                                                                      21150000
.U1      ANOP                                                           21200000
         AIF   ('&UCB' EQ '').I2        NO UCB, IS IOAREA?              21250000
         AIF   (N'&UCB NE 1).ER4        ONLY 1 UCB PARM ALLOWED         21300000
&SWUCB   SETB  1                        SET UCB SWITCH ON               21350000
         AIF   ('&UCB'(1,1) EQ '(').UCBNREG                             21400000
&UCBNCOR SETB  1                        UCB IS IN CORE                  21450000
         AGO   .I2                                                      21500000
.UCBNREG ANOP                                                           21550000
&K       SETA  K'&UCB                   STORE NO. OF CHARS IN UCB       21600000
&UCBNREG SETC  '&UCB'(2,&K-2)           GET REGISTER OF UCB             21650000
         AGO   .I2                                                      21700000
.ER4     ANOP                           UCB= **** ERROR ****            21750000
         SPACE 1                                                        21800000
         MNOTE 12,'***  IHB001 INVALID OPERAND - UCB=&UCB'              21850000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       21900000
.*                                                                      21950000
.* ******************************************************************** 22000000
.* *     IF IOAREA IS PRESENT, CHECK IF IN REG OR NOT                   22050000
.* ******************************************************************** 22100000
.*                                                                      22150000
.I2      ANOP                                                           22200000
         AIF   ('&IOAREA' EQ '').I3C    NO IOAREA, IS IT MF=I?          22250000
         AIF   (N'&IOAREA EQ 1).I3A     NO IOAREA ADDRESS, KEEP/NOKEEP? 22300000
         AIF   (N'&IOAREA NE 2).ER5     ONLY 2 IOAREA PARMS ALLOWED     22350000
&SWIOA   SETB  1                        SET IOAREA SWITCH ON            22400000
         AIF   ('&IOAREA(2)'(1,1) EQ '(').IOANREG                       22450000
&IOANCOR SETB  1                        IOAREA IS IN CORE               22500000
         AGO   .I3A                     CHECK OUT FIRST PARM            22550000
.IOANREG ANOP                                                           22600000
&K       SETA  K'&IOAREA(2)             STORE NO. OF CHARS IN IOAREA    22650000
&IOANREG SETC  '&IOAREA(2)'(2,&K-2)     GET REGISTER OF IOAREA          22700000
.*                                                                      22750000
.* ******************************************************************** 22800000
.* *     VALIDITY CHECK THE FIRST PARM OF IOAREA                        22850000
.* ******************************************************************** 22900000
.*                                                                      22950000
.I3A     ANOP                                                           23000000
         AIF   ('&IOAREA(1)' NE 'KEEP').I3B                             23050000
&BIOO    SETB  1                        SET IOAREA=KEEP SWITCH          23100000
         AGO   .I3C                                                     23150000
.I3B     ANOP                                                           23200000
         AIF   ('&IOAREA(1)' NE 'NOKEEP').ER5                           23250000
&BION    SETB  0                        SET IOAREA=NOKEEP SWITCH        23300000
         AGO   .I3C                                                     23350000
.ER5     ANOP                           IOAREA= **** ERROR ****         23400000
         SPACE 1                                                        23450000
         MNOTE 12,'***  IHB001 INVALID OPERAND - IOAREA=&IOAREA'        23500000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       23550000
.*                                                                      23600000
.* ******************************************************************** 23650000
.* *     INST FORM: DEB OR UCB IS REQUIRED WHEN NO IOAREA=(,ADDR)       23700000
.* ******************************************************************** 23750000
.*                                                                      23800000
.I3C     ANOP                                                           23850000
         AIF   ('&FM' NE 'I').CK4       IF NOT MF=I, SKIP               23900000
         AIF   ('&SWIOA' EQ '1').CK4    IOAREA ADDRESS, SKIP            23950000
         AIF   ('&SWDEB' EQ '1').CK4    DEB ADDRESS, SKIP               24000000
         AIF   ('&SWUCB' EQ '1').CK4    UCB ADDRESS, SKIP               24050000
         SPACE 1                                                        24100000
         MNOTE 12,'***  IHB004 MF=I FORM: DEB OR UCB IS REQUIRED WHEN NX24150000
               O IOAREA      ADDRESS IS SPECIFIED'                      24200000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       24250000
.*                                                                      24300000
.* ******************************************************************** 24350000
.* *     IF BUFLIST IS PRESENT, CHECK IF IN REG OR NOT                  24400000
.* ******************************************************************** 24450000
.*                                                                      24500000
.CK4     ANOP                                                           24550000
         AIF   ('&BUFLIST' EQ '').I4A   NO BUFLIST, IS IT MF=I?         24600000
         AIF   (N'&BUFLIST NE 1).ER6    ONLY 1 BUFLIST PARM ALLOWED     24650000
&SWBUF   SETB  1                        SET BUFLIST SWITCH ON           24700000
         AIF   ('&BUFLIST'(1,1) EQ '(').BUFNREG                         24750000
&BUFNCOR SETB  1                        BUFLIST IS IN CORE              24800000
         AGO   .CK5                                                     24850000
.BUFNREG ANOP                                                           24890000
&K       SETA  K'&BUFLIST               STORE NO. OF CHARS IN BUFLIST   24930000
&BUFNREG SETC  '&BUFLIST'(2,&K-2)       GET REGISTER OF BUFLIST         24970000
         AGO   .CK5                                                     25010000
.ER6     ANOP                           BUFLIST= **** ERROR ****        25100000
         SPACE 1                                                        25150000
         MNOTE 12,'***  IHB001 INVALID OPERAND - BUFLIST=&BUFLIST'      25200000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       25250000
         AGO   .CK5                                                     25300000
.*                                                                      25320000
.* ******************************************************************** 25340000
.* *     INST FORM: BUFLIST IS REQUIRED WHEN ACCESS=WRITE               25360000
.* ******************************************************************** 25380000
.*                                                                      25400000
.I4A     ANOP                              BUFLIST IS REQUIRED FOR      25420000
         AIF   ('&FM' NE 'I').CK5          MF=I WHEN ACCESS=WRITE       25440000
         AIF   ('&FUNCT' NE '02').I4B      NOT WRITE, SKIP              25460000
         SPACE 1                                                        25485000
         MNOTE 12,'***  IHB005 MF=I FORM: BUFLIST= IS REQUIRED IF ACCESX25510000
               S=WRITE'                                                 25535000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       25560000
         AGO   .CK5                                                     25580000
.*                                                                      25600000
.* ******************************************************************** 25620000
.* *     INST FORM: BUFLIST IS REQUIRED WHEN ACCESS=READ,MAPRCDS=NO OR  25640000
.* *                ACCESS=READ,IXRCDS=NOKEEP.                          25660000
.* ******************************************************************** 25680000
.*                                                                      25700000
.I4B     ANOP                                                           25720000
         AIF   ('&FUNCT' NE '01').CK5       NOT READ, SKIP              25740000
         AIF   ('&MAPRCDS(1)' EQ 'YES').CK5 MAPRCDS=YES, SKIP           25756000
         AIF   ('&IXRCDS(1)' EQ 'KEEP').CK5 IXRCDS=KEEP, SKIP           25772000
         SPACE 1                                                        25788000
         MNOTE 12,'***  IHB006 MF=I FORM: BUFLIST= IS REQUIRED IF ACCESX25804000
               S=READ, AND    MAPRCDS=NO OR IXRCDS=NOKEEP'              25820000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       26000000
.*                                                                      26050000
.* ******************************************************************** 26100000
.* *     DEB AND UCB KEYWORDS ARE MUTUALLY EXCLUSIVE                    26150000
.* ******************************************************************** 26200000
.*                                                                      26250000
.CK5     ANOP                                                           26300000
         AIF   ('&SWDEB' EQ '0' OR '&SWUCB' EQ '0').CK6                 26350000
         SPACE 1                                                        26400000
         MNOTE 12,'***  IHB007 DEB AND UCB KEYWORDS ARE MUTUALLY EXCLUSX26450000
               IVE'                                                     26500000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       26550000
.*                                                                      26600000
.* ******************************************************************** 26650000
.* *     VALIDITY CHECK VERIFY KEYWORD                                  26700000
.* ******************************************************************** 26750000
.*                                                                      26800000
.CK6     ANOP                                                           26850000
         AIF   ('&VERIFY' EQ '').CK8    NO KEYWORD, SKIP NEXT CHECK     26900000
         AIF   ('&VERIFY' NE 'NO').VER1                                 26950000
&BVRN    SETB  0                        SET VERIFY=NO SWITCH            27000000
         AGO   .CK8                     AND SKIP NEXT CHECK             27050000
.VER1    ANOP                                                           27100000
         AIF   ('&VERIFY' EQ 'YES').CK7                                 27150000
         SPACE 1                                                        27200000
         MNOTE 12,'***  IHB001 INVALID OPERAND - VERIFY=&VERIFY'        27250000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       27300000
         AGO   .CK8                     BYPASS THE NEXT CHECK           27350000
.*                                                                      27400000
.* ******************************************************************** 27450000
.* *     VERIFY=YES IS INVALID FOR ACCESS=READ OR RLSE                  27500000
.* ******************************************************************** 27550000
.*                                                                      27600000
.CK7     ANOP                                                           27650000
&BVRO    SETB  1                        SET VERIFY=YES SWITCH           27700000
         AIF   ('&ACCESS' NE 'READ' AND '&ACCESS' NE 'RLSE').CK8        27750000
         SPACE 1                                                        27800000
         MNOTE 12,'***  IHB008 VERIFY=YES IS INVALID IF ACCESS=&ACCESS' 27850000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       28000000
.*                                                                      28050000
.* ******************************************************************** 28100000
.* *     IF MAPRCDS IS PRESENT, CHECK IF IN REG OR NOT                  28150000
.* ******************************************************************** 28200000
.*                                                                      28250000
.CK8     ANOP                                                           28300000
         AIF   ('&MAPRCDS' EQ '').CK9   NO MAPRCDS, GO ON               28350000
         AIF   (N'&MAPRCDS EQ 1).MR1    NO MAPRCDS ADDRESS, YES/NO?     28400000
         AIF   (N'&MAPRCDS NE 2).ER7    ONLY 2 MAPRCDS PARMS ALLOWED    28450000
&SWMPR   SETB  1                        SET MAPRCDS SWITCH ON           28500000
         AIF   ('&MAPRCDS(2)'(1,1) EQ '(').MPRNREG                      28550000
&MPRNCOR SETB  1                        MAPRCDS IS IN CORE              28600000
         AGO   .MR1                     CHECK OUT FIRST PARM            28650000
.MPRNREG ANOP                                                           28700000
&K       SETA  K'&MAPRCDS(2)            STORE NO. OF CHARS IN MAPRCDS   28750000
&MPRNREG SETC  '&MAPRCDS(2)'(2,&K-2)    GET REGISTER OF MAPRCDS         28800000
.*                                                                      28850000
.* ******************************************************************** 28900000
.* *     VALIDITY CHECK THE FIRST PARM OF MAPRCDS                       28950000
.* ******************************************************************** 29000000
.*                                                                      29050000
.MR1     ANOP                                                           29100000
         AIF   ('&MAPRCDS(1)' NE 'YES').MR2                             29150000
&BMRO    SETB  1                        SET MAPRCDS=YES SWITCH          29200000
         AGO   .CK9                                                     29250000
.MR2     ANOP                                                           29300000
         AIF   ('&MAPRCDS(1)' NE 'NO').ER7                              29350000
&BMRN    SETB  0                        SET MAPRCDS=NO SWITCH           29400000
         AGO   .CK9                                                     29450000
.ER7     ANOP                           MAPRCDS= **** ERROR ****        29500000
         SPACE 1                                                        29550000
         MNOTE 12,'***  IHB001 INVALID OPERAND - MAPRCDS=&MAPRCDS'      29600000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       29650000
.*                                                                      29700000
.* ******************************************************************** 29750000
.* *     IF IXRCDS IS PRESENT, CHECK IF IN REG OR NOT                   29800000
.* ******************************************************************** 29850000
.*                                                                      29900000
.CK9     ANOP                                                           29950000
         AIF   ('&IXRCDS' EQ '').CK11   NO IXRCDS, GO ON                30000000
         AIF   (N'&IXRCDS EQ 1).CK10    NO IXRCDS ADDRESS, KEEP/NOKEEP? 30050000
         AIF   (N'&IXRCDS NE 2).ER8     ONLY 2 IXRCDS PARMS ALLOWED     30100000
&SWIXR   SETB  1                        SET IXRCDS SWITCH ON            30150000
         AIF   ('&IXRCDS(2)'(1,1) EQ '(').IXRNREG                       30200000
&IXRNCOR SETB  1                        IXRCDS IS IN CORE               30250000
         AGO   .CK10                    CHECK OUT FIRST PARM            30300000
.IXRNREG ANOP                                                           30350000
&K       SETA  K'&IXRCDS(2)             STORE NO. OF CHARS IN IXRCDS    30400000
&IXRNREG SETC  '&IXRCDS(2)'(2,&K-2)     GET REGISTER OF IXRCDS          30450000
.*                                                                      30500000
.* ******************************************************************** 30550000
.* *     VALIDITY CHECK THE FIRST PARM OF IXRCDS                        30600000
.* ******************************************************************** 30650000
.*                                                                      30700000
.CK10    ANOP                                                           30750000
         AIF   ('&IXRCDS(1)' NE 'KEEP').IR1                             30800000
&BIRO    SETB  1                        SET IXRCDS=KEEP SWITCH          30850000
         AGO   .CK11                                                    30900000
.IR1    ANOP                                                            30950000
         AIF   ('&IXRCDS(1)' NE 'NOKEEP').ER8                           31000000
&BIRN    SETB  0                        SET IXRCDS=NOKEEP SWITCH        31050000
         AGO   .CK11                                                    31100000
.ER8     ANOP                           IXRCDS= **** ERROR ****         31150000
         SPACE 1                                                        31200000
         MNOTE 12,'***  IHB001 INVALID OPERAND - IXRCDS=&IXRCDS'        31250000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       31300000
.*                                                                      31350000
.* ******************************************************************** 31400000
.* *     VALIDITY CHECK THE BRANCH OPERANDS                             31450000
.* ******************************************************************** 31500000
.*                                                                      31550000
.CK11    ANOP                                                           31600000
         AIF   ('&BRANCH' EQ '').CKERR      NO BRANCH KEYWORD           31650000
         AIF   ('&BRANCH(1)' EQ 'NO').CKERR BRANCH=NO, GO ON            31700000
         AIF   ('&BRANCH(1)' NE 'YES').ER9  BAD BRANCH=                 31750000
         AIF   (N'&BRANCH EQ 1).CKERR       NO 2ND OPERAND              31800000
         AIF   (N'&BRANCH GT 2).ER9         BAD OPERAND                 31850000
         AIF   ('&BRANCH(2)' NE 'PGM').BR1  CHECK FOR PGM               31900000
&BPGO    SETB  1                        SET BRANCH=(YES,PGM) SWITCH     31950000
         AGO   .CKERR                                                   32000000
.BR1     ANOP                                                           32050000
         AIF   ('&BRANCH(2)' NE 'SUP').ER9  BAD 2ND OPERAND             32100000
&BPGN    SETB  0                        SET BRANCH=(YES,SUP) SWITCH     32150000
         AGO   .CKERR                                                   32200000
.ER9     ANOP                           BRANCH= **** ERROR ****         32250000
         SPACE 1                                                        32300000
         MNOTE 12,'***  IHB001 INVALID OPERAND - BRANCH=&BRANCH'        32350000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       32400000
.*                                                                      32450000
.* ******************************************************************** 32500000
.* *     CHECK ERRORS: IF ANY PRESENT, SET A 'LABEL DS 0F' AND GET OUT  32550000
.* ******************************************************************** 32600000
.*                                                                      32650000
.CKERR   ANOP                                                           32700000
         AIF   ('&ERRSW' EQ '0').EXEC                                   32750000
&LABEL   DS    0F                                                       32800000
         AGO   .FINISH                                                  32850000
.*                                                                      32900000
.* ******************************************************************** 32950000
.* *     ALL PARAMETERS ARE GOOD - BUILD LIST OF DEFINED CONSTANTS.     33000000
.* ******************************************************************** 33050000
.*                                                                      33100000
.EXEC    ANOP                                                           33150000
&FLAG1   SETC  '0&BIOO&BPGO&BMRO&BIRO.000'                              33200000
&FLAG2   SETC  '000000&BVRO.0'                                          33250000
&L       SETC  '&LABEL'                                                 33300000
         AIF   ('&L' NE '').TSTI                                        33350000
&L       SETC  'ICV&NO.S'                                               33400000
.TSTI    ANOP                                                           33450000
         AIF   ('&FM' EQ 'I').STNDRD                                    33500000
         AIF   ('&FM' EQ 'L').LIST                                      33550000
.*                                                                      33600000
.* ******************************************************************** 33650000
.* *     BEGIN BUILD FOR EXECUTE FORM OF MACRO                          33700000
.* ******************************************************************** 33750000
.*                                                                      33800000
         AIF   ('&LABEL' EQ '').OVER   SKIP OVER LABEL                  33850000
&L       EQU   *                                                        33900000
.OVER    ANOP                                                           33950000
         IHBINNRA &MF(2)                PARM LIST INTO REG 1            34000000
         AIF   ('&ACCESS' EQ '').E2     NO ACCESS=, SKIP                34050000
         MVI   6(1),X'&FUNCT'           SET FUNCTION CODE               34100000
         AGO   .E2                      GO TO COMMON ROUTINE            34150000
.*                                                                      34200000
.* ******************************************************************** 34250000
.* *     BEGIN BUILD FOR LIST FORM OF MACRO                             34300000
.* ******************************************************************** 34350000
.*                                                                      34400000
.LIST    ANOP                                                           34450000
         CNOP  0,4                                                      34500000
&L       EQU   *                                                        34550000
         AGO   .COMMON                  GO TO COMMON ROUTINE            34600000
.*                                                                      34650000
.* ******************************************************************** 34700000
.* *     BEGIN BUILD FOR STANDARD FORM OF MACRO                         34750000
.* ******************************************************************** 34800000
.*                                                                      34850000
.STNDRD  ANOP                                                           34900000
         CNOP  0,4                                                      34950000
&LABEL   BAL   1,ICV&NO.E               LOAD CVPL LIST ADDRESS          35000000
&L       SETC  'ICV&NO.S'               SET START OF CVPL               35050000
&L       EQU   *                        START OF CVPL                   35100000
.*                                                                      35150000
.* ******************************************************************** 35200000
.* *     COMMON BUILD CODE FOR MF=I AND L FORMS                         35250000
.* ******************************************************************** 35300000
.*                                                                      35350000
.COMMON  ANOP                                                           35400000
         DC    CL4'CVPL'                EBCDIC 'CVPL'                   35450000
         DC    AL2(ICV&NO.E-&L)         LENGTH OF CVPL                  35500000
         DC    XL1'&FUNCT'              FUNCTION CODE                   35550000
         DC    XL1'00'                  STATUS INFORMATION              35600000
         DC    B'&FLAG1'                FIRST FLAG BYTE                 35650000
         DC    B'&FLAG2'                SECOND FLAG BYTE                35700000
         DC    H'0'                     RESERVED                        35750000
.*                                                                      35800000
.* ******************************************************************** 35850000
.* *     UCB PROCESSING                                                 35900000
.* ******************************************************************** 35950000
.*                                                                      36000000
         AIF   ('&SWUCB' EQ '0').U3     NO UCB PRESENT, SKIP            36050000
         AIF   ('&UCBNCOR' EQ '0').U3   UCB IN REG, SKIP                36100000
         DC    A(&UCB)                  UCB ADDRESS                     36150000
         AGO   .D2                      GO ON TO DSN                    36200000
.U3      ANOP                                                           36250000
         DC    A(0)                     UCB ADDRESS                     36300000
.*                                                                      36350000
.* ******************************************************************** 36400000
.* *     DSN PROCESSING                                                 36450000
.* ******************************************************************** 36500000
.*                                                                      36550000
.D2      ANOP                                                           36600000
         AIF   ('&SWDSN' EQ '0').D3     NO DSN PRESENT, SKIP            36650000
         AIF   ('&DSNNCOR' EQ '0').D3   DSN IN REG, SKIP                36700000
         DC    A(&DSN)                  DATA SET NAME ADDRESS           36750000
         AGO   .B2                      GO ON TO BUFLIST                36800000
.D3      ANOP                                                           36850000
         DC    A(0)                     DATA SET NAME ADDRESS           36900000
.*                                                                      36950000
.* ******************************************************************** 37000000
.* *     BUFLIST PROCESSING                                             37050000
.* ******************************************************************** 37100000
.*                                                                      37150000
.B2      ANOP                                                           37200000
         AIF   ('&SWBUF' EQ '0').B3     NO BUFLIST PRESENT, SKIP        37250000
         AIF   ('&BUFNCOR' EQ '0').B3   BUFLIST IN REG, SKIP            37300000
         DC    A(&BUFLIST)              BUFFER LIST ADDRESS             37350000
         AGO   .I3                      GO ON TO IXRCDS                 37400000
.B3      ANOP                                                           37450000
         DC    A(0)                     BUFFER LIST ADDRESS             37500000
.*                                                                      37550000
.* ******************************************************************** 37600000
.* *     IXRCDS PROCESSING                                              37650000
.* ******************************************************************** 37700000
.*                                                                      37750000
.I3      ANOP                                                           37800000
         AIF   ('&SWIXR' EQ '0').I5     NO IXRCDS PRESENT, SKIP         37850000
         AIF   ('&IXRNCOR' EQ '0').I5   IXRCDS IN REG, SKIP             37900000
         DC    A(&IXRCDS(2))            INDEX VIR'S BUFFER LIST ADDRESS 37950000
         AGO   .M2                      GO ON TO MAPRCDS                38000000
.I5      ANOP                                                           38050000
         DC    A(0)                     INDEX VIR'S BUFFER LIST ADDRESS 38100000
.*                                                                      38150000
.* ******************************************************************** 38200000
.* *     MAPRCDS PROCESSING                                             38250000
.* ******************************************************************** 38300000
.*                                                                      38350000
.M2      ANOP                                                           38400000
         AIF   ('&SWMPR' EQ '0').M3     NO MAPRCDS PRESENT, SKIP        38450000
         AIF   ('&MPRNCOR' EQ '0').M3   MAPRCDS IN REG, SKIP            38500000
         DC    A(&MAPRCDS(2))           MAP VIR'S BUFFER LIST ADDRESS   38550000
         AGO   .O2                      GO ON TO IOAREA                 38600000
.M3      ANOP                                                           38650000
         DC    A(0)                     MAP VIR'S BUFFER LIST ADDRESS   38700000
.*                                                                      38750000
.* ******************************************************************** 38800000
.* *     IOAREA PROCESSING                                              38850000
.* ******************************************************************** 38900000
.*                                                                      38950000
.O2      ANOP                                                           39000000
         AIF   ('&SWIOA' EQ '0').O3     NO IOAREA PRESENT, SKIP         39050000
         AIF   ('&IOANCOR' EQ '0').O3   IOAREA IN REG, SKIP             39100000
         DC    A(&IOAREA(2))            I/O AREA ADDRESS                39150000
         AGO   .DEB2                    GO ON TO DEB                    39200000
.O3      ANOP                                                           39250000
         DC    A(0)                     I/O AREA ADDRESS                39300000
.*                                                                      39350000
.* ******************************************************************** 39400000
.* *     DEB PROCESSING                                                 39450000
.* ******************************************************************** 39500000
.*                                                                      39550000
.DEB2    ANOP                                                           39600000
         AIF   ('&SWDEB' EQ '0').DEB3   NO DEB PRESENT, SKIP            39650000
         AIF   ('&DEBNCOR' EQ '0').DEB3 DEB IN REG, SKIP                39700000
         DC    A(&DEB)                  DEB ADDRESS                     39750000
         AGO   .ARG2                    GO ON TO ARG                    39800000
.DEB3    ANOP                                                           39850000
         DC    A(0)                     DEB ADDRESS                     39900000
.ARG2    ANOP                                                           39950000
         DC    A(0)                     ARGUMENT ADDRESS                40000000
         DC    A(0)                     SPACE PARAMETER LIST ADDRESS    40050000
         DC    A(0)                     EXTENT TABLE ADDRESS            40100000
         DC    A(0)                     NEW VRF VIXM BUFFER LIST ADDR   40150000
         DC    A(0)                     VRF DATA ADDRESS                40200000
         DC    A(0)                     COUNT AREA ADDRESS              40250000
ICV&NO.E EQU   *                        END OF CVPL                     40300000
         AIF   ('&FM' EQ 'L').FINISH    LIST FORM IS DONE               40350000
.*                                                                      40400000
.* ******************************************************************** 40450000
.* *     COMMON BUILD CODE FOR MF=I AND (E,ADDR) FORMS                  40500000
.* ******************************************************************** 40550000
.*                                                                      40600000
.E2      ANOP                                                           40650000
         AIF   ('&FM' EQ 'I').UCB1                                      40700000
&FLAG1N  SETC  '1&BION&BPGN&BMRN&BIRN.111'                              40750000
         AIF   ('&FLAG1N' EQ '11111111').OF1                            40800000
         NI    8(1),B'&FLAG1N'          RESET CVAF FLAGS OFF            40850000
.OF1     ANOP                                                           40900000
         AIF   ('&FLAG1' EQ '00000000').NF2                             40950000
         OI    8(1),B'&FLAG1'           SET CVAF FLAGS ON               41000000
.NF2     ANOP                                                           41050000
         AIF   ('&BVRN' EQ '1').OF2                                     41100000
&FLAG2N  SETC  '111111&BVRN.1'                                          41150000
         NI    9(1),B'&FLAG2N'          RESET CVAF FLAGS OFF            41200000
.OF2     ANOP                                                           41250000
         AIF   ('&BVRO' EQ '0').UCB1                                    41300000
         OI    9(1),B'&FLAG2'           SET CVAF FLAGS ON               41350000
.*                                                                      41400000
.* ******************************************************************** 41450000
.* *     UCB PROCESSING                                                 41500000
.* ******************************************************************** 41550000
.*                                                                      41600000
.UCB1    ANOP                                                           41650000
         AIF   ('&SWUCB' EQ '0').DSN1   NO UCB TO PROCESS               41700000
         AIF   ('&UCBNCOR' EQ '1').UNC  UCB IN CORE, SKIP               41750000
         ST    &UCBNREG,12(,1)          STORE UCB PTR IN PARM LIST      41800000
         AGO   .DSN1                                                    41850000
.UNC     ANOP                                                           41900000
         AIF   ('&FM' EQ 'I').DSN1      MF=I, ALREADY THERE, SKIP       41950000
         LA    15,&UCB                  GET UCB ADDRESS AND             42000000
         ST    15,12(,1)                STORE UCB PTR IN PARM LIST      42050000
.*                                                                      42100000
.* ******************************************************************** 42150000
.* *     DSN PROCESSING                                                 42200000
.* ******************************************************************** 42250000
.*                                                                      42300000
.DSN1    ANOP                                                           42350000
         AIF   ('&SWDSN' EQ '0').BL1    NO DSN TO PROCESS               42400000
         AIF   ('&DSNNCOR' EQ '1').DNC  DSN IN CORE, SKIP               42450000
         ST    &DSNNREG,16(,1)          STORE DSN PTR IN PARM LIST      42500000
         AGO   .BL1                                                     42550000
.DNC     ANOP                                                           42600000
         AIF   ('&FM' EQ 'I').BL1       MF=I, ALREADY THERE, SKIP       42650000
         LA    15,&DSN                  GET DSN ADDRESS AND             42700000
         ST    15,16(,1)                STORE DSN PTR IN PARM LIST      42750000
.*                                                                      42800000
.* ******************************************************************** 42850000
.* *     BUFLIST PROCESSING                                             42900000
.* ******************************************************************** 42950000
.*                                                                      43000000
.BL1     ANOP                                                           43050000
         AIF   ('&SWBUF' EQ '0').IXR1   NO BUFLIST TO PROCESS           43100000
         AIF   ('&BUFNCOR' EQ '1').BNC  BUFLIST IN CORE, SKIP           43150000
         ST    &BUFNREG,20(,1)          STORE BUFLIST PTR IN PARM LIST  43200000
         AGO   .IXR1                                                    43250000
.BNC     ANOP                                                           43300000
         AIF   ('&FM' EQ 'I').IXR1      MF=I, ALREADY THERE, SKIP       43350000
         LA    15,&BUFLIST              GET BUFLIST ADDRESS AND         43400000
         ST    15,20(,1)                STORE BUFLIST PTR IN PARM LIST  43450000
.*                                                                      43500000
.* ******************************************************************** 43550000
.* *     IXRCDS PROCESSING                                              43600000
.* ******************************************************************** 43650000
.*                                                                      43700000
.IXR1    ANOP                                                           43750000
         AIF   ('&SWIXR' EQ '0').MPR1   NO IXRCDS TO PROCESS            43800000
         AIF   ('&IXRNCOR' EQ '1').INC  IXRCDS IN CORE, SKIP            43850000
         ST    &IXRNREG,24(,1)          STORE IXRCDS PTR IN PARM LIST   43900000
         AGO   .MPR1                                                    43950000
.INC     ANOP                                                           44000000
         AIF   ('&FM' EQ 'I').MPR1      MF=I, ALREADY THERE, SKIP       44050000
         LA    15,&IXRCDS(2)            GET IXRCDS ADDRESS AND          44100000
         ST    15,24(,1)                STORE ADDRESS IN PARM LIST      44150000
.*                                                                      44200000
.* ******************************************************************** 44250000
.* *     MAPRCDS PROCESSING                                             44300000
.* ******************************************************************** 44350000
.*                                                                      44400000
.MPR1    ANOP                                                           44450000
         AIF   ('&SWMPR' EQ '0').IOA1   NO MAPRCDS TO PROCESS           44500000
         AIF   ('&MPRNCOR' EQ '1').MNC  MAPRCDS IN CORE, SKIP           44550000
         ST    &MPRNREG,28(,1)          STORE MAPRCDS PTR IN PARM LIST  44600000
         AGO   .IOA1                                                    44650000
.MNC     ANOP                                                           44700000
         AIF   ('&FM' EQ 'I').IOA1      MF=I, ALREADY THERE, SKIP       44750000
         LA    15,&MAPRCDS(2)           GET MAPRCDS ADDRESS AND         44800000
         ST    15,28(,1)                STORE ADDRESS IN PARM LIST      44850000
.*                                                                      44900000
.* ******************************************************************** 44950000
.* *     IOAREA PROCESSING                                              45000000
.* ******************************************************************** 45050000
.*                                                                      45100000
.IOA1    ANOP                                                           45150000
         AIF   ('&SWIOA' EQ '0').DEB1   NO IOAREA TO PROCESS            45200000
         AIF   ('&IOANCOR' EQ '1').ONC  IOAREA IN CORE, SKIP            45250000
         ST    &IOANREG,32(,1)          STORE IOAREA PTR IN PARM LIST   45300000
         AGO   .DEB1                                                    45350000
.ONC     ANOP                                                           45400000
         AIF   ('&FM' EQ 'I').DEB1      MF=I, ALREADY THERE, SKIP       45450000
         LA    15,&IOAREA(2)            GET IOAREA ADDRESS AND          45500000
         ST    15,32(,1)                STORE ADDRESS IN PARM LIST      45550000
.*                                                                      45600000
.* ******************************************************************** 45650000
.* *     DEB PROCESSING                                                 45700000
.* ******************************************************************** 45750000
.*                                                                      45800000
.DEB1    ANOP                                                           45850000
         AIF   ('&SWDEB' EQ '0').BRANCH NO DEB TO PROCESS               45900000
         AIF   ('&DEBNCOR' EQ '1').ENC  DEB IN CORE, SKIP               45950000
         ST    &DEBNREG,36(,1)          STORE DEB PTR IN PARM LIST      46000000
         AGO   .BRANCH                                                  46050000
.ENC     ANOP                                                           46100000
         AIF   ('&FM' EQ 'I').BRANCH    MF=I, ALREADY THERE, SKIP       46150000
         LA    15,&DEB                  GET DEB ADDRESS AND             46200000
         ST    15,36(,1)                STORE ADDRESS IN PARM LIST      46230000
.*                                                                      46260000
.* ******************************************************************** 46290000
.* *     BRANCH PROCESSING -                                            46320000
.* *     LOAD THE CVT, THE VS1/VS2 COMMON EXTENTION 2 POINTER,          46350000
.* *     THE CVTCVAF PTR, THE CVAF POINTER AND BRANCH TO CVAF           46370000
.* *     COMMON ICVCMM00                                                46390000
.* ******************************************************************** 46450000
.*                                                                      46500000
.BRANCH  ANOP                                                           46550000
         AIF   ('&BRANCH' EQ '' OR '&BRANCH(1)' EQ 'NO').SVC139         46600000
         L     15,16                    LOAD THE CVT                    46650000
         L     15,328(,15)              LOAD VS1/VS2 COMMON EXTENTION2  46670000
         L     15,12(,15)               LOAD THE CVT CVAF TABLE         46690000
         CLI   14(15),X'81'             WHAT SYSTEM?               @L1A 46736300
         BNL   ICV&NO.B                 BRANCH IF X/A              @L1A 46782600
         L     15,0(,15)                LOAD THE CVAF ADDRESS      @L1A 46828900
         BALR  14,15                    BRANCH AND LINK TO         @L1A 46875200
*                                       GLUE MODULE ICVCMM01       @L1A 46921500
         B     ICV&NO.C                                            @L1A 46967800
ICV&NO.B EQU   *                        MUST SET MODE (BASSM)      @L1A 47014100
         L     15,28(,15)               LOAD THE CVAF ADDRESS      @L1A 47060400
         DC    X'0CEF'                  BR, SAVE & SET MODE TO     @L1A 47106700
*                                       MODULE ICVCMM00            @L1A 47153000
ICV&NO.C DS    0H                                                  @L1A 47176500
         AGO   .FINISH                                                  47200000
.* ******************************************************************** 47250000
.* *     SVC139 PROCESSING                                              47300000
.* ******************************************************************** 47350000
.*                                                                      47400000
.SVC139  ANOP                                                           47450000
         SVC   139                                                      47500000
.FINISH  ANOP                                                           47550000
         MEND                                                           47600000
