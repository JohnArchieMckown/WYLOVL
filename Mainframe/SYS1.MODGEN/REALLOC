*%GOTO REALPLS;   /* MACRO INTERFACE TO DADSM ALLOCATE (SVC 32)         00025000
         MACRO                                                          00050000
&LABEL   REALLOC &ALLOC=,&DSSIZE=,&F2DSCB=,&F3DSCB=,&MF=,&MINAU=,      *00083300
               &PDSCB=,&PDSDIR=,&UCB=,&VTOCENQD=                   @01C 00116600
.**** START OF SPECIFICATIONS ****************************************  00150000
.*                                                                      00200000
.*$MAC(REALLOC):     REALLOC INTERFACE TO ALLOCATE SVC(32)              00250000
.*                                                                      00300000
.*DESCRIPTIVE-NAME = REALLOC INTERFACE TO ALLOCATE SVC(32)              00350000
.*                                                                      00400000
*PROPRIETARY V3 STATEMENT                                               00428500
*LICENSED MATERIALS - PROPERTY OF IBM                                   00457000
*"RESTRICTED MATERIALS OF IBM"                                          00485500
*5695-DF1                                                               00514000
*(C) COPYRIGHT 1984,1988  IBM CORP.                                     00542500
*END PROPRIETARY V3 STATEMENT                                           00571000
.*                                                                      00600000
.* STATUS: DFP/XA 3.1.0                                                 00650000
.*                                                                      00700000
.*FUNCTION = THIS MACRO WILL SET UP THE REALLOC PARAMETER LIST TO       00750000
.*     ALLOW THE CALLER TO ALLOCATE A DATA SET BASED UPON A             00800000
.*     PARTIAL DSCB WITH:                                               00850000
.*          1. MINIMUM ALLOCATION UNIT REQUEST.                         00900000
.*          2. UP TO 16 EXTENTS FOR NON-ICF DATA SETS.                  00950000
.*          3. UP TO 123 EXTENTS FOR ICF DATA SETS.                     01000000
.*          4. PARTITIONED DATA SET DIRECTORY QUANTITY.                 01050000
.*          5. AN ABSOLUTE TRACK ALLOCATION FOR ANY TYPE DATA SET       01062500
.*             INCLUDING AN ISAM DATASET ORGANIZATION.  A MAXIMUM       01075000
.*             OF 16 EXTENTS MAY BE ALLOCATED IN THIS MANNER.           01087500
.*                                                                      01100000
.*                                                                      01250000
.*NOTES = THE CALLING PROGRAM:                                          01262500
.*          1. MUST BE APF AUTHORIZED.                                  01275000
.*          2. MUST HAVE ALLOCATED THE VOLUME TO THIS TASK AND ENSURE   01287500
.*             IT WILL STAY MOUNTED DURING THE REALLOC FUNCTION.        01300000
.*          3. MUST NOT BE HOLDING ANY LOCKS.                           01312500
.*          4. MAY BE SET TO ANY STORAGE KEY.                           01325000
.*          5. MAY BE IN EITHER SUPERVISOR OR PROBLEM PROGRAM STATE.    01337500
.*                                                                      01350000
.*     ALLOC=ABS SUPPORT IS PROVIDED FOR INDEXED VTOCS ONLY.            01400000
.*                                                                      01500000
.*     A USER LABEL DATA SET IS ONLY SUPPORTED WHEN ALLOC=ABS IS        01501500
.*     SPECIFIED.  IN THIS CASE EACH EXTENT OF THE DATA SET IS ALLO-    01503000
.*     CATED AS AN ABSOLUTE TRACK REQUEST.                              01504500
.*                                                                      01506000
.*     THE  ALX  AND  MIXG  OPTIONS, IF DEFINED WITHIN THE SPECIFIED    01507500
.*     DSCB, WILL BE IGNORED.                                           01509000
.*                                                                      01510500
.*     THE USER MAY INCLUDE THE CVAFTBL MAPPING MACRO (ICVAFPRM) IN     01512000
.*     THEIR PROGRAM AND TEST THE CVFDFPFT FIELD.  IF CVFREALL IS ON,   01513500
.*     THE REALLOC ALLOC=MOV FUNCTION IS SUPPORTED.  IF CVFPREL IS ON,  01515000
.*     BOTH THE ALLOC=ABS AND ALLOC=MOV FUNCTIONS ARE SUPPORTED.        01516500
.*                                                                      01518000
.*      ADDR , IN KEYWORD=ADDR | MF=(E,ADDR)                            01519500
.*            MUST BE SPECIFIED AS A LABEL OF AN AREA.                  01521000
.*            THIS LABEL MUST REPRESENT A VALID RX-TYPE ADDRESS         01522500
.*            WHEN USED IN THE MACRO S EXECUTE-FORM, AND A VALID        01524000
.*            A-TYPE ADDRESS WHEN USED IN THE MACRO S LIST-FORM.        01525500
.*                                                                      01527000
.*      NUMBER , IN KEYWORD=NUMBER | KEYWORD=(REG)                      01528500
.*            MAY BE SPECIFIED AS EITHER A LABEL (A VALID RX-TYPE       01530000
.*            ADDRESS) OF A FULLWORD CONTAINING THE NUMBER, OR A        01531500
.*            REGISTER CONTAINING THE NUMBER.                           01533000
.*                                                                      01534500
.*      REG , IN KEYWORD=(REG) | MF=(E,(REG))                           01536000
.*            MAY BE SPECIFIED AS ANY REGISTER, 2 - 12.                 01537500
.*                                                                      01539000
.*      SIZE , IN KEYWORD=SIZE | KEYWORD=(REG)                          01540500
.*            MAY BE SPECIFIED AS EITHER A LABEL (A VALID RX-TYPE       01542000
.*            ADDRESS) OF A FULLWORD CONTAINING THE SIZE, OR A REGISTER 01543500
.*            CONTAINING THE SIZE.                                      01545000
.*                                                                      01546500
.*                                                                      01548000
.*KEYWORDS APPLICABLE TO THE REALLOC MACRO ARE:                         01550000
.*                                                                      01600000
.*  MF=        THE  MF  KEYWORD IS REQUIRED.  IT'S SUB-PARAMETERS WILL  01641600
.*             DETERMINE WHETHER THE REALLOC PARAMETER LIST IS EXPANDED 01683200
.*             AND/OR EXECUTABLE INSTRUCTIONS ARE GENERATED TO INVOKE   01724800
.*             SVC32.  THE FOLLOWING SUB-PARAMETERS ARE VALID FOR THE   01766400
.*              MF  KEYWORD:                                            01808000
.*                                                                      01850000
.*  MF=D       THE SPECIFICATION OF MF=D WILL RESULT IN THE EXPANSION   01900000
.*             OF THE PARAMETER LIST IN DSECT FORMAT WITH LABELS FOR    02000000
.*             EACH OF THE FIELDS IN THE PARAMETER LIST.  IN THIS FORM  02016600
.*             OF THE MACRO, NO OTHER MACRO PARAMETERS WILL APPLY (IF   02033200
.*             THEY ARE SPECIFIED, THEY WILL BE IGNORED AND AN MNOTE    02049800
.*             ISSUED).  THIS FORM OF THE MACRO WILL NOT GENERATE THE   02066400
.*             ALLOCATE SVC 32.                                         02083000
.*                                                                      02100000
.*  MF=(E,ADDR) | MF=(E,(REG)) | MF=(E,(1))                             02150000
.*             THE SPECIFICATION OF ANY OF THE ABOVE FORMATS FOR THE    02200000
.*              MF  KEYWORD WILL RESULT IN THE MODIFICATION OF AN       02250000
.*             EXISTING PARAMETER LIST.  THE ADDRESS OF THE PARAMETER   02300000
.*             LIST IS PROVIDED VIA THE SECOND SUB-PARAMETER ( ADDR ,   02350000
.*              REG , OR  1 ).  THIS SPECIFICATION WILL ALSO RESULT IN  02400000
.*             THE GENERATION OF THE ALLOCATE SVC (32).  THIS IS CALLED 02450000
.*             THE EXECUTE-FORM OF THE MACRO.                           02550000
.*                                                                      02600000
.*  MF=L       THE SPECIFICATION OF MF=L WILL RESULT IN THE EXPANSION   02650000
.*             OF THE PARAMETER LIST AND INITIALIZE IT ACCORDING TO     03100000
.*             THE SPECIFIED KEYWORDS.  HOWEVER, IF A REGISTER IS USED  03150000
.*             INSTEAD OF AN ADDRESS OR A PARAMETER SPECIFING A  SIZE   03175000
.*             OR  NUMBER  IS USED, THE LIST WILL CONTAIN EITHER AN     03200000
.*             ADCON OR A FULLWORD SPECIFICATION OF ZEROS (AN MNOTE     03225000
.*             WILL BE ISSUED).  THIS FORM OF THE MACRO WILL NOT        03250000
.*             GENERATE THE ALLOCATE SVC 32.                            03275000
.*                                                                      03300000
.*                                                                      03450000
.*  ALLOC=ABS  THE SPECIFICATION OF ALLOC=ABS IDENTIFIES A REQUEST TO   03500000
.*             ALLOCATE A DATA SET BY ABSOLUTE TRACK ADDRESSES.         03550000
.*             ALLOC=ABS IS ONLY SUPPORTED FOR VOLUMES CONTAINING AN    03600000
.*             INDEXED VTOC.  A USER LABEL IS ONLY SUPPORTED WHEN       03650000
.*             ALLOC=ABS IS SPECIFIED.                                  03700000
.*                                                                      03750000
.*             THE REALLOC FUNCTION (ALLOC=ABS):                        03751800
.*             1. MUST BE PROVIDED WITH THE ADDRESS OF A 140 BYTE AREA  03753600
.*                WHICH DESCRIBES A FORMAT 1 DSCB (PDSCB=ADDR MAY BE    03755400
.*                USED).  A MAXIMUM OF 3 EXTENTS WILL BE IDENTIFIED     03757200
.*                WITHIN THE FORMAT 1 DSCB.  IF THE DATA SET IS         03759000
.*                ALLOCATED, THIS DSCB WILL BE USED AS THE MODEL FOR    03760800
.*                THE DSCB WRITTEN IN THE VTOC.  DS1NOEPV WILL BE       03762600
.*                VALIDITY CHECKED AGAINST THE ACTUAL EXTENTS IN THE    03764400
.*                FORMAT 1/3 DSCB(S).  DS1LSTAR (LAST USED TRACK AND    03766200
.*                BLOCK ON TRACK) AND DS1PTRDS (THE FORWARD CHAIN       03768000
.*                POINTER) ARE FIELDS IN THE FORMAT 1 DSCB THAT MAY BE  03769800
.*                MODIFIED.  THE REMAINDER OF THE FIELDS WILL BE        03771600
.*                UNCHANGED.                                            03773400
.*             2. MUST BE PROVIDED WITH THE ADDRESS OF THE VOLUME S UCB 03775200
.*                (UCB=(REG) MAY BE USED).  THE VOLUME IDENTIFIED BY    03777000
.*                THIS UCB MUST BE ALLOCATED TO THIS TASK AND REMAIN    03778800
.*                MOUNTED OR THE CALL TO ALLOCATION WILL FAIL.  EACH    03780600
.*                VOLUME OF A MULTIVOLUME DATA SET MUST BE REQUESTED    03782400
.*                SEPARATELY, SINCE VOLUME SWITCHING WILL NOT BE DONE.  03784200
.*             3. MAY OPTIONALLY BE PROVIDED WITH THE ADDRESS OF AN     03786000
.*                AREA WHICH DESCRIBES A FORMAT 3 DSCB (F3DSCB=ADDR MAY 03787800
.*                BE USED).  THIS AREA MUST BE SPECIFIED FOR ANY DATA   03789600
.*                SET WHICH REQUIRES MORE THAN THREE EXTENTS.  A        03791400
.*                MAXIMUM OF 13 EXTENTS WILL BE IDENTIFIED WITHIN THE   03793200
.*                FORMAT 3 DSCB.  THEREFORE A MAXIMUM OF 16 EXTENTS MAY 03795000
.*                BE ALLOCATED.  DATA SETS WITH MORE THAN ONE FORMAT 3  03796800
.*                DSCB WILL NOT BE SUPPORTED.  IF A FORMAT 3 DSCB       03798600
.*                ADDRESS IS PROVIDED, THE FORMAT 1 DSCB FORWARD CHAIN  03800400
.*                POINTER (DS1PTRDS) OR THE FORMAT 2 DSCB FORWARD CHAIN 03802200
.*                POINTER (DS2PTRDS) WILL BE MODIFIED TO POINT TO THE   03804000
.*                NEW FORMAT 3 DSCB.                                    03805800
.*             4. MAY OPTIONALLY BE PROVIDED WITH THE ADDRESS OF AN     03807600
.*                AREA WHICH DESCRIBES A FORMAT 2 DSCB (F2DSCB=ADDR MAY 03809400
.*                BE USED).  IF PROVIDED:                               03811200
.*                A. THE FORMAT 1 DSCB MUST INDICATE DSORG=IS AND NO    03813000
.*                   USER LABEL.                                        03814800
.*                B. THE FORMAT 2 DSCB COPY WILL BE USED TO MODEL THE   03816600
.*                   NEW FORMAT 2 DSCB.  THE ONLY FIELD THAT WILL BE    03818400
.*                   BE MODIFIED IS THE DS2PTRDS THAT WILL POINT TO     03820200
.*                   THE NEW FORMAT 3 DSCB, IF REQUIRED.                03822000
.*             5. MAY OPTIONALLY BE PROVIDED WITH THE NUMBER OF 256     03823800
.*                BYTE DIRECTORY BLOCKS FOR THE DIRECTORY OF A          03825600
.*                PARTITIONED DATA SET (PDSDIR=NUMBR MAY BE USED).      03827400
.*                IF THE FORMAT 1 DSCB INDICATES DSORG=PO A VALUE FOR   03829200
.*                DIRECTORY BLOCKS IS REQUIRED.  FURTHER:               03831000
.*                A. THE FORMAT 1 DSCB MUST NOT INDICATE A USER LABEL.  03832800
.*                B. THE NUMBER OF DIRECTORY BLOCKS SPECIFIED MUST FIT  03834600
.*                   IN THE FIRST EXTENT GIVEN IN THE FORMAT 1 DSCB.    03836400
.*                C. IF NO ERRORS ARE FOUND, THE DIRECTORY WILL BE      03838200
.*                   FORMATTED.                                         03840000
.*                IF THE FORMAT 1 DSCB INDICATES A DSORG OTHER THAN     03841800
.*                PO, A VALUE FOR DIRECTORY BLOCKS MAY NOT BE           03843600
.*                SPECIFIED.                                            03845400
.*                                                                      03850000
.*                                                                      04100000
.*  ALLOC=MOV  THE SPECIFICATION OF ALLOC=MOV IDENTIFIES A REQUEST TO   04125000
.*             ALLOCATE A DATA SET ANYWHERE ON THE VOLUME.  THE REALLOC 04150000
.*             MACRO WILL DEFAULT TO ALLOC=MOV WHENEVER THE  ALLOC      04175000
.*             KEYWORD IS NOT CODED AS A PARAMETER.  ISAM IS NOT        04200000
.*             SUPPORTED.  A USER LABEL IS NOT SUPPORTED.               04225000
.*                                                                      04250000
.*             THE REALLOC FUNCTION (ALLOC=MOV):                        04254000
.*             1. MUST BE PROVIDED WITH THE ADDRESS OF A PARTIAL DSCB   04258000
.*                (PDSCB=ADDR MAY BE USED).  THIS DSCB (MAPPED BY MACRO 04262000
.*                IECPDSCB) WILL BE USED AS THE MODEL FOR THE DSCB      04266000
.*                WRITTEN IN THE VTOC IF THE DATA SET IS ALLOCATED.     04270000
.*                DS1NOEPV (THE NUMBER OF EXTENTS), DS1LSTAR (LAST USED 04274000
.*                TRACK AND BLOCK ON TRACK), AND DS1PTRDS (THE FORWARD  04278000
.*                CHAIN POINTER) ARE FIELDS IN THE FORMAT 1 DSCB THAT   04282000
.*                MAY BE MODIFIED.  THE REMAINDER OF THE FIELDS WILL BE 04286000
.*                UNCHANGED.                                            04290000
.*             2. MUST BE PROVIDED WITH THE ADDRESS OF THE VOLUME S     04294000
.*                UCB (UCB=(REG) MAY BE USED).  THE VOLUME IDENTIFIED   04298000
.*                BY THIS UCB MUST BE ALLOCATED TO THIS TASK AND        04302000
.*                REMAIN MOUNTED OR THE CALL TO ALLOCATION WILL FAIL.   04306000
.*                EACH VOLUME OF A MULTIVOLUME DATA SET MUST BE         04310000
.*                REQUESTED SEPARATELY, SINCE VOLUME SWITCHING WILL     04314000
.*                NOT BE DONE.                                          04318000
.*             3. MUST BE PROVIDED WITH THE SIZE OF THE DATASET IN      04322000
.*                TRACKS (DSSIZE=SIZE MAY BE USED).  THE MAXIMUM NUMBER 04326000
.*                OF EXTENTS WILL BE DETERMINED BY THE PARTIAL DSCB S   04330000
.*                SPECIFICATION OF DATA SET TYPE:                       04334000
.*                A. 123 EXTENTS FOR VSAM DATA SETS CATALOGED IN AN     04338000
.*                   ICF CATALOG.                                       04342000
.*                B. 16 EXTENTS FOR ALL OTHER DATA SETS.                04346000
.*                THE ALLOCATION WILL ALWAYS USE THE FEWEST POSSIBLE    04350000
.*                EXTENTS REQUIRED TO FILL THE REQUEST.                 04354000
.*             4. MAY OPTIONALLY BE PROVIDED WITH THE NUMBER OF TRACKS  04358000
.*                TO BE USED AS A MINIMUM ALLOCATION UNIT (MINAU=NUMBER 04362000
.*                MAY BE USED).                                         04366000
.*                IF THE SPECIFIED (OR DEFAULTED) DATASET SIZE IS       04370000
.*                   ZERO, THIS FIELD MUST BE SPECIFIED (OR DEFAULTED)  04374000
.*                   TO BE A VALUE OF ZERO.                             04378000
.*                ELSE                                                  04382000
.*                   IF THE PARTIAL DSCB INDICATES THAT THE DATASET IS  04386000
.*                      TO BE ALLOCATED IN CYLINDERS, OR  AVERAGE BLOCK 04390000
.*                      AND ROUND  IS INDICATED, THIS VALUE WILL BE     04394000
.*                      OVERRIDDEN AND THE ALLOCATION WILL BE IN        04398000
.*                      MULTIPLES OF ONE CYLINDER.                      04402000
.*                   ELSE                                               04406000
.*                      IF THIS VALUE (MINIMUM ALLOCATION UNIT) IS NOT  04410000
.*                         SPECIFIED, A VALUE OF 1 WILL BE ASSUMED.     04414000
.*                      OTHERWISE, THE SPECIFIED DATASET SIZE MUST BE   04418000
.*                         A MULTIPLE OF THE MINIMUM ALLOCATION UNIT.   04422000
.*                         IF THE DATASET IS ALLOCATED, ALL EXTENTS     04426000
.*                         WILL BE ALLOCATED IN MULTIPLES OF THIS SIZE. 04430000
.*             5. MAY OPTIONALLY BE PROVIDED WITH THE NUMBER OF 256     04434000
.*                BYTE DIRECTORY BLOCKS FOR THE DIRECTORY OF A          04438000
.*                PARTITIONED DATA SET (PDSDIR=NUMBR MAY BE USED).      04442000
.*                IF THIS NUMBER IS PROVIDED IN THE REALLOC PARAMETER   04446000
.*                LIST, THE QUANTITY IN PDDIRQTY WILL BE OVERLAYED.     04450000
.*                IF THIS NUMBER IS NOT PROVIDED IN THE REALLOC PARA-   04454000
.*                METER LIST, THE QUANTITY IN PDDIRQTY WILL BE USED.    04458000
.*                IF THE FORMAT 1 DSCB INDICATES DSORG=PO A VALUE FOR   04462000
.*                DIRECTORY BLOCKS IS REQUIRED.  FURTHER:               04466000
.*                A. THE FORMAT 1 DSCB MUST NOT INDICATE A USER LABEL.  04470000
.*                B. THE NUMBER OF DIRECTORY BLOCKS SPECIFIED MUST FIT  04474000
.*                   IN THE FIRST EXTENT GIVEN IN THE FORMAT 1 DSCB.    04478000
.*                C. IF NO ERRORS ARE FOUND, THE DIRECTORY WILL BE      04482000
.*                   FORMATTED.                                         04486000
.*                IF THE FORMAT 1 DSCB INDICATES A DSORG OTHER THAN     04490000
.*                PO, THE VALUE FOR DIRECTORY BLOCKS MUST BE ZERO.      04494000
.*                                                                      04500000
.*  DSSIZE=SIZE | DSSIZE=(REG)                                          04510700
.*             THE  DSSIZE  KEYWORD MAY BE USED TO SPECIFY THE NUMBER   04521400
.*             OF TRACKS DESIRED FOR THE DATA SET BEING ALLOCATED.      04532100
.*             PLEASE REFERENCE NOTE 3. ON ALLOC=MOV (ABOVE) FOR        04542800
.*             INFORMATION ON THE USE OF THIS VALUE.                    04553500
.*             THIS PARAMETER WILL ONLY APPLY IF ALLOC=MOV IS SPECIFIED 04564200
.*             (OR DEFAULTED) AND THE EXECUTE-FORM IS REQUESTED.        04574900
.*              SIZE , IN DSSIZE=SIZE, MUST BE SPECIFIED AS THE LABEL   04585600
.*                   OF A FULLWORD.  THE FULLWORD WILL CONTAIN THE      04596300
.*                   DESIRED NUMBER OF TRACKS.                          04607000
.*              REG , IN DSSIZE=(REG), MUST REPRESENT ANY REGISTER,     04617700
.*                   2 - 12.  THE REGISTER WILL CONTAIN THE DESIRED     04628400
.*                   NUMBER OF TRACKS.                                  04639100
.*                                                                      04650000
.*  F2DSCB=ADDR | F2DSCB=(REG)                                          04666600
.*             THE  F2DSCB  KEYWORD MAY BE USED TO SPECIFY THE ADDRESS  04683200
.*             OF AN AREA WHICH DESCRIBES A FORMAT 2 DSCB.  PLEASE REF- 04699800
.*             ERENCE NOTE 4. ON ALLOC=ABS (ABOVE) FOR INFORMATION ON   04716400
.*             THE USE OF THIS AREA.                                    04733000
.*             THIS PARAMETER WILL ONLY APPLY IF ALLOC=ABS IS SPECIFIED 04749600
.*             AND THE EXECUTE OR LIST-FORM IS REQUESTED.  IF THE LIST- 04766200
.*             FORM IS REQUESTED, THE  REG  FORMAT FOR THIS PARAMETER   04782800
.*             WILL NOT APPLY.                                          04799400
.*              ADDR , IN F2DSCB=ADDR, MUST BE SPECIFIED AS THE LABEL   04816000
.*                   OF AN AREA WHICH DESCRIBES A FORMAT 2 DSCB.        04832600
.*              REG , IN F2DSCB=(REG), MUST REPRESENT ANY REGISTER,     04849200
.*                   2 - 12.  THE REGISTER WILL CONTAIN THE ADDRESS     04865800
.*                   OF AN AREA WHICH DESCRIBES A FORMAT 2 DSCB.        04882400
.*                                                                      04900000
.*  F3DSCB=ADDR | F3DSCB=(REG)                                          04910000
.*             THE  F3DSCB  KEYWORD MAY BE USED TO SPECIFY THE ADDRESS  04920000
.*             OF AN AREA WHICH DESCRIBES A FORMAT 3 DSCB.  PLEASE REF- 04930000
.*             ERENCE NOTE 3. ON ALLOC=ABS (ABOVE) FOR INFORMATION ON   04940000
.*             THE USE OF THIS AREA.                                    04950000
.*             THIS PARAMETER WILL ONLY APPLY IF ALLOC=ABS IS SPECIFIED 04960000
.*             AND THE EXECUTE OR LIST-FORM IS REQUESTED.  IF THE LIST- 04970000
.*             FORM IS REQUESTED, THE  REG  FORMAT FOR THIS PARAMETER   04980000
.*             WILL NOT APPLY.                                          04990000
.*              ADDR , IN F3DSCB=ADDR, MUST BE SPECIFIED AS THE LABEL   05000000
.*                   OF AN AREA WHICH DESCRIBES A FORMAT 3 DSCB.        05010000
.*              REG , IN F3DSCB=(REG), MUST REPRESENT ANY REGISTER,     05020000
.*                   2 - 12.  THE REGISTER WILL CONTAIN THE ADDRESS     05030000
.*                   OF AN AREA WHICH DESCRIBES A FORMAT 3 DSCB.        05040000
.*                                                                      05050000
.*  MINAU=NUMBER | MINAU=(REG)                                          05067800
.*             THE  MINAU  KEYWORD MAY BE USED TO SPECIFY THE MINIMUM   05085600
.*             ALLOCATION UNIT, IN TRACKS, FOR THE DATA SET BEING       05103400
.*             ALLOCATED.  PLEASE REFERENCE NOTE 4. ON ALLOC=MOV        05121200
.*             (ABOVE) FOR INFORMATION ON THE USE OF THIS VALUE.        05139000
.*             THIS PARAMETER WILL ONLY APPLY IF ALLOC=MOV IS SPECIFIED 05156800
.*             (OR DEFAULTED) AND THE EXECUTE-FORM IS REQUESTED.        05174600
.*              NUMBER , IN MINAU=NUMBER, MUST BE SPECIFIED AS THE      05192400
.*                   LABEL OF A FULLWORD.  THE FULLWORD WILL CONTAIN    05210200
.*                   THE DESIRED NUMBER OF TRACKS.                      05228000
.*              REG , IN MINAU=(REG), MUST REPRESENT ANY REGISTER,      05245800
.*                   2 - 12.  THE REGISTER WILL CONTAIN THE DESIRED     05263600
.*                   NUMBER OF TRACKS.                                  05281400
.*                                                                      05300000
.*  PDSCB=ADDR | PDSCB=(REG)                                            05310700
.*             THE  PDSCB  KEYWORD MAY BE USED TO SPECIFY THE ADDRESS   05321400
.*             OF AN AREA WHICH DESCRIBES A FORMAT 1 DSCB.  PLEASE      05332100
.*             REFERENCE NOTE 1. ON ALLOC=ABS AND ALLOC=MOV (ABOVE)     05342800
.*             FOR INFORMATION ON THE USE OF THIS AREA.                 05353500
.*             THIS PARAMETER WILL NOT APPLY TO THE DSECT-FORM OF THIS  05364200
.*             MACRO.  IF THE LIST-FORM IS REQUESTED, THE  REG  FORMAT  05374900
.*             FOR THIS PARAMETER WILL NOT APPLY.                       05385600
.*              ADDR , IN PDSCB=ADDR, MUST BE SPECIFIED AS THE LABEL    05396300
.*                   OF AN AREA WHICH DESCRIBES A FORMAT 1 DSCB.        05407000
.*              REG , IN PDSCB=(REG), MUST REPRESENT ANY REGISTER,      05417700
.*                   2 - 12.  THE REGISTER WILL CONTAIN THE ADDRESS     05428400
.*                   OF AN AREA WHICH DESCRIBES A FORMAT 1 DSCB.        05439100
.*                                                                      05450000
.*  PDSDIR=NUMBER | PDSDIR=(REG)                                        05464200
.*             THE  PDSDIR  KEYWORD MAY BE USED TO SPECIFY THE NUMBER   05478400
.*             OF 256 BYTE DIRECTORY BLOCKS FOR THE DATA SET BEING      05492600
.*             ALLOCATED.  PLEASE REFERENCE NOTE 5. ON ALLOC=ABS AND    05506800
.*             ALLOC=MOV (ABOVE) FOR INFORMATION ON THE USE OF THIS     05521000
.*             VALUE.  THIS PARAMETER WILL ONLY APPLY IF THE EXECUTE-   05535200
.*             FORM THIS MACRO IS REQUESTED.                            05549400
.*              NUMBER , IN PDSDIR=NUMBER, MUST BE SPECIFIED AS THE     05563600
.*                   LABEL OF A FULLWORD.  THE FULLWORD WILL CONTAIN    05577800
.*                   THE DESIRED NUMBER OF DIRECTORY BLOCKS.            05592000
.*              REG , IN PDSDIR=(REG), MUST REPRESENT ANY REGISTER,     05606200
.*                   2 - 12.  THE REGISTER WILL CONTAIN THE DESIRED     05620400
.*                   NUMBER OF DIRECTORY BLOCKS.                        05634600
.*                                                                      05650000
.*                                                                      05800000
.*  UCB=(REG)                                                           05816600
.*             THE  UCB  KEYWORD MAY BE USED TO SPECIFY THE ADDRESS     05833200
.*             OF THE UCB WHICH DESCRIBES THE VOLUME UPON WHICH THE     05849800
.*             DATA SET IS TO BE ALLOCATED.  PLEASE REFERENCE NOTE 2.   05866400
.*             ON ALLOC=ABS AND ALLOC=MOV (ABOVE) FOR INFORMATION ON    05883000
.*             THE USE OF THIS AREA.                                    05899600
.*             THIS PARAMETER WILL ONLY APPLY TO THE EXECUTE-FORM       05916200
.*             OF THIS MACRO.                                           05932800
.*              REG , IN UCB=(REG), MUST REPRESENT ANY REGISTER,        05949400
.*                   2 - 12.  THE REGISTER WILL CONTAIN THE ADDRESS     05966000
.*                   OF THE UCB.                                        05982600
.*                                                                      06000000
.*  VTOCENQD=YES|NO                                                @01A 06010000
.*             YES INDICATES THAT THE VTOC ENQ IS ALREADY HELD.    @01A 06020000
.*             IF YES IS SPECIFIED,  DADSM WILL VERIFY THAT THE    @01A 06030000
.*             CURRENT TASK HOLDS THE VTOC ENQ EXCLUSIVE, AND      @01A 06040000
.*             FAIL THE REQUEST IF THIS VERIFICATION FAILS.        @01A 06050000
.*             YES IS INVALID WITH ALLOC=ABS.                      @01A 06060000
.*             YES MAY ONLY BE SPECIFIED BY AUTHORIZED CALLERS.    @01A 06070000
.*             IF NO IS SPECIFIED, OR VTOCENQD IS NOT SPECIFIED,   @01A 06080000
.*             DADSM WILL OBTAIN THE VTOC ENQ EXCLUSIVE.           @01A 06090000
.*                                                                      06150000
.*SUMMARY OF PARAMETERS -- KEYWORD=OPTION COMBINATIONS:                 06175000
.*                                                                      06200000
.*        THE  MF  KEYWORD IS REQUIRED.  THE  ALLOC  KEYWORD HAS A      06250000
.*        DEFAULT OF  MOV .  THE SPECIFICATION OF ALL OTHER KEYWORDS    06300000
.*        IS DEFINED AS A FUNCTION OF  ALLOC  AND/OR  MF :              06350000
.*                                                                      06500000
.* MF  ALLOC DSSIZE F2DSCB F3DSCB MINAU PDSCB PDSDIR UCB  VTOCENQD @01C 06518700
.* --  ----- ------ ------ ------ ----- ----- ------ ---- -------- @01C 06537400
.* D   IG    IG     IG     IG     IG    IG    IG     IG     IG     @01C 06556100
.* E   ABS   IG     OPT    OPT    IG    OPT   OPT    REG    NO     @01C 06574800
.* E   MOV   OPT    IG     IG     OPT   OPT   OPT    REG    YES|NO @01C 06593500
.* L   ABS   IG     ADDR   ADDR   IG    ADDR  IG     IG     NO     @01C 06612200
.* L   MOV   IG     IG     IG     IG    ADDR  IG     IG     YES|NO @01C 06630900
.*                                                                      06650000
.*        ENTRIES IN THE ABOVE TABLE IDENTIFY RESTRICTIONS ON THE       06700000
.*        REALLOC MACRO PARAMETERS AS:                                  06750000
.*                                                                      06900000
.*        ADDR THE PARAMETER IS OPTIONAL.  IF THE PARAMETER IS          06918700
.*             SPECIFIED, IT IS RESTRICTED TO THE KEYWORD=LABEL         06937400
.*             FORMAT.  IF THE PARAMETER IS SPECIFIED IN THE            06956100
.*             KEYWORD=(REG) FORMAT:                                    06974800
.*                1. THE PARAMETER IS IGNORED, AND                      06993500
.*                2. ONE 4 LEVEL MNOTE IS ISSUED FOR THE MACRO CALL     07012200
.*                   (IF NO MAJOR ERROR IS FOUND).                      07030900
.*                                                                      07050000
.*        IG   IF THE PARAMETER IS SPECIFIED:                           07080000
.*                1. THE PARAMETER IS IGNORED, AND                      07110000
.*                2. ONE 4 LEVEL MNOTE IS ISSUED FOR THE MACRO CALL     07140000
.*                   (IF NO MAJOR ERROR IS FOUND).                      07170000
.*                                                                      07200000
.*        OPT  THE PARAMETER IS OPTIONAL.  IF THE PARAMETER IS          07250000
.*             SPECIFIED, EITHER FORMAT:  KEYWORD=LABEL, OR             07300000
.*             KEYWORD=(REG) MAY BE USED.                               07350000
.*                                                                      07450000
.*        REG  THE PARAMETER IS OPTIONAL.  IF THE PARAMETER IS          07487500
.*             SPECIFIED, IT IS RESTRICTED TO THE KEYWORD=(REG)         07525000
.*             FORMAT.                                                  07562500
.*                                                                      07567800
.*        NO   THE PARAMETER IS OPTIONAL.  IF THE PARAMETER IS     @01A 07573100
.*             SPECIFIED, IT IS RESTRICTED TO KEYWORD=NO.          @01A 07578400
.*                                                                      07583700
.*        YES|NO THE PARAMETER IS OPTIONAL.  KEYWORD=YES OR        @01A 07589000
.*               KEYWORD=NO MAY BE SPECIFIED.                      @01A 07594300
.*                                                                      07600000
.*        ALL REFERENCES TO THE WORD  OPTIONAL  IS RELATIVE TO          07630000
.*        PARAMETER SPECIFICATION ON THE MACRO CALL.  THE REALLOC       07660000
.*        FUNCTION WILL REQUIRE INFORMATION TO BE SPECIFIED PRIOR TO    07690000
.*        THE EXECUTION OF SVC32 OR THE ALLOCATION WILL FAIL.           07720000
.*                                                                      07750000
.*MODULE-TYPE = MACRO                                                   07950000
.*                                                                      08000000
.*PROCESSOR = ASSEMBLER LANGUAGE / PLS                                  08050000
.*                                                                      08100000
.*ATTRIBUTES = EXECUTABLE MACRO                                         08150000
.*                                                                      08200000
.*ENTRY-POINT = MACRO STATEMENT.                                        08250000
.*                                                                      08300000
.*INPUT = SEE DESCRIPTION OF KEYWORDS UNDER  FUNCTION .                 08350000
.*                                                                      08400000
.*OUTPUT = REALLOC PARAMETER LIST WITH THE FLAGS AND THE ADDRESSES      08450000
.*         SET DEPENDING UPON THE KEYWORDS SPECIFIED AS DEFINED         08500000
.*         UNDER  KEYWORDS  ABOVE.                                      08550000
.*                                                                      08600000
.*EXIT-NORMAL = MEND STATEMENT.                                         08650000
.*                                                                      08700000
.*EXIT-ERROR  = MNOTE AND MEND STATEMENT.  MNOTES WILL BE GENERATED     08750000
.*              FOR ANY OF THE FOLLOWING ERRORS ENCOUNTERED:            08800000
.*                                                                      08850000
.*              FOR ALL FORMS OF THE MACRO:                             08900000
.*                 1. MF IS A REQUIRED KEYWORD.                         08950000
.*                 2. INVALID OPERAND - KEYWORD=OPERAND.                09000000
.*                 3. ONE OR MORE PARAMETERS IGNORED DUE TO ALLOC       09016600
.*                    AND/OR MF                                         09033200
.*                                                                      09050000
.*              FOR THE EXECUTE FORM OF THE MACRO:                      09100000
.*                 1. MF=(E,ADDR) FORM: SUPPLY PARAMETER LIST ADDRESS.  09150000
.*                                                                      09350000
.*EXTERNAL-REFERENCES = NONE                                            09400000
.*                                                                      09450000
.*TABLES = NONE                                                         09500000
.*                                                                      09550000
.*MACROS = IHBINNRA                                                     09600000
.*                                                                      09650000
.*CHANGE-ACTIVITY = ADDED ALLOC=ABS                                     09700000
.*                = ADDED VTOCENQD                                      09710000
.*                                                                      09750000
.*    MVS/XA,JDP1111,,STLBS: REALLOC INTERFACE MACRO TO ALLOCATE        09783300
.*$L0=MVS/XA,HDP2210,,STLAM: REPLACEMENT OF REALLOC MACRO               09816600
.*$L1=MVS/XA,HDP3310,,STLAM: DADSM SUPPORT FOR SMS                @L1A  09833300
.*$01=OY38616,HDP3330,90288,SJPLKSC:SUPPORT CONDITIONAL            @01A 09838800
.*                                  ACQUISITION OF VTOC ENQ.       @01A 09844300
.*                                                                      09850000
.**** END OF SPECIFICATIONS ******************************************  09900000
.*                                                                      09947900
         LCLB  &ABS       ALLOC=ABS WAS SPECIFIED                       09995800
         LCLB  &DSSIZEA   DSSIZE=ADDR WILL BE USED                      10043700
         LCLB  &DSSIZER   DSSIZE=(REG) WILL BE USED                     10091600
         LCLB  &ERRORSW   A MAJOR ERROR WAS DETECTED                    10139500
         LCLB  &F2DSCBA   F2DSCB=ADDR WILL BE USED                      10187400
         LCLB  &F2DSCBR   F2DSCB=(REG) WILL BE USED                     10235300
         LCLB  &F3DSCBA   F3DSCB=ADDR WILL BE USED                      10283200
         LCLB  &F3DSCBR   F3DSCB=(REG) WILL BE USED                     10331100
         LCLC  &L         LOCAL LABEL VARIABLE                          10379000
         LCLB  &MFD       MF=D WAS SPECIFIED                            10426900
         LCLB  &MFDL      EITHER MF=D OR MF=L WAS SPECIFIED             10474800
         LCLB  &MFE       MF=(E,..) WAS SPECIFIED                       10522700
         LCLB  &MFL       MF=L WAS SPECIFIED                            10570600
         LCLB  &MINAUA    MINAU=ADDR WILL BE USED                       10618500
         LCLB  &MINAUR    MINAU=(REG) WILL BE USED                      10666400
         LCLA  &NO        BRANCH INDEX NUMBER                           10714300
         LCLB  &PDSCBA    PDSCB=ADDR WILL BE USED                       10762200
         LCLB  &PDSCBR    PDSCB=(REG) WILL BE USED                      10810100
         LCLB  &PDSDIRA   PDSDIR=ADDR WILL BE USED                      10858000
         LCLB  &PDSDIRR   PDSDIR=(REG) WILL BE USED                     10905900
         LCLB  &UCBR      UCB=(REG) WILL BE USED                        10953800
         LCLB  &VENQD     VTOCENQD=YES WAS SPECIFIED               @01A 10963800
         LCLB  &WARNSW    A WARNING ERROR WAS DETECTED                  11001700
&NO      SETA  &SYSNDX                  SET BRANCH INDEX NUMBER         11050000
.*                                                                      11100000
.* ******************************************************************** 11150000
.* *  VERIFICATION 1: MF PARAMETER                                      11200000
.* ******************************************************************** 11250000
.*                                                                      11300000
.V1      AIF   ('&MF' EQ '').V1ER2      IF NO MF GIVEN, BRANCH, ERROR   11350000
         AIF   ('&MF'(1,2) EQ '(E').V1E IF E FORM, BRANCH               11400000
         AIF   ('&MF' EQ 'L').V1L       IF L FORM, BRANCH               11450000
         AIF   ('&MF' NE 'D').V1ER1     IF NOT D FORM, BRANCH, ERROR    11500000
&MFD     SETB  1                        ELSE SET MF=D FOUND             11550000
         AGO   .V1X                       AND CONTINUE                  11600000
.*                                                                      11650000
.V1L     ANOP                                                           11700000
&MFL     SETB  1                        SET MF=L FOUND                  11750000
         AGO   .V1X                     AND CONTINUE                    11800000
.*                                                                      11850000
.V1E     ANOP                                                           11900000
&MFE     SETB  1                        SET MF=E FOUND                  11950000
         AIF   (N'&MF EQ 2).V1X         IF TWO PARMS ON MF, BRANCH      12000000
         AIF   (N'&MF EQ 1).V1ER3       IF ONE PARM, BRANCH, ERROR      12050000
.V1ER1   ANOP                                                           12100000
         SPACE 1                                                        12300000
         MNOTE 8,'***  IHB001 INVALID OPERAND - MF=&MF'                 12350000
         AGO   .V1ERX                   GO SET ERROR FLAG               12400000
.*                                                                      12550000
.V1ER2   ANOP                                                           12600000
         SPACE 1                                                        12950000
         MNOTE 8,'***  IHB002 MF IS A REQUIRED KEYWORD'                 12958300
         AGO   .V1ERX                   GO SET ERROR FLAG               12966600
.*                                                                      12974900
.V1ER3   ANOP                                                           12983200
         SPACE 1                                                        12991500
         MNOTE  8,'***  IHB004 MF=(E,ADDR) FORM: SUPPLY PARAMETER LIST X13000000
               ADDRESS'                                                 13050000
.V1ERX   ANOP                                                           13075000
         SPACE 1                                                        13100000
&ERRORSW SETB  1                        SET ERROR SWITCH ON             13125000
.V1X     ANOP                                                           13150000
&MFDL    SETB  (&MFD OR &MFL)           SET MF=D OR MF=L FOUND          13175000
.*                                                                      13200000
.* ******************************************************************** 13250000
.* *  V2: ALLOC= PARAMETER                                              13300000
.* ******************************************************************** 13350000
.*                                                                      13400000
.V2      AIF   ('&ALLOC' EQ '').V2X     IF ALLOC NOT GIVEN, BRANCH      13450000
         AIF   (&MFD).V2NOTE            IF D FORM, GO SET FOR WARNING   13500000
         AIF   ('&ALLOC' EQ 'ABS').V2A  IF ALLOC=ABS, BRANCH            13550000
         AIF   ('&ALLOC' EQ 'MOV').V2X  IF ALLOC=MOV, BRANCH            13600000
         AGO   .V2ER1                   ELSE BRANCH, ERROR              13650000
.*                                                                      13700000
.V2A     ANOP                                                           13750000
&ABS     SETB  1                        SET ALLOC=ABS FOUND             13800000
         AGO   .V2X                     AND CONTINUE                    13850000
.*                                                                      13900000
.V2ER1   ANOP                                                           13950000
         SPACE 1                                                        14000000
         MNOTE 8,'***  IHB001 INVALID OPERAND - ALLOC=&ALLOC'           14050000
         SPACE 1                                                        14100000
&ERRORSW SETB  1                        SET ERROR SWITCH ON             14150000
.V2NOTE  ANOP                                                           14200000
&WARNSW  SETB  1                        SET WARNING SWITCH ON           14250000
.V2X     ANOP                                                           14300000
.*                                                                      14600000
.* ******************************************************************** 14650000
.* *  V3: DSSIZE= PARAMETER                                             14700000
.* ******************************************************************** 14750000
.*                                                                      14800000
.V3      AIF   ('&DSSIZE' EQ '').V3X    IF DSSIZE NOT GIVEN, BRANCH     14850000
         AIF   (&MFDL OR &ABS).V3NOTE   IF D OR L FORM, OR              14900000
.*                                        ALLOC=ABS, GO SET WARNING     14950000
         AIF   ('&DSSIZE'(1,1) EQ '(').V3R IF DSSIZE=(REG), BRANCH      15000000
&DSSIZEA SETB  1                             ELSE SET DSSIZE=ADDR       15050000
         AGO   .V3X                            AND CONTINUE             15100000
.*                                                                      15150000
.V3R     AIF   (N'&DSSIZE NE 1).V3ER1   IF NE ONE PARM, BRANCH, ERROR   15200000
&DSSIZER SETB  1                        SET DSSIZE=(REG)                15250000
         AGO   .V3X                     AND CONTINUE                    15300000
.*                                                                      15350000
.V3ER1   ANOP                                                           15400000
         SPACE 1                                                        15800000
         MNOTE 8,'***  IHB001 INVALID OPERAND - DSSIZE=&DSSIZE'         15850000
         SPACE 1                                                        15900000
&ERRORSW SETB  1                        SET ERROR SWITCH ON             15920000
.V3NOTE  ANOP                                                           15940000
&WARNSW  SETB  1                        SET WARNING SWITCH ON           15960000
.V3X     ANOP                                                           15980000
.*                                                                      16000000
.* ******************************************************************** 16050000
.* *  V4: F2DSCB= PARAMETER                                             16100000
.* ******************************************************************** 16150000
.*                                                                      16200000
.V4      AIF   ('&F2DSCB' EQ '').V4X    IF F2DSCB NOT GIVEN, BRANCH     16210900
         AIF   (&MFD OR &ABS EQ 0).V4NOTE IF D FORM OR                  16221800
.*                                          ALLOC=MOV, GO SET WARNING   16232700
         AIF   ('&F2DSCB'(1,1) EQ '(').V4R IF F2DSCB=(REG), BRANCH      16243600
&F2DSCBA SETB  1                        ELSE SET F2DSCB=ADDR            16254500
         AGO   .V4X                       AND CONTINUE                  16265400
.*                                                                      16276300
.V4R     AIF   (&MFL).V4NOTE            IF MF=L, BRANCH, SET WARNING    16287200
         AIF   (N'&F2DSCB NE 1).V4ER1   IF NE ONE PARM, BRANCH, ERROR   16298100
&F2DSCBR SETB  1                        ELSE SET F2DSCB=(REG)           16309000
         AGO   .V4X                       AND CONTINUE                  16319900
.*                                                                      16330800
.V4ER1   ANOP                                                           16341700
         SPACE 1                                                        16352600
         MNOTE 8,'***  IHB001 INVALID OPERAND - F2DSCB=&F2DSCB'         16363500
         SPACE 1                                                        16374400
&ERRORSW SETB  1                        SET ERROR SWITCH ON             16385300
.V4NOTE  ANOP                                                           16396200
&WARNSW  SETB  1                        SET WARNING SWITCH ON           16407100
.V4X     ANOP                                                           16418000
.*                                                                      16428900
.* ******************************************************************** 16439800
.* *  V5: F3DSCB= PARAMETER                                             16450700
.* ******************************************************************** 16461600
.*                                                                      16472500
.V5      AIF   ('&F3DSCB' EQ '').V5X    IF F3DSCB NOT GIVEN, BRANCH     16483400
         AIF   (&MFD OR &ABS EQ 0).V5NOTE IF D FORM OR                  16494300
.*                                          ALLOC=MOV, GO SET WARNING   16505200
         AIF   ('&F3DSCB'(1,1) EQ '(').V5R IF F3DSCB=(REG), BRANCH      16516100
&F3DSCBA SETB  1                        ELSE SET F3DSCB=ADDR            16527000
         AGO   .V5X                       AND CONTINUE                  16537900
.*                                                                      16548800
.V5R     AIF   (&MFL).V5NOTE            IF MF=L, BRANCH, SET WARNING    16559700
         AIF   (N'&F3DSCB NE 1).V5ER1   IF NE ONE PARM, BRANCH, ERROR   16570600
&F3DSCBR SETB  1                        ELSE SET F3DSCB=(REG)           16581500
         AGO   .V5X                       AND CONTINUE                  16592400
.*                                                                      16603300
.V5ER1   ANOP                                                           16614200
         SPACE 1                                                        16625100
         MNOTE 8,'***  IHB001 INVALID OPERAND - F3DSCB=&F3DSCB'         16636000
         SPACE 1                                                        16646900
&ERRORSW SETB  1                        SET ERROR SWITCH ON             16657800
.V5NOTE  ANOP                                                           16668700
&WARNSW  SETB  1                        SET WARNING SWITCH ON           16679600
.V5X     ANOP                                                           16690500
.*                                                                      16701400
.* ******************************************************************** 16712300
.* *  V6: MINAU= PARAMETER                                              16723200
.* ******************************************************************** 16734100
.*                                                                      16745000
.V6      AIF   ('&MINAU' EQ '').V6X     IF MINAU NOT GIVEN, BRANCH      16755900
         AIF   (&MFDL OR &ABS).V6NOTE   IF D OR L FORM, OR              16766800
.*                                        ALLOC=ABS, GO SET WARNING     16777700
         AIF   ('&MINAU'(1,1) EQ '(').V6R IF MINAU=(REG), BRANCH        16788600
&MINAUA  SETB   1                           ELSE SET MINAU=ADDR         16799500
         AGO   .V6X                           AND CONTINUE              16810400
.*                                                                      16821300
.V6R     AIF   (N'&MINAU NE 1).V6ER1    IF NE ONE PARM, BRANCH, ERROR   16832200
&MINAUR  SETB  1                        SET MINAU=(REG)                 16843100
         AGO   .V6X                     AND CONTINUE                    16854000
.*                                                                      16864900
.V6ER1   ANOP                                                           16875800
         SPACE 1                                                        16886700
         MNOTE 8,'***  IHB001 INVALID OPERAND - MINAU=&MINAU'           16900000
         SPACE 1                                                        16950000
&ERRORSW SETB  1                        SET ERROR SWITCH ON             16970000
.V6NOTE  ANOP                                                           16990000
&WARNSW  SETB  1                        SET WARNING SWITCH ON           17010000
.V6X     ANOP                                                           17030000
.*                                                                      17050000
.* ******************************************************************** 17100000
.* *  V7: PDSCB= PARAMETER                                              17150000
.* ******************************************************************** 17200000
.*                                                                      17250000
.V7      AIF   ('&PDSCB' EQ '').V7X     IF PDSCB NOT GIVEN, BRANCH      17268900
         AIF   (&MFD).V7NOTE            IF D FORM, GO SET WARNING       17287800
         AIF   ('&PDSCB'(1,1) EQ '(').V7R IF PDSCB=(REG), BRANCH        17306700
&PDSCBA  SETB   1                       ELSE SET PDSCB=ADDR             17325600
         AGO   .V7X                       AND CONTINUE                  17344500
.*                                                                      17363400
.V7R     AIF   (&MFL).V7NOTE            IF MF=L, BRANCH, WARNING        17382300
         AIF   (N'&PDSCB NE 1).V7ER1    IF NE ONE PARM, BRANCH, ERROR   17401200
&PDSCBR  SETB   1                       ELSE SET PDSCB=(REG)            17420100
         AGO   .V7X                       AND CONTINUE                  17439000
.*                                                                      17457900
.V7ER1   ANOP                                                           17476800
         SPACE 1                                                        17495700
         MNOTE 8,'***  IHB001 INVALID OPERAND - PDSCB=&PDSCB'           17514600
         SPACE 1                                                        17533500
&ERRORSW SETB  1                        SET ERROR SWITCH ON             17552400
.V7NOTE  ANOP                                                           17571300
&WARNSW  SETB  1                        SET WARNING SWITCH ON           17590200
.V7X     ANOP                                                           17609100
.*                                                                      17628000
.* ******************************************************************** 17646900
.* *  V8: PDSDIR= PARAMETER                                             17665800
.* ******************************************************************** 17684700
.*                                                                      17703600
.V8      AIF   ('&PDSDIR' EQ '').V8X    IF PDSDIR NOT GIVEN, BRANCH     17722500
         AIF   (&MFDL).V8NOTE           IF D OR L FORM, GO SET WARNING  17741400
         AIF   ('&PDSDIR'(1,1) EQ '(').V8R IF PDSDIR=(REG), BRANCH      17760300
&PDSDIRA SETB   1                            ELSE SET PDSDIR=ADDR       17779200
         AGO   .V8X                            AND CONTINUE             17798100
.*                                                                      17817000
.V8R     AIF   (N'&PDSDIR NE 1).V8ER1   IF NE ONE PARM, BRANCH, ERROR   17835900
&PDSDIRR SETB   1                       SET PDSDIR=(REG)                17854800
         AGO   .V8X                     AND CONTINUE                    17873700
.*                                                                      17892600
.V8ER1   ANOP                                                           17911500
         SPACE 1                                                        17930400
         MNOTE 8,'***  IHB001 INVALID OPERAND - PDSDIR=&PDSDIR'         17950000
         SPACE 1                                                        18000000
&ERRORSW SETB  1                        SET ERROR SWITCH ON             18020000
.V8NOTE  ANOP                                                           18040000
&WARNSW  SETB  1                        SET WARNING SWITCH ON           18060000
.V8X     ANOP                                                           18080000
.*                                                                      18100000
.* ******************************************************************** 18150000
.* *  V9: UCB= PARAMETER                                                18200000
.* ******************************************************************** 18250000
.*                                                                      18300000
.V9      AIF   ('&UCB' EQ '').V9X       IF UCB NOT GIVEN, BRANCH        18350000
         AIF   (&MFD OR &MFL).V9NOTE    IF D OR L FORM, GO SET WARNING  18400000
         AIF   ('&UCB'(1,1) NE '(').V9ER1 IF NOT UCB=(REG), BRANCH, ERR 18450000
         AIF   (N'&UCB NE 1).V9ER1      IF NE ONE PARM, BRANCH, ERROR   18500000
&UCBR    SETB   1                       ELSE SET UCB=(REG)              18550000
         AGO   .V9X                       AND CONTINUE                  18600000
.*                                                                      18650000
.V9ER1   ANOP                                                           18700000
         SPACE 1                                                        19300000
         MNOTE 8,'***  IHB001 INVALID OPERAND - UCB=&UCB'               19350000
         SPACE 1                                                        19400000
&ERRORSW SETB  1                        SET ERROR SWITCH ON             19420000
.V9NOTE  ANOP                                                           19440000
&WARNSW  SETB  1                        SET WARNING SWITCH ON           19460000
.V9X     ANOP                                                           19480000
.*                                                                      19500000
.* *******************************************************************  19501500
.* *  V10:  VTOCENQD= PARAMETER                                   @01A  19503000
.* *******************************************************************  19504500
.*                                                                      19506000
.V10     AIF   ('&VTOCENQD' EQ '').V10X IF VTOCENQD NOT GIVEN, BR @01A  19507500
         AIF   (&MFD).V10NOTE           IF D FORM, SET WARNG      @01A  19509000
         AIF   ('&VTOCENQD' EQ 'YES').V10A IF VTOCENQD=YES, BR    @01A  19510500
         AIF   ('&VTOCENQD' EQ 'NO').V10X  IF VTOCENQD=NO, BR     @01A  19512000
         AGO   .V10ER1                  NOT YES OR NO, ERROR      @01A  19513500
.*                                                                @01A  19515000
.V10A    ANOP                                                     @01A  19516500
         AIF   (&ABS).V10ER2            IF ALLOC=ABS, ERROR       @01A  19518000
&VENQD   SETB  1                        SET VTOCENQD=YES SPECIFIED@01A  19519500
         AGO   .V10X                    AND CONTINUE              @01A  19521000
.*                                                                @01A  19522500
.V10ER1  ANOP                           INVALID OPERAND           @01A  19524000
         SPACE 1                                                  @01A  19525500
         MNOTE 8,'***  IHB001 INVALID OPERAND - VTOCENQD=&VTOCENQD'     19527000
         SPACE 1                                                  @01A  19528500
         AGO   .V10ER                                             @01A  19530000
.V10ER2  ANOP                           INVALID OPERAND COMBIN.   @01A  19531500
         SPACE 1                                                  @01A  19533000
         MNOTE 8,'***  IHB005 INVALID COMBINATION  -  ALLOC=&ALLOC AND *19534500
               VTOCENQD=&VTOCENQD'                                      19536000
         SPACE 1                                                  @01A  19537500
.V10ER   ANOP                                                     @01A  19539000
&ERRORSW SETB  1                        SET ERROR SWITCH ON       @01A  19540500
.V10NOTE ANOP                                                     @01A  19542000
&WARNSW  SETB  1                        SET WARNING SWITCH ON     @01A  19543500
.V10X    ANOP                                                     @01A  19545000
.*                                                                      19546500
.* ******************************************************************** 19550000
.* *  CHECK ERRORS                                                      19600000
.* ******************************************************************** 19650000
.*                                                                      19700000
         AIF   (&ERRORSW EQ 0).CONT     IF NO MAJOR ERROR, BRANCH       19750000
&LABEL   DS    0F  *** INVALID OPERAND(S) FOUND IN MACRO EXPANSION.***  19850000
         AGO   .FINISH                                                  19900000
.*                                                                      19950000
.CONT    AIF   (&WARNSW EQ 0).BLD       IF NO WARNING ERROR, BRANCH     19968100
         SPACE 1                                                        19986200
      MNOTE 4,'***  IHB003 ONE OR MORE PARAMETERS IGNORED DUE TO ALLOC *20004300
               AND/OR  MF PARAMETERS'                                   20022400
         SPACE 1                                                        20040500
.BLD     AIF   (&MFE).E1                IF E FORM, BRANCH               20058600
&L       SETC  '&LABEL'                 ELSE ASSUME A LABEL WAS GIVEN   20076700
         AIF   ('&L' NE '').TSTDL         IF A LABEL WAS GIVEN, BRANCH  20094800
&L       SETC  'RAL&NO.S'                 ELSE CONSTRUCT A LABEL        20112900
.TSTDL   AIF   (&MFL).L1                    IF L FORM, BRANCH           20131000
.*                                                                      20150000
.* ******************************************************************** 20600000
.* *  BEGIN BUILD FOR DSECT FORM OF MACRO                               20650000
.* ******************************************************************** 20700000
.*                                                                      20750000
&L       DSECT                          DSECT FOR PARAMETER LIST        21800000
RALPLID  DS    CL4                      EBCDIC 'REAL' FOR REALLOC       21850000
RALNGTH  DS    AL2                      LENGTH OF PARAMETER LIST        21900000
RAERRCDE DS    H                        ERROR CODE RETURNED FROM       *21950000
                                          ALLOCATE (SVC32)              21971400
RALFLAG  DS    XL1                      PARAMETER FLAG BYTE             21992800
RALMOV   EQU   X'00'                    ALLOC=MOV                       22014200
RALABS   EQU   X'80'                    ALLOC=ABS                       22035600
RALVTOCE EQU   X'40'                    VTOCENQD=YES              @01A  22045600
RALFRES  EQU   X'3F'                    RESERVED                  @01C  22055600
RALRSVD  DS    XL3                      RESERVED                        22078400
RALDSSZ  DS    F                        DATA SET SIZE                   22100000
RALMAU   DS    F                        MINIMUM ALLOCATION UNIT         22150000
RALPDSCB DS    A                        PARTIAL DSCB POINTER            22200000
RALUCB   DS    A                        UCB POINTER                     22250000
RALDQTY  DS    F                        PDS DIRECTORY QUANTITY          22300000
RAL2DSCB DS    A                        FORMAT 2 DSCB POINTER           22316600
RAL3DSCB DS    A                        FORMAT 3 DSCB POINTER           22333200
RALEND   EQU   *                        END OF PARAMETER LIST           22350000
RALENGTH EQU   RALEND-&L                LENGTH OF PARAMETER LIST        22400000
         AGO   .FINISH                                                  22450000
.*                                                                      22500000
.* ******************************************************************** 22550000
.* *  BEGIN BUILD FOR EXECUTE FORM OF MACRO                             22600000
.* ******************************************************************** 22650000
.*                                                                      22700000
.E1      AIF   ('&LABEL' EQ '').E2      IF NO LABEL GIVEN, BRANCH       22750000
&LABEL   DS    0H                                                       22800000
.E2      ANOP                                                           22850000
         IHBINNRA &MF(2)                PARM LIST INTO REG 1            22950000
.*                                                                      23000000
         AIF   (&ABS).E3                IF ALLOC=ABS, BRANCH            23041600
         MVI   8(1),X'00'               DEFINE ALLOC=MOV                23083200
         AGO   .E4                      BRANCH AROUND ALLOC=ABS         23124800
.E3      ANOP                                                           23166400
         MVI   8(1),X'80'               DEFINE ALLOC=ABS                23208000
.*                                                                      23250000
.E4      AIF   (&DSSIZER).E5            IF DSSIZE=(REG), BRANCH         23300000
         AIF   (&DSSIZEA EQ 0).E6       IF NOT DSSIZE=ADDR, BRANCH      23350000
         L     15,&DSSIZE               GET SIZE OF DATA SET            23550000
         ST    15,12(,1)                AND STORE IN PARM LIST          23600000
         AGO   .E6                      BRANCH AROUND DSSIZE=(REG)      23612500
.E5      ANOP                                                           23625000
         ST    &DSSIZE(1),12(,1)        STORE DATA SET SIZE             23637500
.*                                                                      23650000
.E6      AIF   (&MINAUR).E7             IF MINAU=(REG), BRANCH          23700000
         AIF   (&MINAUA EQ 0).E8        IF NOT MINAU=ADDR, BRANCH       23750000
         L     15,&MINAU                GET MINIMUM ALLOCATION UNIT     24200000
         ST    15,16(,1)                AND STORE IN PARM LIST          24250000
         AGO   .E8                      BRANCH AROUND MINAU=(REG)       24262500
.E7      ANOP                                                           24275000
         ST    &MINAU(1),16(,1)         STORE MINIMUM ALLOCATION UNIT   24287500
.*                                                                      24300000
.E8      AIF   (&PDSCBR).E9             IF PDSCB=(REG), BRANCH          24350000
         AIF   (&PDSCBA EQ 0).E10       IF NOT PDSCB=ADDR, BRANCH       24400000
         LA    15,&PDSCB                GET PARTIAL DSCB ADDRESS        24800000
         ST    15,20(,1)                AND STORE IN PARM LIST          24850000
         AGO   .E10                     BRANCH AROUND PDSCB=(REG)       24862500
.E9      ANOP                                                           24875000
         ST    &PDSCB(1),20(,1)         STORE PARTIAL DSCB ADDRESS      24887500
.*                                                                      24900000
.E10     AIF   (&UCBR EQ 0).E11         IF NOT UCB=(REG), BRANCH        24950000
         ST    &UCB(1),24(,1)           STORE UCB PTR IN PARM LIST      25000000
.*                                                                      25100000
.E11     AIF   (&PDSDIRR).E12           IF PDSDIR=(REG), BRANCH         25150000
         AIF   (&PDSDIRA EQ 0).E13      IF NOT PDSDIR=ADDR, BRANCH      25200000
         L     15,&PDSDIR               GET DIRECTORY QUANTITY          26100000
         ST    15,28(,1)                AND STORE IN PARM LIST          26150000
         AGO   .E13                     BRANCH AROUND PDSDIR=(REG)      26162500
.E12     ANOP                                                           26175000
         ST    &PDSDIR(1),28(,1)        STORE DIRECTORY QUANTITY        26187500
.*                                                                      26200000
.E13     AIF   (&F2DSCBR).E14           IF F2DSCB=(REG), BRANCH         26225000
         AIF   (&F2DSCBA EQ 0).E15      IF NOT F2DSCB=ADDR, BRANCH      26250000
         LA    15,&F2DSCB               GET FORMAT 2 DSCB ADDRESS       26275000
         ST    15,32(,1)                AND STORE IN PARM LIST          26300000
         AGO   .E15                     BRANCH AROUND F2DSCB=(REG)      26325000
.E14     ANOP                                                           26350000
         ST    &F2DSCB(1),32(,1)        STORE FORMAT 2 DSCB ADDRESS     26375000
.*                                                                      26400000
.E15     AIF   (&F3DSCBR).E16           IF F3DSCB=(REG), BRANCH         26410000
         AIF   (&F3DSCBA EQ 0).E17      IF NOT F3DSCB=ADDR, BRANCH      26420000
         LA    15,&F3DSCB               GET FORMAT 3 DSCB ADDRESS       26430000
         ST    15,36(,1)                AND STORE IN PARM LIST          26440000
         AGO   .E17                     BRANCH AROUND F3DSCB=(REG)      26450000
.E16     ANOP                                                           26460000
         ST    &F3DSCB(1),36(,1)        STORE FORMAT 3 DSCB ADDRESS     26470000
.*                                                                      26480000
.E17     AIF   (&VENQD).E18             IF VTOCENQD=YES, BR       @01A  26482800
         AGO   .E19                                               @01A  26485600
.E18     ANOP                                                     @01A  26488400
         OI    8(1),X'40'               DEFINE VTOCENQD           @01A  26491200
.*                                                                @01A  26494000
.E19     ANOP                                                     @01C  26496800
         LCR   1,1                      LOAD COMPLEMENT OF ADDRESS      26500000
         SVC   32                       ISSUE THE ALLOCATE SVC          26550000
         AGO   .FINISH                  EXECUTE FROM IS DONE            26551000
.*                                                                      26552000
.* ******************************************************************** 26553000
.* *  BEGIN BUILD FOR LIST FORM OF MACRO                                26554000
.* ******************************************************************** 26555000
.*                                                                      26556000
.L1      ANOP                                                           26557000
&L       DS    0F                                                       26558000
         DC    CL4'REAL'                EBCDIC 'REAL' FOR REALLOC       26559000
         DC    AL2(RAL&NO.E-&L)         LENGTH OF PARAMETER LIST        26560000
         DC    H'0'                     ERROR CODE RETURNED FROM       *26561000
                                          ALLOCATE (SVC32)              26562000
.*                                                                      26563000
         AIF   (&ABS).L2                IF ALLOC=ABS, BRANCH            26564000
         AIF   (&VENQD).L2A             IF VTOCENQD=YES, BRANCH   @01A  26564500
         DC    XL1'00'                  ALLOC=MOV                       26565000
         AGO   .L3                      BRANCH AROUND ALLOC=ABS         26566000
.L2A     ANOP                                                     @01C  26566400
         DC    XL1'40'                  ALLOC=MOV,VTOCENQD=YES    @01A  26566800
         AGO   .L3                                                @01A  26567200
.L2      ANOP                                                     @01A  26567600
         DC    XL1'80'                  ALLOC=ABS                       26568000
         AGO   .L3                                                @01A  26568500
.*                                                                      26569000
.L3      ANOP                                                           26570000
         DC    XL3'00'                  RESERVED                        26571000
         DC    F'0'                     DATA SET SIZE                   26572000
         DC    F'0'                     MINIMUM ALLOCATION UNIT         26573000
.*                                                                      26574000
         AIF   (&PDSCBA).L4             IF PDSCB=ADDR, BRANCH           26575000
         DC    A(0)                     PARTIAL DSCB ADDRESS            26576000
         AGO   .L5                      BRANCH AROUND PDSCB=ADDR        26577000
.L4      ANOP                                                           26578000
         DC    A(&PDSCB)                PARTIAL DSCB ADDRESS            26579000
.*                                                                      26580000
.L5      ANOP                                                           26581000
         DC    A(0)                     UCB ADDRESS                     26582000
         DC    F'0'                     PDS DIRECTORY QUANTITY          26583000
.*                                                                      26584000
         AIF   (&F2DSCBA).L6            IF F2DSCB=ADDR, BRANCH          26585000
         DC    A(0)                     FORMAT 2 DSCB ADDRESS           26586000
         AGO   .L7                      BRANCH AROUND F2DSCB=ADDR       26587000
.L6      ANOP                                                           26588000
         DC    A(&F2DSCB)               FORMAT 2 DSCB ADDRESS           26589000
.*                                                                      26590000
.L7      AIF   (&F3DSCBA).L8            IF F3DSCB=ADDR, BRANCH          26591000
         DC    A(0)                     FORMAT 3 DSCB ADDRESS           26592000
         AGO   .L9                      BRANCH AROUND F3DSCB=ADDR       26593000
.L8      ANOP                                                           26594000
         DC    A(&F3DSCB)               FORMAT 3 DSCB ADDRESS           26595000
.*                                                                      26596000
.L9      ANOP                                                           26597000
RAL&NO.E EQU   *                        END OF REALLOC PARM LIST        26598000
.*                                                                      26599000
.FINISH  ANOP                                                           26600000
         MEND                                                           26650000
*********************************************************************/  26700000
*%REALPLS:;                                                             26750000
*                                                                       26800000
*/*******************************************************************/  26850000
*/*  PLS MAPPING OF THE PARAMETER LIST FOR DADSM ALLOCATE (SVC 32)  */  26900000
*/*******************************************************************/  26950000
* DCL 1 REALPL BASED BDY(WORD),                                         27000000
*       2 RALPLID   CHAR(4),      /* EBCDIC 'REAL' FOR REALLOC      */  27050000
*       2 RALNGTH   FIXED(15),    /* LENGTH OF PARAMETER LIST       */  27100000
*       2 RAERRCDE  FIXED(15),    /* ERROR CODE RETURNED FROM           27150000
*                                      ALLOCATE (SVC32)             */  27200000
*       2 RALFLAG   BIT(8),       /* PARAMETER FLAG BYTE            */  27250000
*         3 RALABS    BIT(1),     /* ALLOC=ABS                      */  27300000
*         3 RALVTOCE  BIT(1),     /* VTOCENQD=YES               @01A*/  27310000
*         3 RALFRES   BIT(6),     /* RESERVED                   @01C*/  27320000
*       2 RALRSVD   CHAR(3),      /* RESERVED                       */  27400000
*       2 RALDSSZ   FIXED(31),    /* DATA SET SIZE                  */  27450000
*       2 RALMAU    FIXED(31),    /* MINIMUM ALLOCATION UNIT        */  27500000
*       2 RALPDSCB  PTR(31),      /* PARTIAL DSCB POINTER           */  27550000
*       2 RALUCB    PTR(31),      /* UCB POINTER                    */  27600000
*       2 RALDQTY   FIXED(31),    /* PDS DIRECTORY QUANTITY         */  27650000
*       2 RAL2DSCB  PTR(31),      /* FORMAT 2 DSCB POINTER          */  27700000
*       2 RAL3DSCB  PTR(31);      /* FORMAT 3 DSCB POINTER          */  27750000
*/*******************************************************************/  27800000
