*********************************************************************** 00050000
*                                                                     * 00200000
*PROPRIETARY V3 STATEMENT                                             * 00250000
*LICENSED MATERIALS - PROPERTY OF IBM                                 * 00300000
*"RESTRICTED MATERIALS OF IBM"                                        * 00350000
*5695-DF1                                                             * 00400000
*(C) COPYRIGHT 1992  IBM CORP.                                        * 00450000
*END PROPRIETARY V3 STATEMENT                                         * 00500000
*                                                                     * 00600000
*********************************************************************** 00650000
         MACRO                                                          06000000
         IGGCP13C &OPTCD=                                               12000000
.*         RELEASE 23 DELETIONS/CHANGES                                 12010000
.*         RELEASE 22 DELETIONS/CHANGES                                 12020000
.*         RELEASE 21 DELETIONS/CHANGES                                 12030000
* CP13C  WRITES BACK BLOCK IF THE INSERTION IS A RECORD WITH A KEY      18000000
*        IDENTICAL TO THAT OF A RECORD, WHICH ALTHOUGH LOGICALLY        24000000
*        DELETED,IS STILL PHYSICAL PRESENT WITHIN THE BLOCK.            30000000
CL5      CCW   SIDEQ,0,CC,5              SEARCH FOR BLOCK INSERTION     36000000
CL6      CCW   TIC,CL5-CB1,0,0            POINT                         42000000
         AIF   ('&OPTCD' NE 'W').SWC                                    42010000
CL7      CCW   WD,0,CC,0                 REPLACE BLOCK                  48000000
         AGO   .WC                                                      48001000
.SWC     ANOP                                                           48002000
CL7      CCW   WD,0,0,0                 REPLACE BLOCK                   48003000
.WC      ANOP                                                           48004000
SZ13C    EQU   CL7+8-CL5                                                48010000
         AIF   ('&OPTCD' NE 'W').END                                    54000000
* 13CW   WRITE VALIDITY CHECK                                           60000000
CL70     CCW   NOP,0,CC+SILI,1                                          66000000
CL7A     CCW   SIDEQ,0,CC,5              FIND RECORD AGAIN              72000000
CL7B     CCW   TIC,CL7A-CB1,0,0                                         78000000
CL7C     CCW   RDATA,0,SKIP,0               READ IT BACK                84000000
SZ13CW   EQU   CL7C+8-CL70+SZ13C                                        84010000
.END     MEND                                                           90000000
