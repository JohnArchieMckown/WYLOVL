*%GOTO   FILTPLS;     /* CVAFFILT.S CVPL MAPPING MACRO FOR PLS          00025000
         MACRO                                                          00050000
&LABEL   CVAFFILT &ACCESS=,&BRANCH=,&BUFLIST=,&DEB=,&FCL=,&IOAREA=,    C00100000
               &FLTAREA=,&MF=I,&UCB=                                    00150000
.**** START OF SPECIFICATIONS ***************************************** 00200000
.*                                                                      00250000
.*$MAC(CVAFFILT) COMP(DM1CV): CVAF FILTER ACCESS TO THE VTOC            00300000
.*                                                                      00350000
.* DESCRIPTIVE-NAME = CVAF - FILTERED ACCESS TO THE VTOC                00400000
.*                                                                      00450000
.*PROPRIETARY V3 STATEMENT                                              00481200
.*LICENSED MATERIALS - PROPERTY OF IBM                                  00512400
.*"RESTRICTED MATERIALS OF IBM"                                         00543600
.*5695-DF1                                                              00574800
.*(C) COPYRIGHT 1986  IBM CORP.                                         00606000
.*END PROPRIETARY V3 STATEMENT                                          00653000
.*                                                                      00700000
.*$STATUS = MVS/XA DFP 2.3.0                                            00750000
.*                                                                      00800000
.* FUNCTION = THIS MACRO WILL SET UP THE CVAF PARAMETER LIST TO ALLOW   00850000
.*     THE CALLER TO INVOKE CVAF FILTER FUNCTIONS IN ADDITION TO THE    00900000
.*     PRIOR CVAF FUNCTIONS (I.E. THE CVFSA ADDRESS WORD IS ADDED TO    00950000
.*     THE CURRENT CVPL AND ITS LENGTH IS ADJUSTED).                    01000000
.*                                                                      01150000
.* NOTES = THIS MACRO MAY BE USED TO MAP OR INITIALIZE THE CVPL WITH    01155500
.*         CVFSA, OR TO INVOKE CVAF FILTER SERVICES.                    01161000
.*         THE ORIGINAL CVPL MAPPING MACRO (ICVAFPL) MAY BE USED TO     01166600
.*         MAP THE CVPL WITH CVFSA (BY PARAMETER REQUEST) OR            01174900
.*         WITHOUT CVFSA (BY DEFAULT).                                  01183200
.*                                                                      01191500
.*         LOCATION OF CONTROL BLOCKS ... KEYWORD=ADDR OR =(REG)        01192000
.*         THE CONTROL BLOCKS FOR CVAF FILTER ARE EITHER CALLER         01192500
.*         DEFINED (BUFLIST, FCL AND CVPL), OR ARE CALLER REFERENCED    01193000
.*         (DEB, FLTAREA, IOAREA AND UCB). THIS DIFFERENCE IS           01193500
.*         REFLECTED IN THE CODE GENERATED BY THE CVAFFILT MACRO IN     01194000
.*         SUPPORT OF KEYWORD=ADDR AND KEYWORD=(REG) SPECIFICATIONS.    01194500
.*         A. WHEN SPECIFIED AS (REG), THE MACRO WILL ASSUME THAT THE   01195000
.*            REGISTER CONTAINS THE ADDRESS OF THE CONTROL BLOCK.       01195500
.*         B. WHEN BUFLIST, FCL, OR CVPL IS SPECIFIED AS ADDR, THE      01196000
.*            MACRO WILL GENERATE A LOAD ADDRESS INSTRUCTION.           01196500
.*         C. WHEN DEB, FLTAREA, IOAREA, OR UCB IS SPECIFIED AS ADDR,   01197000
.*            THE MACRO WILL ASSUME THAT THE GIVEN LABEL IS THAT OF     01197500
.*            A FULL WORD WHICH CONTAINS THE ADDRESS OF THE CONTROL     01198000
.*            BLOCK (I.E. IT WILL GENERATE A LOAD INSTRUCTION).         01198500
.*                                                                      01199000
.*   KEYWORDS =                                                         01200000
.*                                                                      01250000
.*      MF       - THE MACRO FORMAT IS AN OPTIONAL OPERAND. IF THE      01300000
.*                 MF OPERAND IS NOT SPECIFIED, MF=I WILL BE ASSUMED.   01350000
.*                                                                      01450000
.*                VALID ENTRIES:  MF=D                                  01491300
.*                                 MF=(E,ADDR) OR MF=(E,(REG))          01532600
.*                                 MF=I ...... DEFAULT                  01573900
.*                                 MF=L                                 01615200
.*                                                                      01656500
.*        MF=D   - THIS OPERAND SPECIFIES THE DSECT FORM OF THE MACRO.  01697800
.*                 THE DSECT WILL BE GENERATED USING THE ICVAFPL MACRO  01739100
.*                 TO MAP THE CVAF FILTER PARAMETER LIST (CVPL).        01780400
.*                                                                      01821700
.*        MF=(E,ADDR) OR MF=(E,(REG))  - EITHER OF THESE OPERANDS       01863000
.*                 SPECIFIES THAT THE EXECUTE FORM OF THE MACRO WILL    01904300
.*                 BE USED FOR THE MODIFICATION OF AN EXISTING CVAF     01945600
.*                 PARAMETER LIST AND/OR THE INVOCATION OF CVAF.        01986900
.*                 THE ADDRESS OF THE CVPL IS PROVIDED VIA THE SECOND   02028200
.*                 PARAMETER. THE MACRO WILL GENERATE CODE FOR A        02069500
.*                 BRANCH ENTRY TO CVAF OR ISSUE SVC 139 (SEE BRANCH=). 02110800
.*                                                                      02152100
.*        MF=I   - THIS OPERAND SPECIFIES THE IN-LINE (OR STANDARD,     02193400
.*                 DEFAULT) FORM OF THE MACRO. THE MACRO WILL GENERATE  02234700
.*                 AN INLINE PARAMETER LIST, INITIALIZE IT, AND INVOKE  02276000
.*                 CVAF FILTER. THE MACRO WILL GENERATE CODE FOR A      02317300
.*                 BRANCH ENTRY TO CVAF OR ISSUE SVC 139(SEE BRANCH=).  02358600
.*                                                                      02399900
.*        MF=L   - THIS OPERAND SPECIFIES THE LIST FORM OF THE MACRO.   02441200
.*                 THE MACRO WILL GENERATE AN IN-LINE PARAMETER LIST    02482500
.*                 AND INITIALIZE IT AS SPECIFIED. IT WILL NOT          02523800
.*                 GENERATE CODE TO INVOKE CVAF.                        02565100
.*                                                                      02606400
.*       ACCESS  - WILL SET THE CVFCTN FIELD OF THE CVAF PARAMETER      02650000
.*                 LIST TO X'0E' FOR READ, X'0F' FOR RESUME, OR X'10'   02700000
.*                 FOR RLSE.                                            02750000
.*                                                                      02900000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN        02912500
.*                 MNOTE, SINCE READ IS THE DEFAULT FOR MF=L AND        02925000
.*                 MF=I.  THE CVFCTN FIELD WILL NOT BE CHANGE IN        02937500
.*                 THE ABSENCE OF THE ACCESS KEYWORD FOR THE            02950000
.*                 MF=(E,ADDR) FORM.                                    02962500
.*                                                                      02975000
.*                 VALID ENTRIES:  ACCESS=READ        DEFAULT           02987500
.*                                 ACCESS=RESUME                        03000000
.*                                 ACCESS=RLSE                          03050000
.*                                                                      03100000
.*       BRANCH  - SPECIFIES SVC 139 ENTRY TO CVAF OR BRANCH ENTRY AND  03150000
.*                 CALLER STATE. FOR BRANCH ENTRY REQUESTS, THE MACRO   03200000
.*                 MAY BE USED TO SET THE CV1PGM BIT IN THE PARAMETER   03250000
.*                 LIST TO IDENTIFY CALLER STATE (SEE NOTES BELOW).     03300000
.*                                                                      03400000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN MNOTE, 03435700
.*                 SINCE BRANCH=NO IS THE DEFAULT FOR ALL FORMS OF THIS 03471400
.*                 MACRO.                                               03507100
.*                                                                      03542800
.*                 VALID ENTRIES:  BRANCH=NO ........ DEFAULT           03578500
.*                                 BRANCH=YES                           03614200
.*                                 BRANCH=(YES,SUP)                     03649900
.*                                 BRANCH=(YES,PGM)                     03685600
.*                                                                      03721300
.*                 FOR MF=I, CV1PGM IS SET TO 1 IF BRANCH=(YES,PGM) IS  03757000
.*                 CODED.  OTHERWISE, CV1PGM IS SET TO 0.               03792700
.*                                                                      03828400
.*                 FOR MF=L, CV1PGM IS SET TO 1 IF BRANCH=(YES,PGM) IS  03864100
.*                 CODED.  OTHERWISE, CV1PGM IS SET TO 0 (NO EXECUTABLE 03899800
.*                 CODE WOULD BE GENERATED).                            03935500
.*                                                                      03971200
.*                 FOR MF=(E,ADDR) OR MF=(E,(REG)), CV1PGM IS SET TO 1  04006900
.*                 IF BRANCH=(YES,PGM) IS CODED AND CV1PGM IS SET TO 0  04042600
.*                 IF BRANCH=(YES,SUP) IS CODED.  OTHERWISE, CV1PGM IS  04078300
.*                 NOT MODIFIED.                                        04114000
.*                                                                      04149700
.*                 FOR MF=I, MF=(E,ADDR)OR MF=(E,(REG)), IF BRANCH=YES, 04185400
.*                 BRANCH=(YES,SUP), OR BRANCH=(YES,PGM) IS SPECIFIED,  04221100
.*                 THE MACRO WILL GENERATE CODE TO BRANCH ENTER CVAF.   04256800
.*                 IF BRANCH=NO IS SPECIFIED (OR DEFAULTED TO), CODE    04292500
.*                 WILL BE GENERATED TO INVOKE CVAF VIA SVC 139.        04328200
.*                                                                      04363900
.*       BUFLIST - WILL SET THE ADDRESS OF THE BUFFER LIST, SPECIFIED   04400000
.*                 BY THE 'ADDR', INTO THE FIELD: CVBUFL.               04450000
.*                                                                      04500000
.*                 THE ABSENCE OF THIS KEYWORD WILL CAUSE AN MNOTE      04550000
.*                 TO BE ISSUED WHEN ACCESS=READ OR ACCESS=RESUME       04600000
.*                 IS CODED FOR THE MF = I FORM OF THIS MACRO.          04650000
.*                                                                      04700000
.*                 VALID ENTRIES:  BUFLIST=ADDR                         04712500
.*                                 BUFLIST=(REG)                        04725000
.*                                                                      04737500
.*       DEB     - WILL SET THE ADDRESS OF A DEB, SPECIFIED BY THE      04750000
.*                 'ADDR', INTO THE FIELD: CVDEB.  THIS KEYWORD         04800000
.*                 IS MUTUALLY EXCLUSIVE WITH UCB.  EITHER DEB OR       04850000
.*                 UCB IS REQUIRED UNLESS IOAREA=(,ADDR) IS             04900000
.*                 SPECIFIED FOR THE MF=I FORM OF THIS MACRO.           04950000
.*                                                                      05000000
.*                 VALID ENTRIES:  DEB=ADDR                             05012500
.*                                 DEB=(REG)                            05025000
.*                                                                      05037500
.*       FCL     - WILL SET THE ADDRESS OF THE CALLER SUPPLIED          05050000
.*                 FILTER CRITERIA LIST SPECIFIED BY THE 'ADDR',        05100000
.*                 INTO THE FIELD: CVDSN.                               05150000
.*                                                                      05200000
.*                 THE ABSENCE OF THIS KEYWORD WILL CAUSE AN MNOTE      05206200
.*                 TO BE ISSUED WHEN ACCESS=READ OR ACCESS=RESUME       05212400
.*                 IS CODED FOR THE MF = I FORM OF THIS MACRO.          05218600
.*                                                                      05224800
.*                 VALID ENTRIES:  FCL=ADDR                             05231000
.*                                 FCL=(REG)                            05237200
.*                                                                      05243400
.*       IOAREA  - WILL SET THE ADDRESS OF THE I/O AREA, SPECIFIED      05250000
.*                 BY THE 'ADDR', INTO THE FIELD: CVIOAR.  ALSO,        05300000
.*                 THE FLAG, CV1IOAR, WILL BE SET TO 1 IF KEEP IS       05350000
.*                 CODED AND RESET TO 0 IF NOKEEP IS CODED.             05400000
.*                                                                      05450000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN MNOTE, 05500000
.*                 SINCE NOKEEP IS THE DEFAULT FOR MF=L AND MF=I.       05550000
.*                 THE FLAG WILL NOT BE CHANGED IN THE ABSENCE OF THE   05600000
.*                 IOAREA KEYWORD FOR MF=(E,ADDR) FORM.                 05650000
.*                                                                      05700000
.*                 VALID ENTRIES:  IOAREA=NOKEEP ........ DEFAULT       05750000
.*                                 IOAREA=(NOKEEP,ADDR)                 05800000
.*                                 IOAREA=KEEP                          05850000
.*                                 IOAREA=(KEEP,ADDR)                   05900000
.*                                                                      05950000
.*       FLTAREA - WILL SET THE ADDRESS OF THE FILTER SAVE AREA,        06000000
.*                 SPECIFIED BY THE 'ADDR' INTO THE FIELD:CVFSA.        06050000
.*                 ALSO, THE FLAG, CV3FILT WILL BE SET TO 1 IF KEEP IS  06100000
.*                 CODED AND RESET TO 0 IF NOKEEP IS CODED.             06150000
.*                                                                      06200000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN MNOTE, 06250000
.*                 SINCE NOKEEP IS THE DEFAULT FOR MF=L AND MF=I.       06300000
.*                 THE FLAG WILL NOT BE CHANGED IN THE ABSENCE OF THE   06350000
.*                 FLTAREA KEYWORD FOR MF=(E,ADDR) FORM.                06400000
.*                                                                      06450000
.*                 VALID ENTRIES:  FLTAREA=NOKEEP ...... DEFAULT        06500000
.*                                 FLTAREA=(NOKEEP,ADDR)                06550000
.*                                 FLTAREA=KEEP                         06600000
.*                                 FLTAREA=(KEEP,ADDR)                  06650000
.*                                                                      06700000
.*                                                                      06750000
.*       UCB     - WILL SET THE ADDRESS OF THE UCB, SPECIFIED BY        07850000
.*                 THE 'ADDR', INTO THE FIELD: CVUCB.  THIS KEYWORD     07900000
.*                 IS MUTUALLY EXCLUSIVE WITH DEB.  EITHER DEB OR       07950000
.*                 UCB IS REQUIRED UNLESS IOAREA=(,ADDR) IS             08000000
.*                 SPECIFIED FOR THE MF=I FORM OF THIS MACRO.           08050000
.*                                                                      08100000
.*                 VALID ENTRIES:  UCB=ADDR                             08116600
.*                                 UCB=(REG)                            08133200
.*                                                                      08150000
.* MODULE-TYPE = MACRO                                                  08300000
.*                                                                      08350000
.*   PROCESSOR = PLS (MAPPING ONLY) OR ASSEMBLER LANGUAGE               08400000
.*                                                                      08450000
.*   ATTRIBUTES = MAPPING OR EXECUTABLE MACRO                           08500000
.*                                                                      08550000
.* ENTRY-POINT = MACRO STATEMENT.                                       08600000
.*                                                                      08650000
.*   PURPOSE = SEE FUNCTION ABOVE.                                      08700000
.*                                                                      08750000
.*   LINKAGE = PLS -  INCLUDE CVAFFILT (FOR CVPL MAPPING),              08778500
.*                    1. THIS MACRO WILL SET THE CVPLFSA MACRO          08807000
.*                       VARIABLE TO YES AND INCLUDE ICVAFPL.           08835500
.*                    2. MACRO VARIABLE CVPLPRM MAY BE DEFINED          08864000
.*                       BY THE USER (SEE ICVAFPL).                     08892500
.*             BAL -  SEE DESCRIPTION OF KEYWORDS UNDER 'FUNCTION'.     08921000
.*                                                                      08950000
.* INPUT =  PLS - MACRO VARIABLE CVPLPRM MAY BE PROVIDED (SEE ICVAFPL). 08955000
.*          BAL - SEE DESCRIPTION OF KEYWORDS UNDER 'FUNCTION'.         08960000
.*                                                                      08965000
.* OUTPUT = PLS - MACRO VARIABLE CVPLFSA SET TO YES, INCLUDE OF         08970000
.*                ICVAFPL GENERATED.                                    08975000
.*          BAL - CVAF PARAMETER LIST WITH ITS FLAGS AND ADDRESSES      08980000
.*                SET DEPENDING UPON THE KEYWORDS SPECIFIED AS          08985000
.*                DEFINED UNDER 'KEYWORDS' ABOVE.                       08990000
.*                                                                      08995000
.* EXIT-NORMAL = MEND STATEMENT.                                        09000000
.*                                                                      09050000
.*  EXIT-ERROR = MNOTE AND MEND STATEMENT.  MNOTES WILL BE GENERATED    09100000
.*               FOR ANY OF THE FOLLOWING ERRORS ENCOUNTERED (BAL):     09150000
.*                                                                      09200000
.*               FOR THE MF=D FORM OF THE MACRO:                        09250000
.*                   1. ANY OPERAND SPECIFIED (OTHER THAN MF).          09300000
.*                                                                      09550000
.*               FOR ALL FORMS OF THE MACRO (OTHER THAN MF=D):          09600000
.*                   1. INVALID KEYWORD/OPERAND SYNTAX.                 09650000
.*                   2. DEB AND UCB ARE MUTUALLY EXCLUSIVE.             09700000
.*                   3. ACCESS=READ AND AN ADDRESS IS SUPPLIED WITH     09712500
.*                      FLTAREA KEEP OR NOKEEP.                         09725000
.*                   4. ACCESS=RLSE AND FLTAREA KEEP MAY BE ILLOGICAL.  09737500
.*                                                                      09750000
.*               FOR THE MF=I FORM OF THE MACRO:                        09754500
.*                   1. ACCESS=READ OR ACCESS=RESUME AND NO ADDRESS     09759000
.*                      SPECIFIED FOR BUFLIST OR FCL.                   09763500
.*                   2. ACCESS= READ OR ACCESS=RESUME AND THE VOLUME    09768000
.*                      IS NOT SPECIFIED (I.E. NO DEB, UCB, OR          09772500
.*                      IOAREA ADDRESS).                                09777000
.*                   3. ACCESS=RLSE AND NO ADDRESS SPECIFIED FOR        09781500
.*                      EITHER FLTAREA OR IOAREA.                       09786000
.*                                                                      09790500
.*                                                                      09795000
.* EXTERNAL-REFERENCES = NONE                                           09800000
.*                                                                      09850000
.* TABLES = NONE                                                        09900000
.*                                                                      09950000
.* MACROS = ICVAFPL                                                     10000000
.*                                                                      10050000
.* CHANGE-ACTIVITY =                                                    10075000
.*                                                                      10084300
.*$L0=FILT,JDP2220,,STL:            CVAF FILTER                    @L0A 10112500
.*$01=OY02410,HDP2230,T860180,STLAM: FIX MINOR ERRORS IN MACRO     @01A 10125000
.*$02=OY09390,HDP2230,,ISGRPS:       TO SHIP MACRO, NO CODE CHANGE @02A 10137500
.*                                                                      10150000
.*                                                                      10175000
.**** END OF SPECIFICATIONS ******************************************* 10200000
         LCLA  &K                       LENGTH OF PARM                  10250000
         LCLA  &NO                      BRANCH INDEX NUMBER             10300000
         LCLB  &BION                    IOAREA AND BIT FLAG1            10350000
         LCLB  &BIOO                    IOAREA OR BIT FLAG1             10400000
         LCLB  &BFAN                    FLTAREA AND BIT FLAG1           10450000
         LCLB  &BFAO                    FLTAREA OR BIT FLAG1            10500000
         LCLB  &BPGN                    PGM AND BIT FLAG1               10550000
         LCLB  &BPGO                    PGM OR BIT FLAG1                10600000
         LCLB  &ERRSW                   AN ERROR WAS DETECTED           10650000
         LCLB  &SWBUF                   BUFLIST PARM PRESENT SWITCH     10700000
         LCLB  &SWDEB                   DEB PARM PRESENT SWITCH         10750000
         LCLB  &SWFCL                   FCL PARM PRESENT SWITCH         10800000
         LCLB  &SWIOA                   IOAREA PARM PRESENT SWITCH      10850000
         LCLB  &SWFAA                   FLTAREA PARM PRESENT SWITCH     10900000
         LCLB  &SWUCB                   UCB PARM PRESENT SWITCH         10950000
         LCLB  &BUFNCOR                 BUFLIST IN STORAGE SWITCH       11000000
         LCLB  &DEBNCOR                 DEB IN STORAGE SWITCH           11050000
         LCLB  &FCLNCOR                 FCL IN STORAGE SWITCH           11100000
         LCLB  &IOANCOR                 IOAREA IN STORAGE SWITCH        11150000
         LCLB  &FAANCOR                 IOAREA IN STORAGE SWITCH        11200000
         LCLB  &UCBNCOR                 UCB IN STORAGE SWITCH           11250000
         LCLC  &BUFNREG                 BUFLIST IN REG VALUE            11300000
         LCLC  &DEBNREG                 DEB IN REGISTER VALUE           11350000
         LCLC  &FCLNREG                 FCL IN REG VALUE                11400000
         LCLC  &IOANREG                 IOAREA IN REGISTER VALUE        11450000
         LCLC  &FAANREG                 FLTAREA IN REG VALUE            11500000
         LCLC  &UCBNREG                 UCB IN REGISTER VALUE           11550000
         LCLC  &L                       LOCAL LABEL VARIABLE            11600000
         LCLC  &ACC                     ACCESS VALUE FOR MNOTES    @01A 11625000
         LCLC  &FM                      MF=FORM CHARACTER VARIABLE      11650000
         LCLC  &FLAG1                   DEFINE LOCAL CHAR VARIABLE      11700000
         LCLC  &FLAG2                   DEFINE LOCAL CHAR VARIABLE      11750000
         LCLC  &FLAG3                   DEFINE LOCAL CHAR VARIABLE      11800000
         LCLC  &FLAG1N                  DEFINE LOCAL CHAR VARIABLE      11850000
         LCLC  &FLAG2N                  DEFINE LOCAL CHAR VARIABLE      11900000
         LCLC  &FLAG3N                  DEFINE LOCAL CHAR VARIABLE      11950000
         LCLC  &FUNCT                   FUNCTION CODE FOR ACCESS=       12000000
&NO      SETA  &SYSNDX                  SET BRANCH INDEX NUMBER         12050000
&BION    SETB  1                        INITIALIZE 'AND' BIT            12100000
&BFAN    SETB  1                        INITIALIZE 'AND' BIT            12150000
&BPGN    SETB  1                        INITIALIZE 'AND' BIT            12200000
.*                                                                      12250000
.* ******************************************************************** 12300000
.* *     MF=' ' VERIFICATION                                            12350000
.* ******************************************************************** 12400000
.*                                                                      12450000
         AIF   (N'&MF GT 2).ER          MF= HAS ONLY 2 PARMS            12500000
         AIF   ('&MF(1)' EQ 'E').E1     TEST FOR E FORM                 12550000
         AIF   (N'&MF NE 1).ER          MF=L OR I HAS ONLY 1 PARM       12600000
         AIF   ('&MF(1)' EQ 'I').I1     TEST FOR I FORM                 12650000
         AIF   ('&MF(1)' EQ 'L').L1     TEST FOR L FORM                 12700000
         AIF   ('&MF(1)' EQ 'D').D1     TEST FOR D FORM            @01A 12725000
.ER      ANOP                                                           12750000
         SPACE 1                                                        12800000
         MNOTE 8,'***  IHB001 INVALID OPERAND - MF=&MF'                 12850000
&ERRSW   SETB  1                        SET ERROR SWITCH ON             12900000
         AGO   .CKERR                   GO TO ERROR IN CHECK ROUTINE    12950000
.*                                                                      13000000
.* ******************************************************************** 13050000
.* *     EXECUTE FORM, MF=(E,' ') VERIFICATION                          13100000
.* ******************************************************************** 13150000
.*                                                                      13200000
.E1      ANOP                           EXECUTE FORM OF MACRO           13250000
&FM      SETC  'E'                      SET THE MACRO FORM SWITCH       13300000
         AIF   (N'&MF EQ 2).CK1         MF=E MUST HAVE 2 PARMS          13350000
         SPACE 1                                                        13400000
        MNOTE 8,'***  IHB002 MF=E - PARAMETER LIST ADDRESS IS REQUIRED' 13450000
.*                                      THE LINE ABOVE WAS CHANGED @01C 13500000
&ERRSW   SETB  1                        SET ERROR SWITCH ON             13550000
         AGO   .CK1                     GO CHECK NEXT KEYWORD           13600000
.*                                                                      13650000
.* ******************************************************************** 13700000
.* *     LIST FORM OF CVAFFILT                                          13750000
.* ******************************************************************** 13800000
.*                                                                      13850000
.L1      ANOP                           LIST FORM OF MACRO              13900000
&FM      SETC  'L'                      SET THE MACRO FORM SWITCH       13950000
         AGO   .CK1                     GO CHECK NEXT KEYWORD           14000000
.*                                                                      14050000
.* ******************************************************************** 14100000
.* *     INSTRUCTION FORM OF CVAFFILT                                   14150000
.* ******************************************************************** 14200000
.*                                                                      14250000
.I1      ANOP                           INSTRUCTION FORM OF MACRO       14300000
&FM      SETC  'I'                      SET THE MACRO FORM SWITCH       14350000
         AGO   .CK1                     GO CHECK NEXT KEYWORD      @01A 14375000
.*                                                                      14400000
.* ******************************************************************** 14450000
.* *     DSECT FORM OF CVAFFILT                                         14478900
.* ******************************************************************** 14507800
.*                                                                      14536700
.D1      AIF   ('&ACCESS' NE '').D2IG   DSECT FORM OF MACRO        @01A 14565600
         AIF   ('&BRANCH' NE '').D2IG   GIVES AN MNOTE IF ANY      @01A 14594500
         AIF   ('&BUFLIST' NE '').D2IG  OPERAND OTHER THAN MF WAS  @01A 14623400
         AIF   ('&DEB' NE '').D2IG      CODED.                     @01A 14652300
         AIF   ('&FCL' NE '').D2IG                                 @01A 14681200
         AIF   ('&FLTAREA' NE '').D2IG                             @01A 14710100
         AIF   ('&IOAREA' NE '').D2IG                              @01A 14739000
         AIF   ('&UCB' EQ '').D2GO                                 @01A 14767900
.D2IG    ANOP                                                      @01A 14796800
         MNOTE 4,'*** IHB011 MF=D - ONE OR MORE OPERANDS IGNORED'  @01A 14825700
.D2GO    ANOP                                                      @01A 14854600
&LABEL   ICVAFPL  DSECT=YES,CVPLFSA=YES                            @01A 14883500
         AGO   .FINISH                                             @01A 14912400
.*                                                                      14941300
.* ******************************************************************** 14970200
.* *     VERIFY 'ACCESS' KEYWORD                                        15000000
.* ******************************************************************** 15050000
.*                                                                      15100000
.CK1     ANOP                                                           15150000
         AIF   ('&ACCESS' EQ '').AC0    DEFAULT TO ACCESS=READ          15175000
         AIF   ('&ACCESS' NE 'READ').AC1                                15200000
.AC0     ANOP                                                           15225000
&FUNCT   SETC  '0E'                       CVAFFILT ACCESS=READ          15250000
&ACC     SETC  'READ'                                              @01A 15275000
         AGO   .CK2                                                     15300000
.AC1     ANOP                                                           15350000
         AIF   ('&ACCESS' NE 'RESUME').AC2 NOT RESUME, GO ON            15400000
&FUNCT   SETC  '0F'                       CVAFFILT ACCESS=RESUME        15450000
         AGO   .AC2A                                               @01C 15500000
.AC2     ANOP                             MUST BE RELEASE               15550000
         AIF   ('&ACCESS' NE 'RLSE').AC3  NOT RLSE, GO ON               15600000
&FUNCT   SETC  '10'                       CVAFFILT ACCESS=RLSE          15650000
.AC2A    ANOP                                                      @01A 15666600
&ACC     SETC  '&ACCESS'                                           @01A 15683200
         AGO   .CK2                                                     15700000
.AC3     ANOP                                                           15750000
.*                                                                      15800000
         SPACE 1                                                        15950000
         MNOTE 8,'***  IHB001 INVALID OPERAND - ACCESS=&ACCESS'         16000000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       16050000
.*                                                                      16100000
.* ******************************************************************** 16150000
.* *     IF FCL IS PRESENT, CHECK IF IN REG OR NOT                      16200000
.* ******************************************************************** 16250000
.*                                                                      16300000
.CK2     ANOP                                                           16350000
         AIF   ('&FCL' EQ '').ER2B      NO FCL, CHECK WHICH ACCESS      16400000
         AIF   (N'&FCL NE 1).ER2A       ONLY 1 FCL PARM ALLOWED         16450000
&SWFCL   SETB  1                        SET FCL SWITCH ON               16500000
         AIF   ('&FCL'(1,1) EQ '(').FCLNREG                             16550000
&FCLNCOR SETB  1                        FCL IS IN CORE                  16600000
         AGO   .CK3                                                     16650000
.FCLNREG ANOP                                                           16700000
&K       SETA  K'&FCL                   STORE NO. OF CHARS IN FCL       16750000
&FCLNREG SETC  '&FCL'(2,&K-2)           GET REGISTER OF FCL             16800000
         AGO   .CK3                                                     16850000
.ER2A    ANOP                           FCL= **** ERROR ****            16900000
         SPACE 1                                                        16950000
         MNOTE 8,'***  IHB001 INVALID OPERAND - FCL=&FCL'               17000000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       17050000
         AGO   .CK3                                                     17100000
.ER2B    ANOP                           FCL= **** ERROR ****            17150000
         AIF   ('&FUNCT' EQ '10').CK3   NO FCL, CHECK ACCESS            17200000
         AIF   ('&FM' NE 'I').CK3       NO FCL, CHECK MACRO FORMAT      17250000
         SPACE 1                                                        17300000
         MNOTE 8,'***  IHB003 MF=I - FCL ADDRESS REQUIRED FOR ACCESS=&AX17333300
               CC'                                                 @01C 17366600
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       17400000
.*                                                                      17450000
.* ******************************************************************** 17500000
.* *     IF DEB IS PRESENT, CHECK IF IN REG OR NOT                      17550000
.* ******************************************************************** 17600000
.*                                                                      17650000
.CK3     ANOP                                                           17700000
         AIF   ('&DEB' EQ '').U1        NO DEB, GO CHECK UCB            17750000
         AIF   (N'&DEB NE 1).ER3        ONLY 1 DEB PARM ALLOWED         17800000
         AIF   ('&FM' EQ 'L').ER3A      DEB PARM INVALID FOR MF=L       17825000
&SWDEB   SETB  1                        SET DEB SWITCH ON               17850000
         AIF   ('&DEB'(1,1) EQ '(').DEBNREG                             17900000
&DEBNCOR SETB  1                        DEB IS IN CORE                  17950000
         AGO   .U1                                                      18000000
.DEBNREG ANOP                                                           18050000
&K       SETA  K'&DEB                   STORE NO. OF CHARS IN DEB       18100000
&DEBNREG SETC  '&DEB'(2,&K-2)           GET REGISTER OF DEB             18150000
         AGO   .U1                                                      18200000
.ER3     ANOP                           DEB= **** ERROR ****            18250000
         SPACE 1                                                        18300000
         MNOTE 8,'***  IHB001 INVALID OPERAND - DEB=&DEB'               18350000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       18400000
         AGO   .U1                                                      18410000
.ER3A    ANOP                           DEB PARAMETER NOT ALLOWED       18420000
         SPACE 1                        FOR MF=L                        18430000
         MNOTE 4,'***  IHB004 MF=L - DEB PARAMETER IGNORED'        @01C 18440000
.*                                                                      18450000
.* ******************************************************************** 18500000
.* *     IF UCB IS PRESENT, CHECK IF IN REG OR NOT                      18550000
.* ******************************************************************** 18600000
.*                                                                      18650000
.U1      ANOP                                                           18700000
         AIF   ('&UCB' EQ '').I2        NO UCB, IS IOAREA?              18750000
         AIF   (N'&UCB NE 1).ER4        ONLY 1 UCB PARM ALLOWED         18800000
         AIF   ('&FM' EQ 'L').ER4A      UCB PARM INVALID FOR MF=L       18825000
&SWUCB   SETB  1                        SET UCB SWITCH ON               18850000
         AIF   ('&UCB'(1,1) EQ '(').UCBNREG                             18900000
&UCBNCOR SETB  1                        UCB IS IN CORE                  18950000
         AGO   .I2                                                      19000000
.UCBNREG ANOP                                                           19050000
&K       SETA  K'&UCB                   STORE NO. OF CHARS IN UCB       19100000
&UCBNREG SETC  '&UCB'(2,&K-2)           GET REGISTER OF UCB             19150000
         AGO   .I2                                                      19200000
.ER4     ANOP                           UCB= **** ERROR ****            19250000
         SPACE 1                                                        19300000
         MNOTE 8,'***  IHB001 INVALID OPERAND - UCB=&UCB'               19350000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       19400000
         AGO   .I2                                                      19410000
.ER4A    ANOP                           UCB PARAMETER NOT ALLOWED       19420000
         SPACE 1                        FOR MF=L                        19430000
         MNOTE 4,'***  IHB005 MF=L - UCB PARAMETER IGNORED'        @01C 19440000
.*                                                                      19450000
.* ******************************************************************** 19500000
.* *     IF IOAREA IS PRESENT, CHECK IF IN REG OR NOT                   19550000
.* ******************************************************************** 19600000
.*                                                                      19650000
.I2      ANOP                                                           19700000
         AIF   ('&IOAREA' EQ '').I3C    NO IOAREA, IS IT MF=I?          19750000
         AIF   (N'&IOAREA EQ 1).I3A     NO IOAREA ADDRESS, KEEP/NOKEEP? 19800000
         AIF   (N'&IOAREA NE 2).ER5A    ONLY 2 IOAREA PARMS ALLOWED     19850000
         AIF   ('&MF' NE 'L').I2XX      IF NOT LIST FORM, BRANCH   @01A 19862500
         MNOTE 4,'***  IHB012 MF=L - IOAREA ADDRESS IS ILLOGICAL'  @01A 19875000
.I2XX    ANOP                                                      @01A 19887500
.*                                                                      19900000
&SWIOA   SETB  1                        SET IOAREA SWITCH ON            19950000
         AIF   ('&IOAREA(2)'(1,1) EQ '(').IOANREG                       20000000
&IOANCOR SETB  1                        IOAREA IS IN CORE               20050000
         AGO   .I3A                     CHECK OUT FIRST PARM            20100000
.IOANREG ANOP                                                           20150000
&K       SETA  K'&IOAREA(2)             STORE NO. OF CHARS IN IOAREA    20200000
&IOANREG SETC  '&IOAREA(2)'(2,&K-2)     GET REGISTER OF IOAREA          20250000
.*                                                                      20300000
.* ******************************************************************** 20350000
.* *     VALIDITY CHECK THE FIRST PARM OF IOAREA                        20400000
.* ******************************************************************** 20450000
.*                                                                      20500000
.I3A     ANOP                                                           20550000
         AIF   ('&IOAREA(1)' NE 'KEEP').I3B                             20600000
&BIOO    SETB  1                        SET IOAREA=KEEP SWITCH          20650000
         AGO   .I3C                                                     20700000
.I3B     ANOP                                                           20750000
         AIF   ('&IOAREA(1)' NE 'NOKEEP').ER5A                     @01C 20800000
&BION    SETB  0                        SET IOAREA=NOKEEP SWITCH        20850000
         AGO   .I3C                                                     20900000
.ER5A    ANOP                           IOAREA= **** ERROR ****         20950000
         SPACE 1                                                        21000000
         MNOTE 8,'***  IHB001 INVALID OPERAND - IOAREA=&IOAREA'         21050000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       21100000
.*                                                                      21150000
.* ******************************************************************** 21550000
.* *     INST FORM: DEB, UCB OR IOAREA ADDRESS REQUIRED (READ,RESUME)   21600000
.* ******************************************************************** 21650000
.*                                                                      21700000
.I3C     ANOP                                                           21750000
.*                                                                 @01D 21800000
         AIF   ('&FM' NE 'I').F2        IF NOT MF=I, SKIP               21850000
         AIF   ('&ACCESS' EQ 'RLSE').F2 IF RELEASE, SKIP           @01A 21875000
         AIF   ('&SWDEB' EQ '1').F2     DEB ADDRESS, SKIP               21900000
         AIF   ('&SWUCB' EQ '1').F2     UCB ADDRESS, SKIP               21950000
         AIF   ('&SWIOA' EQ '1').F2     IOAREA ADDRESS, SKIP       @01A 21975000
         SPACE 1                                                        22000000
         MNOTE 8,'***  IHB006 MF=I - DEB, UCB OR IOAREA ADDRESS REQUIREX22050000
               D FOR ACCESS=&ACC'                                  @01C 22100000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       22150000
.*                                                                      22200000
.* ******************************************************************** 22250000
.* *     IF FLTAREA IS PRESENT, CHECK IF IN REG OR NOT                  22300000
.* ******************************************************************** 22350000
.*                                                                      22400000
.F2      ANOP                                                           22450000
         AIF   ('&FLTAREA' EQ '').CK4   NO FLTAREA, SKIP                22500000
         AIF   (N'&FLTAREA EQ 1).F3A    NO FLTAREA ADDR, KEEP/NOKEEP?   22550000
         AIF   (N'&FLTAREA NE 2).ER5C   ONLY 2 FLTAREA PARMS ALLOWED    22600000
         AIF   ('&ACCESS' EQ 'READ').F2WARN  IF READ, BRANCH       @01A 22607100
         AIF   ('&MF' NE 'L').F2XX      IF NOT LIST FORM, BRANCH   @01A 22614200
.F2WARN  ANOP                                                      @01A 22621300
         MNOTE 4,'***  IHB013 MF=L OR ACCESS=READ - FLTAREA ADDRESS IS X22628400
               ILLOGICAL'                                          @01A 22635500
.F2XX    ANOP                                                      @01A 22642600
&SWFAA   SETB  1                        SET FLTAREA SWITCH ON           22650000
         AIF   ('&FLTAREA(2)'(1,1) EQ '(').FAANREG                      22700000
&FAANCOR SETB  1                        FLTAREA IS IN CORE              22750000
         AGO   .F3A                     CHECK OUT FIRST PARM            22800000
.FAANREG ANOP                                                           22850000
&K       SETA  K'&FLTAREA(2)            STORE NO. OF CHARS IN FLTAREA   22900000
&FAANREG SETC  '&FLTAREA(2)'(2,&K-2)    GET REGISTER OF FLTAREA         22950000
.*                                                                      23000000
.* ******************************************************************** 23050000
.* *     VALIDITY CHECK THE FIRST PARM OF FLTAREA                       23100000
.* ******************************************************************** 23150000
.*                                                                      23200000
.F3A     ANOP                                                           23250000
         AIF   ('&FLTAREA(1)' NE 'KEEP').F3B                            23300000
         AIF   ('&ACCESS' NE 'RLSE').F3AXX    IF NOT RLSE, BRANCH  @01A 23310000
         MNOTE 4,'***  IHB014 FLTAREA KEEP MAY BE ILLOGICAL FOR ACCESS=X23320000
               RLSE'                                               @01A 23330000
.F3AXX   ANOP                                                      @01A 23340000
&BFAO    SETB  1                        SET FLTAREA=KEEP SWITCH         23350000
         AGO   .CK4                                                     23400000
.F3B     ANOP                                                           23450000
         AIF   ('&FLTAREA(1)' NE 'NOKEEP').ER5C                         23500000
&BFAN    SETB  0                        SET FLTAREA=NOKEEP SWITCH       23550000
         AGO   .CK4                                                     23600000
.ER5C    ANOP                           FLTAREA= **** ERROR ****        23650000
         SPACE 1                                                        23700000
         MNOTE 8,'***  IHB001 INVALID OPERAND - FLTAREA=&FLTAREA'       23750000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       23800000
.*                                                                      23850000
.* ******************************************************************** 23900000
.* *     IF BUFLIST IS PRESENT, CHECK IF IN REG OR NOT                  23950000
.* ******************************************************************** 24000000
.*                                                                      24050000
.CK4     ANOP                                                           24100000
         AIF   ('&BUFLIST' EQ '').I4A   NO BUFLIST, IS IT ACCESS=RLSE?  24150000
         AIF   (N'&BUFLIST NE 1).ER6    ONLY 1 BUFLIST PARM ALLOWED     24200000
&SWBUF   SETB  1                        SET BUFLIST SWITCH ON           24250000
         AIF   ('&BUFLIST'(1,1) EQ '(').BUFNREG                         24300000
&BUFNCOR SETB  1                        BUFLIST IS IN CORE              24350000
         AGO   .CK5                                                     24400000
.BUFNREG ANOP                                                           24450000
&K       SETA  K'&BUFLIST               STORE NO. OF CHARS IN BUFLIST   24500000
&BUFNREG SETC  '&BUFLIST'(2,&K-2)       GET REGISTER OF BUFLIST         24550000
         AGO   .CK5                                                     24600000
.ER6     ANOP                           BUFLIST= **** ERROR ****        24650000
         SPACE 1                                                        24700000
         MNOTE 8,'***  IHB001 INVALID OPERAND - BUFLIST=&BUFLIST'       24750000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       24800000
         AGO   .CK5                                                     24850000
.*                                                                      24900000
.* ******************************************************************** 24950000
.* *     INST FORM: BUFLIST IS REQUIRED WHEN ACCESS=READ                25000000
.* *                OR WHEN ACCESS=RESUME.                              25050000
.* ******************************************************************** 25100000
.*                                                                      25150000
.I4A     ANOP                              BUFLIST IS REQUIRED FOR      25200000
         AIF   ('&FM' NE 'I').CK5          MF=I WHEN ACCESS~=RLSE       25250000
         AIF   ('&FUNCT' EQ '10').CK5      IF RELEASE, SKIP             25300000
         SPACE 1                                                        25350000
         MNOTE 8,'***  IHB007 MF=I - BUFLIST ADDRESS REQUIRED FOR ACCESX25400000
               S=&ACC'                                             @01C 25450000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       25500000
.*                                                                      25550000
.* ******************************************************************** 25600000
.* *     DEB AND UCB KEYWORDS ARE MUTUALLY EXCLUSIVE                    25650000
.* ******************************************************************** 25700000
.*                                                                      25750000
.CK5     ANOP                                                           25800000
         AIF   ('&SWDEB' EQ '0' OR '&SWUCB' EQ '0').CK6                 25850000
         SPACE 1                                                        25900000
         MNOTE 8,'***  IHB008 DEB AND UCB KEYWORDS ARE MUTUALLY EXCLUSIX25950000
               VE'                                                      26000000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       26050000
.*                                                                      26100000
.* ******************************************************************** 26150000
.* *     VALIDITY CHECK THE BRANCH OPERANDS                             26200000
.* ******************************************************************** 26250000
.*                                                                      26300000
.CK6     ANOP                                                           26350000
         AIF   ('&BRANCH' EQ '').I5A        NO BRANCH KEYWORD           26400000
         AIF   ('&BRANCH(1)' EQ 'NO').I5A   BRANCH=NO, GO ON            26450000
         AIF   ('&BRANCH(1)' NE 'YES').ER9  BAD BRANCH=                 26500000
         AIF   (N'&BRANCH EQ 1).I5A         NO 2ND OPERAND              26550000
         AIF   (N'&BRANCH GT 2).ER9         BAD OPERAND                 26600000
         AIF   ('&BRANCH(2)' NE 'PGM').BR1  CHECK FOR PGM               26650000
&BPGO    SETB  1                        SET BRANCH=(YES,PGM) SWITCH     26700000
         AGO   .I5A                                                     26750000
.BR1     ANOP                                                           26800000
         AIF   ('&BRANCH(2)' NE 'SUP').ER9  BAD 2ND OPERAND             26850000
&BPGN    SETB  0                        SET BRANCH=(YES,SUP) SWITCH     26900000
         AGO   .I5A                                                     26950000
.ER9     ANOP                           BRANCH= **** ERROR ****         27000000
         SPACE 1                                                        27050000
         MNOTE 8,'***  IHB001 INVALID OPERAND - BRANCH=&BRANCH'         27100000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       27150000
.*                                                                      27200000
.* ******************************************************************** 27250000
.* *     INST FORM: FLTAREA IS REQUIRED WHEN ACCESS=RESUME.             27251800
.* ******************************************************************** 27253600
.*                                                                      27255400
.I5A     ANOP                              FLTAREA IS REQUIRED FOR      27257200
         AIF   ('&FM' NE 'I').CKERR        MF=I WHEN ACCESS=RESUME      27259000
         AIF   ('&SWFAA' NE '0').CKERR                                  27260800
         AIF   ('&FUNCT' NE '0F').I6A                                   27262600
         SPACE 1                                                        27264400
         MNOTE 8,'***  IHB009 MF=I - FLTAREA ADDRESS REQUIRED FOR ACCESX27266200
               S=RESUME'                                           @01C 27268000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       27269800
.*                                                                      27271600
.* ******************************************************************** 27273400
.* *     INST FORM: FLTAREA AND/OR IOAREA IS REQUIRED FOR               27275200
.* *                ACCESS=RLSE.                                        27277000
.* ******************************************************************** 27278800
.*                                                                      27280600
.I6A     AIF   ('&SWFAA' NE '0').CKERR     FLTAREA OR IOAREA IS   @01C  27282400
         AIF   ('&SWIOA' NE '0').CKERR     REQUIRED FOR MF=I WHEN       27284200
         AIF   ('&FUNCT' NE '10').CKERR    ACCESS=RLSE                  27286000
         SPACE 1                                                        27287800
         MNOTE 8,'***  IHB010 MF=I - FLTAREA AND/OR IOAREA ADDRESS REQUX27289600
               IRED IF ACCESS=RLSE'                                @01C 27291400
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       27293200
.*                                                                      27295000
.* ******************************************************************** 27296800
.* *     CHECK ERRORS: IF ANY PRESENT, SET A 'LABEL DS 0F' AND GET OUT  27300000
.* ******************************************************************** 27350000
.*                                                                      27400000
.CKERR   ANOP                                                           27450000
         AIF   ('&ERRSW' EQ '0').EXEC                                   27500000
&LABEL   DS    0F                                                       27550000
         AGO   .FINISH                                                  27600000
.*                                                                      27650000
.* ******************************************************************** 27700000
.* *     ALL PARAMETERS ARE GOOD - BUILD LIST OF DEFINED CONSTANTS.     27750000
.* ******************************************************************** 27800000
.*                                                                      27850000
.EXEC    ANOP                                                           27900000
&FLAG1   SETC  '0&BIOO&BPGO.00000'                                      27950000
&FLAG2   SETC  '00000000'                                               28000000
&FLAG3   SETC  '&BFAO.0000000'                                          28050000
&L       SETC  '&LABEL'                                                 28100000
         AIF   ('&L' NE '').TSTI                                        28150000
&L       SETC  'ICV&NO.S'                                               28200000
.TSTI    ANOP                                                           28250000
         AIF   ('&FM' EQ 'I').STNDRD                                    28300000
         AIF   ('&FM' EQ 'L').LIST                                      28350000
.*                                                                      28400000
.* ******************************************************************** 28450000
.* *     BEGIN BUILD FOR EXECUTE FORM OF MACRO                          28500000
.* ******************************************************************** 28550000
.*                                                                      28600000
         AIF   ('&LABEL' EQ '').OVER   SKIP OVER LABEL                  28650000
&L       DS    0H                                                  @01C 28700000
.OVER    ANOP                                                           28750000
         IHBINNRA &MF(2)                PARM LIST INTO REG 1            28800000
         AIF   ('&ACCESS' EQ '').E2     NO ACCESS=, SKIP                28850000
         MVI   6(1),X'&FUNCT'           SET FUNCTION CODE               28900000
         AGO   .E2                      GO TO COMMON ROUTINE            28950000
.*                                                                      29000000
.* ******************************************************************** 29050000
.* *     BEGIN BUILD FOR LIST FORM OF MACRO                             29100000
.* ******************************************************************** 29150000
.*                                                                      29200000
.LIST    ANOP                                                           29250000
         CNOP  0,4                                                      29300000
&L       EQU   *                                                        29350000
         AGO   .COMMON                  GO TO COMMON ROUTINE            29400000
.*                                                                      29450000
.* ******************************************************************** 29500000
.* *     BEGIN BUILD FOR STANDARD FORM OF MACRO                         29550000
.* ******************************************************************** 29600000
.*                                                                      29650000
.STNDRD  ANOP                                                           29700000
         CNOP  0,4                                                      29750000
&LABEL   BAL   1,ICV&NO.E               LOAD CVPL LIST ADDRESS          29800000
&L       SETC  'ICV&NO.S'               SET START OF CVPL               29850000
&L       EQU   *                        START OF CVPL                   29900000
.*                                                                      29950000
.* ******************************************************************** 30000000
.* *     COMMON BUILD CODE FOR MF=I AND L FORMS                         30050000
.* ******************************************************************** 30100000
.*                                                                      30150000
.COMMON  ANOP                                                           30200000
         DC    CL4'CVPL'                EBCDIC 'CVPL'                   30250000
         DC    AL2(ICV&NO.E-&L)         LENGTH OF CVPL                  30300000
         DC    XL1'&FUNCT'              FUNCTION CODE                   30350000
         DC    XL1'00'                  STATUS INFORMATION              30400000
         DC    B'&FLAG1'                FIRST FLAG BYTE                 30450000
         DC    B'&FLAG2'                SECOND FLAG BYTE                30500000
         DC    B'&FLAG3'                THIRD FLAG BYTE                 30550000
         DC    X'0'                     RESERVED                        30600000
         DC    A(0)                     UCB ADDRESS                     31150000
.*                                                                      31200000
.* ******************************************************************** 31250000
.* *     FCL PROCESSING                                                 31300000
.* ******************************************************************** 31350000
.*                                                                      31400000
.D2      ANOP                                                           31450000
         AIF   ('&SWFCL' EQ '0').D3     NO FCL PRESENT, SKIP            31500000
         AIF   ('&FCLNCOR' EQ '0').D3   FCL IN REG, SKIP                31550000
         DC    A(&FCL)                  FILTER CRITERIA LIST ADDRESS    31600000
         AGO   .B2                      GO ON TO BUFLIST                31650000
.D3      ANOP                                                           31700000
         DC    A(0)                     FILTER CRITERIA LIST ADDRESS    31750000
.*                                                                      31800000
.* ******************************************************************** 31850000
.* *     BUFLIST PROCESSING                                             31900000
.* ******************************************************************** 31950000
.*                                                                      32000000
.B2      ANOP                                                           32050000
         AIF   ('&SWBUF' EQ '0').B3     NO BUFLIST PRESENT, SKIP        32100000
         AIF   ('&BUFNCOR' EQ '0').B3   BUFLIST IN REG, SKIP            32150000
         DC    A(&BUFLIST)              BUFFER LIST ADDRESS             32200000
         AGO   .O2                      GO ON TO IOAREA PROCESSING      32250000
.B3      ANOP                                                           32300000
         DC    A(0)                     BUFFER LIST ADDRESS             32350000
.*                                                                      32400000
.* ******************************************************************** 32450000
.* *     IOAREA PROCESSING                                              32500000
.* ******************************************************************** 32550000
.*                                                                      32600000
.O2      ANOP                                                           32650000
         DC    A(0)                     INDEX VIR'S BUFFER LIST ADDRESS 32700000
         DC    A(0)                     MAP VIR'S BUFFER LIST ADDRESS   32750000
         AIF   ('&SWIOA' EQ '0').O3     NO IOAREA PRESENT, SKIP         32800000
         AIF   ('&IOANCOR' EQ '0').O3   IOAREA IN REG, SKIP             32850000
         DC    A(&IOAREA(2))            I/O AREA ADDRESS                32900000
         AGO   .DEB2                    GO ON TO DEB                    32950000
.O3      ANOP                                                           33000000
         DC    A(0)                     I/O AREA ADDRESS                33050000
.DEB2    ANOP                                                           33100000
         DC    A(0)                     DEB ADDRESS                     33650000
         DC    A(0)                     ARGUMENT ADDRESS                33750000
         DC    A(0)                     SPACE PARAMETER LIST ADDRESS    33800000
         DC    A(0)                     EXTENT TABLE ADDRESS            33850000
         DC    A(0)                     NEW VRF VIXM BUFFER LIST ADDR   33900000
         DC    A(0)                     VRF DATA ADDRESS                33950000
         DC    A(0)                     COUNT AREA ADDRESS              34000000
.*                                                                      34050000
.* ******************************************************************** 34100000
.* *     FLTAREA PROCESSING                                             34150000
.* ******************************************************************** 34200000
.*                                                                      34250000
.FSA     ANOP                                                           34300000
         AIF   ('&SWFAA' EQ '0').FDC    NO FLTAREA PRESENT, SKIP        34350000
         AIF   ('&FAANCOR' EQ '0').FDC  FLTAREA IN REG, SKIP            34400000
         DC    A(&FLTAREA(2))           FILTER SAVE AREA ADDRESS        34450000
         AGO   .FIN                     GO ON TO DEB                    34500000
.FDC     ANOP                                                           34550000
         DC    A(0)                     FILTER SAVE AREA ADDRESS        34600000
.FIN     ANOP                                                           34650000
ICV&NO.E EQU   *                        END OF CVPL                     34700000
         AIF   ('&FM' EQ 'L').FINISH    LIST FORM IS DONE               34725000
.*                                                                      34750000
.* ******************************************************************** 34800000
.* *     COMMON BUILD CODE FOR MF=I AND (E,ADDR) FORMS                  34850000
.* ******************************************************************** 34900000
.*                                                                      34950000
.E2      ANOP                                                           35000000
         AIF   ('&FM' EQ 'I').UCB1                                      35050000
&FLAG1N  SETC  '1&BION&BPGN.11111'                                      35100000
         AIF   ('&FLAG1N' EQ '11111111').OF1                            35150000
         NI    8(1),B'&FLAG1N'          RESET CVAF FLAGS OFF            35200000
.OF1     ANOP                                                           35250000
         AIF   ('&FLAG1' EQ '00000000').NF3                             35300000
         OI    8(1),B'&FLAG1'           SET CVAF FLAGS ON               35350000
.NF3     ANOP                                                           35400000
&FLAG3N  SETC  '&BFAN.1111111'                                          35450000
         AIF   ('&FLAG3N' EQ '11111111').OF3                            35500000
         NI    10(1),B'&FLAG3N'         RESET CVAF FLAGS OFF            35550000
.OF3     ANOP                                                           35600000
         AIF   ('&FLAG3' EQ '00000000').UCB1                            35650000
         OI    10(1),B'&FLAG3'          SET CVAF FLAGS ON               35700000
.*                                                                      35750000
.* ******************************************************************** 35800000
.* *     UCB PROCESSING                                                 35850000
.* ******************************************************************** 35900000
.*                                                                      35950000
.UCB1    ANOP                                                           36000000
         AIF   ('&SWUCB' EQ '0').FCL1   NO UCB TO PROCESS               36050000
         AIF   ('&UCBNCOR' EQ '1').UNC  UCB IN CORE, SKIP               36100000
         ST    &UCBNREG,12(,1)          STORE UCB PTR IN PARM LIST      36150000
         AGO   .FCL1                                                    36200000
.UNC     ANOP                                                           36250000
.*                                                                      36300000
         L     15,&UCB                  GET UCB ADDRESS AND             36350000
         ST    15,12(,1)                STORE UCB PTR IN PARM LIST      36400000
.*                                                                      36450000
.* ******************************************************************** 36500000
.* *     FCL PROCESSING                                                 36550000
.* ******************************************************************** 36600000
.*                                                                      36650000
.FCL1    ANOP                                                           36700000
         AIF   ('&SWFCL' EQ '0').BL1    NO FCL TO PROCESS               36750000
         AIF   ('&FCLNCOR' EQ '1').DNC  FCL IN CORE, SKIP               36800000
         ST    &FCLNREG,16(,1)          STORE FCL PTR IN PARM LIST      36850000
         AGO   .BL1                                                     36900000
.DNC     ANOP                                                           36950000
         AIF   ('&FM' EQ 'I').BL1       MF=I, ALREADY THERE, SKIP       37000000
         LA    15,&FCL                  GET FCL ADDRESS AND             37050000
         ST    15,16(,1)                STORE FCL PTR IN PARM LIST      37100000
.*                                                                      37150000
.* ******************************************************************** 37200000
.* *     BUFLIST PROCESSING                                             37250000
.* ******************************************************************** 37300000
.*                                                                      37350000
.BL1     ANOP                                                           37400000
         AIF   ('&SWBUF' EQ '0').IOA1   NO BUFLIST TO PROCESS           37450000
         AIF   ('&BUFNCOR' EQ '1').BNC  BUFLIST IN CORE, SKIP           37500000
         ST    &BUFNREG,20(,1)          STORE BUFLIST PTR IN PARM LIST  37550000
         AGO   .IOA1                                                    37600000
.BNC     ANOP                                                           37650000
         AIF   ('&FM' EQ 'I').IOA1      MF=I, ALREADY THERE, SKIP       37700000
         LA    15,&BUFLIST              GET BUFLIST ADDRESS AND         37750000
         ST    15,20(,1)                STORE BUFLIST PTR IN PARM LIST  37800000
.*                                                                      37850000
.* ******************************************************************** 37900000
.* *     IOAREA PROCESSING                                              37950000
.* ******************************************************************** 38000000
.*                                                                      38050000
.IOA1    ANOP                                                           38100000
         AIF   ('&SWIOA' EQ '0').DEB1   NO IOAREA TO PROCESS            38150000
         AIF   ('&IOANCOR' EQ '1').ONC  IOAREA IN CORE, SKIP            38200000
         ST    &IOANREG,32(,1)          STORE IOAREA PTR IN PARM LIST   38250000
         AGO   .DEB1                                                    38300000
.ONC     ANOP                                                           38350000
         AIF   ('&FM' EQ 'I').DEB1      MF=I, ALREADY THERE, SKIP       38400000
         L     15,&IOAREA(2)            GET IOAREA ADDRESS AND     @01C 38450000
         ST    15,32(,1)                STORE ADDRESS IN PARM LIST      38500000
.*                                                                      38550000
.* ******************************************************************** 38600000
.* *     DEB PROCESSING                                                 38650000
.* ******************************************************************** 38700000
.*                                                                      38750000
.DEB1    ANOP                                                           38800000
         AIF   ('&SWDEB' EQ '0').FSA1   NO DEB TO PROCESS               38850000
         AIF   ('&DEBNCOR' EQ '1').ENC  DEB IN CORE, SKIP               38900000
         ST    &DEBNREG,36(,1)          STORE DEB PTR IN PARM LIST      38950000
         AGO   .FSA1                                                    39000000
.ENC     ANOP                                                           39050000
         L     15,&DEB                  GET DEB ADDRESS AND             39150000
         ST    15,36(,1)                STORE ADDRESS IN PARM LIST      39200000
.*                                                                      39250000
.* ******************************************************************** 39300000
.* *     FLTAREA PROCESSING                                             39350000
.* ******************************************************************** 39400000
.*                                                                      39450000
.FSA1    ANOP                                                           39500000
         AIF   ('&SWFAA' EQ '0').BRANCH NO FLTAREA TO PROCESS           39550000
         AIF   ('&FAANCOR' EQ '1').FNC  FLTAREA IN CORE, SKIP           39600000
         ST    &FAANREG,64(,1)          STORE FLTAREA PTR IN PARM LIST  39650000
         AGO   .BRANCH                                                  39700000
.FNC     ANOP                                                           39750000
         AIF   ('&FM' EQ 'I').BRANCH    MF=I, ALREADY THERE, SKIP       39800000
         L     15,&FLTAREA(2)           GET FLTAREA ADDRESS AND    @01C 39850000
         ST    15,64(,1)                STORE ADDRESS IN PARM LIST      39900000
.*                                                                      39950000
.* ******************************************************************** 40000000
.* *     BRANCH PROCESSING -                                            40050000
.* *     LOAD THE CVT, THE VS1/VS2 COMMON EXTENTION 2 POINTER,          40100000
.* *     THE CVTCVAF PTR, THE CVAF POINTER AND BRANCH TO CVAF           40150000
.* *     COMMON ICVCMM00                                                40200000
.* ******************************************************************** 40250000
.*                                                                      40300000
.BRANCH  ANOP                                                           40350000
         AIF   ('&BRANCH' EQ '' OR '&BRANCH(1)' EQ 'NO').SVC139         40400000
         L     15,16                    LOAD THE CVT                    40450000
         L     15,328(,15)              LOAD VS1/VS2 COMMON EXTENTION2  40500000
         L     15,12(,15)               LOAD THE CVT CVAF TABLE         40550000
         L     15,28(,15)               LOAD THE CVAF ADDRESS           40600000
         BASSM 14,15                    BR, SAVE & SET MODE TO          40650000
*                                       MODULE ICVCMM00                 40700000
         AGO   .FINISH                                                  40750000
.* ******************************************************************** 40800000
.* *     SVC139 PROCESSING                                              40850000
.* ******************************************************************** 40900000
.*                                                                      40950000
.SVC139  ANOP                                                           41000000
         SVC   139                                                      41050000
.FINISH  ANOP                                                           41100000
         MEND                                                           41150000
**********************************************************************/ 41200000
*%FILTPLS: ;                                                            41250000
*                                                                       41300000
*/********************************************************************/ 41350000
*/* CVAFFILT.S MAPPING OF THE CVPL (USING ICVAFPL).                  */ 41400000
*/********************************************************************/ 41450000
*/* %CVPLFSA='YES'                  CAUSE ICVAFPL TO GENERATE CVFSA  */ 41500000
*%CVPLFSA='YES';                                                        41550000
*%INCLUDE SYSLIB(ICVAFPL);                                              41600000
