         MACRO                                                          00050000
&LABEL   CVAFSEQ &ACCESS=,&ARG=,&BRANCH=,&BUFLIST=,&DEB=,&DSN=,        C00100000
               &DSNONLY=,&IOAREA=,&IXRCDS=,&MF=I,&UCB=                  00150000
.**** START OF SPECIFICATIONS ****************************************  00200000
.*                                                                      00250000
.*$MAC(CVAFSEQ) COMP(DM1CV) PROD(DMS-XZ): CVAF- SEQUENTIAL ACCESS       00300000
.*                                                                      00350000
.* DESCRIPTIVE-NAME = COMMON VTOC ACCESS FACILITY (CVAF) - SEQUENTIAL   00400000
.*                    ACCESS OF THE VTOC INDEX.                         00450000
.*                                                                      00500000
.*PROPRIETARY V3 STATEMENT                                              00512500
.*LICENSED MATERIALS - PROPERTY OF IBM                                  00525000
.*"RESTRICTED MATERIALS OF IBM"                                         00537500
.*5695-DF1                                                              00550000
.*(C) COPYRIGHT 1980,1985  IBM CORP.                                    00562500
.*END PROPRIETARY V3 STATEMENT                                          00581200
.*                                                                      00600000
.* STATUS = RELEASE 2.1.0                                          @L1A 00650000
.*                                                                      00700000
.* FUNCTION = THIS MACRO WILL SET UP THE CVAF PARAMETER LIST TO ALLOW   00750000
.*     THE CALLER TO:                                                   00800000
.*      1. READ FORMAT 1 AND 4 DSCBS IN DATA SET NAME SEQUENCE THROUGH  00850000
.*         THE INDEX ONLY.                                              00900000
.*      2. READ THE DATA SET NAMES IN THE INDEX.                        00950000
.*      3. RETAIN VIERS READ IN VIRTUAL STORAGE.                        01000000
.*      4. FREE VIER RECORDS RETAINED IN VIRTUAL STORAGE.               01050000
.*      5. READ ONE OR MORE PHYSICALLY CONTIGUOUS DSCBS.                01100000
.*                                                                      01150000
.*     THE 'MF' KEYWORD DETERMINES WHETHER THE CVAF PARAMETER LIST      01200000
.*     IS EXPANDED AND/OR EXECUTABLE INSTRUCTIONS ARE GENERATED TO      01250000
.*     INVOKE CVAF.                                                     01300000
.*                                                                      01350000
.*     THE SPECIFICATION OF MF=(E,ADDR), WILL RESULT IN THE             01400000
.*     MODIFICATION OF AN EXISTING CVAF PARAMETER LIST.  THE            01450000
.*     ADDRESS OF THE PARAMETER LIST IS PROVIDED VIA A SECOND           01500000
.*     SUBPARAMETER OF THE 'MF' KEYWORD.  IT ALSO GENERATES CODE        01550000
.*     NECESSARY TO EITHER BRANCH TO CVAF OR ISSUE SVC 139 TO INVOKE    01600000
.*     CVAF TO PERFORM THE REQUESTED FUNCTIONS.  THIS IS CALLED THE     01650000
.*     EXECUTE-FORM OF THE MACRO.                                       01700000
.*                                                                      01750000
.*     WITH A SPECIFICATION OF MF=I, OR NOT SPECIFYING THE 'MF'         01800000
.*     KEYWORD AT ALL, THIS MACRO WILL EXPAND THE CVAF PARAMETER        01850000
.*     LIST AND INITIALIZE IT ACCORDING TO THE OPTIONS SELECTED         01900000
.*     VIA THE ALLOWABLE KEYWORDS.  IT ALSO GENERATES CODE              01950000
.*     NECESSARY TO EITHER BRANCH TO CVAF OR ISSUE SVC 139 TO           02000000
.*     INVOKE CVAF TO PERFORM THE REQUESTED FUNCTIONS.  THIS IS         02050000
.*     CALLED THE INSTRUCTION-FORM (NORMAL-FORM) OF THE MACRO.          02100000
.*                                                                      02150000
.*     THE SPECIFICATION OF MF=L WILL RESULT IN THE EXPANSION OF THE    02200000
.*     PARAMETER LIST AND INITIALIZE IT ACCORDING TO THE SPECIFIED      02250000
.*     KEYWORDS. HOWEVER IT DOES NOT GENERATE THE CODE TO INVOKE        02300000
.*     CVAF.  THIS IS CALLED THE LIST-FORM OF THE MACRO.                02350000
.*                                                                      02400000
.*     KEYWORDS APPLICABLE TO THE CVAFSEQ  MACRO ARE:                   02450000
.*                                                                      02500000
.*       ACCESS  - WILL SET THE, CVFCTN, FIELD OF THE CVAF PARAMETER    02550000
.*                 LIST TO X'04' FOR GT, X'05' FOR GTEQ.  THIS          02600000
.*                 KEYWORD IS REQUIRED FOR THE MF=I FORM AND IS         02650000
.*                 OPTIONAL FOR THE MF=L OR MF=(E,ADDR) FORM.           02700000
.*                                                                      02750000
.*                 VALID ENTRIES:  ACCESS=GT                            02800000
.*                                 ACCESS=GTEQ                          02850000
.*                                                                      02900000
.*       ARG     - WILL SET THE ADDRESS OF A FIVE BYTE ARGUMENT,        02950000
.*                 SPECIFIED BY THE 'ADDR', INTO THE FIELD: CVARG.      03000000
.*                 THERE IS NO DIFFERENCE BETWEEN THE MACRO-FORMS FOR   03050000
.*                 THIS KEYWORD.                                        03100000
.*                                                                      03150000
.*       BRANCH  - WILL SET THE FLAG, CV1PGM, TO 1 IF (YES,PGM)         03200000
.*                 IS CODED OR RESET IT TO 0 IF (YES,SUP) IS CODED.     03250000
.*                 IF BRANCH=YES OR NO IS CODED, OR IN THE ABSENCE      03300000
.*                 OF THIS KEYWORD, THE FLAG, CV1PGM, WILL NOT BE       03350000
.*                 CHANGED FOR THE MF=(E,ADDR) FORM.                    03400000
.*                                                                      03450000
.*                 FOR MF=I OR MF=(E,ADDR) AND BRANCH=NO IS             03500000
.*                 CODED, OR OMITTED, CODE WILL BE GENERATED TO         03550000
.*                 INVOKE CVAF VIA SVC 139.                             03600000
.*                                                                      03650000
.*                 FOR MF=I OR MF=(E,ADDR) AND YES IS CODED, THE        03700000
.*                 CODE IS GENERATED TO INVOKE CVAF VIA A BRANCH,  @L1A 03725000
.*                 OR A BASSM IF THE RESIDENT SYSTEM IS X/A        @L1A 03750000
.*                 2.1.0 OR LATER.                                 @L1A 03775000
.*                                                                      03800000
.*                 FOR MF=L, ONLY THE FLAG WILL BE INITIALIZED          03850000
.*                 AND NO EXECUTABLE CODED WILL BE GENERATED.           03900000
.*                                                                      03950000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE           04000000
.*                 AN MNOTE, SINCE NO IS THE DEFAULT FOR ALL            04050000
.*                 FORMS OF THIS MACRO.                                 04100000
.*                                                                      04150000
.*                 VALID ENTRIES:  BRANCH=NO        DEFAULT FOR MF=I    04200000
.*                                 BRANCH=YES       (DEFAULT FOR YES    04250000
.*                                 BRANCH=(YES,SUP)  IS (YES,SUP))      04300000
.*                                 BRANCH=(YES,PGM)                     04350000
.*                                                                      04400000
.*       BUFLIST - WILL SET THE ADDRESS OF THE BUFFER LIST, SPECIFIED   04450000
.*                 BY THE 'ADDR', INTO THE FIELD: CVBUFL.               04500000
.*                                                                      04550000
.*                 THE ABSENCE OF THIS KEYWORD WILL CAUSE AN MNOTE      04600000
.*                 TO BE ISSUED WHEN ACCESS=READ OR WRITE (BUT          04650000
.*                 NOT RLSE) FOR THE MF=I FORM OF THIS MACRO.           04700000
.*                                                                      04750000
.*       DEB     - WILL SET THE ADDRESS OF A DEB, SPECIFIED BY THE      04800000
.*                 'ADDR', INTO THE FIELD: CVDEB.  THIS KEYWORD         04850000
.*                 IS MUTUALLY EXCLUSIVE WITH UCB.  EITHER DEB OR       04900000
.*                 UCB IS REQUIRED UNLESS IOAREA=(,ADDR) IS             04950000
.*                 SPECIFIED FOR THE MF=I FORM OF THIS MACRO.           05000000
.*                                                                      05050000
.*       DSN     - WILL SET THE ADDRESS OF A 44 BYTE DATA SET NAME      05100000
.*                 OF THE DSCB, SPECIFIED BY THE 'ADDR', INTO THE       05150000
.*                 FIELD: CVDSN.                                        05200000
.*                                                                      05250000
.*                 THE ABSENCE OF THIS KEYWORD WILL CAUSE AN MNOTE      05300000
.*                 WHEN DSNONLY=YES IS CODED FOR THE MF=I FORM OF       05350000
.*                 THIS MACRO.                                          05380000
.*                                                                      05450000
.*       DSNONLY - WILL SET THE FLAG, CV2DSNLY, TO 1 IF YES IS CODED    05500000
.*                 AND RESET TO 0 IF NO IS CODED.                       05550000
.*                                                                      05600000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN MNOTE, 05650000
.*                 SINCE NO IS THE DEFAULT FOR MF=L AND MF=I.           05700000
.*                 THE FLAG WILL NOT BE CHANGED IN THE ABSENCE OF THE   05750000
.*                 DSNONLY KEYWORD FOR MF=(E,ADDR) FORM.                05800000
.*                                                                      05850000
.*                 VALID ENTRIES:  DSNONLY=NO       DEFAULT FOR MF=I    05900000
.*                                 DSNONLY=YES                          05950000
.*                                                                      06000000
.*       IOAREA  - WILL SET THE ADDRESS OF THE I/O AREA, SPECIFIED      06050000
.*                 BY THE 'ADDR', INTO THE FIELD CVIOAR.  ALSO,         06100000
.*                 THE FLAG, CV1IOAR, WILL BE SET TO 1 IF KEEP IS       06150000
.*                 CODED AND RESET TO 0 IF NOKEEP IS CODED.             06200000
.*                                                                      06250000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN MNOTE, 06300000
.*                 SINCE NOKEEP IS THE DEFAULT FOR MF=L AND MF=I.       06350000
.*                 THE FLAG WILL NOT BE CHANGED IN THE ABSENCE OF THE   06400000
.*                 IOAREA KEYWORD FOR MF=(E,ADDR) FORM.                 06450000
.*                                                                      06500000
.*                 VALID ENTRIES:  IOAREA=NOKEEP    DEFAULT FOR MF=I    06550000
.*                                 IOAREA=(NOKEEP,ADDR)                 06600000
.*                                 IOAREA=KEEP                          06650000
.*                                 IOAREA=(KEEP,ADDR)                   06700000
.*                                                                      06750000
.*       IXRCDS  - WILL SET THE ADDRESS OF THE VIERS BUFFER LIST,       06800000
.*                 SPECIFIED BY THE 'ADDR', INTO THE FIELD: CVIRCDS.    06850000
.*                 ALSO, THE FLAG, CV1IRCDS, WILL BE SET TO 1 IF KEEP   06900000
.*                 IS CODED AND RESET TO 0 IF NOKEEP IS CODED.          06950000
.*                                                                      07000000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN MNOTE, 07050000
.*                 SINCE NOKEEP IS THE DEFAULT FOR MF=L AND MF=I.       07100000
.*                 THE FLAG WILL NOT BE CHANGED IN THE ABSENCE OF THE   07150000
.*                 IXRCDS KEYWORD FOR MF=(E,ADDR) FORM.                 07200000
.*                                                                      07250000
.*                 VALID ENTRIES:  IXRCDS=NOKEEP    DEFAULT FOR MF=I    07300000
.*                                 IXRCDS=(NOKEEP,ADDR)                 07350000
.*                                 IXRCDS=KEEP                          07400000
.*                                 IXRCDS=(KEEP,ADDR)                   07450000
.*                                                                      07500000
.*       MF      - SEE THE OPENING PARAGRAPHS ABOVE.  IF THE MF KEYWORD 07550000
.*                 IS NOT SPECIFIED, THE DEFAULT, MF=I, WILL BE IN      07600000
.*                 EFFECT.                                              07650000
.*                                                                      07700000
.*                 FOR THE INSTRUCTION-FORM (MF=I), THE                 07750000
.*                 FOLLOWING VALIDITY CHECKS WILL BE MADE:              07800000
.*                   1. ACCESS IS REQUIRED.                             07850000
.*                   2. BUFLIST IS REQUIRED WHEN DSNONLY=NO IS CODED.   07900000
.*                   3. IOAREA=(,ADDR) HAS NOT BEEN SPECIFIED AND       07950000
.*                      THE DEB OR UCB HAVE NOT BEEN CODED.             07980000
.*                   4. DSN IS REQUIRED WHEN DSNONLY=YES IS CODED.      08050000
.*                                                                      08100000
.*                 FOR ALL FORMS OF THE MACRO, THE FOLLOWING            08150000
.*                 VALIDITY CHECKS WILL BE MADE:                        08200000
.*                   1. VALID KEYWORDS.                                 08250000
.*                   2. VALID KEYWORD OPERANDS.                         08300000
.*                   3. DEB AND UCB ARE MUTUALLY EXCLUSIVE.             08350000
.*                                                                      08400000
.*                 VALID ENTRIES:  MF=I             DEFAULT             08450000
.*                                 MF=L                                 08500000
.*                                 MF=(E,ADDR)                          08550000
.*                                                                      08600000
.*       UCB     - WILL SET THE ADDRESS OF THE UCB, SPECIFIED BY        08650000
.*                 THE 'ADDR', INTO THE FIELD: CVUCB.  THIS KEYWORD     08700000
.*                 IS MUTUALLY EXCLUSIVE WITH DEB.  EITHER DEB OR       08750000
.*                 UCB IS REQUIRED UNLESS IOAREA=(,ADDR) IS             08800000
.*                 SPECIFIED FOR THE MF=I FORM OF THIS MACRO.           08850000
.*                                                                      08900000
.* NOTES = N/A                                                          08950000
.*                                                                      09000000
.* MODULE-TYPE = MACRO                                                  09050000
.*                                                                      09100000
.*   PROCESSOR = ASSEMBLER LANGUAGE                                     09150000
.*                                                                      09200000
.*   ATTRIBUTES = EXECUTABLE MACRO                                      09250000
.*                                                                      09300000
.* ENTRY-POINT = MACRO STATEMENT.                                       09350000
.*                                                                      09400000
.* INPUT = SEE DESCRIPTION OF KEYWORDS UNDER 'FUNCTION'.                09450000
.*                                                                      09500000
.* OUTPUT = CVAF PARAMETER LIST WITH THE FLAGS AND THE ADDRESSES        09550000
.*          SET DEPENDING UPON THE KEYWORDS SPECIFIED AS DEFINED        09600000
.*          UNDER 'KEYWORDS' ABOVE.                                     09650000
.*                                                                      09700000
.* EXIT-NORMAL = MEND STATEMENT.                                        09750000
.*                                                                      09800000
.* EXIT-ERROR = MNOTE AND MEND STATEMENT.  AN MNOTE WILL BE GENERATE    09850000
.*              FOR ANY OF THE FOLLOWING ERRORS ENCOUNTERED:            09900000
.*                                                                      09950000
.*                 FOR THE MF=I FORM OF THE MACRO:                      10000000
.*                   1. ACCESS IS NOT SUPPLIED.                         10050000
.*                   2. BUFLIST IS NOT SUPPLIED AND DSNONLY=NO WAS      10100000
.*                      CODED.                                          10150000
.*                   3. IOAREA=(,ADDR) HAS NOT BEEN SPECIFIED AND       10200000
.*                      THE DEB OR UCB HAVE NOT BEEN CODED.             10250000
.*                   4. DSN IS REQUIRED WHEN DSNONLY=YES IS CODED.      10300000
.*                                                                      10450000
.*                 FOR ALL FORMS OF THE MACRO:                          10500000
.*                   1. VALID KEYWORD OPERANDS.                         10550000
.*                   2. DEB AND UCB ARE MUTUALLY EXCLUSIVE.             10600000
.*                                                                      10650000
.* EXTERNAL-REFERENCES = NONE                                           10700000
.*                                                                      10750000
.* TABLES = NONE                                                        10800000
.*                                                                      10850000
.* MACROS = IHBINNRA                                                    10900000
.*                                                                      10950000
.* CHANGE-ACTIVITY =                                                    11000000
.*                                                                      11016600
.*$L0=IXVTOC,JDM1134,T790225,STLBS: NEW MACRO                     @L0A  11033200
.*$L1=VSCR,HDP2210,T840401,STLMDB: CVAF VSCR                      @L1A  11041600
.*                                                                      11050000
.**** END OF SPECIFICATIONS ******************************************  11100000
         LCLA  &K                       LENGTH OF PARM                  11150000
         LCLA  &NO                      BRANCH INDEX NUMBER             11200000
         LCLB  &BDOO                    DSNONLY OR BIT FLAG1            11250000
         LCLB  &BIOO                    IOAREA OR BIT FLAG1             11300000
         LCLB  &BIRO                    IXRCDS OR BIT FLAG1             11350000
         LCLB  &BPGO                    BRANCH OR BIT FLAG1             11400000
         LCLB  &BDON                    DSNONLY AND BIT FLAG1           11450000
         LCLB  &BION                    IOAREA AND BIT FLAG1            11500000
         LCLB  &BIRN                    IXRCDS AND BIT FLAG1            11550000
         LCLB  &BPGN                    BRANCH AND BIT FLAG1            11600000
         LCLB  &ERRSW                   AN ERROR WAS DETECTED           11650000
         LCLB  &SWARG                   ARGUMENT PARM PRESENT SWITCH    11700000
         LCLB  &SWBUF                   BUFLIST PARM PRESENT SWITCH     11750000
         LCLB  &SWDEB                   DEB PARM PRESENT SWITCH         11800000
         LCLB  &SWDSN                   DSN PARM PRESENT SWITCH         11850000
         LCLB  &SWIOA                   IOAREA PARM PRESENT SWITCH      11900000
         LCLB  &SWIXR                   IXRCDS PARM PRESENT SWITCH      11950000
         LCLB  &SWUCB                   UCB PARM PRESENT SWITCH         12000000
         LCLB  &ARGNCOR                 ARGUMENT IN STORAGE SWITCH      12050000
         LCLB  &BUFNCOR                 BUFLIST IN STORAGE SWITCH       12100000
         LCLB  &DEBNCOR                 DEB IN STORAGE SWITCH           12150000
         LCLB  &DSNNCOR                 DSN IN STORAGE SWITCH           12200000
         LCLB  &IOANCOR                 IOAREA IN STORAGE SWITCH        12250000
         LCLB  &IXRNCOR                 IXRCDS IN STORAGE SWITCH        12300000
         LCLB  &UCBNCOR                 UCB IN STORAGE SWITCH           12350000
         LCLC  &ARGNREG                 ARGUMENT IN REG VALUE           12400000
         LCLC  &BUFNREG                 BUFLIST IN REG VALUE            12450000
         LCLC  &DEBNREG                 DEB IN REGISTER VALUE           12500000
         LCLC  &DSNNREG                 DSN IN REG VALUE                12550000
         LCLC  &IOANREG                 IOAREA IN REGISTER VALUE        12600000
         LCLC  &IXRNREG                 IXRCDS IN REG VALUE             12650000
         LCLC  &UCBNREG                 UCB IN REGISTER VALUE           12700000
         LCLC  &L                       LOCAL LABEL VARIABLE            12750000
         LCLC  &FM                      MF=FORM CHARACTER VARIABLE      12800000
         LCLC  &FLAG1                   DEFINE LOCAL CHAR VARIABLE      12850000
         LCLC  &FLAG2                   DEFINE LOCAL CHAR VARIABLE      12900000
         LCLC  &FLAG1N                  DEFINE LOCAL CHAR VARIABLE      12950000
         LCLC  &FLAG2N                  DEFINE LOCAL CHAR VARIABLE      13000000
         LCLC  &FUNCT                   FUNCTION CODE FOR ACCESS=       13050000
&NO      SETA  &SYSNDX                  INITIALIZE BRANCH INDEX NUM     13100000
&BDON    SETB  1                        INITIALIZE 'AND' BIT            13150000
&BION    SETB  1                        INITIALIZE 'AND' BIT            13200000
&BIRN    SETB  1                        INITIALIZE 'AND' BIT            13250000
&BPGN    SETB  1                        INITIALIZE 'AND' BIT            13300000
.*                                                                      13350000
.* ******************************************************************** 13400000
.* *     MF=' ' VERIFICATION                                            13450000
.* ******************************************************************** 13500000
.*                                                                      13550000
         AIF   (N'&MF GT 2).ER          MF= HAS ONLY 2 PARMS            13600000
         AIF   ('&MF(1)' EQ 'E').E1     TEST FOR E FORM                 13650000
         AIF   (N'&MF NE 1).ER          MF=L OR I HAS ONLY 1 PARM       13700000
         AIF   ('&MF(1)' EQ 'I').I1     TEST FOR I FORM                 13750000
         AIF   ('&MF(1)' EQ 'L').L1     TEST FOR L FORM                 13800000
.ER      ANOP                                                           13850000
         SPACE 1                                                        13900000
         MNOTE 16,'***  IHB001 INVALID OPERAND - MF=&MF'                13950000
&ERRSW   SETB  1                        SET ERROR SWITCH ON             14000000
         AGO   .CKERR                   GO TO ERROR IN CHECK ROUTINE    14050000
.*                                                                      14100000
.* ******************************************************************** 14150000
.* *     EXECUTE FORM, MF=(E,' ') VERIFICATION                          14200000
.* ******************************************************************** 14250000
.*                                                                      14300000
.E1      ANOP                           EXECUTE FORM OF MACRO           14350000
&FM      SETC  'E'                      SET THE MACRO FORM SWITCH       14400000
         AIF   (N'&MF EQ 2).CK1         MF=E MUST HAVE 2 PARMS          14450000
         SPACE 1                                                        14500000
         MNOTE 16,'***  IHB002 MF=(E,ADDR) FORM: PARAMETER LIST ADDRESSX14550000
                IS REQUIRED'                                            14600000
&ERRSW   SETB  1                        SET ERROR SWITCH ON             14650000
         AGO   .CK1                     GO CHECK NEXT KEYWORD           14700000
.*                                                                      14750000
.* ******************************************************************** 14800000
.* *     LIST FORM OF CVAFSEQ                                           14850000
.* ******************************************************************** 14900000
.*                                                                      14950000
.L1      ANOP                           LIST FORM OF MACRO              15000000
&FM      SETC  'L'                      SET THE MACRO FORM SWITCH       15050000
         AGO   .CK1                     GO CHECK NEXT KEYWORD           15100000
.*                                                                      15150000
.* ******************************************************************** 15200000
.* *     INSTRUCTION FORM OF CVAFSEQ                                    15250000
.* ******************************************************************** 15300000
.*                                                                      15350000
.I1      ANOP                           INSTRUCTION FORM OF MACRO       15400000
&FM      SETC  'I'                      SET THE MACRO FORM SWITCH       15450000
.*                                                                      15500000
.* ******************************************************************** 15550000
.* *     INSTRUCTION FORM REQUIRES THE 'ACCESS' KEYWORD                 15600000
.* ******************************************************************** 15650000
.*                                                                      15700000
         AIF   ('&ACCESS' NE '').CK1    OK IF ACCESS IS CODED           15750000
         SPACE 1                                                        15800000
         MNOTE 12,'***  IHB003 MF=I FORM: ACCESS KEYWORD IS REQUIRED'   15850000
&ERRSW   SETB  1                         SET ERROR IN CHECK SWITCH      15900000
         AGO   .CK2                      BYPASS NEXT CHECK              15950000
.*                                                                      16000000
.* ******************************************************************** 16050000
.* *     VALIDATE 'ACCESS' KEYWORD                                      16100000
.* ******************************************************************** 16150000
.*                                                                      16200000
.CK1     ANOP                                                           16250000
         AIF   ('&ACCESS' NE 'GT').AC1                                  16300000
&FUNCT   SETC  '04'                       CVAFSEQ ACCESS=GT             16350000
         AGO   .CK2                                                     16400000
.AC1     ANOP                                                           16450000
         AIF   ('&ACCESS' NE 'GTEQ').AC2 NOT WRITE, GO ON               16500000
&FUNCT   SETC  '05'                       CVAFSEQ ACCESS=GTEQ           16550000
         AGO   .CK2                                                     16600000
.AC2     ANOP                             MUST BE RELEASE               16650000
         AIF   ('&ACCESS' EQ '' AND '&FM' EQ 'E').CK2                   16700000
&FUNCT   SETC  '00'                       ACCESS= NOT CODED             16750000
         AIF   ('&ACCESS' EQ '' AND '&FM' NE 'I').CK2 MF~=I, SKIP       16800000
         SPACE 1                                                        16850000
         MNOTE 12,'***  IHB001 INVALID OPERAND - ACCESS=&ACCESS'        16900000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       16950000
.*                                                                      17000000
.* ******************************************************************** 17050000
.* *     IF DSN IS PRESENT, CHECK IF IN REG OR NOT                      17100000
.* ******************************************************************** 17150000
.*                                                                      17200000
.CK2     ANOP                                                           17250000
         AIF   ('&DSN' EQ '').DNO       NO DSN, GO TO DSNONLY CHECK     17300000
         AIF   (N'&DSN NE 1).ER2        ONLY 1 DSN PARM ALLOWED         17350000
&SWDSN   SETB  1                        SET DSN SWITCH ON               17400000
         AIF   ('&DSN'(1,1) EQ '(').DSNNREG                             17450000
&DSNNCOR SETB  1                        DSN IS IN CORE                  17500000
         AGO   .DNO                                                     17550000
.DSNNREG ANOP                                                           17600000
&K       SETA  K'&DSN                   STORE NO. OF CHARS IN DSN       17650000
&DSNNREG SETC  '&DSN'(2,&K-2)           GET REGISTER OF DSN             17700000
         AGO   .DNO                                                     17750000
.ER2     ANOP                           DSN= **** ERROR ****            17800000
         SPACE 1                                                        17850000
         MNOTE 12,'***  IHB001 INVALID OPERAND - DSN=&DSN'              17900000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       17950000
&SWDSN   SETB  0                        RESET DSN SWITCH                18000000
.*                                                                      18050000
.* ******************************************************************** 18100000
.* *     IF DSNONLY= IS PRESENT, VALIDITY CHECK IT                      18150000
.* ******************************************************************** 18200000
.*                                                                      18250000
.DNO     ANOP                                                           18300000
         AIF   ('&DSNONLY' EQ '').CK3   NO DSNONLY, SKIP NEXT CHECK     18350000
         AIF   ('&DSNONLY' NE 'YES').D1 DSNONLY=NO, SKIP                18400000
&BDOO    SETB  1                        SET DSNONLY=YES SWITCH          18450000
         AGO   .D2                                                      18500000
.D1      ANOP                                                           18550000
         AIF   ('&DSNONLY' NE 'NO').ERD DSNONLY=??, SKIP TO ERROR       18600000
&BDON    SETB  0                        SET DSNONLY=NO SWITCH           18650000
         AGO   .CK3                                                     18700000
.ERD     ANOP                           DSNONLY= **** ERROR ****        18750000
         SPACE 1                                                        18800000
         MNOTE 12,'***  IHB001 INVALID OPERAND - DSNONLY=&DSNONLY'      18850000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       18900000
.*                                                                      18950000
.* ******************************************************************** 19000000
.* *     INST FORM: DSN IS REQUIRED WHEN DSNONLY=YES                    19050000
.* ******************************************************************** 19100000
.*                                                                      19150000
.D2      ANOP                                                           19200000
         AIF   ('&FM' NE 'I').CK3        MF=L OR E, SKIP                19250000
         AIF   ('&SWDSN' EQ '1').CK3     DSN PRESENT, SKIP              19300000
         SPACE 1                                                        19350000
         MNOTE 12,'***  IHB004 MF=I FORM: DSN IS REQUIRED FOR DSNONLY=YX19400000
               ES'                                                      19450000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       19500000
.*                                                                      19550000
.* ******************************************************************** 19600000
.* *     IF DEB IS PRESENT, CHECK IF IN REG OR NOT                      19650000
.* ******************************************************************** 19700000
.*                                                                      19750000
.CK3     ANOP                                                           19800000
         AIF   ('&DEB' EQ '').U1        NO DEB, GO CHECK UCB            19850000
         AIF   (N'&DEB NE 1).ER3        ONLY 1 DEB PARM ALLOWED         19900000
&SWDEB   SETB  1                        SET DEB SWITCH ON               19950000
         AIF   ('&DEB'(1,1) EQ '(').DEBNREG                             20000000
&DEBNCOR SETB  1                        DEB IS IN CORE                  20050000
         AGO   .U1                                                      20100000
.DEBNREG ANOP                                                           20150000
&K       SETA  K'&DEB                   STORE NO. OF CHARS IN DEB       20200000
&DEBNREG SETC  '&DEB'(2,&K-2)           GET REGISTER OF DEB             20250000
         AGO   .U1                                                      20300000
.ER3     ANOP                           DEB= **** ERROR ****            20350000
         SPACE 1                                                        20400000
         MNOTE 12,'***  IHB001 INVALID OPERAND - DEB=&DEB'              20450000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       20500000
.*                                                                      20550000
.* ******************************************************************** 20600000
.* *     IF UCB IS PRESENT, CHECK IF IN REG OR NOT                      20650000
.* ******************************************************************** 20700000
.*                                                                      20750000
.U1      ANOP                                                           20800000
         AIF   ('&UCB' EQ '').I2        NO UCB, IS IOAREA?              20850000
         AIF   (N'&UCB NE 1).ER4        ONLY 1 UCB PARM ALLOWED         20900000
&SWUCB   SETB  1                        SET UCB SWITCH ON               20950000
         AIF   ('&UCB'(1,1) EQ '(').UCBNREG                             21000000
&UCBNCOR SETB  1                        UCB IS IN CORE                  21050000
         AGO   .I2                                                      21100000
.UCBNREG ANOP                                                           21150000
&K       SETA  K'&UCB                   STORE NO. OF CHARS IN UCB       21200000
&UCBNREG SETC  '&UCB'(2,&K-2)           GET REGISTER OF UCB             21250000
         AGO   .I2                                                      21300000
.ER4     ANOP                           UCB= **** ERROR ****            21350000
         SPACE 1                                                        21400000
         MNOTE 12,'***  IHB001 INVALID OPERAND - UCB=&UCB'              21450000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       21500000
.*                                                                      21550000
.* ******************************************************************** 21600000
.* *     IF IOAREA IS PRESENT, CHECK IF IN REG OR NOT                   21650000
.* ******************************************************************** 21700000
.*                                                                      21750000
.I2      ANOP                                                           21800000
         AIF   ('&IOAREA' EQ '').I3C    NO IOAREA, IS IT MF=I?          21850000
         AIF   (N'&IOAREA EQ 1).I3A     NO IOAREA ADDRESS, KEEP/NOKEEP? 21900000
         AIF   (N'&IOAREA NE 2).ER5     ONLY 2 IOAREA PARMS ALLOWED     21950000
&SWIOA   SETB  1                        SET IOAREA SWITCH ON            22000000
         AIF   ('&IOAREA(2)'(1,1) EQ '(').IOANREG                       22050000
&IOANCOR SETB  1                        IOAREA IS IN CORE               22100000
         AGO   .I3A                     CHECK OUT FIRST PARM            22150000
.IOANREG ANOP                                                           22200000
&K       SETA  K'&IOAREA(2)             STORE NO. OF CHARS IN IOAREA    22250000
&IOANREG SETC  '&IOAREA(2)'(2,&K-2)     GET REGISTER OF IOAREA          22300000
.*                                                                      22350000
.* ******************************************************************** 22400000
.* *     VALIDITY CHECK THE FIRST PARM OF IOAREA                        22450000
.* ******************************************************************** 22500000
.*                                                                      22550000
.I3A     ANOP                                                           22600000
         AIF   ('&IOAREA(1)' NE 'KEEP').I3B                             22650000
&BIOO    SETB  1                        SET IOAREA=KEEP SWITCH          22700000
         AGO   .I3C                                                     22750000
.I3B     ANOP                                                           22800000
         AIF   ('&IOAREA(1)' NE 'NOKEEP').ER5                           22850000
&BION    SETB  0                        SET IOAREA=NOKEEP SWITCH        22900000
         AGO   .I3C                                                     22950000
.ER5     ANOP                           IOAREA= **** ERROR ****         23000000
         SPACE 1                                                        23050000
         MNOTE 12,'***  IHB001 INVALID OPERAND - IOAREA=&IOAREA'        23100000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       23150000
.*                                                                      23200000
.* ******************************************************************** 23250000
.* *     INST FORM: DEB OR UCB IS REQUIRED WHEN NO IOAREA=(,ADDR)       23300000
.* ******************************************************************** 23350000
.*                                                                      23400000
.I3C     ANOP                                                           23450000
         AIF   ('&FM' NE 'I').CK4       IF NOT MF=I, SKIP               23500000
         AIF   ('&SWIOA' EQ '1').CK4    IOAREA ADDRESS, SKIP            23550000
         AIF   ('&SWDEB' EQ '1').CK4    DEB ADDRESS, SKIP               23600000
         AIF   ('&SWUCB' EQ '1').CK4    UCB ADDRESS, SKIP               23650000
         SPACE 1                                                        23700000
         MNOTE 12,'***  IHB005 MF=I FORM: DEB OR UCB IS REQUIRED WHEN NX23750000
               O IOAREA      ADDRESS IS SPECIFIED'                      23800000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       23850000
.*                                                                      23900000
.* ******************************************************************** 23950000
.* *     IF BUFLIST IS PRESENT, CHECK IF IN REG OR NOT                  24000000
.* ******************************************************************** 24050000
.*                                                                      24100000
.CK4     ANOP                                                           24150000
         AIF   ('&BUFLIST' EQ '').I4    NO BUFLIST, IS IT MF=I?         24200000
         AIF   (N'&BUFLIST NE 1).ER6    ONLY 1 BUFLIST PARM ALLOWED     24250000
&SWBUF   SETB  1                        SET BUFLIST SWITCH ON           24300000
         AIF   ('&BUFLIST'(1,1) EQ '(').BUFNREG                         24350000
&BUFNCOR SETB  1                        BUFLIST IS IN CORE              24400000
         AGO   .I4                                                      24450000
.BUFNREG ANOP                                                           24500000
&K       SETA  K'&BUFLIST               STORE NO. OF CHARS IN BUFLIST   24550000
&BUFNREG SETC  '&BUFLIST'(2,&K-2)       GET REGISTER OF BUFLIST         24600000
         AGO   .I4                                                      24650000
.ER6     ANOP                           BUFLIST= **** ERROR ****        24700000
         SPACE 1                                                        24750000
         MNOTE 12,'***  IHB001 INVALID OPERAND - BUFLIST=&BUFLIST'      24800000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       24850000
.*                                                                      24900000
.* ******************************************************************** 24950000
.* *     INST FORM: BUFLIST IS REQUIRED WHEN DSNONLY=NO                 25000000
.* ******************************************************************** 25050000
.*                                                                      25100000
.I4      ANOP                                                           25150000
         AIF   ('&SWBUF' EQ '1').CK5       BUFLIST IS REQUIRED FOR      25200000
         AIF   ('&FM' NE 'I').CK5          MF=I WHEN DSNONLY=           25250000
         AIF   ('&DSNONLY' EQ 'YES').CK5   NO                           25300000
         SPACE 1                                                        25350000
         MNOTE 12,'***  IHB006 MF=I FORM: BUFLIST IS REQUIRED FOR DSNONX25400000
               LY=NO'                                                   25450000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       25500000
.*                                                                      25550000
.* ******************************************************************** 25600000
.* *     DEB AND UCB KEYWORDS ARE MUTUALLY EXCLUSIVE                    25650000
.* ******************************************************************** 25700000
.*                                                                      25750000
.CK5     ANOP                                                           25800000
         AIF   ('&SWDEB' EQ '0' OR '&SWUCB' EQ '0').CK6                 25850000
         SPACE 1                                                        25900000
         MNOTE 12,'***  IHB007 DEB AND UCB KEYWORDS ARE MUTUALLY EXCLUSX25950000
               IVE'                                                     26000000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       26050000
.*                                                                      26100000
.* ******************************************************************** 26150000
.* *     IF ARG IS PRESENT, CHECK IF IN REG OR NOT                      26200000
.* ******************************************************************** 26250000
.*                                                                      26300000
.CK6     ANOP                                                           26350000
         AIF   ('&ARG' EQ '').CK9       NO ARG, SKIP                    26400000
         AIF   (N'&ARG NE 1).CK7        ONLY 1 ARG PARM ALLOWED         26450000
&SWARG   SETB  1                        SET ARG SWITCH ON               26500000
         AIF   ('&ARG'(1,1) EQ '(').ARGNREG                             26550000
&ARGNCOR SETB  1                        ARG IS IN CORE                  26600000
         AGO   .CK9                                                     26650000
.ARGNREG ANOP                                                           26700000
&K       SETA  K'&ARG                   STORE NO. OF CHARS IN ARG       26750000
&ARGNREG SETC  '&ARG'(2,&K-2)           GET REGISTER OF ARG             26800000
         AGO   .CK9                                                     26850000
.CK7     ANOP                           ARG= **** ERROR ****            26900000
         SPACE 1                                                        26950000
         MNOTE 12,'***  IHB001 INVALID OPERAND - ARG=&ARG'              27000000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       27050000
.*                                                                      27100000
.* ******************************************************************** 27150000
.* *     IF IXRCDS IS PRESENT, CHECK IF IN REG OR NOT                   27200000
.* ******************************************************************** 27250000
.*                                                                      27300000
.CK9     ANOP                                                           27350000
         AIF   ('&IXRCDS' EQ '').CK11   NO IXRCDS, GO ON                27400000
         AIF   (N'&IXRCDS EQ 1).CK10    NO IXRCDS ADDRESS, KEEP/NOKEEP? 27450000
         AIF   (N'&IXRCDS NE 2).ER8     ONLY 2 IXRCDS PARMS ALLOWED     27500000
&SWIXR   SETB  1                        SET IXRCDS SWITCH ON            27550000
         AIF   ('&IXRCDS(2)'(1,1) EQ '(').IXRNREG                       27600000
&IXRNCOR SETB  1                        IXRCDS IS IN CORE               27650000
         AGO   .CK10                    CHECK OUT FIRST PARM            27700000
.IXRNREG ANOP                                                           27750000
&K       SETA  K'&IXRCDS(2)             STORE NO. OF CHARS IN IXRCDS    27800000
&IXRNREG SETC  '&IXRCDS(2)'(2,&K-2)     GET REGISTER OF IXRCDS          27850000
.*                                                                      27900000
.* ******************************************************************** 27950000
.* *     VALIDITY CHECK THE FIRST PARM OF IXRCDS                        28000000
.* ******************************************************************** 28050000
.*                                                                      28100000
.CK10    ANOP                                                           28150000
         AIF   ('&IXRCDS(1)' NE 'KEEP').IR1                             28200000
&BIRO    SETB  1                        SET IXRCDS=KEEP SWITCH          28250000
         AGO   .CK11                                                    28300000
.IR1    ANOP                                                            28350000
         AIF   ('&IXRCDS(1)' NE 'NOKEEP').ER8                           28400000
&BIRN    SETB  0                        SET IXRCDS=NOKEEP SWITCH        28450000
         AGO   .CK11                                                    28500000
.ER8     ANOP                           IXRCDS= **** ERROR ****         28550000
         SPACE 1                                                        28600000
         MNOTE 12,'***  IHB001 INVALID OPERAND - IXRCDS=&IXRCDS'        28650000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       28700000
.*                                                                      28750000
.* ******************************************************************** 28800000
.* *     VALIDITY CHECK THE BRANCH OPERANDS                             28850000
.* ******************************************************************** 28900000
.*                                                                      28950000
.CK11    ANOP                                                           29000000
         AIF   ('&BRANCH' EQ '').CKERR      NO BRANCH KEYWORD           29050000
         AIF   ('&BRANCH(1)' EQ 'NO').CKERR BRANCH=NO, GO ON            29100000
         AIF   ('&BRANCH(1)' NE 'YES').ER9  BAD BRANCH=                 29150000
         AIF   (N'&BRANCH EQ 1).CKERR       NO 2ND OPERAND              29200000
         AIF   (N'&BRANCH GT 2).ER9         BAD OPERAND                 29250000
         AIF   ('&BRANCH(2)' NE 'PGM').BR1  CHECK FOR PGM               29300000
&BPGO    SETB  1                        SET BRANCH=(YES,PGM) SWITCH     29350000
         AGO   .CKERR                                                   29400000
.BR1     ANOP                                                           29450000
         AIF   ('&BRANCH(2)' NE 'SUP').ER9  BAD 2ND OPERAND             29500000
&BPGN    SETB  0                        SET BRANCH=(YES,SUP) SWITCH     29550000
         AGO   .CKERR                                                   29600000
.ER9     ANOP                           BRANCH= **** ERROR ****         29650000
         SPACE 1                                                        29700000
         MNOTE 12,'***  IHB001 INVALID OPERAND - BRANCH=&BRANCH'        29750000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       29800000
.*                                                                      29850000
.* ******************************************************************** 29900000
.* *     CHECK ERRORS: IF ANY PRESENT, SET A 'LABEL DS 0F' AND GET OUT  29950000
.* ******************************************************************** 30000000
.*                                                                      30050000
.CKERR   ANOP                                                           30100000
         AIF   ('&ERRSW' EQ '0').EXEC                                   30150000
&LABEL   DS    0F                                                       30200000
         AGO   .FINISH                                                  30250000
.*                                                                      30300000
.* ******************************************************************** 30350000
.* *     ALL PARAMETERS ARE GOOD - BUILD LIST OF DEFINED CONSTANTS.     30400000
.* ******************************************************************** 30450000
.*                                                                      30500000
.EXEC    ANOP                                                           30550000
&FLAG1   SETC  '0&BIOO&BPGO.0&BIRO.000'                                 30600000
&FLAG2   SETC  '00000&BDOO.00'                                          30650000
&L       SETC  '&LABEL'                                                 30700000
         AIF   ('&L' NE '').TSTI                                        30750000
&L       SETC  'ICV&NO.S'                                               30800000
.TSTI    ANOP                                                           30850000
         AIF   ('&FM' EQ 'I').STNDRD                                    30900000
         AIF   ('&FM' EQ 'L').LIST                                      30950000
.*                                                                      31000000
.* ******************************************************************** 31050000
.* *     BEGIN BUILD FOR EXECUTE FORM OF MACRO                          31100000
.* ******************************************************************** 31150000
.*                                                                      31200000
         AIF   ('&LABEL' EQ '').OVER   SKIP OVER LABEL                  31250000
&L       EQU   *                                                        31300000
.OVER    ANOP                                                           31350000
         IHBINNRA &MF(2)                PARM LIST INTO REG 1            31400000
         AIF   ('&ACCESS' EQ '').E2     NO ACCESS=, SKIP                31450000
         MVI   6(1),X'&FUNCT'           SET FUNCTION CODE               31500000
         AGO   .E2                      GO TO COMMON ROUTINE            31550000
.*                                                                      31600000
.* ******************************************************************** 31650000
.* *     BEGIN BUILD FOR LIST FORM OF MACRO                             31700000
.* ******************************************************************** 31750000
.*                                                                      31800000
.LIST    ANOP                                                           31850000
         CNOP  0,4                                                      31900000
&L       EQU   *                                                        31950000
         AGO   .COMMON                  GO TO COMMON ROUTINE            32000000
.*                                                                      32050000
.* ******************************************************************** 32100000
.* *     BEGIN BUILD FOR STANDARD FORM OF MACRO                         32150000
.* ******************************************************************** 32200000
.*                                                                      32250000
.STNDRD  ANOP                                                           32300000
         CNOP  0,4                                                      32350000
&LABEL   BAL   1,ICV&NO.E               LOAD CVPL LIST ADDRESS          32400000
&L       SETC  'ICV&NO.S'               SET START OF CVPL               32450000
&L       EQU   *                        START OF CVPL                   32500000
.*                                                                      32550000
.* ******************************************************************** 32600000
.* *     COMMON BUILD CODE FOR MF=I AND L FORMS                         32650000
.* ******************************************************************** 32700000
.*                                                                      32750000
.COMMON  ANOP                                                           32800000
         DC    CL4'CVPL'                EBCDIC 'CVPL'                   32850000
         DC    AL2(ICV&NO.E-&L)         LENGTH OF CVPL                  32900000
         DC    XL1'&FUNCT'              FUNCTION CODE                   32950000
         DC    XL1'00'                  STATUS INFORMATION              33000000
         DC    B'&FLAG1'                FIRST FLAG BYTE                 33050000
         DC    B'&FLAG2'                SECOND FLAG BYTE                33100000
         DC    H'0'                     RESERVED                        33150000
.*                                                                      33200000
.* ******************************************************************** 33250000
.* *     UCB PROCESSING                                                 33300000
.* ******************************************************************** 33350000
.*                                                                      33400000
         AIF   ('&SWUCB' EQ '0').U3     NO UCB PRESENT, SKIP            33450000
         AIF   ('&UCBNCOR' EQ '0').U3   UCB IN REG, SKIP                33500000
         DC    A(&UCB)                  UCB ADDRESS                     33550000
         AGO   .D3                      GO ON TO DSN                    33600000
.U3      ANOP                                                           33650000
         DC    A(0)                     UCB ADDRESS                     33700000
.*                                                                      33750000
.* ******************************************************************** 33800000
.* *     DSN PROCESSING                                                 33850000
.* ******************************************************************** 33900000
.*                                                                      33950000
.D3      ANOP                                                           34000000
         AIF   ('&SWDSN' EQ '0').D4     NO DSN PRESENT, SKIP            34050000
         AIF   ('&DSNNCOR' EQ '0').D4   DSN IN REG, SKIP                34100000
         DC    A(&DSN)                  DATA SET NAME ADDRESS           34150000
         AGO   .B2                      GO ON TO BUFLIST                34200000
.D4      ANOP                                                           34250000
         DC    A(0)                     DATA SET NAME ADDRESS           34300000
.*                                                                      34350000
.* ******************************************************************** 34400000
.* *     BUFLIST PROCESSING                                             34450000
.* ******************************************************************** 34500000
.*                                                                      34550000
.B2      ANOP                                                           34600000
         AIF   ('&SWBUF' EQ '0').B3     NO BUFLIST PRESENT, SKIP        34650000
         AIF   ('&BUFNCOR' EQ '0').B3   BUFLIST IN REG, SKIP            34700000
         DC    A(&BUFLIST)              BUFFER LIST ADDRESS             34750000
         AGO   .I3                      GO ON TO IXRCDS                 34800000
.B3      ANOP                                                           34850000
         DC    A(0)                     BUFFER LIST ADDRESS             34900000
.*                                                                      34950000
.* ******************************************************************** 35000000
.* *     IXRCDS PROCESSING                                              35050000
.* ******************************************************************** 35100000
.*                                                                      35150000
.I3      ANOP                                                           35200000
         AIF   ('&SWIXR' EQ '0').I5     NO IXRCDS PRESENT, SKIP         35250000
         AIF   ('&IXRNCOR' EQ '0').I5   IXRCDS IN REG, SKIP             35300000
         DC    A(&IXRCDS(2))            INDEX VIR'S BUFFER LIST ADDRESS 35350000
         AGO   .M2                      GO ON TO MAPRCDS                35400000
.I5      ANOP                                                           35450000
         DC    A(0)                     INDEX VIR'S BUFFER LIST ADDRESS 35500000
.M2      ANOP                                                           35550000
         DC    A(0)                     MAP VIR'S BUFFER LIST ADDRESS   35600000
.*                                                                      35650000
.* ******************************************************************** 35700000
.* *     IOAREA PROCESSING                                              35750000
.* ******************************************************************** 35800000
.*                                                                      35850000
         AIF   ('&SWIOA' EQ '0').O3     NO IOAREA PRESENT, SKIP         35900000
         AIF   ('&IOANCOR' EQ '0').O3   IOAREA IN REG, SKIP             35950000
         DC    A(&IOAREA(2))            I/O AREA ADDRESS                36000000
         AGO   .DEB2                    GO ON TO DEB                    36050000
.O3      ANOP                                                           36100000
         DC    A(0)                     I/O AREA ADDRESS                36150000
.DEB2    ANOP                                                           36200000
.*                                                                      36250000
.* ******************************************************************** 36300000
.* *     DEB PROCESSING                                                 36350000
.* ******************************************************************** 36400000
.*                                                                      36450000
         AIF   ('&SWDEB' EQ '0').DEB3   NO DEB PRESENT, SKIP            36500000
         AIF   ('&DEBNCOR' EQ '0').DEB3 DEB IN REG, SKIP                36550000
         DC    A(&DEB)                  DEB ADDRESS                     36600000
         AGO   .ARG2                    GO ON TO ARG                    36650000
.DEB3    ANOP                                                           36700000
         DC    A(0)                     DEB ADDRESS                     36750000
.*                                                                      36800000
.* ******************************************************************** 36850000
.* *     ARGUMENT PROCESSING                                            36900000
.* ******************************************************************** 36950000
.*                                                                      37000000
.ARG2    ANOP                                                           37050000
         AIF   ('&SWARG' EQ '0').ARG3   NO ARG PRESENT, SKIP            37100000
         AIF   ('&ARGNCOR' EQ '0').ARG3 ARG IN REG, SKIP                37150000
         DC    A(&ARG)                  ARGUMENT ADDRESS                37200000
         AGO   .NDC                     GO ON TO NEXT DC                37250000
.ARG3    ANOP                                                           37300000
         DC    A(0)                     ARGUMENT ADDRESS                37350000
.NDC     ANOP                                                           37400000
         DC    A(0)                     SPACE PARAMETER LIST ADDRESS    37450000
         DC    A(0)                     EXTENT TABLE ADDRESS            37500000
         DC    A(0)                     NEW VRF VIXM BUFFER LIST ADDR   37550000
         DC    A(0)                     VRF DATA ADDRESS                37600000
         DC    A(0)                     COUNT AREA ADDRESS              37650000
ICV&NO.E EQU   *                        END OF CVPL                     37700000
         AIF   ('&FM' EQ 'L').FINISH    LIST FORM IS DONE               37750000
.*                                                                      37800000
.* ******************************************************************** 37850000
.* *     COMMON BUILD CODE FOR MF=I AND (E,ADDR) FORMS                  37900000
.* ******************************************************************** 37950000
.*                                                                      38000000
.E2      ANOP                                                           38050000
         AIF   ('&FM' EQ 'I').UCB1                                      38100000
&FLAG1N  SETC  '1&BION&BPGN.1&BIRN.111'                                 38150000
         AIF   ('&FLAG1N' EQ '11111111').OF1                            38200000
         NI    8(1),B'&FLAG1N'          RESET CVAF FLAGS OFF            38250000
.OF1     ANOP                                                           38300000
         AIF   ('&FLAG1' EQ '00000000').NF2                             38350000
         OI    8(1),B'&FLAG1'           SET CVAF FLAGS ON               38400000
.NF2     ANOP                                                           38450000
         AIF   ('&BDON' EQ '1').OF2                                     38500000
&FLAG2N  SETC  '11111&BDON.11'                                          38550000
         NI    9(1),B'&FLAG2N'          RESET CVAF FLAGS OFF            38600000
.OF2     ANOP                                                           38650000
         AIF   ('&BDOO' EQ '0').UCB1                                    38700000
         OI    9(1),B'&FLAG2'           SET CVAF FLAGS ON               38750000
.*                                                                      38800000
.* ******************************************************************** 38850000
.* *     UCB PROCESSING                                                 38900000
.* ******************************************************************** 38950000
.*                                                                      39000000
.UCB1    ANOP                                                           39050000
         AIF   ('&SWUCB' EQ '0').DSN1   NO UCB TO PROCESS               39100000
         AIF   ('&UCBNCOR' EQ '1').UNC  UCB IN CORE, SKIP               39150000
         ST    &UCBNREG,12(,1)          STORE UCB PTR IN PARM LIST      39200000
         AGO   .DSN1                                                    39250000
.UNC     ANOP                                                           39300000
         AIF   ('&FM' EQ 'I').DSN1      MF=I, ALREADY THERE, SKIP       39350000
         LA    15,&UCB                  GET UCB ADDRESS AND             39400000
         ST    15,12(,1)                STORE UCB PTR IN PARM LIST      39450000
.*                                                                      39500000
.* ******************************************************************** 39550000
.* *     DSN PROCESSING                                                 39600000
.* ******************************************************************** 39650000
.*                                                                      39700000
.DSN1    ANOP                                                           39750000
         AIF   ('&SWDSN' EQ '0').BL1    NO DSN TO PROCESS               39800000
         AIF   ('&DSNNCOR' EQ '1').DNC  DSN IN CORE, SKIP               39850000
         ST    &DSNNREG,16(,1)          STORE DSN PTR IN PARM LIST      39900000
         AGO   .BL1                                                     39950000
.DNC     ANOP                                                           40000000
         AIF   ('&FM' EQ 'I').BL1       MF=I, ALREADY THERE, SKIP       40050000
         LA    15,&DSN                  GET DSN ADDRESS AND             40100000
         ST    15,16(,1)                STORE DSN PTR IN PARM LIST      40150000
.*                                                                      40200000
.* ******************************************************************** 40250000
.* *     BUFLIST PROCESSING                                             40300000
.* ******************************************************************** 40350000
.*                                                                      40400000
.BL1     ANOP                                                           40450000
         AIF   ('&SWBUF' EQ '0').IXR1   NO BUFLIST TO PROCESS           40500000
         AIF   ('&BUFNCOR' EQ '1').BNC  BUFLIST IN CORE, SKIP           40550000
         ST    &BUFNREG,20(,1)          STORE BUFLIST PTR IN PARM LIST  40600000
         AGO   .IXR1                                                    40650000
.BNC     ANOP                                                           40700000
         AIF   ('&FM' EQ 'I').IXR1      MF=I, ALREADY THERE, SKIP       40750000
         LA    15,&BUFLIST              GET BUFLIST ADDRESS AND         40800000
         ST    15,20(,1)                STORE BUFLIST PTR IN PARM LIST  40850000
.*                                                                      40900000
.* ******************************************************************** 40950000
.* *     IXRCDS PROCESSING                                              41000000
.* ******************************************************************** 41050000
.*                                                                      41100000
.IXR1    ANOP                                                           41150000
         AIF   ('&SWIXR' EQ '0').IOA1   NO IXRCDS TO PROCESS            41200000
         AIF   ('&IXRNCOR' EQ '1').INC  IXRCDS IN CORE, SKIP            41250000
         ST    &IXRNREG,24(,1)          STORE IXRCDS PTR IN PARM LIST   41300000
         AGO   .IOA1                                                    41350000
.INC     ANOP                                                           41400000
         AIF   ('&FM' EQ 'I').IOA1      MF=I, ALREADY THERE, SKIP       41450000
         LA    15,&IXRCDS(2)            GET IXRCDS ADDRESS AND          41500000
         ST    15,24(,1)                STORE ADDRESS IN PARM LIST      41550000
.*                                                                      41600000
.* ******************************************************************** 41650000
.* *     IOAREA PROCESSING                                              41700000
.* ******************************************************************** 41750000
.*                                                                      41800000
.IOA1    ANOP                                                           41850000
         AIF   ('&SWIOA' EQ '0').DEB1   NO IOAREA TO PROCESS            41900000
         AIF   ('&IOANCOR' EQ '1').ONC  IOAREA IN CORE, SKIP            41950000
         ST    &IOANREG,32(,1)          STORE IOAREA PTR IN PARM LIST   42000000
         AGO   .DEB1                                                    42050000
.ONC     ANOP                                                           42100000
         AIF   ('&FM' EQ 'I').DEB1      MF=I, ALREADY THERE, SKIP       42150000
         LA    15,&IOAREA(2)            GET IOAREA ADDRESS AND          42200000
         ST    15,32(,1)                STORE ADDRESS IN PARM LIST      42250000
.*                                                                      42300000
.* ******************************************************************** 42350000
.* *     DEB PROCESSING                                                 42400000
.* ******************************************************************** 42450000
.*                                                                      42500000
.DEB1    ANOP                                                           42550000
         AIF   ('&SWDEB' EQ '0').ARG1   NO DEB TO PROCESS               42600000
         AIF   ('&DEBNCOR' EQ '1').ENC  DEB IN CORE, SKIP               42650000
         ST    &DEBNREG,36(,1)          STORE DEB PTR IN PARM LIST      42700000
         AGO   .ARG1                                                    42750000
.ENC     ANOP                                                           42800000
         AIF   ('&FM' EQ 'I').ARG1      MF=I, ALREADY THERE, SKIP       42850000
         LA    15,&DEB                  GET DEB ADDRESS AND             42900000
         ST    15,36(,1)                STORE ADDRESS IN PARM LIST      42950000
.*                                                                      43000000
.* ******************************************************************** 43050000
.* *     ARGUMENT PROCESSING                                            43100000
.* ******************************************************************** 43150000
.*                                                                      43200000
.ARG1    ANOP                                                           43250000
         AIF   ('&SWARG' EQ '0').BRANCH NO ARGUMENT TO PROCESS          43300000
         AIF   ('&ARGNCOR' EQ '1').ANC  ARGUMENT IN CORE, SKIP          43350000
         ST    &ARGNREG,40(,1)          STORE ARGUMENT PTR IN PARM LIST 43400000
         AGO   .BRANCH                                                  43450000
.ANC     ANOP                                                           43500000
         AIF   ('&FM' EQ 'I').BRANCH    MF=I, ALREADY THERE, SKIP       43550000
         LA    15,&ARG                  GET ARGUMENT ADDRESS AND        43600000
         ST    15,40(,1)                STORE ADDRESS IN PARM LIST      43650000
.*                                                                      43700000
.* ******************************************************************** 43750000
.* *     BRANCH PROCESSING -                                            43800000
.* *     LOAD THE CVT, THE VS1/VS2 COMMON EXTENTION 2 POINTER,          43850000
.* *     THE CVTCVAF PTR, THE CVAF POINTER AND BRANCH TO CVAF           43870000
.* *     COMMON ICVCMM00                                                43890000
.* ******************************************************************** 43950000
.*                                                                      44000000
.BRANCH  ANOP                                                           44050000
         AIF   ('&BRANCH' EQ '' OR '&BRANCH(1)' EQ 'NO').SVC139         44100000
         L     15,16                    LOAD THE CVT                    44150000
         L     15,328(,15)              LOAD VS1/VS2 COMMON EXTENTION2  44170000
         L     15,12(,15)               LOAD THE CVAF TABLE ADDRESS     44190000
         CLI   14(15),X'81'             WHAT SYSTEM?               @L1A 44204500
         BNL   ICV&NO.B                 BRANCH IF X/A              @L1A 44219000
         L     15,0(,15)                LOAD THE CVAF ADDRESS      @L1A 44233500
         BALR  14,15                    BRANCH AND LINK TO         @L1A 44248000
*                                       GLUE MODULE ICVCMM01       @L1A 44262500
         B     ICV&NO.C                                            @L1A 44277000
ICV&NO.B EQU   *                        MUST SET MODE (BASSM)      @L1A 44291500
         L     15,28(,15)               LOAD THE CVAF ADDRESS      @L1A 44306000
         DC    X'0CEF'                  BR, SAVE & SET MODE TO     @L1A 44320500
*                                       MODULE ICVCMM00            @L1A 44335000
ICV&NO.C DS    0H                                                  @L1A 44342500
         AGO   .FINISH                                                  44350000
.* ******************************************************************** 44400000
.* *     SVC139 PROCESSING                                              44450000
.* ******************************************************************** 44500000
.*                                                                      44550000
.SVC139  ANOP                                                           44600000
         SVC   139                                                      44650000
.FINISH  ANOP                                                           44700000
         MEND                                                           44750000
