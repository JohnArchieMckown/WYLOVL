         MACRO                                                          00050000
&LABEL   CVAFDSM &ACCESS=,&ARG=,&BRANCH=,&COUNT=,&CTAREA=,&DEB=,&DSN=, C00100000
               &EXTENTS=,&HIVIER=,&IOAREA=,&IXRCDS=,&MAP=,&MAPRCDS=,   C00150000
               &MF=I,&RECOVER=,&SEARCH=,&SPACE=,&UCB=,&RTA4BYTE=        00200000
.**** START OF SPECIFICATIONS ****************************************  00250000
.*                                                                      00300000
.*$MAC(CVAFDSM) COMP(DM1CV) PROD(DMS-XZ): CVAF-DATA MANAGEMENT          00350000
.*                                                                      00400000
.* DESCRIPTIVE-NAME = CVAF - DATA MANAGEMENT ACCESS TO THE VTOC         00450000
.*                     AND VTOC INDEX                                   00500000
.*                                                                      00550000
.*PROPRIETARY V3 STATEMENT                                              00564200
.*LICENSED MATERIALS - PROPERTY OF IBM                                  00578400
.*"RESTRICTED MATERIALS OF IBM"                                         00592600
.*5695-DF1                                                              00606800
.*(C) COPYRIGHT 1980,1993  IBM CORP.                                    00621000
.*END PROPRIETARY V3 STATEMENT                                          00635200
.*                                                                      00650000
.* STATUS = DFSMS/MVS 1.1.0                                        @L2A 00700000
.*                                                                      00750000
.* FUNCTION = THIS MACRO WILL SET UP THE CVAF PARAMETER LIST TO ALLOW   00800000
.*     THE CALLER TO PERFORM THE FOLLOWING FUNCTIONS ON AN INDEXED      00833300
.*     VTOC VOLUME:                                                @L2C 00866600
.*      1. ADD A DATA SET NAME AND CCHHR INTO THE INDEX.                00900000
.*      2. DELETE A DATA SET NAME AND CCHHR FROM THE INDEX.             00950000
.*      3. ALLOCATE AND RELEASE VOLUME SPACE USING THE VPSM.            01000000
.*      4. ALLOCATE AND RELEASE VTOC INDEX SPACE USING THE VIXM.        01050000
.*      5. ALLOCATE AND RELEASE A DSCB USING THE VMDS.                  01100000
.*      6. OBTAIN VOLUME FREE SPACE INFORMATION FROM THE VPSM IN        01150000
.*         F5 DSCB EXTENT FORMAT (XXYYZ) OR 4-BYTE RTA, RTA+1'S         01183300
.*         FORMAT.                                                 @L2A 01216600
.*      7. COUNT THE NUMBER OF UNALLOCATED DSCBS IN THE VTOC            01250000
.*         USING THE VMDS.                                              01300000
.*      8. COUNT THE NUMBER OF UNALLOCATED VTOC INDEX RECORDS           01350000
.*         USING THE VIXM.                                              01400000
.*                                                                      01402900
.*     In addition, for OS VTOC volumes, it allows the caller to obtain 01405800
.*     volume free space information in F5 DSCB extent format (XXYYZ)   01408700
.*     or 4-BYTE RTA, RTA+1's extent format.  CVAFDSM ACCESS=MAPDATA    01411600
.*     MAP=VOLUME EXTENTS=addr with other parameters should be coded    01414500
.*     for this service.                                           @L2A 01417400
.*                                                                      01420300
.*     For ACCESS=MAPDATA and MAP=VOLUME, if the extent table is in     01423200
.*     XXYYZ format and the output extents are beyond the 2-byte        01426100
.*     capacity, only those free extents within the 64*1024 tracks      01429000
.*     boundary are returned in the table.                         @L2A 01431900
.*                                                                      01434800
.*     For ACCESS=ALLOC and MAP=VOLUME, if the output extents are       01437700
.*     beyond the 2-byte capacity, only those extents within the        01440600
.*     64*1024 tracks boundary are returned in the table.          @L2A 01443500
.*                                                                      01446400
.*                                                                      01450000
.*   KEYWORDS =                                                         01500000
.*                                                                      01550000
.*     THE 'MF' KEYWORD DETERMINES WHETHER THE CVAF PARAMETER LIST      01600000
.*     IS EXPANDED AND/OR EXECUTABLE INSTRUCTIONS ARE GENERATED TO      01650000
.*     INVOKE CVAF.                                                     01700000
.*                                                                      01750000
.*     THE SPECIFICATION OF MF=(E,ADDR), WILL RESULT IN THE             01800000
.*     MODIFICATION OF AN EXISTING CVAF PARAMETER LIST.  THE            01850000
.*     ADDRESS OF THE PARAMETER LIST IS PROVIDED VIA A SECOND           01900000
.*     SUBPARAMETER OF THE 'MF' KEYWORD.  IT ALSO GENERATES CODE        01950000
.*     NECESSARY TO EITHER BRANCH TO CVAF OR ISSUE SVC 139 TO INVOKE    02000000
.*     CVAF TO PERFORM THE REQUESTED FUNCTIONS.  THIS IS CALLED THE     02050000
.*     EXECUTE-FORM OF THE MACRO.                                       02100000
.*                                                                      02150000
.*     WITH A SPECIFICATION OF MF=I, OR NOT SPECIFYING THE 'MF'         02200000
.*     KEYWORD AT ALL, THIS MACRO WILL EXPAND THE CVAF PARAMETER        02250000
.*     LIST AND INITIALIZE IT ACCORDING TO THE OPTIONS SELECTED         02300000
.*     VIA THE ALLOWABLE KEYWORDS.  IT ALSO GENERATES CODE              02350000
.*     NECESSARY TO EITHER BRANCH TO CVAF OR ISSUE SVC 139 TO           02400000
.*     INVOKE CVAF TO PERFORM THE REQUESTED FUNCTIONS.  THIS IS         02450000
.*     CALLED THE INSTRUCTION-FORM (NORMAL-FORM) OF THE MACRO.          02500000
.*                                                                      02550000
.*     THE SPECIFICATION OF MF=L WILL RESULT IN THE EXPANSION OF THE    02600000
.*     PARAMETER LIST AND INITIALIZE IT ACCORDING TO THE SPECIFIED      02650000
.*     KEYWORDS. HOWEVER IT DOES NOT GENERATE THE CODE TO INVOKE        02700000
.*     CVAF.  THIS IS CALLED THE LIST-FORM OF THE MACRO.                02750000
.*                                                                      02800000
.*     KEYWORDS APPLICABLE TO THE CVAFDSM MACRO ARE:                    02850000
.*                                                                      02900000
.*       ACCESS  - WILL SET THE CVFCTN FIELD OF THE CVPL TO:            02920000
.*                 X'06' FOR IXADD,                                     02940000
.*                 X'07' FOR IXDLT,                                     02960000
.*                 X'08' FOR ALLOC,                                     02980000
.*                 X'09' FOR RLSE,                                      03000000
.*                 X'AA' FOR MAPDATA and RTA4BYTE=YES,             @01C 03020000
.*                 X'0A' FOR MAPDATA AND RTA4BYTE=NO, or           @01C 03040000
.*                                       RTA4BYTE not specified    @01C 03060000
.*                                                                      03080000
.*                 THIS KEYWORD IS REQUIRED FOR MF=I FORM AND IS        03100000
.*                 OPTIONAL FOR THE MF=(E,ADDR) OR MF=L FORM.           03150000
.*                                                                      03200000
.*                 VALID ENTRIES:  ACCESS=IXADD                         03250000
.*                                 ACCESS=IXDLT                         03300000
.*                                 ACCESS=ALLOC                         03350000
.*                                 ACCESS=RLSE                          03400000
.*                                 ACCESS=MAPDATA                       03450000
.*                                                                      03500000
.*       ARG     - WILL SET THE ADDRESS OF A FIVE BYTE ARGUMENT,        03550000
.*                 SPECIFIED BY THE 'ADDR', INTO THE FIELD: CVARG.      03600000
.*                                                                      03650000
.*                 THIS KEYWORD IS REQUIRED FOR MF=I FORM WHEN ACCESS=  03700000
.*                 IXADD IS CODED.  THIS KEYWORD IS OPTIONAL FOR        03750000
.*                 FOR ACCESS=ALLOC, RLSE, OR IXDLT AND INVALID FOR     03783300
.*                 MAPDATA.                                             03816600
.*                                                                      03850000
.*       BRANCH  - WILL SET THE FLAG, CV1PGM, TO 1 IF (YES,PGM)         03900000
.*                 IS CODED OR RESET IT TO 0 IF (YES,SUP) IS CODED.     03950000
.*                 IF BRANCH=YES OR NO IS CODED, OR IN THE ABSENCE      04000000
.*                 OF THIS KEYWORD, THE FLAG, CV1PGM, WILL NOT BE       04050000
.*                 CHANGED FOR THE MF=(E,ADDR) FORM.                    04100000
.*                                                                      04150000
.*                 FOR MF=I OR MF=(E,ADDR) AND BRANCH=NO IS             04200000
.*                 CODED, OR OMITTED, CODE WILL BE GENERATED TO         04250000
.*                 INVOKE CVAF VIA SVC 139.                             04300000
.*                                                                      04350000
.*                 FOR MF=I OR MF=(E,ADDR) AND YES IS CODED, THE        04400000
.*                 CODE IS GENERATED TO INVOKE CVAF VIA A BRANCH,  @L1A 04425000
.*                 OR VIA A BASSM IF THE RESIDENT SYSTEM IS X/A    @L1A 04450000
.*                 2.1.0 OR LATER.                                 @L1A 04475000
.*                                                                      04500000
.*                 FOR MF=L, ONLY THE FLAG WILL BE INITIALIZED          04550000
.*                 AND NO EXECUTABLE CODED WILL BE GENERATED.           04600000
.*                                                                      04650000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE           04700000
.*                 AN MNOTE, SINCE NO IS THE DEFAULT FOR ALL            04750000
.*                 FORMS OF THIS MACRO.                                 04800000
.*                                                                      04850000
.*                 VALID ENTRIES:  BRANCH=NO        DEFAULT FOR MF=I    04900000
.*                                 BRANCH=YES       (DEFAULT FOR YES    04950000
.*                                 BRANCH=(YES,SUP)  IS (YES,SUP))      05000000
.*                                 BRANCH=(YES,PGM)                     05050000
.*                                                                      05100000
.*       COUNT   - WILL SET THE FLAG, CV2CNT, TO 1 IF YES IS CODED      05150000
.*                 AND RESET TO 0 IF NO IS CODED.                       05200000
.*                                                                      05250000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN MNOTE, 05300000
.*                 SINCE NO IS THE DEFAULT FOR MF=L AND MF=I.           05350000
.*                 THE FLAG WILL NOT BE CHANGED IN THE ABSENCE OF THE   05400000
.*                 COUNT KEYWORD FOR MF=(E,ADDR) FORM.                  05450000
.*                                                                      05500000
.*                 AN MNOTE WILL BE ISSUED IF THIS KEYWORD IS CODED     05550000
.*                 AND ACCESS=MAPDATA IS NOT CODED FOR ALL MACRO-FORMS. 05600000
.*                                                                      05650000
.*                 AN MNOTE WILL BE ISSUED IF YES IS CODED AND          05700000
.*                 MAP=VOLUME IS CODED FOR ALL MACRO-FORMS.             05750000
.*                                                                      05800000
.*                 AN MNOTE WILL BE ISSUED IF NO IS CODED AND EITHER    05850000
.*                 MAP=VTOC OR INDEX IS CODED FOR ALL MACRO-FORMS.      05900000
.*                                                                      05950000
.*                 VALID ENTRIES:  COUNT=NO         DEFAULT FOR MF=I    06000000
.*                                 COUNT=YES                            06050000
.*                                                                      06100000
.*       CTAREA  - WILL SET THE ADDRESS OF A FOUR BYTE COUNT FIELD,     06150000
.*                 SPECIFIED BY THE 'ADDR', INTO THE FIELD: CVCTAR.     06200000
.*                 THIS KEYWORD IS OPTIONAL ONLY WHEN ACCESS=MAPDATA    06250000
.*                 AND AN MNOTE WILL BE ISSUED FOR ANY OTHER ACCESS.    06300000
.*                 AN MNOTE WILL BE ISSUED IF COUNT=NO IS CODED OR      06350000
.*                 OMITTED AND THIS KEYWORD IS SPECIFIED.               06400000
.*                                                                      06450000
.*       DEB     - WILL SET THE ADDRESS OF A DEB, SPECIFIED BY THE      06457100
.*                 'ADDR', INTO THE FIELD: CVDEB.  THIS KEYWORD         06464200
.*                 IS MUTUALLY EXCLUSIVE WITH UCB.  EITHER DEB OR       06471300
.*                 UCB IS REQUIRED UNLESS IOAREA=(,ADDR) IS             06478400
.*                 SPECIFIED FOR THE MF=I FORM OF THIS MACRO.           06485500
.*                                                                      06492600
.*       DSN     - WILL SET THE ADDRESS OF THE DATA SET NAME OF THE     06500000
.*                 DSCB, SPECIFIED BY THE 'ADDR', INTO THE FIELD:       06550000
.*                 CVDSN.                                               06600000
.*                                                                      06650000
.*                 THIS KEYWORD IS REQUIRED WHEN ACCESS=IXADD OR        06700000
.*                 IXDLT IS CODED FOR MF=I FORM OF THE MACRO.           06750000
.*                 AN MNOTE WILL BE ISSUED IF ACCESS=ALLOC, RLSE, OR    06800000
.*                 MAPDATA IS CODED AND THIS KEYWORD IS SPECIFIED.      06850000
.*                                                                      06900000
.*       EXTENTS - WILL SET THE ADDRESS OF THE EXTENT TABLE, SPECIFIED  06950000
.*                 BY THE 'ADDR', INTO THE FIELD: CVEXTS.               07000000
.*                                                                      07050000
.*                 THIS KEYWORD IS REQUIRED WHEN MAP=VOLUME,ACCESS=     07100000
.*                 ALLOC, RLSE, OR MAPDATA IS CODED FOR THE MF=I FORM   07150000
.*                 OF THE MACRO.                                        07200000
.*                                                                      07250000
.*       HIVIER  - WILL SET THE FLAG, CV2HIVIX, TO 1 IF YES IS CODED    07300000
.*                 AND RESET TO 0 IF NO IS CODED.                       07350000
.*                                                                      07400000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN MNOTE, 07450000
.*                 SINCE NO IS THE DEFAULT FOR MF=L AND MF=I.           07500000
.*                 THE FLAG WILL NOT BE CHANGED IN THE ABSENCE OF THE   07550000
.*                 HIVIER KEYWORD FOR MF=(E,ADDR) FORM.                 07600000
.*                                                                      07650000
.*                 THIS KEYWORD IS OPTIONAL FOR ACCESS=ALLOC,MAP=INDEX  07700000
.*                 ONLY AND AN MNOTE WILL BE ISSUED FOR ANY OTHER       07750000
.*                 COMBINATION.                                         07800000
.*                                                                      07850000
.*                 VALID ENTRIES:  HIVIER=NO        DEFAULT FOR MF=I    07900000
.*                                 HIVIER=YES                           07950000
.*                                                                      08000000
.*       IOAREA  - WILL SET THE ADDRESS OF THE I/O AREA, SPECIFIED      08050000
.*                 BY THE 'ADDR', INTO THE FIELD: CVIOAR.   ALSO,       08100000
.*                 THE FLAG, CV1IOAR, WILL BE SET TO 1 IF KEEP IS       08150000
.*                 CODED AND RESET TO 0 IF NOKEEP IS CODED.             08200000
.*                                                                      08250000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN MNOTE, 08300000
.*                 SINCE NOKEEP IS THE DEFAULT FOR MF=L AND MF=I.       08350000
.*                 THE FLAG WILL NOT BE CHANGED IN THE ABSENCE OF THE   08400000
.*                 IOAREA KEYWORD FOR MF=(E,ADDR) FORM.                 08450000
.*                                                                      08500000
.*                 VALID ENTRIES:  IOAREA=NOKEEP    DEFAULT FOR MF=I    08550000
.*                                 IOAREA=(NOKEEP,ADDR)                 08600000
.*                                 IOAREA=KEEP                          08650000
.*                                 IOAREA=(KEEP,ADDR)                   08700000
.*                                                                      08750000
.*       IXRCDS  - WILL SET THE ADDRESS OF THE VIERS BUFFER LIST,       08800000
.*                 SPECIFIED BY THE 'ADDR', INTO THE FIELD: CVIRCDS.    08850000
.*                 ALSO, THE FLAG, CV1IRCDS, WILL BE SET TO 1 IF KEEP   08900000
.*                 IS CODED.  IF NOKEEP IS CODED, AN MNOTE WILL BE      08950000
.*                 ISSUED.                                              09000000
.*                                                                      09050000
.*                 THIS KEYWORD IS OPTIONAL FOR MF=I FORM WHEN ACCESS=  09100000
.*                 IXADD OR IXDLT IS CODED.  THIS KEYWORD IS INVALID    09150000
.*                 FOR ACCESS=ALLOC, RLSE AND MAPDATA.                  09200000
.*                                                                      09250000
.*                 VALID ENTRIES:  IXRCDS=KEEP      DEFAULT FOR MF=I    09300000
.*                                 IXRCDS=(KEEP,ADDR)                   09350000
.*                                                                      09400000
.*       MAP     - WILL SET ONE OF THE FOLLOWING FLAGS TO 1:            09450000
.*                 CVMAPIX FOR MAP=INDEX                                09500000
.*                 CVMAPVL FOR MAP=VOLUME                               09550000
.*                 CVMAPVT FOR MAP=VTOC                                 09600000
.*                 AND RESET THE OTHER TWO FLAGS TO 0 FOR THE           09650000
.*                 MF=(E,ADDR) FORM OF THE MACRO.                       09700000
.*                                                                      09750000
.*                 THIS KEYWORD IS OPTIONAL FOR THE MF=L OR (E,ADDR)    09800000
.*                 FORM OF THE MACRO AND REQUIRED FOR THE MF=I FORM     09850000
.*                 WHEN ACCESS=ALLOC, RLSE, OR MAPDATA IS CODED.  THIS  09900000
.*                 KEYWORD IS INVALID FOR ACCESS=IXADD OR IXDLT.        09950000
.*                                                                      10000000
.*                 VALID ENTRIES:  MAP=INDEX                            10050000
.*                                 MAP=VOLUME                           10100000
.*                                 MAP=VTOC                             10150000
.*                                                                      10200000
.*       MAPRCDS - WILL SET THE ADDRESS OF THE MAP RECORDS BUFFER LIST, 10250000
.*                 SPECIFIED BY THE 'ADDR', INTO THE FIELD: CVMRCDS.    10300000
.*                 ALSO, THE FLAG, CV1MRCDS, WILL BE SET TO 1 IF YES    10350000
.*                 IS CODED.                                            10400000
.*                                                                      10450000
.*                 THIS KEYWORD IS OPTIONAL FOR ALL ACCESS KEYWORD      10500000
.*                 OPERANDS FOR ALL FORMS OF THE MACRO.                 10550000
.*                 MAPRCDS=NO AND (NO,ADDR) ARE VALID ONLY FOR ACCESS=  10600000
.*                 MAPDATA.                                             10650000
.*                                                                      10700000
.*                 VALID ENTRIES:  MAPRCDS=YES      DEFAULT FOR MF=I    10750000
.*                                 MAPRCDS=(YES,ADDR)                   10800000
.*                 (VALID FOR      MAPRCDS=NO                           10850000
.*                  MAPDATA ONLY)  MAPRCDS=(NO,ADDR)                    10900000
.*                                                                      10950000
.*       MF      - SEE THE OPENING PARAGRAPHS ABOVE.  IF THE MF KEYWORD 11000000
.*                 IS NOT SPECIFIED, THE DEFAULT, MF=I, WILL BE IN      11050000
.*                 EFFECT.                                              11100000
.*                                                                      11150000
.*                 FOR THE INSTRUCTION-FORM (MF=I), THE                 11200000
.*                 FOLLOWING VALIDITY CHECKS WILL BE MADE:              11250000
.*                   1. ACCESS IS REQUIRED.                             11300000
.*                   2. ARG IS REQUIRED FOR ACCESS=IXADD.               11350000
.*                   3. DEB OR UCB IS REQUIRED WHEN IOAREA=(,ADDR)      11388800
.*                      HAS NOT BEEN SPECIFIED.                         11427600
.*                   4. DSN IS REQUIRED FOR ACCESS=IXADD OR IXDLT.      11466400
.*                   5. EXTENTS IS REQUIRED FOR ACCESS=MAPDATA OR       11505200
.*                      MAP=VOLUME,ACCESS=ALLOC OR RLSE.                11544000
.*                   6. MAP IS REQUIRED FOR ACCESS=ALLOC, RLSE, OR      11582800
.*                      MAPDATA.                                        11621600
.*                   7. SPACE IS REQUIRED WHEN SEARCH=NO,ACCESS=        11660400
.*                      ALLOC,MAP=VOLUME IS CODED.                      11700000
.*                                                                      11750000
.*                 FOR ALL FORMS OF THE MACRO, THE FOLLOWING            11800000
.*                 VALIDITY CHECKS WILL BE MADE:                        11850000
.*                   1. VALID KEYWORD OPERANDS.                         11900000
.*                   2. ARG IS INVALID FOR ACCESS=MAPDATA OR            11950000
.*                      ACCESS=ALLOC,MAP=VOLUME.                        12000000
.*                   3. COUNT IS VALID ONLY FOR ACCESS=MAPDATA.         12050000
.*                   4. CTAREA IS VALID ONLY FOR ACCESS=MAPDATA.        12100000
.*                   5. DEB AND UCB ARE MUTUALLY EXCLUSIVE.             12150000
.*                   6. DSN IS VALID ONLY FOR ACCESS=IXADD OR IXDLT.    12196600
.*                   7. EXTENTS IS VALID ONLY FOR ACCESS=MAPDATA OR     12243200
.*                      MAP=VOLUME,ACCESS=ALLOC OR RLSE.                12289800
.*                   8. HIVIER IS VALID ONLY FOR ACCESS=ALLOC,MAP=      12336400
.*                      INDEX.                                          12383000
.*                   9. IXRCDS IS VALID ONLY FOR ACCESS=IXADD OR IXDLT. 12429600
.*                  10. MAP IS VALID ONLY FOR ACCESS=ALLOC, RLSE, OR    12476200
.*                      MAPDATA.                                        12522800
.*                  11. RECOVER IS VALID ONLY FOR ACCESS=IXADD OR       12569400
.*                      IXDLT.                                          12616000
.*                  12. SEARCH IS VALID ONLY FOR ACCESS=ALLOC.          12662600
.*                  13. SPACE IS VALID ONLY FOR ACCESS=ALLOC,MAP=       12709200
.*                      VOLUME.                                         12755800
.*                  14. MAPRCDS=NO IS VALID ONLY FOR ACCESS=MAPDATA.    12802400
.*                                                                      12850000
.*                 VALID ENTRIES:  MF=I             DEFAULT             12900000
.*                                 MF=L                                 12950000
.*                                 MF=(E,ADDR)                          13000000
.*                                                                      13050000
.*       RECOVER - WILL SET THE FLAG, CV2RCVR, TO 1 WHEN YES IS CODED   13100000
.*                 AND RESET TO 0 WHEN NO IS CODED.                     13150000
.*                 RECOVER IS VALID ONLY FOR ACCESS=IXADD OR IXDLT.     13200000
.*                                                                      13250000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN MNOTE, 13300000
.*                 SINCE NO IS THE DEFAULT FOR MF=L AND MF=I.           13350000
.*                 THE FLAG WILL NOT BE CHANGED IN THE ABSENCE OF THE   13400000
.*                 RECOVER KEYWORD FOR MF=(E,ADDR) FORM.                13450000
.*                                                                      13500000
.*                 VALID ENTRIES:  RECOVER=NO       DEFAULT FOR MF=I    13550000
.*                                 RECOVER=YES                          13600000
.*                                                                      13650000
.*       RTA4BYTE- WILL SET THE FLAG, CV3RTA4B TO 1 WHEN YES       @P0C 13652000
.*                 IS CODED AND RESET TO 0 WHEN NO IS CODED.       @P0C 13654000
.*                                                                      13656000
.*                 RTA4BYTE IS VALID ONLY WHEN ACCESS=MAPDATA,     @L2A 13658000
.*                 EXTENTS=ADDR AND MAP=VOLUME ARE CODED.          @L2A 13660000
.*                                                                      13662000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN   @P0A 13664000
.*                 MNOTE, SINCE NO IS THE DEFAULT FOR MF=L AND     @P0A 13666000
.*                 MF=I.  THE FLAG WILL NOT BE CHANGED IN THE      @P0A 13668000
.*                 ABSENCE OF THE RTA4BYTE KEYWORD FOR MF=(E,ADDR) @P0A 13670000
.*                 FORM.                                           @P0A 13672000
.*                                                                      13674000
.*                 VALID ENTRIES:  RTA4BYTE=NO    DEFAULT FOR MF=I @P0A 13676000
.*                                 RTA4BYTE=YES                    @P0A 13678000
.*                                                                      13680000
.*                 RTA4BYTE IS RECOMMENDED IF ACCESSING A VOLUME   @L2A 13682000
.*                 WITH GREATER THAN 64*1024 TRACKS. THE EXTENT    @L2A 13684000
.*                 TABLE SHOULD BE MAPPED BY ICVEDT02, THE COMMON  @L2A 13686000
.*                 CVAF/DADSM EXTENT DESCRIPTION TABLE.            @L2A 13688000
.*                                                                      13690000
.*                 RTA4BYTE IS OPTIONAL IF ACCESSING A VOLUME NOT  @L2A 13692000
.*                 GREATER THAN 64*1024 TRACKS.                    @L2A 13694000
.*                                                                      13696000
.*                                                                      13698000
.*       SEARCH  - WILL SET THE FLAG, CV2SRCH, TO 1 IF YES IS CODED     13700000
.*                 AND RESET TO 0 IF NO IS CODED.                       13750000
.*                 SEARCH IS VALID ONLY FOR ACCESS=ALLOC.               13800000
.*                                                                      13850000
.*                 THE ABSENCE OF THIS KEYWORD WILL NOT CAUSE AN MNOTE, 13900000
.*                 SINCE YES IS THE DEFAULT FOR MF=L AND MF=I.          13950000
.*                 THE FLAG WILL NOT BE CHANGED IN THE ABSENCE OF THE   14000000
.*                 SEARCH KEYWORD FOR MF=(E,ADDR) FORM.                 14050000
.*                                                                      14100000
.*                 VALID ENTRIES:  SEARCH=YES       DEFAULT FOR MF=I    14150000
.*                                 SEARCH=NO                            14200000
.*                                                                      14250000
.*       SPACE   - WILL SET THE ADDRESS OF THE SPACE TABLE, SPECIFIED   14300000
.*                 BY THE 'ADDR', INTO THE FIELD: CVSPACE.  SPACE       14350000
.*                 IS VALID ONLY FOR ACCESS=ALLOC,MAP=VOLUME AND        14400000
.*                 IS REQUIRED WHEN SEARCH=NO IS SUPPLIED FOR THE       14450000
.*                 MF=I FORM OF THIS MACRO.                             14500000
.*                                                                      14550000
.*       UCB     - WILL SET THE ADDRESS OF THE UCB, SPECIFIED BY        14600000
.*                 THE 'ADDR', INTO THE FIELD: CVUCB.  THIS KEYWORD     14650000
.*                 IS MUTUALLY EXCLUSIVE WITH DEB.  EITHER DEB OR       14687500
.*                 UCB IS REQUIRED UNLESS IOAREA=(,ADDR) IS             14725000
.*                 SPECIFIED FOR THE MF=I FORM OF THIS MACRO.           14762500
.*                                                                      14800000
.* NOTES = N/A                                                          14850000
.*                                                                      14900000
.* MODULE-TYPE = MACRO                                                  14950000
.*                                                                      15000000
.*   PROCESSOR = ASSEMBLER LANGUAGE                                     15050000
.*                                                                      15100000
.*   ATTRIBUTES = EXECUTABLE MACRO                                      15150000
.*                                                                      15200000
.* ENTRY-POINT = MACRO STATEMENT.                                       15250000
.*                                                                      15300000
.* INPUT = SEE DESCRIPTION OF KEYWORDS UNDER 'FUNCTION'.                15350000
.*                                                                      15400000
.* OUTPUT = CVAF PARAMETER LIST WITH THE FLAGS AND THE ADDRESSES        15450000
.*          SET DEPENDING UPON THE KEYWORDS SPECIFIED AS DEFINED        15500000
.*          UNDER 'KEYWORDS' ABOVE.                                     15550000
.*                                                                      15600000
.* EXIT-NORMAL = MEND STATEMENT.                                        15650000
.*                                                                      15700000
.* EXIT-ERROR = MNOTE AND MEND STATEMENT.  AN MNOTE WILL BE GENERATED   15750000
.*              FOR ANY OF THE FOLLOWING ERRORS ENCOUNTERED:            15800000
.*                                                                      15850000
.*                 FOR THE MF=I FORM OF THE MACRO:                      15900000
.*                   1. ACCESS IS REQUIRED.                             15950000
.*                   2. ARG IS REQUIRED FOR ACCESS=IXADD.               16000000
.*                   3. EITHER DEB OR UCB IS NOT SUPPLIED, AND          16038800
.*                      IOAREA=(,ADDR) WAS NOT SPECIFIED.               16077600
.*                   4. DSN IS REQUIRED FOR ACCESS=IXADD OR IXDLT.      16116400
.*                   5. EXTENTS IS REQUIRED FOR ACCESS=MAPDATA OR       16155200
.*                      MAP=VOLUME,ACCESS=ALLOC OR RLSE.                16194000
.*                   6. MAP IS REQUIRED FOR ACCESS=ALLOC, RLSE, OR      16232800
.*                      MAPDATA.                                        16271600
.*                   7. SPACE IS REQUIRED WHEN SEARCH=NO,ACCESS=        16310400
.*                      ALLOC,MAP=VOLUME IS CODED.                      16350000
.*                                                                      16400000
.*                 FOR ALL FORMS OF THE MACRO:                          16450000
.*                   1. VALID KEYWORD OPERANDS.                         16500000
.*                   2. ARG IS INVALID FOR ACCESS=MAPDATA OR            16550000
.*                      ACCESS=ALLOC,MAP=VOLUME.                        16600000
.*                   3. COUNT IS VALID ONLY FOR ACCESS=MAPDATA.         16650000
.*                   4. CTAREA IS VALID ONLY FOR ACCESS=MAPDATA.        16700000
.*                   5. DEB AND UCB ARE MUTUALLY EXCLUSIVE.             16750000
.*                   6. DSN IS VALID ONLY FOR ACCESS=IXADD OR IXDLT.    16796600
.*                   7. EXTENTS IS VALID ONLY FOR ACCESS=MAPDATA OR     16843200
.*                      MAP=VOLUME,ACCESS=ALLOC OR RLSE.                16889800
.*                   8. HIVIER IS VALID ONLY FOR ACCESS=ALLOC,MAP=      16936400
.*                      INDEX.                                          16983000
.*                   9. IXRCDS IS VALID ONLY FOR ACCESS=IXADD OR IXDLT. 17029600
.*                  10. MAP IS VALID ONLY FOR ACCESS=ALLOC, RLSE, OR    17076200
.*                      MAPDATA.                                        17122800
.*                  11. RECOVER IS VALID ONLY FOR ACCESS=IXADD OR       17169400
.*                      IXDLT.                                          17216000
.*                  12. SEARCH IS VALID ONLY FOR ACCESS=ALLOC.          17262600
.*                  13. SPACE IS VALID ONLY FOR ACCESS=ALLOC,MAP=       17309200
.*                      VOLUME.                                         17355800
.*                  14. MAPRCDS=NO IS VALID ONLY FOR ACCESS=MAPDATA.    17402400
.*                  15. RTA4BYTE IS VALID ONLY FOR ACCESS=MAPDATA,      17418200
.*                      EXTENTS=ADDR AND MAP=VOLUME ARE CODED.    @L2A  17434000
.*                                                                      17450000
.* EXTERNAL-REFERENCES = NONE                                           17500000
.*                                                                      17550000
.* TABLES = NONE                                                        17600000
.*                                                                      17650000
.* MACROS = IHBINNRA                                                    17700000
.*                                                                      17750000
.* CHANGE-ACTIVITY = NEW MACRO                                          17800000
.*                                                                      17816600
.*$L0=IXVTOC,JDM1134,T790225,STLBS: INDEXED VTOC SUPPORT           @L0A 17820300
.*$L1=VSCR,HDP2210,T840401,STLMDB: CVAF VSCR                       @L1A 17824000
.*$L2=64KTRACK,JDZ1110,T920616,SJPLCJC: Greater than 64K tracks    @L2A 17827700
.*                                      device support             @L2A 17831400
.*$P0=KMM3212,JDZ1110,T920831,SJPLCJC: RTA4BYTE=YES|NO             @P0A 17835100
.*$01=OY58740,JDZ1110,T921028,SJPLRGC: New function code for       @01A 17838800
.*                                     CVAFDSM with RTA4BYTE=YES   @01A 17842500
.*$02=OY59960,JDZ1110,T921209,SJPLRPS: Assem H abends-no code chng @02A 17846200
.*                                                                      17850000
.**** END OF SPECIFICATIONS ******************************************* 17900000
         LCLA  &K                       LENGTH OF PARM                  17950000
         LCLA  &NO                      BRANCH INDEX NUMBER             18000000
         LCLB  &BCTN                    COUNT 'AND' BIT FLAG2           18050000
         LCLB  &BHVN                    HIVIER 'AND' BIT FLAG2          18100000
         LCLB  &BION                    IOAREA 'AND' BIT FLAG1          18150000
         LCLB  &BMCN                    MAP=VTOC 'AND' BIT FLAG1        18200000
         LCLB  &BMEN                    MAP=VOLUME 'AND' BIT FLAG1      18250000
         LCLB  &BMIN                    MAP=INDEX 'AND' BIT FLAG1       18300000
         LCLB  &BMRN                    MAPRCDS 'AND' BIT FLAG1         18350000
         LCLB  &BPGN                    BRANCH 'AND' BIT FLAG1          18400000
         LCLB  &BRCN                    RECOVER 'AND' BIT FLAG2         18450000
         LCLB  &BSRN                    SEARCH 'AND' BIT FLAG2          18500000
         LCLB  &BRTN                    RTA4BYTE 'AND' BIT FLAG3 @L2A   18525000
         LCLB  &BCTO                    COUNT 'OR' BIT FLAG2            18550000
         LCLB  &BHVO                    HIVIER 'OR' BIT FLAG2           18600000
         LCLB  &BIOO                    IOAREA 'OR' BIT FLAG1           18650000
         LCLB  &BIRO                    IXRCDS 'OR' BIT FLAG1           18700000
         LCLB  &BMCO                    MAP=VTOC 'OR' BIT FLAG1         18750000
         LCLB  &BMEO                    MAP=VOLUME 'OR' BIT FLAG1       18800000
         LCLB  &BMIO                    MAP=INDEX 'OR' BIT FLAG1        18850000
         LCLB  &BMRO                    MAPRCDS 'OR' BIT FLAG1          18900000
         LCLB  &BPGO                    BRANCH 'OR' BIT FLAG1           18950000
         LCLB  &BRCO                    RECOVER 'OR' BIT FLAG2          19000000
         LCLB  &BSRO                    SEARCH 'OR' BIT FLAG2           19050000
         LCLB  &BRTO                    RTA4BYTE 'OR' BIT FLAG3  @L2A   19075000
         LCLB  &ERRSW                   AN ERROR WAS DETECTED           19100000
         LCLB  &SWARG                   ARGUMENT PARM PRESENT SWITCH    19150000
         LCLB  &SWCTA                   CTAREA PARM PRESENT SWITCH      19200000
         LCLB  &SWDEB                   DEB PARM PRESENT SWITCH         19250000
         LCLB  &SWDSN                   DSN PARM PRESENT SWITCH         19300000
         LCLB  &SWEXT                   EXTENTS PARM PRESENT SWITCH     19350000
         LCLB  &SWIOA                   IOAREA PARM PRESENT SWITCH      19400000
         LCLB  &SWIXR                   IXRCDS PARM PRESENT SWITCH      19450000
         LCLB  &SWMPR                   MAPRCDS PARM PRESENT SWITCH     19500000
         LCLB  &SWSPC                   SPACE PARM PRESENT SWITCH       19550000
         LCLB  &SWUCB                   UCB PARM PRESENT SWITCH         19600000
         LCLB  &ARGNCOR                 ARGUMENT IN STORAGE SWITCH      19650000
         LCLB  &CTANCOR                 CTAREA IN STORAGE SWITCH        19700000
         LCLB  &DEBNCOR                 DEB IN STORAGE SWITCH           19750000
         LCLB  &DSNNCOR                 DSN IN STORAGE SWITCH           19800000
         LCLB  &EXTNCOR                 EXTENTS IN STORAGE SWITCH       19850000
         LCLB  &IOANCOR                 IOAREA IN STORAGE SWITCH        19900000
         LCLB  &IXRNCOR                 IXRCDS IN STORAGE SWITCH        19950000
         LCLB  &MPRNCOR                 MAPRCDS IN STORAGE SWITCH       20000000
         LCLB  &SPCNCOR                 SPACE IN STORAGE SWITCH         20050000
         LCLB  &UCBNCOR                 UCB IN STORAGE SWITCH           20100000
         LCLC  &ARGNREG                 ARGUMENT IN REG VALUE           20150000
         LCLC  &CTANREG                 CTAREA IN REG VALUE             20200000
         LCLC  &DEBNREG                 DEB IN REGISTER VALUE           20250000
         LCLC  &DSNNREG                 DSN IN REG VALUE                20300000
         LCLC  &EXTNREG                 EXTENTS IN REG VALUE            20350000
         LCLC  &IOANREG                 IOAREA IN REGISTER VALUE        20400000
         LCLC  &IXRNREG                 IXRCDS IN REG VALUE             20450000
         LCLC  &MPRNREG                 MAPRCDS IN REG VALUE            20500000
         LCLC  &SPCNREG                 SPACE IN REG VALUE              20550000
         LCLC  &UCBNREG                 UCB IN REGISTER VALUE           20600000
         LCLC  &L                       LOCAL LABEL VARIABLE            20650000
         LCLC  &FM                      MF=FORM CHARACTER VARIABLE      20700000
         LCLC  &FLAG1                   DEFINE LOCAL CHAR VARIABLE      20750000
         LCLC  &FLAG2                   DEFINE LOCAL CHAR VARIABLE      20800000
         LCLC  &FLAG3                   DEFINE LOCAL CHAR VAR     @L2A  20825000
         LCLC  &FLAG1N                  DEFINE LOCAL CHAR VARIABLE      20850000
         LCLC  &FLAG2N                  DEFINE LOCAL CHAR VARIABLE      20900000
         LCLC  &FLAG3N                  DEFINE LOCAL CHAR VAR     @L2A  20925000
         LCLC  &FUNCT                   FUNCTION CODE FOR ACCESS=       20950000
&NO      SETA  &SYSNDX                  INITIALIZE BRANCH INDEX NUM     21000000
&BCTN    SETB  1                        INITIALIZE 'AND' BIT            21050000
&BHVN    SETB  1                        INITIALIZE 'AND' BIT            21100000
&BION    SETB  1                        INITIALIZE 'AND' BIT            21150000
&BMCN    SETB  1                        INITIALIZE 'AND' BIT            21200000
&BMEN    SETB  1                        INITIALIZE 'AND' BIT            21250000
&BMIN    SETB  1                        INITIALIZE 'AND' BIT            21300000
&BMRN    SETB  1                        INITIALIZE 'AND' BIT            21350000
&BPGN    SETB  1                        INITIALIZE 'AND' BIT            21400000
&BRCN    SETB  1                        INITIALIZE 'AND' BIT            21450000
&BSRN    SETB  1                        INITIALIZE 'AND' BIT            21500000
&BRTN    SETB  1                        INIT 'AND' BIT OF RTA4BYTE @P0A 21525000
.*                                                                      21550000
.* ******************************************************************** 21600000
.* *     MF=' ' VERIFICATION                                            21650000
.* ******************************************************************** 21700000
.*                                                                      21750000
         AIF   (N'&MF GT 2).ER          MF= HAS ONLY 2 PARMS            21800000
         AIF   ('&MF(1)' EQ 'E').E1     TEST FOR E FORM                 21850000
         AIF   (N'&MF NE 1).ER          MF=L OR I HAS ONLY 1 PARM       21900000
         AIF   ('&MF(1)' EQ 'I').I1     TEST FOR I FORM                 21950000
         AIF   ('&MF(1)' EQ 'L').L1     TEST FOR L FORM                 22000000
.ER      ANOP                                                           22050000
         SPACE 1                                                        22100000
         MNOTE 16,'***  IHB001 INVALID OPERAND - MF=&MF'                22150000
&ERRSW   SETB  1                        SET ERROR SWITCH ON             22200000
         AGO   .CKERR                   GO TO ERROR IN CHECK ROUTINE    22250000
.*                                                                      22300000
.* ******************************************************************** 22350000
.* *     EXECUTE FORM, MF=(E,' ') VERIFICATION                          22400000
.* ******************************************************************** 22450000
.*                                                                      22500000
.E1      ANOP                           EXECUTE FORM OF MACRO           22550000
&FM      SETC  'E'                      SET THE MACRO FORM SWITCH       22600000
         AIF   (N'&MF EQ 2).CK1         MF=E MUST HAVE 2 PARMS          22650000
         SPACE 1                                                        22700000
         MNOTE 16,'***  IHB002 MF=(E,ADDR) FORM: PARAMETER LIST ADDRESSX22750000
                IS REQUIRED'                                            22800000
&ERRSW   SETB  1                        SET ERROR SWITCH ON             22850000
         AGO   .CK1                     GO CHECK NEXT KEYWORD           22900000
.*                                                                      22950000
.* ******************************************************************** 23000000
.* *     LIST FORM OF CVAFDSM                                           23050000
.* ******************************************************************** 23100000
.*                                                                      23150000
.L1      ANOP                           LIST FORM OF MACRO              23200000
&FM      SETC  'L'                      SET THE MACRO FORM SWITCH       23250000
         AGO   .CK1                     GO CHECK NEXT KEYWORD           23300000
.*                                                                      23350000
.* ******************************************************************** 23400000
.* *     INSTRUCTION FORM OF CVAFDSM                                    23450000
.* ******************************************************************** 23500000
.*                                                                      23550000
.I1      ANOP                           INSTRUCTION FORM OF MACRO       23600000
&FM      SETC  'I'                      SET THE MACRO FORM SWITCH       23650000
.*                                                                      23700000
.* ******************************************************************** 23750000
.* *     INSTRUCTION FORM REQUIRES THE 'ACCESS' KEYWORD                 23800000
.* ******************************************************************** 23850000
.*                                                                      23900000
         AIF   ('&ACCESS' NE '').CK1    OK IF ACCESS IS CODED           23950000
         SPACE 1                                                        24000000
         MNOTE 12,'***  IHB003 MF=I FORM: ACCESS KEYWORD IS REQUIRED'   24050000
&ERRSW   SETB  1                         SET ERROR IN CHECK SWITCH      24100000
         AGO   .CK2                      BYPASS NEXT CHECK              24150000
.*                                                                      24200000
.* ******************************************************************** 24250000
.* *     VERIFY 'ACCESS' KEYWORD                                        24300000
.* ******************************************************************** 24350000
.*                                                                      24400000
.CK1     ANOP                                                           24450000
         AIF   ('&ACCESS' NE 'IXADD').AC1 NOT IXADD, GO ON              24500000
&FUNCT   SETC  '06'                       CVAFDSM ACCESS=IXADD          24550000
         AGO   .CK2                                                     24600000
.AC1     ANOP                                                           24650000
         AIF   ('&ACCESS' NE 'IXDLT').AC2 NOT IXDLT, GO ON              24700000
&FUNCT   SETC  '07'                       CVAFDSM ACCESS=IXDLT          24750000
         AGO   .CK2                                                     24800000
.AC2     ANOP                                                           24850000
         AIF   ('&ACCESS' NE 'ALLOC').AC3 NOT ALLOC, GO ON              24900000
&FUNCT   SETC  '08'                       CVAFDSM ACCESS=ALLOC          24950000
         AGO   .CK2                                                     25000000
.AC3     ANOP                                                           25050000
         AIF   ('&ACCESS' NE 'RLSE').AC4  NOT RLSE, GO ON               25100000
&FUNCT   SETC  '09'                       CVAFDSM ACCESS=RLSE           25150000
         AGO   .CK2                                                     25200000
.AC4     ANOP                                                           25250000
         AIF   ('&ACCESS' NE 'MAPDATA').AC5 NOT MAPDATA, GO ON          25300000
&FUNCT   SETC  '0A'                       CVAFDSM ACCESS=MAPDATA        25350000
         AGO   .CK2                                                     25400000
.AC5     ANOP                                                           25450000
         AIF   ('&ACCESS' EQ '' AND '&FM' EQ 'E').CK2                   25500000
&FUNCT   SETC  '00'                       ACCESS= NOT CODED             25550000
         AIF   ('&ACCESS' EQ '' AND '&FM' NE 'I').CK2 MF~=I, SKIP       25600000
         SPACE 1                                                        25650000
         MNOTE 12,'***  IHB001 INVALID OPERAND - ACCESS=&ACCESS'        25700000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       25750000
.*                                                                      25800000
.* ******************************************************************** 25850000
.* *     IF DSN IS PRESENT, CHECK IF IN REG OR NOT                      25900000
.* ******************************************************************** 25950000
.*                                                                      26000000
.CK2     ANOP                                                           26050000
         AIF   ('&DSN' EQ '').D1        NO DSN, SEE IF MF=I             26100000
         AIF   (N'&DSN NE 1).ER2        ONLY 1 DSN PARM ALLOWED         26150000
&SWDSN   SETB  1                        SET DSN SWITCH ON               26200000
         AIF   ('&DSN'(1,1) EQ '(').DSNNREG                             26250000
&DSNNCOR SETB  1                        DSN IS IN CORE                  26300000
         AGO   .CK3A                                                    26350000
.DSNNREG ANOP                                                           26400000
&K       SETA  K'&DSN                   STORE NO. OF CHARS IN DSN       26450000
&DSNNREG SETC  '&DSN'(2,&K-2)           GET REGISTER OF DSN             26500000
         AGO   .CK3A                                                    26550000
.ER2     ANOP                           DSN= **** ERROR ****            26600000
         SPACE 1                                                        26650000
         MNOTE 12,'***  IHB001 INVALID OPERAND - DSN=&DSN'              26700000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       26750000
         AGO   .CK3B                    SKIP OTHER DSN CHECKS           26800000
.*                                                                      26850000
.* ******************************************************************** 26900000
.* *     INST FORM: DSN IS REQUIRED WHEN ACCESS=IXADD OR IXDLT IS CODED 26950000
.* ******************************************************************** 27000000
.*                                                                      27050000
.D1      ANOP                                                           27100000
         AIF   ('&FM' NE 'I').CK3B                MF=L OR E, SKIP       27150000
         AIF   ('&ACCESS' EQ 'IXADD').ERR1        ACCESS=IXADD, ERROR   27200000
         AIF   ('&ACCESS' NE 'IXDLT').CK3B        ACCESS=IXDLT, ERROR   27250000
.ERR1    ANOP                                                           27300000
         SPACE 1                                                        27350000
         MNOTE 12,'***  IHB004 MF=I FORM: DSN IS REQUIRED FOR ACCESS=&AX27400000
               CCESS'                                                   27450000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       27500000
         AGO   .CK3B                    SKIP OTHER DSN CHECKS           27550000
.*                                                                      27600000
.* ******************************************************************** 27650000
.* *     DSN IS INVALID WHEN ACCESS=ALLOC, RLSE, OR MAPDATA IS CODED    27700000
.* ******************************************************************** 27750000
.*                                                                      27800000
.CK3A    ANOP                                                           27850000
         AIF   ('&ACCESS' EQ '').CK3B        NO ACCESS=, SKIP           27900000
         AIF   ('&ACCESS' EQ 'IXADD').CK3B   ACCESS=IXADD, SKIP         27950000
         AIF   ('&ACCESS' EQ 'IXDLT').CK3B   ACCESS=IXDLT, SKIP         28000000
         SPACE 1                                                        28050000
         MNOTE 12,'***  IHB005 DSN IS INVALID IF ACCESS=&ACCESS'        28100000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       28102300
.*                                                                      28104600
.* ******************************************************************** 28106900
.* *     IF DEB IS PRESENT, CHECK IF IN REG OR NOT                      28109200
.* ******************************************************************** 28111500
.*                                                                      28113800
.CK3B    ANOP                                                           28116100
         AIF   ('&DEB' EQ '').CK3B2     NO DEB, GO CHECK ARG            28118400
         AIF   (N'&DEB NE 1).ER31       ONLY 1 DEB PARM ALLOWED         28120700
&SWDEB   SETB  1                        SET DEB SWITCH ON               28123000
         AIF   ('&DEB'(1,1) EQ '(').DEBNREG                             28125300
&DEBNCOR SETB  1                        DEB IS IN CORE                  28127600
         AGO   .CK3B2                                                   28129900
.DEBNREG ANOP                                                           28132200
&K       SETA  K'&DEB                   STORE NO. OF CHARS IN DEB       28134500
&DEBNREG SETC  '&DEB'(2,&K-2)           GET REGISTER OF DEB             28136800
         AGO   .CK3B2                                                   28139100
.ER31    ANOP                           DEB= **** ERROR ****            28141400
         SPACE 1                                                        28143700
         MNOTE 12,'***  IHB001 INVALID OPERAND - DEB=&DEB'              28146000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       28150000
.*                                                                      28200000
.* ******************************************************************** 28250000
.* *     IF ARG IS PRESENT, CHECK IF IN REG OR NOT                      28300000
.* ******************************************************************** 28350000
.*                                                                      28400000
.CK3B2   ANOP                                                           28450000
         AIF   ('&ARG' EQ '').CK3C      NO ARG, GO SEE IF MF=I          28500000
         AIF   (N'&ARG NE 1).ER32       ONLY 1 ARG PARM ALLOWED         28550000
&SWARG   SETB  1                        SET ARG SWITCH ON               28600000
         AIF   ('&ARG'(1,1) EQ '(').ARGNREG                             28650000
&ARGNCOR SETB  1                        ARG IS IN CORE                  28700000
         AGO   .CK3D                                                    28750000
.ARGNREG ANOP                                                           28800000
&K       SETA  K'&ARG                   STORE NO. OF CHARS IN ARG       28850000
&ARGNREG SETC  '&ARG'(2,&K-2)           GET REGISTER OF ARG             28900000
         AGO   .CK3D                                                    28950000
.ER32    ANOP                           ARG= **** ERROR ****            29000000
         SPACE 1                                                        29050000
         MNOTE 12,'***  IHB001 INVALID OPERAND - ARG=&ARG'              29100000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       29150000
         AGO   .CK3D                    SKIP OTHER ARG CHECKS           29200000
.*                                                                      29250000
.* ******************************************************************** 29300000
.* *     INST FORM: ARG IS REQUIRED WHEN ACCESS=IXADD IS CODED.         29350000
.* ******************************************************************** 29400000
.*                                                                      29450000
.CK3C    ANOP                                                           29500000
         AIF   ('&FM' NE 'I').U1                  MF=L OR E, SKIP       29550000
         AIF   ('&ACCESS' NE 'IXADD').U1          ACCESS=IXADD, ERROR   29600000
.ERR2    ANOP                                                           29650000
         SPACE 1                                                        29700000
         MNOTE 12,'***  IHB006 MF=I FORM: ARG IS REQUIRED FOR ACCESS=IXX29750000
               ADD'                                                     29800000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       29900000
         AGO   .U1                                                      29950000
.*                                                                      30000000
.* ******************************************************************** 30050000
.* *     ARG IS INVALID FOR ACCESS=MAPDATA OR ACCESS=ALLOC,MAP=VOLUME   30100000
.* ******************************************************************** 30150000
.*                                                                      30200000
.CK3D    ANOP                                                           30250000
         AIF   ('&ACCESS' EQ 'MAPDATA').ERR3 MAPDATA, ERROR             30300000
         AIF   ('&ACCESS' NE 'ALLOC').U1     NOT ALLOC, SKIP            30350000
         AIF   ('&MAP' NE 'VOLUME').U1       NOT VOLUME, SKIP           30400000
         SPACE 1                                                        30450000
         MNOTE 12,'***  IHB007 ARG IS INVALID IF ACCESS=ALLOC,MAP=VOLUMX30500000
               E'                                                       30550000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       30600000
         AGO   .U1                      CHECK OUT THE UCB               30650000
.ERR3    ANOP                                                           30700000
         SPACE 1                                                        30750000
         MNOTE 12,'***  IHB008 ARG IS INVALID IF ACCESS=MAPDATA'        30800000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       30850000
.*                                                                      30900000
.* ******************************************************************** 30950000
.* *     IF UCB IS PRESENT, CHECK IF IN REG OR NOT                      31000000
.* ******************************************************************** 31050000
.*                                                                      31100000
.U1      ANOP                                                           31150000
         AIF   ('&UCB' EQ '').I2        NO UCB, IS IOAREA?              31200000
         AIF   (N'&UCB NE 1).ER4        ONLY 1 UCB PARM ALLOWED         31250000
&SWUCB   SETB  1                        SET UCB SWITCH ON               31300000
         AIF   ('&UCB'(1,1) EQ '(').UCBNREG                             31350000
&UCBNCOR SETB  1                        UCB IS IN CORE                  31400000
         AGO   .I2                                                      31450000
.UCBNREG ANOP                                                           31500000
&K       SETA  K'&UCB                   STORE NO. OF CHARS IN UCB       31550000
&UCBNREG SETC  '&UCB'(2,&K-2)           GET REGISTER OF UCB             31600000
         AGO   .I2                                                      31650000
.ER4     ANOP                           UCB= **** ERROR ****            31700000
         SPACE 1                                                        31750000
         MNOTE 12,'***  IHB001 INVALID OPERAND - UCB=&UCB'              31800000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       31850000
.*                                                                      31900000
.* ******************************************************************** 31950000
.* *     DEB AND UCB KEYWORDS ARE MUTUALLY EXCLUSIVE                    32000000
.* ******************************************************************** 32013300
.*                                                                      32026600
.I2      ANOP                                                           32039900
         AIF   ('&SWDEB' EQ '0' OR '&SWUCB' EQ '0').I22                 32053200
         SPACE 1                                                        32066500
         MNOTE 12,'***  IHB009 DEB AND UCB KEYWORDS ARE MUTUALLY EXCLUSX32079800
               IVE'                                                     32093100
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       32106400
.*                                                                      32119700
.* ******************************************************************** 32133000
.* *     IF IOAREA IS PRESENT, CHECK IF IN REG OR NOT                   32146300
.* ******************************************************************** 32159600
.*                                                                      32172900
.I22     ANOP                                                           32186200
         AIF   ('&IOAREA' EQ '').I3C    NO IOAREA, IS IT MF=I?          32200000
         AIF   (N'&IOAREA EQ 1).I3A     NO IOAREA ADDRESS, KEEP/NOKEEP? 32250000
         AIF   (N'&IOAREA NE 2).ER5     ONLY 2 IOAREA PARMS ALLOWED     32300000
&SWIOA   SETB  1                        SET IOAREA SWITCH ON            32350000
         AIF   ('&IOAREA(2)'(1,1) EQ '(').IOANREG                       32400000
&IOANCOR SETB  1                        IOAREA IS IN CORE               32450000
         AGO   .I3A                     CHECK OUT FIRST PARM            32500000
.IOANREG ANOP                                                           32550000
&K       SETA  K'&IOAREA(2)             STORE NO. OF CHARS IN IOAREA    32600000
&IOANREG SETC  '&IOAREA(2)'(2,&K-2)     GET REGISTER OF IOAREA          32650000
.*                                                                      32700000
.* ******************************************************************** 32750000
.* *     VALIDITY CHECK THE FIRST PARM OF IOAREA                        32800000
.* ******************************************************************** 32850000
.*                                                                      32900000
.I3A     ANOP                                                           32950000
         AIF   ('&IOAREA(1)' NE 'KEEP').I3B                             33000000
&BIOO    SETB  1                        SET IOAREA=KEEP SWITCH          33050000
         AGO   .I3C                                                     33100000
.I3B     ANOP                                                           33150000
         AIF   ('&IOAREA(1)' NE 'NOKEEP').ER5                           33200000
&BION    SETB  0                        SET IOAREA=NOKEEP SWITCH        33250000
         AGO   .I3C                                                     33300000
.ER5     ANOP                           IOAREA= **** ERROR ****         33350000
         SPACE 1                                                        33400000
         MNOTE 12,'***  IHB001 INVALID OPERAND - IOAREA=&IOAREA'        33450000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       33500000
.*                                                                      33550000
.* ******************************************************************** 33600000
.* *     INST FORM: DEB OR UCB IS REQUIRED WHEN NO IOAREA=(,ADDR)       33650000
.* ******************************************************************** 33666600
.*                                                                      33683200
.I3C     ANOP                                                           33699800
         AIF   ('&FM' NE 'I').I3C2      IF NOT MF=I, SKIP               33716400
         AIF   ('&SWIOA' EQ '1').I3C2   IOAREA ADDRESS, SKIP            33733000
         AIF   ('&SWDEB' EQ '1').I3C2   DEB ADDRESS, SKIP               33749600
         AIF   ('&SWUCB' EQ '1').I3C2   UCB ADDRESS, SKIP               33766200
         SPACE 1                                                        33782800
         MNOTE 12,'***  IHB010 MF=I FORM: DEB OR UCB IS REQUIRED WHEN NX33799400
               O IOAREA      ADDRESS IS SPECIFIED'                      33816000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       33832600
.*                                                                      33849200
.* ******************************************************************** 33865800
.* *     VALIDITY CHECK 'COUNT=' KEYWORD                                33882400
.* ******************************************************************** 33899000
.*                                                                      33915600
.I3C2    ANOP                                                           33932200
         AIF   ('&COUNT' EQ '').CK4     NO KEYWORD, SKIP NEXT CHECK     33948800
         AIF   ('&COUNT' NE 'NO').CNT1  COUNT=YES, GO CHECK IT          33965400
         AIF   ('&MAP' NE 'VOLUME').ERR7 NOT MAP=VOLUME IS ERROR        33982000
         AIF   ('&FUNCT' NE '0A').ERR6  NO MAPDATA IS ERROR             34000000
&BCTN    SETB  0                        SET COUNT=NO SWITCH             34050000
         AGO   .CK4                     AND SKIP NEXT CHECK             34100000
.CNT1    ANOP                                                           34150000
         AIF   ('&COUNT' NE 'YES').ERR4 COUNT=??, IS AN ERROR           34200000
         AIF   ('&FUNCT' NE '0A').ERR6  NO MAPDATA IS ERROR             34250000
         AIF   ('&MAP' EQ 'VOLUME').ERR7 MAP=VOLUME IS ERROR            34300000
&BCTO    SETB  1                        SET COUNT=YES SWITCH            34350000
         AGO   .CK4                     AND SKIP NEXT CHECK             34400000
.ERR4    ANOP                                                           34450000
         SPACE 1                                                        34500000
         MNOTE 12,'***  IHB001 INVALID OPERAND - COUNT=&COUNT'          34550000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       34600000
         AGO   .CK4                     BYPASS THE NEXT CHECK           34650000
.*                                                                      34700000
.* ******************************************************************** 34750000
.* *     COUNT=YES OR NO IS CODED AND ACCESS=MAPDATA WAS NOT CODED      34800000
.* ******************************************************************** 34842800
.*                                                                      34885600
.ERR6    ANOP                                                           34928400
         SPACE 1                                                        34971200
         MNOTE 12,'***  IHB011 COUNT=&COUNT IS VALID ONLY FOR ACCESS=MAX35014000
               PDATA'                                                   35056800
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       35100000
         AGO   .CK4                     BYPASS THE NEXT CHECK           35150000
.*                                                                      35200000
.* ******************************************************************** 35250000
.* *     COUNT=YES IS INVALID WHEN MAP=VOLUME IS CODED                  35300000
.* *     COUNT=NO IS INVALID WHEN MAP=VTOC OR INDEX IS CODED            35350000
.* ******************************************************************** 35400000
.*                                                                      35450000
.ERR7    ANOP                                                           35500000
         SPACE 1                                                        35550000
         MNOTE 12,'***  IHB012 COUNT=&COUNT IS INVALID IF MAP=&MAP'     35600000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       35650000
         AGO   .CK4                     BYPASS THE NEXT CHECK           35700000
.*                                                                      35750000
.* ******************************************************************** 35800000
.* *     IF CTAREA IS PRESENT, CHECK IF IN REG OR NOT                   36350000
.* ******************************************************************** 36400000
.*                                                                      36450000
.CK4     ANOP                                                           36500000
         AIF   ('&CTAREA' EQ '').CK5    NO CTAREA, SKIP NEXT CHECK      36550000
         AIF   (N'&CTAREA NE 1).ER6     ONLY 1 CTAREA PARM ALLOWED      36600000
&SWCTA   SETB  1                        SET CTAREA SWITCH ON            36650000
         AIF   ('&CTAREA'(1,1) EQ '(').CTANREG                          36700000
&CTANCOR SETB  1                        CTAREA IS IN CORE               36750000
         AGO   .CK4A                                                    36800000
.CTANREG ANOP                                                           36850000
&K       SETA  K'&CTAREA                STORE NO. OF CHARS IN CTAREA    36900000
&CTANREG SETC  '&CTAREA'(2,&K-2)        GET REGISTER OF CTAREA          36950000
         AGO   .CK4A                                                    37000000
.ER6     ANOP                           CTAREA= **** ERROR ****         37050000
         SPACE 1                                                        37100000
         MNOTE 12,'***  IHB001 INVALID OPERAND - CTAREA=&CTAREA'        37150000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       37200000
         AGO   .CK5                     SKIP NEXT CHECK                 37250000
.*                                                                      37300000
.* ******************************************************************** 37350000
.* *     CTAREA IS VALID ONLY WHEN ACCESS=MAPDATA HAS BEEN CODED        37400000
.* ******************************************************************** 37450000
.*                                                                      37500000
.CK4A    ANOP                                                           37550000
         AIF   ('&ACCESS' EQ '').CK4B         NULL IS OK                37600000
         AIF   ('&ACCESS' EQ 'MAPDATA').CK4B  MAPDATA IS OK             37650000
         SPACE 1                                                        37700000
         MNOTE 12,'***  IHB013 CTAREA IS INVALID IF ACCESS=&ACCESS'     37750000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       37850000
         AGO   .CK5                     SKIP NEXT CHECK                 37900000
.*                                                                      37950000
.* ******************************************************************** 38000000
.* *     CTAREA IS VALID ONLY IF COUNT=YES HAS BEEN CODED               38050000
.* ******************************************************************** 38100000
.*                                                                      38150000
.CK4B    ANOP                                                           38200000
         AIF   ('&COUNT' EQ 'YES').CK5   YES IS OK                      38250000
         SPACE 1                                                        38300000
         MNOTE 12,'***  IHB014 CTAREA IS INVALID IF COUNT=NO'           38350000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       38450000
.*                                                                      38500000
.* ******************************************************************** 38550000
.* *     IF MAPRCDS IS PRESENT, CHECK IF IN REG OR NOT                  38600000
.* ******************************************************************** 38650000
.*                                                                      38700000
.CK5     ANOP                                                           38750000
         AIF   ('&MAPRCDS' EQ '').MR1   NO MAPRCDS, GO ON               38800000
         AIF   (N'&MAPRCDS EQ 1).MR1    NO MAPRCDS ADDRESS, YES/NO?     38850000
         AIF   (N'&MAPRCDS NE 2).ER7    ONLY 2 MAPRCDS PARMS ALLOWED    38900000
&SWMPR   SETB  1                        SET MAPRCDS SWITCH ON           38950000
         AIF   ('&MAPRCDS(2)'(1,1) EQ '(').MPRNREG                      39000000
&MPRNCOR SETB  1                        MAPRCDS IS IN CORE              39050000
         AGO   .MR1                     CHECK OUT FIRST PARM            39100000
.MPRNREG ANOP                                                           39150000
&K       SETA  K'&MAPRCDS(2)            STORE NO. OF CHARS IN MAPRCDS   39200000
&MPRNREG SETC  '&MAPRCDS(2)'(2,&K-2)    GET REGISTER OF MAPRCDS         39250000
.*                                                                      39300000
.* ******************************************************************** 39350000
.* *     VALIDITY CHECK THE FIRST PARM OF MAPRCDS                       39400000
.* ******************************************************************** 39450000
.*                                                                      39500000
.MR1     ANOP                                                           39550000
         AIF   ('&MAPRCDS' EQ '' AND '&FM' EQ 'I').SETON MAPRCDS BIT    39600000
         AIF   ('&MAPRCDS' EQ '').CK6   MAPRCDS NOT CODED, SKIP         39650000
         AIF   ('&MAPRCDS(1)' EQ 'YES').SETON MAPRCDS BIT               39700000
         AIF   ('&MAPRCDS(1)' EQ 'NO' AND '&ACCESS' EQ '').SETOFF BIT   39750000
         AIF   ('&MAPRCDS(1)' EQ 'NO' AND '&FUNCT' EQ '0A').SETOFF BIT  39800000
         AIF   ('&MAPRCDS(1)' NE 'NO').ER7                              39850000
         AGO   .ERR8                                                    39900000
.SETON   ANOP                                                           39950000
&BMRO    SETB  1                            SET MAPRCDS=YES SWITCH      40000000
         AGO   .CK6                                                     40050000
.SETOFF  ANOP                                                           40100000
&BMRN    SETB  0                            SET MAPRCDS=NO SWITCH       40150000
         AGO   .CK6                                                     40200000
.ER7     ANOP                           MAPRCDS= **** ERROR ****        40250000
         SPACE 1                                                        40300000
         MNOTE 12,'***  IHB001 INVALID OPERAND - MAPRCDS=&MAPRCDS'      40350000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       40400000
         AGO   .CK6                                                     40450000
.ERR8    ANOP                           MAPRCDS= **** ERROR ****        40500000
         SPACE 1                                                        40550000
         MNOTE 12,'***  IHB015 MAPRCDS=NO IS INVALID IF ACCESS=&ACCESS' 40600000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       40700000
.*                                                                      40750000
.* ******************************************************************** 40800000
.* *     IF IXRCDS IS PRESENT, CHECK IF IN REG OR NOT                   40850000
.* ******************************************************************** 40900000
.*                                                                      40950000
.CK6     ANOP                                                           41000000
         AIF   ('&IXRCDS' EQ '').CK7A   NO IXRCDS, GO ON                41050000
         AIF   (N'&IXRCDS EQ 1).CK7     NO IXRCDS ADDRESS, KEEP?        41100000
         AIF   (N'&IXRCDS NE 2).ER8     ONLY 2 IXRCDS PARMS ALLOWED     41150000
&SWIXR   SETB  1                        SET IXRCDS SWITCH ON            41200000
         AIF   ('&IXRCDS(2)'(1,1) EQ '(').IXRNREG                       41250000
&IXRNCOR SETB  1                        IXRCDS IS IN CORE               41300000
         AGO   .CK7                     CHECK OUT FIRST PARM            41350000
.IXRNREG ANOP                                                           41400000
&K       SETA  K'&IXRCDS(2)             STORE NO. OF CHARS IN IXRCDS    41450000
&IXRNREG SETC  '&IXRCDS(2)'(2,&K-2)     GET REGISTER OF IXRCDS          41500000
.*                                                                      41550000
.* ******************************************************************** 41600000
.* *     VALIDITY CHECK THE FIRST PARM OF IXRCDS                        41650000
.* ******************************************************************** 41700000
.*                                                                      41750000
.CK7     ANOP                                                           41800000
         AIF   ('&IXRCDS(1)' EQ 'NOKEEP').ERR9   NOKEEP IS INVALID      41850000
         AIF   ('&IXRCDS(1)' NE 'KEEP').ER8      KEEP IS OK, DON'T SKIP 41900000
         AIF   ('&ACCESS' EQ '').CK7OK           ACCESS=, OK, SKIP      41950000
         AIF   ('&FUNCT' NE '06' AND '&FUNCT' NE '07').ER8A             41966600
.CK7OK   ANOP                                                           41983200
&BIRO    SETB  1                                 SET IXRCDS=KEEP SWITCH 42000000
         AGO   .CK8                                                     42050000
.CK7A    ANOP                                                           42100000
         AIF   ('&FUNCT' NE '06' AND '&FUNCT' NE '07').CK8              42150000
         AIF   ('&FM' NE 'I').CK8                NOT MF=I, SKIP         42200000
&BIRO    SETB  1                                 SET IXRCDS=KEEP SWITCH 42250000
         AGO   .CK8                                                     42300000
.ER8     ANOP                           IXRCDS= **** ERROR ****         42350000
         SPACE 1                                                        42400000
         MNOTE 12,'***  IHB001 INVALID OPERAND - IXRCDS=&IXRCDS'        42450000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       42500000
         AGO   .CK8                                                     42550000
.ER8A    ANOP                           IXRCDS= **** ERROR ****         42600000
         SPACE 1                                                        42650000
         MNOTE 12,'***  IHB016 IXRCDS= IS INVALID IF ACCESS=&ACCESS'    42700000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       42750000
         AGO   .CK8                                                     42800000
.ERR9    ANOP                           IXRCDS=NOKEEP ***ERROR***       42850000
         SPACE 1                                                        42900000
         MNOTE 12,'***  IHB017 IXRCDS=NOKEEP IS INVALID FOR CVAFDSM'    42950000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       43000000
.*                                                                      43050000
.* ******************************************************************** 43100000
.* *     IF EXTENTS IS PRESENT, CHECK IF IN REG OR NOT                  43150000
.* ******************************************************************** 43200000
.*                                                                      43250000
.CK8     ANOP                                                           43300000
         AIF   ('&EXTENTS' EQ '').CK10  NO EXTENTS, SEE IF MF=I         43350000
         AIF   (N'&EXTENTS NE 1).ER9    ONLY 1 EXTENTS PARM ALLOWED     43400000
&SWEXT   SETB 1                         SET EXTENTS SWITCH ON           43450000
         AIF   ('&EXTENTS'(1,1) EQ '(').EXTNREG                         43500000
&EXTNCOR SETB  1                        EXTENTS IS IN CORE              43550000
         AGO   .CK9                                                     43600000
.EXTNREG ANOP                                                           43650000
&K       SETA  K'&EXTENTS               STORE NO. OF CHARS IN EXTENTS   43700000
&EXTNREG SETC  '&EXTENTS'(2,&K-2)       GET REGISTER OF EXTENTS         43750000
         AGO   .CK9                                                     43800000
.ER9     ANOP                           EXTENTS= **** ERROR ****        43850000
         SPACE 1                                                        43900000
         MNOTE 12,'***  IHB001 INVALID OPERAND - EXTENTS=&EXTENTS'      43950000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       44000000
         AGO   .CK11                    SKIP OTHER EXTENTS CHECKS       44050000
.*                                                                      44100000
.* ******************************************************************** 44150000
.* *     EXTENTS= IS VALID ONLY FOR ACCESS=MAPDATA OR MAP=VOLUME,       44200000
.* *     ACCESS=ALLOC OR RLSE                                           44250000
.* ******************************************************************** 44300000
.*                                                                      44350000
.CK9     ANOP                                                           44400000
         AIF   ('&ACCESS' EQ 'MAPDATA').CK10A  YES, SKIP          @L2C  44450000
         AIF   ('&MAP' NE 'VOLUME').CK10A   MAP=VOLUME, DON'T SKIP@L2C  44500000
         AIF   ('&ACCESS' EQ 'ALLOC').CK10A    ACCESS=ALLOC, SKIP @L2C  44550000
         AIF   ('&ACCESS' EQ 'RLSE').CK10A     ACCESS=RLSE, SKIP  @L2C  44600000
         SPACE 1                                                        44650000
         MNOTE 12,'***  IHB018 EXTENTS= IS INVALID IF ACCESS=&ACCESS.,MX44700000
               AP=&MAP'                                                 44750000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       44800000
         AGO   .CK10A                   SKIP OTHER EXTENTS CHECKS @L2C  44850000
.*                                                                      44900000
.* ******************************************************************** 44950000
.* *     INST FORM: EXTENTS IS REQUIRED WHEN ACCESS=ALLOC, MAPDATA,     45000000
.* *                OR RLSE AND MAP=VOLUME IS CODED.                    45050000
.* ******************************************************************** 45100000
.*                                                                      45150000
.CK10    ANOP                                  EXTENTS IS NOT THERE     45200000
         AIF   ('&FM' NE 'I').CK10A            NOT MF=I, SKIP     @L2C  45250000
         AIF   ('&MAP' NE 'VOLUME').CK10A      NOT MAP=VOLUME,SKIP@L2C  45300000
         AIF   ('&FUNCT' EQ '06' OR '&FUNCT' EQ '07').CK10A       @L2C  45350000
         SPACE 1                                                        45400000
         MNOTE 12,'***  IHB019 MF=I FORM: EXTENTS= IS REQUIRED FOR ACCEX45450000
               SS=&ACCESS.,  MAP=VOLUME'                                45500000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       45550000
         AGO   .CK10A                   SKIP OTHER EXTENTS CHECKS @L2C  45553300
.*                                                                      45556600
.* ******************************************************************** 45559900
.* *     VALIDITY CHECK 'RTA4BYTE=' KEYWORD                        @P0C 45563200
.* ******************************************************************** 45566500
.*                                                                      45569800
.CK10A   ANOP                                                           45573100
         AIF   ('&RTA4BYTE' EQ '').CK11 NO KEYWORD,SKIP NEXT CHECK @P0C 45576400
         AIF   ('&SWEXT' NE '1').ER10A  EXTENTS NOT PRESENT,ERROR  @L2A 45579700
         AIF   ('&ACCESS' NE 'MAPDATA').ER10A  NOT MAPDATA, ERROR  @L2C 45583000
         AIF   ('&MAP'    NE 'VOLUME').ER10A  NOT VOLUME, ERROR    @P0C 45586300
         AIF   ('&RTA4BYTE' NE 'NO').RT1 RTA4BYTE=YES, GO CHECK IT @P0C 45589600
&BRTN    SETB  0                        SET RTA4BYTE=NO SWITCH     @P0A 45592900
         AGO   .CK11                    AND SKIP                   @P0A 45596200
.RT1     ANOP                                                      @P0A 45599500
         AIF   ('&RTA4BYTE' NE 'YES').ER10B RTA4BYTE=?? IS AN ERROR@P0A 45602800
&BRTO    SETB  1                        SET RTA4BYTE=YES SWITCH    @P0A 45606100
&FUNCT   SETC  'AA'                     ACCESS=MAPDATA RTA4BYTE=YES@01A 45609400
         AGO   .CK11                    AND SKIP NEXT CHECK        @L2A 45612700
.ER10A   ANOP                                                      @L2A 45616000
         SPACE 1                                                   @L2A 45619300
         MNOTE 12,'***  IHB027 RTA4BYTE= IS VALID ONLY IF EXTENTS IS PRX45622600
               ESENT,ACCESS=MAPDATA AND MAP=VOLUME'                @P0C 45625900
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       45629200
         AGO   .CK11                    BYPASS THE NEXT CHECK           45632500
.ER10B   ANOP                                                           45635800
         SPACE 1                                                        45639100
         MNOTE 12,'***  IHB028 INVALID OPERAND - RTA4BYTE=&RTA4BYTE'    45642400
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       45645700
.*                                                                      45650000
.* ******************************************************************** 45700000
.* *     VALIDITY CHECK 'HIVIER=' KEYWORD                               45750000
.* ******************************************************************** 45800000
.*                                                                      45850000
.CK11    ANOP                                                           45900000
         AIF   ('&HIVIER' EQ '').CK12     NO KEYWORD, SKIP NEXT CHECK   45950000
         AIF   ('&HIVIER' NE 'NO').HIV1   HIVIER=YES, GO CHECK IT       46000000
         AIF   ('&FUNCT' NE '08').ER11     NOT ALLOC, ERROR             46050000
         AIF   ('&MAP' NE 'INDEX').ER11   NOT INDEX, ERROR              46100000
&BHVN    SETB  0                          SET HIVIER=NO SWITCH          46150000
         AGO   .CK12                      AND SKIP NEXT CHECK           46200000
.HIV1    ANOP                                                           46250000
         AIF   ('&HIVIER' NE 'YES').ERR11 HIVIER=??, IS AN ERROR        46300000
         AIF   ('&FUNCT' NE '08').ER11     NOT ALLOC, ERROR             46350000
         AIF   ('&MAP' NE 'INDEX').ER11   NOT INDEX, ERROR              46400000
&BHVO    SETB  1                          SET HIVIER=YES SWITCH         46450000
         AGO   .CK12                      AND SKIP NEXT CHECK           46500000
.ERR11   ANOP                                                           46550000
         SPACE 1                                                        46600000
         MNOTE 12,'***  IHB001 INVALID OPERAND - HIVIER=&HIVIER'        46650000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       46700000
         AGO   .CK12                    BYPASS THE NEXT CHECK           46750000
.ER11    ANOP                                                           46800000
         SPACE 1                                                        46850000
         MNOTE 12,'***  IHB020 HIVIER IS INVALID IF ACCESS=&ACCESS.,MAPX46900000
               =&MAP'                                                   46950000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       47000000
.*                                                                      47050000
.* ******************************************************************** 47100000
.* *     VALIDITY CHECK 'MAP=' KEYWORD                                  47150000
.* ******************************************************************** 47200000
.*                                                                      47250000
.CK12    ANOP                                                           47300000
         AIF   ('&MAP' EQ '').CK13        NO KEYWORD, IS IT MF=I        47350000
         AIF   ('&MAP' NE 'INDEX').CK12A  NOT INDEX, IS IT VOLUME       47400000
         AIF   ('&FUNCT' EQ '06' OR '&FUNCT' EQ '07').ER12              47450000
&BMIO    SETB  1                          SET MAP=INDEX SWITCH          47500000
&BMEN    SETB  0                          RESET MAP=VOLUME SWITCH       47550000
&BMCN    SETB  0                          RESET MAP=VTOC SWITCH         47600000
         AGO   .CK14                      AND SKIP NEXT CHECK           47650000
.CK12A   ANOP                                                           47700000
         AIF   ('&MAP' NE 'VOLUME').CK12B  NOT VOLUME, IS IT VTOC       47750000
         AIF   ('&FUNCT' EQ '06' OR '&FUNCT' EQ '07').ER12              47800000
&BMIN    SETB  0                          RESET MAP=INDEX SWITCH        47850000
&BMEO    SETB  1                          SET MAP=VOLUME SWITCH         47900000
&BMCN    SETB  0                          RESET MAP=VTOC SWITCH         47950000
         AGO   .CK14                      AND SKIP NEXT CHECK           48000000
.CK12B   ANOP                                                           48050000
         AIF   ('&MAP' NE 'VTOC').ERR12   NOT VTOC, ERROR               48100000
         AIF   ('&FUNCT' EQ '06' OR '&FUNCT' EQ '07').ER12              48150000
&BMIN    SETB  0                          RESET MAP=INDEX SWITCH        48200000
&BMEN    SETB  0                          RESET MAP=VOLUME SWITCH       48250000
&BMCO    SETB  1                          SET MAP=VTOC SWITCH           48300000
         AGO   .CK14                      AND SKIP NEXT CHECK           48350000
.ERR12   ANOP                                                           48400000
         SPACE 1                                                        48450000
         MNOTE 12,'***  IHB001 INVALID OPERAND - MAP=&MAP'              48500000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       48550000
         AGO   .CK14                    BYPASS THE NEXT CHECK           48600000
.ER12    ANOP                                                           48650000
         SPACE 1                                                        48700000
         MNOTE 12,'***  IHB021 MAP= IS INVALID IF ACCESS=&ACCESS'       48750000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       48800000
         AGO   .CK14                    BYPASS THE NEXT CHECK           48850000
.*                                                                      48900000
.* ******************************************************************** 48950000
.* *     INST FORM: MAP= IS REQUIRED WHEN ACCESS=ALLOC, RLSE, OR        49000000
.* *                MAPDATA IS CODED                                    49050000
.* ******************************************************************** 49100000
.*                                                                      49150000
.CK13    ANOP                                  MAP= IS NOT THERE        49200000
         AIF   ('&FM' NE 'I').CK14             NOT MF=I FORM, SKIP      49250000
         AIF   ('&FUNCT' EQ '06' OR '&FUNCT' EQ '07').CK14              49290000
         SPACE 1                                                        49330000
         MNOTE 12,'***  IHB022 MF=I FORM: MAP= IS REQUIRED FOR ACCESS=&X49370000
               ACCESS'                                                  49410000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       49450000
.*                                                                      49500000
.* ******************************************************************** 49550000
.* *     VALIDITY CHECK 'RECOVER=' KEYWORD                              49600000
.* ******************************************************************** 49650000
.*                                                                      49700000
.CK14    ANOP                                                           49750000
         AIF   ('&RECOVER' EQ '').CK15    NO KEYWORD, SKIP NEXT CHECK   49800000
         AIF   ('&RECOVER' NE 'NO').REC1  RECOVER=YES, GO CHECK IT      49850000
         AIF   ('&FUNCT' NE '06' AND '&FUNCT' NE '07').ER14             49900000
&BRCN    SETB  0                          SET RECOVER=NO SWITCH         49950000
         AGO   .CK15                      AND SKIP                      50000000
.REC1    ANOP                                                           50050000
         AIF   ('&RECOVER' NE 'YES').ERR14 RECOVER=??, IS AN ERROR      50100000
         AIF   ('&FUNCT' NE '06' AND '&FUNCT' NE '07').ER14             50150000
&BRCO    SETB  1                          SET RECOVER=YES SWITCH        50200000
         AGO   .CK15                      AND SKIP                      50250000
.ERR14   ANOP                                                           50300000
         SPACE 1                                                        50350000
         MNOTE 12,'***  IHB001 INVALID OPERAND - RECOVER=&RECOVER'      50400000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       50450000
         AGO   .CK15                    BYPASS THE NEXT CHECK           50500000
.ER14    ANOP                                                           50550000
         SPACE 1                                                        50600000
         MNOTE 12,'***  IHB023 RECOVER= IS INVALID IF ACCESS=&ACCESS'   50650000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       50750000
.*                                                                      50800000
.* ******************************************************************** 50850000
.* *     VALIDITY CHECK 'SEARCH=' KEYWORD                               50900000
.* ******************************************************************** 50950000
.*                                                                      51000000
.CK15    ANOP                                                           51050000
         AIF   ('&SEARCH' EQ '' AND '&FM' NE 'E').SRC2 SET BIT ON       51100000
         AIF   ('&SEARCH' EQ '').CK16     NO KEYWORD, SKIP              51150000
         AIF   ('&SEARCH' NE 'NO').SRC1   SEARCH=YES, GO CHECK IT       51200000
         AIF   ('&FUNCT' NE '08').ER15                                  51250000
&BSRN    SETB  0                          SET SEARCH=NO SWITCH          51300000
         AGO   .CK16                      AND SKIP                      51350000
.SRC1    ANOP                                                           51400000
         AIF   ('&SEARCH' NE 'YES').ERR15 SEARCH=??, IS AN ERROR        51450000
         AIF   ('&FUNCT' NE '08').ER15                                  51500000
&BSRO    SETB  1                          SET SEARCH=YES SWITCH         51550000
         AGO   .CK16                      AND SKIP                      51600000
.SRC2    ANOP                                                           51650000
         AIF   ('&FUNCT' NE '08').CK16                                  51700000
&BSRO    SETB  1                          SET SEARCH=YES SWITCH         51750000
         AGO   .CK16                      AND SKIP                      51800000
.ERR15   ANOP                                                           51850000
         SPACE 1                                                        51900000
         MNOTE 12,'***  IHB001 INVALID OPERAND - SEARCH=&SEARCH'        51950000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       52000000
         AGO   .CK16                    BYPASS THE NEXT CHECK           52050000
.ER15    ANOP                                                           52100000
         SPACE 1                                                        52150000
         MNOTE 12,'***  IHB024 SEARCH= IS INVALID IF ACCESS=&ACCESS'    52200000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       52250000
.*                                                                      52300000
.* ******************************************************************** 52350000
.* *     IF SPACE IS PRESENT, CHECK IF IN REG OR NOT                    52400000
.* ******************************************************************** 52450000
.*                                                                      52500000
.CK16    ANOP                                                           52550000
         AIF   ('&SPACE' EQ '').CK17    NO SPACE, SEE IF MF=I           52600000
         AIF   (N'&SPACE NE 1).ER16     ONLY 1 SPACE PARM ALLOWED       52650000
         AIF   ('&FUNCT' NE '08').ERR16  NOT ALLOC, ERROR               52700000
         AIF   ('&MAP' NE 'VOLUME').ERR16  NOT ALLOC, ERROR             52750000
&SWSPC   SETB 1                         SET SPACE SWITCH ON             52800000
         AIF   ('&SPACE'(1,1) EQ '(').SPCNREG                           52850000
&SPCNCOR SETB  1                        SPACE IS IN CORE                52900000
         AGO   .CK18                                                    52950000
.SPCNREG ANOP                                                           53000000
&K       SETA  K'&SPACE                 STORE NO. OF CHARS IN SPACE     53050000
&SPCNREG SETC  '&SPACE'(2,&K-2)         GET REGISTER OF SPACE           53100000
         AGO   .CK18                                                    53150000
.ER16    ANOP                           SPACE= **** ERROR ****          53200000
         SPACE 1                                                        53250000
         MNOTE 12,'***  IHB001 INVALID OPERAND - SPACE=&SPACE'          53300000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       53350000
         AGO   .CK18                    SKIP OTHER SPACE CHECKS         53400000
.ERR16   ANOP                                                           53450000
         SPACE 1                                                        53500000
         MNOTE 12,'***  IHB025 SPACE= IS INVALID IF ACCESS=&ACCESS.,MAPX53550000
               =&MAP'                                                   53600000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       53650000
         AGO   .CK18                    SKIP OTHER SPACE CHECKS         53700000
.*                                                                      53750000
.* ******************************************************************** 53800000
.* *     INST FORM: SPACE= IS REQUIRED WHEN SEARCH=NO                   53850000
.* ******************************************************************** 53900000
.*                                                                      53950000
.CK17    ANOP                           SPACE= IS NOT THERE             54000000
         AIF   ('&FM' NE 'I').CK18      NOT MF=I, SKIP                  54050000
         AIF   ('&SEARCH' NE 'NO').CK18 SEARCH=YES, SKIP                54100000
         SPACE 1                                                        54150000
         MNOTE 12,'***  IHB026 MF=I FORM: SPACE= IS REQUIRED FOR SEARCHX54200000
               =NO'                                                     54250000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       54300000
.*                                                                      54350000
.*                                                                      54400000
.* ******************************************************************** 54450000
.* *     VALIDITY CHECK THE BRANCH OPERANDS                             54500000
.* ******************************************************************** 54550000
.*                                                                      54600000
.CK18    ANOP                                                           54650000
         AIF   ('&BRANCH' EQ '').CKERR      NO BRANCH KEYWORD           54700000
         AIF   ('&BRANCH(1)' EQ 'NO').CKERR BRANCH=NO, GO ON            54750000
         AIF   ('&BRANCH(1)' NE 'YES').ER18 BAD BRANCH=                 54800000
         AIF   (N'&BRANCH EQ 1).CKERR       NO 2ND OPERAND              54850000
         AIF   (N'&BRANCH GT 2).ER18        BAD OPERAND                 54900000
         AIF   ('&BRANCH(2)' NE 'PGM').BR1  CHECK FOR PGM               54950000
&BPGO    SETB  1                        SET BRANCH=(YES,PGM) SWITCH     55000000
         AGO   .CKERR                                                   55050000
.BR1     ANOP                                                           55100000
         AIF   ('&BRANCH(2)' NE 'SUP').ER18 BAD 2ND OPERAND             55150000
&BPGN    SETB  0                        SET BRANCH=(YES,SUP) SWITCH     55200000
         AGO   .CKERR                                                   55250000
.ER18    ANOP                           BRANCH= **** ERROR ****         55300000
         SPACE 1                                                        55350000
         MNOTE 12,'***  IHB001 INVALID OPERAND - BRANCH=&BRANCH'        55400000
&ERRSW   SETB  1                        SET ERROR IN CHECK SWITCH       55450000
.*                                                                      55500000
.* ******************************************************************** 55550000
.* *     CHECK ERRORS: IF ANY PRESENT, SET A 'LABEL DS 0F' AND GET OUT  55600000
.* ******************************************************************** 55650000
.*                                                                      55700000
.CKERR   ANOP                                                           55750000
         AIF   ('&ERRSW' EQ '0').EXEC                                   55800000
&LABEL   DS    0F                                                       55850000
         AGO   .FINISH                                                  55900000
.*                                                                      55950000
.* ******************************************************************** 56000000
.* *     ALL PARAMETERS ARE GOOD - BUILD LIST OF DEFINED CONSTANTS.     56050000
.* ******************************************************************** 56100000
.*                                                                      56150000
.EXEC    ANOP                                                           56200000
&FLAG1   SETC  '0&BIOO&BPGO&BMRO&BIRO&BMIO&BMCO&BMEO'                   56250000
&FLAG2   SETC  '&BHVO.0&BCTO&BRCO&BSRO.000'                             56300000
&FLAG3   SETC  '0000000&BRTO'                                    @L2A   56325000
&L       SETC  '&LABEL'                                                 56350000
         AIF   ('&L' NE '').TSTI                                        56400000
&L       SETC  'ICV&NO.S'                                               56450000
.TSTI    ANOP                                                           56500000
         AIF   ('&FM' EQ 'I').STNDRD                                    56550000
         AIF   ('&FM' EQ 'L').LIST                                      56600000
.*                                                                      56650000
.* ******************************************************************** 56700000
.* *     BEGIN BUILD FOR EXECUTE FORM OF MACRO                          56750000
.* ******************************************************************** 56800000
.*                                                                      56850000
         AIF   ('&LABEL' EQ '').OVER   SKIP OVER LABEL                  56900000
&L       EQU   *                                                        56950000
.OVER    ANOP                                                           57000000
         IHBINNRA &MF(2)                PARM LIST INTO REG 1            57050000
         AIF   ('&ACCESS' EQ '').E2     NO ACCESS=, SKIP                57100000
         MVI   6(1),X'&FUNCT'           SET FUNCTION CODE               57150000
         AGO   .E2                      GO TO COMMON ROUTINE            57200000
.*                                                                      57250000
.* ******************************************************************** 57300000
.* *     BEGIN BUILD FOR LIST FORM OF MACRO                             57350000
.* ******************************************************************** 57400000
.*                                                                      57450000
.LIST    ANOP                                                           57500000
         CNOP  0,4                                                      57550000
&L       EQU   *                                                        57600000
         AGO   .COMMON                  GO TO COMMON ROUTINE            57650000
.*                                                                      57700000
.* ******************************************************************** 57750000
.* *     BEGIN BUILD FOR STANDARD FORM OF MACRO                         57800000
.* ******************************************************************** 57850000
.*                                                                      57900000
.STNDRD  ANOP                                                           57950000
         CNOP  0,4                                                      58000000
&LABEL   BAL   1,ICV&NO.E               LOAD CVPL LIST ADDRESS          58050000
&L       SETC  'ICV&NO.S'               SET START OF CVPL               58100000
&L       EQU   *                        START OF CVPL                   58150000
.*                                                                      58200000
.* ******************************************************************** 58250000
.* *     COMMON BUILD CODE FOR MF=I AND L FORMS                         58300000
.* ******************************************************************** 58350000
.*                                                                      58400000
.COMMON  ANOP                                                           58450000
         DC    CL4'CVPL'                EBCDIC 'CVPL'                   58500000
         DC    AL2(ICV&NO.E-&L)         LENGTH OF CVPL                  58550000
         DC    XL1'&FUNCT'              FUNCTION CODE                   58600000
         DC    XL1'00'                  STATUS INFORMATION              58650000
         DC    B'&FLAG1'                FIRST FLAG BYTE                 58700000
         DC    B'&FLAG2'                SECOND FLAG BYTE                58750000
         DC    B'&FLAG3'                THIRD FLAG BYTE          @L2A   58783300
         DC    X'0'                     RESERVED                 @L2C   58816600
.*                                                                      58850000
.* ******************************************************************** 58900000
.* *     UCB PROCESSING                                                 58950000
.* ******************************************************************** 59000000
.*                                                                      59050000
         AIF   ('&SWUCB' EQ '0').U3     NO UCB PRESENT, SKIP            59100000
         AIF   ('&UCBNCOR' EQ '0').U3   UCB IN REG, SKIP                59150000
         DC    A(&UCB)                  UCB ADDRESS                     59200000
         AGO   .D2                      GO ON TO DSN                    59250000
.U3      ANOP                                                           59300000
         DC    A(0)                     UCB ADDRESS                     59350000
.*                                                                      59400000
.* ******************************************************************** 59450000
.* *     DSN PROCESSING                                                 59500000
.* ******************************************************************** 59550000
.*                                                                      59600000
.D2      ANOP                                                           59650000
         AIF   ('&SWDSN' EQ '0').D3     NO DSN PRESENT, SKIP            59700000
         AIF   ('&DSNNCOR' EQ '0').D3   DSN IN REG, SKIP                59750000
         DC    A(&DSN)                  DATA SET NAME ADDRESS           59800000
         AGO   .I3                      GO ON TO IXRCDS                 59850000
.D3      ANOP                                                           59900000
         DC    A(0)                     DATA SET NAME ADDRESS           59950000
.*                                                                      60000000
.* ******************************************************************** 60050000
.* *     IXRCDS PROCESSING                                              60100000
.* ******************************************************************** 60150000
.*                                                                      60200000
.I3      ANOP                                                           60250000
         DC    A(0)                     BUFFER LIST ADDRESS             60300000
         AIF   ('&SWIXR' EQ '0').I5     NO IXRCDS PRESENT, SKIP         60350000
         AIF   ('&IXRNCOR' EQ '0').I5   IXRCDS IN REG, SKIP             60400000
         DC    A(&IXRCDS(2))            INDEX VIR'S BUFFER LIST ADDRESS 60450000
         AGO   .M2                      GO ON TO MAPRCDS                60500000
.I5      ANOP                                                           60550000
         DC    A(0)                     INDEX VIR'S BUFFER LIST ADDRESS 60600000
.*                                                                      60650000
.* ******************************************************************** 60700000
.* *     MAPRCDS PROCESSING                                             60750000
.* ******************************************************************** 60800000
.*                                                                      60850000
.M2      ANOP                                                           60900000
         AIF   ('&SWMPR' EQ '0').M3     NO MAPRCDS PRESENT, SKIP        60950000
         AIF   ('&MPRNCOR' EQ '0').M3   MAPRCDS IN REG, SKIP            61000000
         DC    A(&MAPRCDS(2))           MAP VIR'S BUFFER LIST ADDRESS   61050000
         AGO   .O2                      GO ON TO IOAREA                 61100000
.M3      ANOP                                                           61150000
         DC    A(0)                     MAP VIR'S BUFFER LIST ADDRESS   61200000
.*                                                                      61250000
.* ******************************************************************** 61300000
.* *     IOAREA PROCESSING                                              61350000
.* ******************************************************************** 61400000
.*                                                                      61450000
.O2      ANOP                                                           61500000
         AIF   ('&SWIOA' EQ '0').O3     NO IOAREA PRESENT, SKIP         61550000
         AIF   ('&IOANCOR' EQ '0').O3   IOAREA IN REG, SKIP             61600000
         DC    A(&IOAREA(2))            I/O AREA ADDRESS                61650000
         AGO   .DEB2                    GO ON TO ARG                    61700000
.O3      ANOP                                                           61750000
         DC    A(0)                     I/O AREA ADDRESS                61800000
.*                                                                      61850000
.* ******************************************************************** 61900000
.* *     DEB PROCESSING                                                 61903800
.* ******************************************************************** 61907600
.*                                                                      61911400
.DEB2    ANOP                                                           61915200
         AIF   ('&SWDEB' EQ '0').DEB3   NO DEB PRESENT, SKIP            61919000
         AIF   ('&DEBNCOR' EQ '0').DEB3 DEB IN REG, SKIP                61922800
         DC    A(&DEB)                  DEB ADDRESS                     61926600
         AGO   .ARG2                    GO ON TO ARG                    61930400
.DEB3    ANOP                                                           61934200
         DC    A(0)                     DEB ADDRESS                     61938000
.*                                                                      61941800
.* ******************************************************************** 61945600
.* *     ARG PROCESSING                                                 61950000
.* ******************************************************************** 62000000
.*                                                                      62050000
.ARG2    ANOP                                                           62100000
         AIF   ('&SWARG' EQ '0').ARG3   NO ARG PRESENT, SKIP            62200000
         AIF   ('&ARGNCOR' EQ '0').ARG3 ARG IN REG, SKIP                62250000
         DC    A(&ARG)                  ARGUMENT ADDRESS                62300000
         AGO   .SPC2                    GO ON TO SPACE                  62350000
.ARG3    ANOP                                                           62400000
         DC    A(0)                     ARGUMENT ADDRESS                62450000
.*                                                                      62500000
.* ******************************************************************** 62550000
.* *     SPACE PROCESSING                                               62600000
.* ******************************************************************** 62650000
.*                                                                      62700000
.SPC2    ANOP                                                           62750000
         AIF   ('&SWSPC' EQ '0').SPC3   NO SPACE PRESENT, SKIP          62800000
         AIF   ('&SPCNCOR' EQ '0').SPC3 SPACE IN REG, SKIP              62850000
         DC    A(&SPACE)                SPACE PARAMETER LIST ADDRESS    62900000
         AGO   .EXT2                    GO ON TO EXTENTS                62950000
.SPC3    ANOP                                                           63000000
         DC    A(0)                     SPACE PARAMETER LIST ADDRESS    63050000
.*                                                                      63100000
.* ******************************************************************** 63150000
.* *     EXTENTS PROCESSING                                             63200000
.* ******************************************************************** 63250000
.*                                                                      63300000
.EXT2    ANOP                                                           63350000
         AIF   ('&SWEXT' EQ '0').EXT3   NO EXTENTS PRESENT, SKIP        63400000
         AIF   ('&EXTNCOR' EQ '0').EXT3 EXTENTS IN REG, SKIP            63450000
         DC    A(&EXTENTS)              EXTENTS TABLE ADDRESS           63500000
         AGO   .CNT2                    GO ON TO COUNT AREA             63550000
.EXT3    ANOP                                                           63600000
         DC    A(0)                     EXTENTS TABLE ADDRESS           63650000
.*                                                                      63700000
.* ******************************************************************** 63750000
.* *     CTAREA PROCESSING                                              63800000
.* ******************************************************************** 63850000
.*                                                                      63900000
.CNT2    ANOP                                                           63950000
         DC    A(0)                     NEW VRF VIXM BUFFER LIST ADDR   64000000
         DC    A(0)                     VRF DATA ADDRESS                64050000
         AIF   ('&SWCTA' EQ '0').CNT3   NO COUNT AREA PRESENT, SKIP     64100000
         AIF   ('&CTANCOR' EQ '0').CNT3 COUNT AREA IN REG, SKIP         64150000
         DC    A(&CTAREA)               COUNT AREA ADDRESS              64200000
         AGO   .DONE                    GO ON TO COUNT AREA             64250000
.CNT3    ANOP                                                           64300000
         DC    A(0)                     COUNT AREA ADDRESS              64350000
.DONE    ANOP                                                           64400000
ICV&NO.E EQU   *                        END OF CVPL                     64450000
         AIF   ('&FM' EQ 'L').FINISH    LIST FORM IS DONE               64500000
.*                                                                      64550000
.* ******************************************************************** 64600000
.* *     COMMON BUILD CODE FOR MF=I AND (E,ADDR) FORMS                  64650000
.* ******************************************************************** 64700000
.*                                                                      64750000
.E2      ANOP                                                           64800000
         AIF   ('&FM' EQ 'I').UCB1                                      64850000
&FLAG1N  SETC  '1&BION&BPGN&BMRN.1&BMIN&BMCN&BMEN'                      64900000
&FLAG2N  SETC  '&BHVN.1&BCTN&BRCN&BSRN.111'                             64950000
&FLAG3N  SETC  '1111111&BRTN'                                    @L2A   64975000
         AIF   ('&FLAG1N' EQ '11111111').OF1                            65000000
         NI    8(1),B'&FLAG1N'          RESET CVAF FLAGS OFF            65050000
.OF1     ANOP                                                           65100000
         AIF   ('&FLAG1' EQ '00000000').NF2                             65150000
         OI    8(1),B'&FLAG1'           SET CVAF FLAGS ON               65200000
.NF2     ANOP                                                           65250000
         AIF   ('&FLAG2N' EQ '11111111').OF2                            65300000
         NI    9(1),B'&FLAG2N'          RESET CVAF FLAGS OFF            65350000
.OF2     ANOP                                                           65400000
         AIF   ('&FLAG2' EQ '00000000').NF3                        @L2C 65450000
         OI    9(1),B'&FLAG2'           SET CVAF FLAGS ON               65500000
.NF3     ANOP                                                      @L2A 65507100
         AIF   ('&FLAG3N' EQ '11111111').OF3                       @L2A 65514200
         NI    10(1),B'&FLAG3N'         RESET CVAF FLAGS OFF       @L2A 65521300
.OF3     ANOP                                                      @L2A 65528400
         AIF   ('&FLAG3' EQ '00000000').UCB1                       @L2A 65535500
         OI    10(1),B'&FLAG3'          SET CVAF FLAGS ON          @L2A 65542600
.*                                                                      65550000
.* ******************************************************************** 65600000
.* *     COMMON BUILD CODE FOR MF=I AND (E,ADDR) FORMS                  65650000
.* *     START WITH UCB PROCESSING                                      65700000
.* ******************************************************************** 65750000
.*                                                                      65800000
.UCB1    ANOP                                                           65850000
         AIF   ('&SWUCB' EQ '0').DSN1   NO UCB TO PROCESS               65900000
         AIF   ('&UCBNCOR' EQ '1').UNC  UCB IN CORE, SKIP               65950000
         ST    &UCBNREG,12(,1)          STORE UCB PTR IN PARM LIST      66000000
         AGO   .DSN1                                                    66050000
.UNC     ANOP                                                           66100000
         AIF   ('&FM' EQ 'I').DSN1      MF=I, ALREADY THERE, SKIP       66150000
         LA    15,&UCB                  GET UCB ADDRESS AND             66200000
         ST    15,12(,1)                STORE UCB PTR IN PARM LIST      66250000
.*                                                                      66300000
.* ******************************************************************** 66350000
.* *     DSN PROCESSING                                                 66400000
.* ******************************************************************** 66450000
.*                                                                      66500000
.DSN1    ANOP                                                           66550000
         AIF   ('&SWDSN' EQ '0').IXR1   NO DSN TO PROCESS               66600000
         AIF   ('&DSNNCOR' EQ '1').DNC  DSN IN CORE, SKIP               66650000
         ST    &DSNNREG,16(,1)          STORE DSN PTR IN PARM LIST      66700000
         AGO   .IXR1                                                    66750000
.DNC     ANOP                                                           66800000
         AIF   ('&FM' EQ 'I').IXR1      MF=I, ALREADY THERE, SKIP       66850000
         LA    15,&DSN                  GET DSN ADDRESS AND             66900000
         ST    15,16(,1)                STORE DSN PTR IN PARM LIST      66950000
.*                                                                      67000000
.* ******************************************************************** 67050000
.* *     IXRCDS PROCESSING                                              67100000
.* ******************************************************************** 67150000
.*                                                                      67200000
.IXR1    ANOP                                                           67250000
         AIF   ('&SWIXR' EQ '0').MPR1   NO IXRCDS TO PROCESS            67300000
         AIF   ('&IXRNCOR' EQ '1').INC  IXRCDS IN CORE, SKIP            67350000
         ST    &IXRNREG,24(,1)          STORE IXRCDS PTR IN PARM LIST   67400000
         AGO   .MPR1                                                    67450000
.INC     ANOP                                                           67500000
         AIF   ('&FM' EQ 'I').MPR1      MF=I, ALREADY THERE, SKIP       67550000
         LA    15,&IXRCDS(2)            GET IXRCDS ADDRESS AND          67600000
         ST    15,24(,1)                STORE ADDRESS IN PARM LIST      67650000
.*                                                                      67700000
.* ******************************************************************** 67750000
.* *     MAPRCDS PROCESSING                                             67800000
.* ******************************************************************** 67850000
.*                                                                      67900000
.MPR1    ANOP                                                           67950000
         AIF   ('&SWMPR' EQ '0').IOA1   NO MAPRCDS TO PROCESS           68000000
         AIF   ('&MPRNCOR' EQ '1').MNC  MAPRCDS IN CORE, SKIP           68050000
         ST    &MPRNREG,28(,1)          STORE MAPRCDS PTR IN PARM LIST  68100000
         AGO   .IOA1                                                    68150000
.MNC     ANOP                                                           68200000
         AIF   ('&FM' EQ 'I').IOA1      MF=I, ALREADY THERE, SKIP       68250000
         LA    15,&MAPRCDS(2)           GET MAPRCDS ADDRESS AND         68300000
         ST    15,28(,1)                STORE ADDRESS IN PARM LIST      68350000
.*                                                                      68400000
.* ******************************************************************** 68450000
.* *     IOAREA PROCESSING                                              68500000
.* ******************************************************************** 68550000
.*                                                                      68600000
.IOA1    ANOP                                                           68650000
         AIF   ('&SWIOA' EQ '0').DEB1   NO IOAREA TO PROCESS            68700000
         AIF   ('&IOANCOR' EQ '1').ONC  IOAREA IN CORE, SKIP            68750000
         ST    &IOANREG,32(,1)          STORE IOAREA PTR IN PARM LIST   68800000
         AGO   .DEB1                                                    68850000
.ONC     ANOP                                                           68900000
         AIF   ('&FM' EQ 'I').DEB1      MF=I, ALREADY THERE, SKIP       68950000
         LA    15,&IOAREA(2)            GET IOAREA ADDRESS AND          69000000
         ST    15,32(,1)                STORE ADDRESS IN PARM LIST      69050000
.*                                                                      69100000
.* ******************************************************************** 69150000
.* *     DEB PROCESSING                                                 69153300
.* ******************************************************************** 69156600
.*                                                                      69159900
.DEB1    ANOP                                                           69163200
         AIF   ('&SWDEB' EQ '0').ARG1   NO DEB TO PROCESS               69166500
         AIF   ('&DEBNCOR' EQ '1').DBNC DEB IN CORE, SKIP               69169800
         ST    &DEBNREG,36(,1)          STORE DEB PTR IN PARM LIST      69173100
         AGO   .ARG1                                                    69176400
.DBNC    ANOP                                                           69179700
         AIF   ('&FM' EQ 'I').ARG1      MF=I, ALREADY THERE, SKIP       69183000
         LA    15,&DEB                  GET DEB ADDRESS AND             69186300
         ST    15,36(,1)                STORE ADDRESS IN PARM LIST      69189600
.*                                                                      69192900
.* ******************************************************************** 69196200
.* *     ARG PROCESSING                                                 69200000
.* ******************************************************************** 69250000
.*                                                                      69300000
.ARG1    ANOP                                                           69350000
         AIF   ('&SWARG' EQ '0').SPC1   NO ARG TO PROCESS               69400000
         AIF   ('&ARGNCOR' EQ '1').ANC  ARG IN CORE, SKIP               69450000
         ST    &ARGNREG,40(,1)          STORE ARG PTR IN PARM LIST      69500000
         AGO   .SPC1                                                    69550000
.ANC     ANOP                                                           69600000
         AIF   ('&FM' EQ 'I').SPC1      MF=I, ALREADY THERE, SKIP       69650000
         LA    15,&ARG                  GET ARG ADDRESS AND             69700000
         ST    15,40(,1)                STORE ADDRESS IN PARM LIST      69750000
.*                                                                      69800000
.* ******************************************************************** 69850000
.* *     SPACE PROCESSING                                               69900000
.* ******************************************************************** 69950000
.*                                                                      70000000
.SPC1    ANOP                                                           70050000
         AIF   ('&SWSPC' EQ '0').EXT1   NO SPACE TO PROCESS             70100000
         AIF   ('&SPCNCOR' EQ '1').SNC  SPACE IN CORE, SKIP             70150000
         ST    &SPCNREG,44(,1)          STORE SPACE PTR IN PARM LIST    70200000
         AGO   .EXT1                                                    70250000
.SNC     ANOP                                                           70300000
         AIF   ('&FM' EQ 'I').EXT1      MF=I, ALREADY THERE, SKIP       70350000
         LA    15,&SPACE                GET SPACE ADDRESS AND           70400000
         ST    15,44(,1)                STORE ADDRESS IN PARM LIST      70450000
.*                                                                      70500000
.* ******************************************************************** 70550000
.* *     EXTENTS PROCESSING                                             70600000
.* ******************************************************************** 70650000
.*                                                                      70700000
.EXT1    ANOP                                                           70750000
         AIF   ('&SWEXT' EQ '0').CT1    NO EXTENTS TO PROCESS           70800000
         AIF   ('&EXTNCOR' EQ '1').ENC  EXTENTS IN CORE, SKIP           70850000
         ST    &EXTNREG,48(,1)          STORE EXTENTS PTR IN PARM LIST  70900000
         AGO   .CT1                                                     70950000
.ENC     ANOP                                                           71000000
         AIF   ('&FM' EQ 'I').CT1       MF=I, ALREADY THERE, SKIP       71050000
         LA    15,&EXTENTS              GET EXTENTS ADDRESS AND         71100000
         ST    15,48(,1)                STORE ADDRESS IN PARM LIST      71150000
.*                                                                      71200000
.* ******************************************************************** 71250000
.* *     CTAREA PROCESSING                                              71300000
.* ******************************************************************** 71350000
.*                                                                      71400000
.CT1     ANOP                                                           71450000
         AIF   ('&SWCTA' EQ '0').BRANCH NO CTAREA TO PROCESS            71500000
         AIF   ('&CTANCOR' EQ '1').CNC  CTAREA IN CORE, SKIP            71550000
         ST    &CTANREG,60(,1)          STORE CTAREA PTR IN PARM LIST   71600000
         AGO   .BRANCH                                                  71650000
.CNC     ANOP                                                           71700000
         AIF   ('&FM' EQ 'I').BRANCH    MF=I, ALREADY THERE, SKIP       71750000
         LA    15,&CTAREA               GET CTAREA ADDRESS AND          71800000
         ST    15,60(,1)                STORE CTAREA PTR IN PARM LIST   71850000
.*                                                                      71900000
.* ******************************************************************** 71950000
.* *     BRANCH PROCESSING -                                            72000000
.* *     LOAD THE CVT, THE VS1/VS2 COMMON EXTENTION 2 POINTER,          72050000
.* *     THE CVTCVAF PTR, THE CVAF POINTER AND BRANCH TO CVAF           72070000
.* *     COMMON ICVCMM00                                                72090000
.* *                                                                    72150000
.* ******************************************************************** 72200000
.*                                                                      72250000
.BRANCH  ANOP                                                           72300000
         AIF   ('&BRANCH' EQ '' OR '&BRANCH(1)' EQ 'NO').SVC139         72350000
         L     15,16                    LOAD THE CVT                    72400000
         L     15,328(,15)              LOAD VS1/VS2 COMMON EXTENTION2  72420000
         L     15,12(,15)               LOAD THE CVAF TABLE ADDRESS     72440000
         CLI   14(15),X'81'             WHAT SYSTEM?               @L1A 72453300
         BNL   ICV&NO.B                 BRANCH IF X/A              @L1A 72466600
         L     15,0(,15)                LOAD THE CVAF ADDRESS      @L1A 72479900
         BALR  14,15                    BRANCH AND LINK TO         @L1A 72493200
*                                       GLUE MODULE ICVCMM01       @L1A 72506500
         B     ICV&NO.C                                            @L1A 72519800
ICV&NO.B EQU   *                        MUST SET MODE (BASSM)      @L1A 72533100
         L     15,28(,15)               LOAD THE CVAF ADDRESS      @L1A 72546400
         DC    X'0CEF'                  BR, SAVE & SET MODE TO     @L1A 72559700
*                                       MODULE ICVCMM00            @L1A 72573000
ICV&NO.C DS    0H                                                  @L1A 72586300
         AGO   .FINISH                                                  72600000
.* ******************************************************************** 72650000
.* *     SVC139 PROCESSING                                              72700000
.* ******************************************************************** 72750000
.*                                                                      72800000
.SVC139  ANOP                                                           72850000
         SVC   139                                                      72900000
.FINISH  ANOP                                                           72950000
         MEND                                                           73000000
