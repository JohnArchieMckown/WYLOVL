         MACRO                                                                  
&L       PEND  &P                                                               
.*       Added 4/79, JDN; Modified, 12/90, Niz                                  
         GBLB  &$PCODE                                                          
         GBLA  &$PPTR                                                           
         GBLC  &$PSTK(0),&$PLENSTK(0),&$PFRSTK(0),&$PLRSTK(0)                   
         GBLC  &$PPTRSTK(0),&$PENDSTK(0)                                        
.*                                                                              
&L       END   TYPE=P                                                           
         POP   RAR,                                                    *        
               (&$PFRSTK(&$PPTR),&$PLRSTK(&$PPTR)),&$PLENSTK(&$PPTR),  *        
               PTR=&$PPTRSTK(&$PPTR)                                            
&ENDMAC  SETC  '&$PENDSTK(&$PPTR)'                                              
&$PPTR   SETA  &$PPTR-1                                                         
         AIF   (&$PCODE).CGEN                                                   
.*                                                                              
.*       User defined exit macro.                                               
.*                                                                              
         AIF   ('&ENDMAC' EQ '').NORM                                           
         &ENDMAC &P                                                             
         MEXIT                                                                  
.*                                                                              
.*       Normal exit convention.                                                
.*                                                                              
.NORM    AIF   ('&P' EQ '*').NOCC                                               
&R       SETC  'R15'                                                            
         AIF   ('&P' EQ '').LTR                                                 
&R       SETC  '&P'                                                             
         AIF   ('&P'(1,1) EQ '''').GEN                                          
.LTR     LTR   &R,&R                                                            
.NOCC    BR    RAR                                                              
         MEXIT                                                                  
.*                                                                              
.GEN     GEN   &P                                                               
         BR    RAR                                                              
         MEXIT                                                                  
.*                                                                              
.*       C-code                                                                 
.*                                                                              
.CGEN    ANOP                                                                   
         AIF   ('&ENDMAC' EQ '').NORM2                                          
         MNOTE 8,'User exit macro not supported for C-CODE.'                    
.*       &ENDMAC &P                                                             
         MEXIT                                                                  
.*                                                                              
.*       Normal exit convention.                                                
.*                                                                              
.NORM2   AIF   ('&P' EQ '*').NOCC2                                              
&R       SETC  'R15'                                                            
         AIF   ('&P' EQ '').LTR2                                                
&R       SETC  '&P'                                                             
         AIF   ('&P'(1,1) EQ '''').GEN2                                         
.LTR2    LTR   &R,&R                                                            
.NOCC2   ANOP                                                                   
*C-CODE return;                                                                 
         DS    0H                                                               
*C-CODE }                                                                       
*C-PEND                                                                         
         DS    0H                                                               
         MEXIT                                                                  
.*                                                                              
.GEN2    GEN   &P                                                               
*C-CODE return;                                                                 
         DS    0H                                                               
*C-CODE }                                                                       
*C-PEND                                                                         
         DS    0H                                                               
         MEND                                                                   
